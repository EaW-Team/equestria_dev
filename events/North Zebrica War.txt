add_namespace = north_war
add_namespace = north_war_alliance

#Hippogriffia Receives the White Peace Offer from Chiropterra and Colthage
#Called by northern_war_peace_timer in northern_zebrican_war_decision.txt
#Event chain from 1 - 4
country_event = { 
	id = north_war.1
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.1"}
	title = north_war.1.t
	desc = north_war.1.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes

	option = { #Accept
		ai_chance = {
			factor = 90
		}
		name = north_war.1.a
		hidden_effect = {
			country_event = {
				id = north_war.3 # Smooth transition event (hidden)
			}
		}
		hidden_effect = {
			every_other_country = {
				limit = {
					has_war_with = HIP
					NOT = {
						has_country_flag = NZW_war_participant
					}
					OR = {
						is_faction_leader = yes
						is_in_faction = no
						AND = {
							is_in_faction = yes
							var:faction_leader = {
								NOT = {
									has_war_with = HIP
								}
							}
						}
					}
				}
				country_event = {
					id = north_war.33 # Gets the opportunity to offer white peace to HIP
					days = 2
				}
			}
		}
		hidden_effect = {
			country_event = {
				id = hippogriff.1002 # NZW defeat event sender
				days = 3
			}
		}
	}

	option = { #Refuse
		ai_chance = {
			factor = 10
		}
		name = north_war.1.b
		custom_effect_tooltip = northern_total_war_tp
		add_stability = -0.10
		add_war_support = -0.10
		add_popularity = {
			ideology = var:current_party_ideology_group
			popularity = -0.1
		}
		hidden_effect = {
			if = {
				limit = {
					NZ1 = {
						has_country_flag = NZW_war_participant
					}
				}
				NZ1 = {
					country_event = {
						id = north_war.4 # Informed that peace was declined
					}
				}
			}
			if = {
				limit = {
					NZ2 = {
						has_country_flag = NZW_war_participant
					}
				}
				NZ2 = {
					country_event = {
						id = north_war.4 # Informed that peace was declined
					}
				}
			}
			if = {
				limit = {
					WNG = {
						has_country_flag = NZW_war_participant
					}
				}
				WNG = {
					country_event = {
						id = north_war.4 # Informed that peace was declined
					}
				}
			}
		}
		country_event = {
			id = hippogriff.66 # Beginning of Defeatism
			days = 2
		}
	}
}

country_event = { #Chiropterra and Colthage receive what they demanded from Hippogriffia
	id = north_war.2
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.2"}
	title = north_war.2.t
	desc = north_war.2.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					has_global_flag = NZW_alliance_signed_flag
				}
				country_event = {
					id = north_war_alliance.5 # Option to dissolve alliance
					days = 2
				}
			}
		}
	}
	
	option = {
		trigger = {
			original_tag = BAT
		}
		name = north_war.2.a
				
		hidden_effect = {
			set_country_flag = BAT_HIP_defeated
			
			if = {
				limit = {
					NOT = {
						has_global_flag = NZW_alliance_signed_flag
					}
				}
				country_event = {
					id = bat.79
				}
			}
		}
	}
	option = {
		trigger = {
			NOT = { original_tag = BAT }
		}
		name = north_war.2.b
		
		hidden_effect = {
			set_country_flag = BAT_HIP_defeated
		}
	}
}

country_event = { #Hidden Event for smooth transition
	id = north_war.3
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.3"}
	hidden = yes

	is_triggered_only = yes

	option = {
		name = north_war.3.a
		
		# Peacemaking
		HIP = { # The main contenders
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			if = {
				limit = {
					has_war_with = NZ1
				}
				white_peace = NZ1
				
				NZ1 = {
					country_event = {
						id = north_war.2
						hours = 6
					}
				}
			}
			if = {
				limit = {
					has_war_with = NZ2
				}
				white_peace = NZ2
				
				NZ2 = {
					country_event = {
						id = north_war.2
						hours = 6
					}
				}
			}
			if = {
				limit = {
					has_war_with = WNG
				}
				white_peace = WNG
				
				WNG = {
					country_event = {
						id = north_war.2
						hours = 6
					}
				}
			}
		}
		if = { # Everybody allied with the north (if the north was at war)
			limit = {
				NZ1 = {
					has_country_flag = NZW_war_participant
				}
			}
			every_other_country = {
				limit = {
					NZW_is_aligned_with_NZ1 = yes
					has_war_with = HIP
				}
				set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
				white_peace = HIP
			}
		}
		if = { # Everybody allied with the south (if the south was at war)
			limit = {
				NZ2 = {
					has_country_flag = NZW_war_participant
				}
			}
			every_other_country = {
				limit = {
					NZW_is_aligned_with_NZ1 = yes
					has_war_with = HIP
				}
				set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
				white_peace = HIP
			}
		}
		if = { # Everybody allied with Wingbardy (if Wingbardy was at war)
			limit = {
				WNG = {
					has_country_flag = NZW_war_participant
				}
			}
			every_other_country = {
				limit = {
					OR = {
						is_in_faction_with = WNG
						is_subject_of = WNG
					}
					has_war_with = HIP
				}
				set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
				white_peace = HIP
			}
		}
		
		# Hippogriffia allies make peace
		every_other_country = {
			limit = {
				NZW_is_aligned_with_HIP = yes
				has_war_with = NZ1
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = NZ1
		}
		every_other_country = {
			limit = {
				NZW_is_aligned_with_HIP = yes
				has_war_with = NZ2
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = NZ2
		}
		every_other_country = {
			limit = {
				NZW_is_aligned_with_HIP = yes
				has_war_with = WNG
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = WNG
		}
		
		# The peace deal
		NZW_HIP_surrender_peace_deal_effect = yes
	}
}

country_event = { #Chiropterra and Colthage receive the news that Hippogriffia will not surrender
	id = north_war.4
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.4"}
	title = north_war.4.t
	desc = north_war.4.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes

	option = {
		trigger = {
			original_tag = BAT
		}
		name = north_war.4.a
		custom_effect_tooltip = northern_total_war_2_tp
		add_war_support = 0.10
		hidden_effect = {
		    clr_global_flag = NZW_war_status_partial
			set_global_flag = NZW_war_status_total
			set_global_flag = NZW_war_status_partial_blocked
		}
		if = {
			limit = {
				has_global_flag = NZW_winggarten_established
				is_ai = no
			}
			country_event = north_war.21 # Option to play as Winggarten
		}
	}
	option = {
		trigger = {
			NOT = { original_tag = BAT }
		}
		name = north_war.4.b
		custom_effect_tooltip = northern_total_war_2_tp
		add_war_support = 0.10
		hidden_effect = {
		    clr_global_flag = NZW_war_status_partial
			set_global_flag = NZW_war_status_total
			set_global_flag = NZW_war_status_partial_blocked
		}
		if = {
			limit = {
				has_global_flag = NZW_winggarten_established
				is_ai = no
			}
			country_event = north_war.21 # Option to play as Winggarten
		}
	}
}

country_event = { #Player Receives Option to play as Winggarden
	id = north_war.21
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.21"}
	title = north_war.21.t
	desc = north_war.21.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes

	option = {
		name = north_war.21.a
		add_political_power = 5
	}

	option = {
		name = north_war.21.b
		custom_effect_tooltip = switch_to_winggarden_tp
		hidden_effect = {
			WIN = {
				change_tag_from = ROOT
			}
			WIN = {
			    activate_WIN_influence_mission = yes
			}
		}
	}
}

# Hippogriffia-Wingbardy peace section - TODO
# No 30 - 36, except 33

country_event = { #Hidden event for WNG-HIP white peace
	id = north_war.30
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.30"}
	hidden = yes

	is_triggered_only = yes
		option = {
		name = north_war.30.a
		WNG = {
			country_event = hippogriff.641
		}
		HIP = {
			country_event = {id = hippogriff.641 hours = 6}
		}
		WNG = {
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = HIP
			clr_country_flag = NZW_war_participant
		}
		every_other_country = {
			limit = {
				OR = {
					is_subject_of = BAT
					is_in_faction_with = BAT
				}
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = HIP
		}
		every_other_country = {
			limit = {
				OR = {
					is_subject_of = WNG
					is_in_faction_with = WNG
				}
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = HIP
		}
		every_other_country = {
			limit = {
				OR = {
					is_subject_of = ROOT
					is_in_faction_with = ROOT
				}
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = WNG
		}
	}
}

country_event = { #Hidden event for HIP enforcing demands on WNG
	id = north_war.31
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.31"}
	hidden = yes

	is_triggered_only = yes
		option = {
		name = north_war.31.a
		HIP = {
			set_country_flag = HIP_won_north_zebrican_war
			mark_focus_tree_layout_dirty = yes
		}
		WNG = {
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = HIP
			clr_country_flag = NZW_war_participant
		}
		every_other_country = {
			limit = {
				OR = {
					is_subject_of = BAT
					is_in_faction_with = BAT
				}
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = HIP
		}
		every_other_country = {
			limit = {
				OR = {
					is_subject_of = WNG
					is_in_faction_with = WNG
				}
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = HIP
		}
		every_other_country = {
			limit = {
				OR = {
					is_subject_of = ROOT
					is_in_faction_with = ROOT
				}
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = WNG
		}
		if = {
			limit = {
				ABY = {
					exists = no
				}
			}
			WNG = {
				release = ABY
			}
			ABY = {
				every_core_state = {
					limit = {
						owner = {
							OR = {
								tag = WNG
								OR = {
									is_subject_of = WNG
									is_in_faction_with = WNG
								}
							}
						}
					}
				set_state_owner_to = ABY
				set_state_controller_to = ABY
				}
				set_country_flag = HIP_liberated_ABY
			}
		}
		else_if = {
			limit = {
				ABY = {
					is_subject_of = WNG
				}
			}
			end_puppet = ABY
			ABY = {
				leave_faction = yes
				every_core_state = {
					limit = {
						owner = {
							OR = {
								tag = WNG
								OR = {
									is_subject_of = WNG
									is_in_faction_with = WNG
								}
							}
						}
					}
				set_state_owner_to = ABY
				set_state_controller_to = ABY
				}
				set_country_flag = HIP_liberated_ABY
			}
		}
		else = {
			ABY = {
				every_core_state = {
					limit = {
						owner = {
							OR = {
								tag = WNG
								OR = {
									is_subject_of = WNG
									is_in_faction_with = WNG
								}
							}
						}
					}
				set_state_owner_to = ABY
				set_state_controller_to = ABY
				}
			}
		}
		if = {
			limit = {
				741 = {
					owner = {
						OR = {
							tag = WNG
							OR = {
								is_subject_of = WNG
								is_in_faction_with = WNG
							}
						}
					}
				}
			}
			741 = {
				set_state_owner_to = ABY
				set_state_controller_to = ABY
			}
		}
		country_event = {
			id = north_war.32
			hours = 6
		}
	}
}

country_event = {
	id = north_war.32
	title = north_war.32.t
	desc = {
		text = north_war.32.d1
		trigger = {
			NOT = {
				ABY = {
					has_country_flag = HIP_liberated_ABY
				}
			}
		}
	}
	desc = {
		text = north_war.32.d2
		trigger = {
			ABY = {
				has_country_flag = HIP_liberated_ABY
			}
		}
	}


	picture = GFX_event_zebrica_2
	is_triggered_only = yes
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					ABY = {
						has_country_flag = HIP_liberated_ABY
					}
				}
				ABY = {
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
				}
			}
			if = {
				limit = {
					ABY = {
						has_cosmetic_tag = ABY_WNG_protectorate
					}
				}
				drop_cosmetic_tag = yes
			}
		}
	}

	option = {#Withdraw
		name = north_war.32.a
		trigger = {
			NOT = {
				has_government = fascism
			}
		}
		ai_chance = {
			base = 10
		}
		if = {
			limit = {
				ABY = {
					has_country_flag = HIP_liberated_ABY
				}
			}
			ABY = {
				add_opinion_modifier = {
					target = ROOT
					modifier = ABY_HIP_liberators
				}
			}
		}
		ABY = {
			add_opinion_modifier = {
				target = ROOT
				modifier = ABY_HIP_returned_territory
			}
		}
	}
	option = {#Occupy Purrsia
		name = north_war.32.b
		ai_chance = {
			base = 5
			modifier = {
				has_government = communism
				factor = 3
			}
		}
			HIP = {
				transfer_state = 784
			}
		if = {
			limit = {
				ABY = {
					has_country_flag = HIP_liberated_ABY
				}
			}
			ABY = {
				add_opinion_modifier = {
					target = ROOT
					modifier = ABY_HIP_liberators
				}
			}
		}
	}
	option = {#Under New Management
		name = north_war.32.c
		trigger = {
			has_government = fascism
		}
		ai_chance = {
			base = 15
		}
		HIP = {
			transfer_state = 784
		}
		HIP = {
			transfer_state = 1200
		}
		if = {
			limit = {
				ABY = {
					has_country_flag = HIP_liberated_ABY
				}
			}
			HIP = {
				transfer_state = 1201
			}
			custom_effect_tooltip = HIP_this_will_be_useful_tt
		}
	}
}

country_event = {#NZW is over do we white peace HIP?
	id = north_war.33
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.33"}
	title = north_war.33.t
	desc = north_war.33.d

	picture = GFX_event_HIP_warzone
	is_triggered_only = yes

	option = {#Yeah sure
		name = north_war.33.a
		ai_chance = { factor = 1 }
		HIP = {
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = ROOT
		}
		every_other_country = {
			limit = {
				OR = {
					is_subject_of = ROOT
					is_in_faction_with = ROOT
				}
			}
			set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
			white_peace = HIP
		}
	}
	option = {#No way
		name = north_war.33.b
		ai_chance = {
			factor = 1000
			modifier = {
				NOT = {
					OR = {
						has_country_leader = {
							ruling_only = yes
							character = BAT_ocean_spray
						}
						has_country_leader = {
							ruling_only = yes
							character = CTH_hiram_zerranid
						}
						original_tag = DED
						has_country_flag = ZAR_wormy
					}
				}
				factor = 0
			}
		}
		add_war_support = 0.05
	}
}

country_event = {#year one of war
	id = north_war.34
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.34"}
	title = north_war.34.t
	desc = {
		text = north_war.34.d1
		trigger = {tag = HIP}
	}
	desc = {
		text = north_war.34.d2
		trigger = {tag = WNG}
	}
	picture = GFX_event_HIP_warzone
	is_triggered_only = yes

	option = {#Well this kinda sucks
		name = north_war.34.a
		set_country_flag = HIP_WNG_year_one_of_war
	}
}

country_event = {#year two of war
	id = north_war.35
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.35"}
	title = north_war.35.t
	desc = {
		text = north_war.35.d1
		trigger = {tag = HIP}
	}
	desc = {
		text = north_war.35.d2
		trigger = {tag = WNG}
	}
	picture = GFX_event_HIP_warzone
	is_triggered_only = yes

	option = {#Well this really sucks
		name = north_war.35.a
		set_country_flag = HIP_WNG_year_two_of_war
		add_war_support = -0.025
		if = {
			limit = {
				tag = WNG
			}
			add_popularity = {
				ideology = fascism
				popularity = -0.025
			}
		}
	}
}

country_event = {#another year of war
	id = north_war.36
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.34"}
	title = north_war.36.t
	desc = {
		text = north_war.36.d1
		trigger = {tag = HIP}
	}
	desc = {
		text = north_war.36.d2
		trigger = {tag = WNG}
	}
	picture = GFX_event_HIP_warzone
	is_triggered_only = yes

	option = {#Guess this is just our lives now
		name = north_war.36.a
		if = {
			limit = {
				tag = WNG
			}
			add_popularity = {
				ideology = fascism
				popularity = -0.05
			}
		}
		add_war_support = -0.025
	}
}

#Hippogriffia is asking for peace
#Called by ???
country_event = {
	id = north_war.50
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.50"}
	title = north_war.50.t
	desc = north_war.50.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes

	option = {#accept
		ai_chance = {
			factor = 90
		}
		name = north_war.50.a
		hidden_effect = {
			HIP = {
				country_event = {
					id = hippogriff.1002
					days = 3
				}
			}
		}
		if = {
			limit = {
				AND = {
					CTH = {
						has_country_flag = NZW_war_participant
					}
					BAT = {
						has_country_flag = NZW_war_participant
					}
					WNG = {
						has_country_flag = NZW_war_participant
					}
				}
			}
			hidden_effect = {
				HIP = {
					country_event = {
						id = north_war.15
					}
				}
			}
			BAT = {transfer_state = 695}
		}
		else_if = {
			limit = {
				AND = {
					CTH = {
						has_country_flag = NZW_war_participant
					}
					BAT = {
						has_country_flag = NZW_war_participant
					}
				}
			}
			hidden_effect = {
				HIP = {
					country_event = {
						id = north_war.3
					}
				}
				CTH = {transfer_state = 695}
			}
		}
		else_if = {
			limit = {
				BAT = {
					has_country_flag = NZW_war_participant
				}
			}
			hidden_effect = {
				HIP = {
					country_event = {
						id = north_war.7
					}
				}
				BAT = {transfer_state = 695}
			}
		}
		else_if = {
			limit = {
				TBK = {
					has_country_flag = NZW_war_participant
				}
				CTH = {
					has_country_flag = NZW_war_participant
				}
			}
			hidden_effect = {
				HIP = {
					country_event = {
						id = north_war.24
					}
				}
				TBK = {transfer_state = 695}
			}
		}
		else_if = {
			limit = {
				CTH = {
					has_country_flag = NZW_war_participant
				}
			}
			hidden_effect = {
				HIP = {
					country_event = {
						id = north_war.11
					}
				}
				CTH = {transfer_state = 695}
			}
		}
		else_if = {
			limit = {
				TBK = {
					has_country_flag = NZW_war_participant
				}
			}
			hidden_effect = {
				HIP = {
					country_event = {
						id = north_war.28
					}
				}
			}
			TBK = {transfer_state = 695}
		}
	}
	option = {#refuse
		name = north_war.50.b
		ai_chance = {
			factor = 10
		}
	}
}

# North Zebrican War breakout news
news_event = {
	id = north_war.101
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.101"}

	title = north_war.101.t
	picture = GFX_news_event_mt_aris
	is_triggered_only = yes

	major = yes


	desc = {
		text = north_war.101.d1
		trigger = {
			CTH = {
				has_war_with = HIP
			}
			BAT = {
				has_war_with = HIP
			}
			OR = {
				HIP = {
					has_defensive_war = yes
				}
				WAR = {
					AND = {
						has_defensive_war = yes
						NOT = {has_war_with = HIP}
					}
				}
			}
		}
	}

	desc = {
		text = north_war.101.d2
		trigger = {
			CTH = {
				has_war_with = HIP
			}
			NOT = {
				BAT = {
					has_war_with = HIP
				}
			}
			OR = {
				HIP = {
					has_defensive_war = yes
				}
				WAR = {
					AND = {
						has_defensive_war = yes
						NOT = {has_war_with = HIP}
					}
				}
			}
		}
	}

	desc = {
		text = north_war.101.d3
		trigger = {
			NOT = {
				CTH = {
					has_war_with = HIP
				}
			}
			BAT = {
				has_war_with = HIP
			}
			OR = {
				HIP = {
					has_defensive_war = yes
				}
				WAR = {
					AND = {
						has_defensive_war = yes
						NOT = {has_war_with = HIP}
					}
				}
			}
		}
	}

	desc = {
		text = north_war.101.d4
		trigger = {
			AND = {
				HIP = {has_offensive_war = yes}
				WAR = {
					OR = {
						has_defensive_war = no
						has_war_with = HIP
					}
				}
			}
		}
	}

	desc = {
		text = north_war.101.d5
		trigger = {
			NOT = {
				CTH = {
					has_war_with = HIP
				}
			}
			NOT = {
				BAT = {
					has_war_with = HIP
				}
			}
			OR = {
				HIP = {
					has_defensive_war = yes
				}
				WAR = {
					AND = {
						has_defensive_war = yes
						NOT = {has_war_with = HIP}
					}
				}
			}
		}
	}


	option = {
		name = north_war.101.a
		trigger = {
			original_tag = HIP
		}
	}
	option = {
		name = north_war.101.b
		trigger = {
			NOT = {
				original_tag = HIP
			}
			OR = {
				AND = {
					OR = {
						original_tag = EQS
						original_tag = EQC
						original_tag = WNG
						original_tag = CRY
					}
					has_government = democratic
					HIP = {
						has_government = democratic
					}
				}
				OR = {
					is_in_faction_with = HIP
					is_subject_of = HIP
				}
			}
		}
	}
	option = {
		name = north_war.101.c
		trigger = {
			has_country_flag = NZW_war_participant
			has_war_with = HIP
		}
	}
	option = {
		name = north_war.101.d
		trigger = {
			NOT = {
				original_tag = HIP
				has_country_leader = {
					character = EQC_big_sister
					ruling_only = yes
				}
				has_country_leader = {
					character = EQC_maresoc
					ruling_only = yes
				}
			}
			has_government = communism
			HIP = {
				has_government = communism
			}
		}
	}
	option = {
		name = north_war.101.e
		trigger = {
			OR = {
				has_country_leader = {
					character = EQC_big_sister
					ruling_only = yes
				}
				has_country_leader = {
					character = EQC_maresoc
					ruling_only = yes
				}
			}
		}
	}

	option = {
		name = north_war.101.f
		trigger = {
			original_tag = WNG
			has_government = fascism
			NOT = {
				has_country_flag = NZW_war_participant
			}
			BAT = {
				has_war_with = HIP
			}
			CTH = {
				has_war_with = HIP
			}
		}
	}
	option = {
		name = north_war.101.g
		trigger = {
			NOT = {
				has_country_flag = NZW_war_participant
				has_country_leader = {
					character = EQC_big_sister
					ruling_only = yes
				}
				has_country_leader = {
					character = EQC_maresoc
					ruling_only = yes
				}
				AND = {
					has_government = communism
					HIP = {
						has_government = communism
					}
				}
				AND = {
					OR = {
						original_tag = EQS
						original_tag = EQC
						original_tag = WNG
						original_tag = CRY
					}
					has_government = democratic
					HIP = {
						has_government = democratic
					}
				}
				OR = {
					original_tag = HIP
					is_in_faction_with = HIP
					is_subject_of = HIP
				}
				AND = {
						BAT = {
						has_war_with = HIP
					}
					CTH = {
						has_war_with = HIP
					}
					ROOT = {
						has_government = fascism
						original_tag = WNG
					}
				}
			}
		}
	}
}

country_event = { # Government of National Unity event (option to play as)
	id = north_war.102
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war.102"}
	title = north_war.102.t
	desc = north_war.102.d

	picture = GFX_event_mt_aris
	is_triggered_only = yes

	option = {
		name = north_war.102.a
		HIP = {
			transfer_state = 683
			transfer_state = 684
			transfer_state = 685
			transfer_state = 686
			transfer_state = 1164
			transfer_state = 1165
			transfer_state = 1202
			transfer_state = 1203
			transfer_state = 1204

			if = {
				limit = {
					has_government = communism
				}
				HIP_remove_all_posadist_ideas = yes
			}
			hidden_effect = {
				if = {
					limit = {
						has_idea = HIP_phalanx_assault_teams
					}
					remove_ideas = HIP_phalanx_assault_teams
				}
				if = {
					limit = {
						has_idea = HIP_her_majestys_government
					}
					remove_ideas = HIP_her_majestys_government
				}
				if = {
					limit = {
						has_idea = HIP_royal_advisory_council
					}
					remove_ideas = HIP_royal_advisory_council
				}
				if = {
					limit = {
						has_idea = HIP_natsynd_idea
					}
					remove_ideas = HIP_natsynd_idea
				}
				remove_dynamic_modifier = {
					modifier = HIP_phalangist_rule
				}
			}
			add_country_leader_role = {
				character = HIP_SIR_plumage_moonfeather
				promote_leader = yes

				country_leader = {
					ideology = corporatocracy
					desc = HIP_MOONFEATHER_DESC
					expire = "1965.1.1"
					traits = {
						comically_corrupt_kleptocrat
					}
				}
			}
			set_party_name = {
				ideology = fascism
				long_name = HIP_moonfeather_clique_long
				name = HIP_moonfeather_clique
			}
			set_party_name = {
				ideology = democratic
				long_name = HIP_resistance_party_long
				name = HIP_resistance_party
			}
			set_party_name = {
				ideology = neutrality
				long_name = HIP_resistance_party_long
				name = HIP_resistance_party
			}
			set_party_name = {
				ideology = communism
				long_name = HIP_resistance_party_long
				name = HIP_resistance_party
			}
			set_politics = {
				ruling_party = fascism
				elections_allowed = no
			}
			set_cosmetic_tag = HIP_GNU
			add_popularity = {
				ideology = fascism
				popularity = -1
			}
			load_focus_tree = HIP_GNU_tree
		}
	}
	option = {
		trigger = { is_ai = no }
		name = north_war.102.b
		HIP = { change_tag_from = ROOT }
		HIP = {
			transfer_state = 683
			transfer_state = 684
			transfer_state = 685
			transfer_state = 686
			transfer_state = 1164
			transfer_state = 1165
			transfer_state = 1202
			transfer_state = 1203
			transfer_state = 1204

			if = {
				limit = {
					has_government = communism
				}
				HIP_remove_all_posadist_ideas = yes
			}
			hidden_effect = {
				if = {
					limit = {
						has_idea = HIP_phalanx_assault_teams
					}
					remove_ideas = HIP_phalanx_assault_teams
				}
				if = {
					limit = {
						has_idea = HIP_her_majestys_government
					}
					remove_ideas = HIP_her_majestys_government
				}
				if = {
					limit = {
						has_idea = HIP_royal_advisory_council
					}
					remove_ideas = HIP_royal_advisory_council
				}
				if = {
					limit = {
						has_idea = HIP_natsynd_idea
					}
					remove_ideas = HIP_natsynd_idea
				}
				remove_dynamic_modifier = {
					modifier = HIP_phalangist_rule
				}
			}
			add_country_leader_role = {
				character = HIP_SIR_plumage_moonfeather
				promote_leader = yes

				country_leader = {
					ideology = corporatocracy
					expire = "1965.1.1"
					traits = {
						comically_corrupt_kleptocrat
					}
				}
			}
			set_party_name = {
				ideology = fascism
				long_name = HIP_moonfeather_clique_long
				name = HIP_moonfeather_clique
			}
			set_party_name = {
				ideology = democratic
				long_name = HIP_resistance_party_long
				name = HIP_resistance_party
			}
			set_party_name = {
				ideology = neutrality
				long_name = HIP_resistance_party_long
				name = HIP_resistance_party
			}
			set_party_name = {
				ideology = communism
				long_name = HIP_resistance_party_long
				name = HIP_resistance_party
			}
			set_politics = {
				ruling_party = fascism
				elections_allowed = no
			}
			set_cosmetic_tag = HIP_GNU
			add_popularity = {
				ideology = fascism
				popularity = -1
			}
			load_focus_tree = HIP_GNU_tree
		}
	}
}

country_event = { # Ask the player if they want to offer an alliance (called in NZW_alliance_effect) - TODO: Write event chain loc
	id = north_war_alliance.1
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.1"}
	title = north_war_alliance.1.t
	desc = north_war_alliance.1.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes

	option = { #Send the offer
		ai_chance = {
			factor = 10
		}
		name = north_war_alliance.1.a
		
		if = {
			limit = {
				tag = BAT
			}
			NZ1 = {
				country_event = bat.67
			}
		}
		else = {
			if = {
				limit = {
					has_global_flag = NZW_NZ1_alliance_proposer
				}
				NZ2 = {
					country_event = north_war_alliance.2
				}
			}
			else = {
				NZ1 = {
					country_event = north_war_alliance.2
				}
			}
		}
	}
	
	option = { #Don't send the offer
		ai_chance = {
			factor = 0
		}
	}
}

country_event = { # Gets asked about if they want to join alliance
	id = north_war_alliance.2
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.2"}
	title = north_war_alliance.2.t
	desc = north_war_alliance.2.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes

	option = { #Accept
		ai_chance = {
			factor = 10
		}
		name = north_war_alliance.2.a
		
		NZ1 = {
			if = {
				limit = {
					is_faction_leader = yes
				}
				every_other_country = {
					limit = {
						is_in_faction_with = NZ1
					}
					set_country_flag = NZW_was_in_NZ1_faction
				}
				set_country_flag = NZW_was_faction_leader
				
				dismantle_faction = yes
			}
		}
		NZ2 = {
			if = {
				limit = {
					is_faction_leader = yes
				}
				every_other_country = {
					limit = {
						is_in_faction_with = NZ2
					}
					set_country_flag = NZW_was_in_NZ2_faction
				}
				set_country_flag = NZW_was_faction_leader
				
				dismantle_faction = yes
			}
		}
		
		# FROM is proposer of the alliance and gets to lead it
		FROM = {
			create_faction = NZW_anti_aris_axis
		}
		every_other_country = {
			limit = {
				OR = {
					has_country_flag = NZW_was_in_NZ1_faction
					has_country_flag = NZW_was_in_NZ2_faction
					has_country_flag = NZW_was_faction_leader
				}
			}
			FROM = {
				add_to_faction = PREV
			}
		}
		
		FROM = {
			country_event = north_war_alliance.3 # Inform
		}
	}
	
	option = { #Decline
		ai_chance = {
			factor = 0
		}
		
		FROM = {
			country_event = north_war_alliance.4 # Inform
		}
	}
}

country_event = { # Alliance got accepted
	id = north_war_alliance.3
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.3"}
	title = north_war_alliance.3.t
	desc = north_war_alliance.3.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
		
	option = { # Yay
		name = north_war_alliance.3.a
	}
}

country_event = { # Alliance got rejected
	id = north_war_alliance.4
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.4"}
	title = north_war_alliance.4.t
	desc = north_war_alliance.4.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
		
	option = { # Regrettable
		name = north_war_alliance.4.a
	}
}

country_event = { # Ask the player if they want to dissolve an alliance (called in north_war.2 event) - TODO: Write event chain loc
	id = north_war_alliance.5
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.5"}
	title = north_war_alliance.5.t
	desc = north_war_alliance.5.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
		
	option = { # Dissolve Alliance
		ai_chance = {
			factor = 1
		}
		name = north_war_alliance.5.a
		
		set_country_flag = NZW_dissolve_alliance_flag
		add_to_variable = { NZW_countries_alliance_event_option_counter = 1 }
		
		hidden_effect = {
			country_event = {
				id = north_war_alliance.6
				days = 1
			}
		}
	}
	
	option = { # Keep Alliance
		ai_chance = {
			factor = 9
		}
		name = north_war_alliance.5.b
		
		set_country_flag = NZW_keep_alliance_flag
		add_to_variable = { NZW_countries_alliance_event_option_counter = 1 }
		
		hidden_effect = {
			country_event = {
				id = north_war_alliance.6
				days = 1
			}
		}
	}
}

country_event = {
	id = north_war_alliance.6
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.5"}
	
	hidden = yes
	
	is_triggered_only = yes
	trigger = { check_variable = { NZW_countries_alliance_event_option_counter = 2 } } # Only after both have responded
		
	option = { # Dissolve Alliance
		ai_chance = {
			factor = 10
		}
		name = north_war_alliance.5.a
		
		if = {
			limit = {
				NZ1 = {
					has_country_flag = NZW_keep_alliance_flag
				}
				NZ2 = {
					has_country_flag = NZW_keep_alliance_flag
				}
			}
			# Rename alliance and keep it
			set_faction_name = BAT_aghzat_pact
			
			NZ1 = {
				country_event = north_war_alliance.7 # Yay event
			}
			NZ2 = {
				country_event = north_war_alliance.7 # Yay event
			}
		}
		else_if = {
			limit = {
				NZ1 = {
					has_country_flag = NZW_keep_alliance_flag
				}
				NZ2 = {
					has_country_flag = NZW_dissolve_alliance_flag
				}
			}
			NZW_alliance_dissolve_effect = yes
			NZ1 = {
				country_event = north_war_alliance.8 # How sad event
			}
			NZ2 = {
				country_event = north_war_alliance.9 # Good riddance event
			}
		}
		else_if = {
			limit = {
				NZ1 = {
					has_country_flag = NZW_dissolve_alliance_flag
				}
				NZ2 = {
					has_country_flag = NZW_keep_alliance_flag
				}
			}
			NZW_alliance_dissolve_effect = yes
			NZ1 = {
				country_event = north_war_alliance.9 # Good riddance event
			}
			NZ2 = {
				country_event = north_war_alliance.8 # How sad event
			}
		}
		else = {
			NZW_alliance_dissolve_effect = yes
			NZ1 = {
				country_event = north_war_alliance.10 # Good riddance to you too event
			}
			NZ2 = {
				country_event = north_war_alliance.10 # Good riddance to you too event
			}
		}
	}
}

country_event = { # Both sides agreed to keep the alliance
	id = north_war_alliance.7
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.7"}
	title = north_war_alliance.7.t
	desc = north_war_alliance.7.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
		
	option = { # Yay
		name = north_war_alliance.7.a
	}
}

country_event = { # The other side wanted to dissolve the alliance, so it goes
	id = north_war_alliance.8
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.8"}
	title = north_war_alliance.8.t
	desc = north_war_alliance.8.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
		
	option = { # How sad
		name = north_war_alliance.8.a
	}
}

country_event = { # We wanted to dissolve the alliance, so it goes
	id = north_war_alliance.9
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.9"}
	title = north_war_alliance.9.t
	desc = north_war_alliance.9.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
		
	option = { # Good riddance
		name = north_war_alliance.9.a
	}
}

country_event = { # Both wanted to dissolve the alliance, so it goes
	id = north_war_alliance.10
	immediate = {log = "[GetDateText]: [Root.GetName]: event north_war_alliance.10"}
	title = north_war_alliance.10.t
	desc = north_war_alliance.10.d

	picture = GFX_event_sao_macaw
	is_triggered_only = yes
		
	option = { # Good riddance
		name = north_war_alliance.10.a
	}
}