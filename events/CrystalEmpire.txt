add_namespace = crystalemp

add_namespace = cryscr

add_namespace = crysom

add_namespace = crycom

############################################################
############################################################
############### Scroup Rudely Interrupts ######################
############################################################
############################################################

country_event = {
	id = cryscr.1
	immediate = {log = "[Root.GetName]: event cryscr.1"}#Auto-logging
	title = cryscr.1.t
	desc = cryscr.1.d
	picture = GFX_event_winter_sun
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.1.a
		add_political_power = 10
		set_country_flag = winter_solstice_planned
	}
}
country_event = {
	id = cryscr.2
	immediate = {log = "[Root.GetName]: event cryscr.2"}#Auto-logging
	title = cryscr.2.t
	desc = cryscr.2.d
	picture = GFX_event_winter_sun
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.2.a
		add_political_power = 10
		add_popularity = { ideology = fascism popularity = 0.03 }
		add_popularity = { ideology = communism popularity = 0.05 }
		swap_ideas = { remove_idea = royal_family add_idea = royal_family2 }
	}
}
country_event = {
	id = cryscr.3
	immediate = {log = "[Root.GetName]: event cryscr.3"}#Auto-logging
	title = cryscr.3.t
	desc = cryscr.3.d
	picture = GFX_event_hearthswarming_2
	
	trigger = {
		original_tag = CRY
		has_country_flag = winter_solstice_planned
		date > 1007.12.20
		has_government = democratic
		has_war = no
	}
	mean_time_to_happen =  { days = 1 }
	fire_only_once = yes
	
	option = {
		name = cryscr.3.a
		add_political_power = 250
		add_stability = 0.03
	}
}
country_event = {
	id = cryscr.4
	immediate = {log = "[Root.GetName]: event cryscr.4"}#Auto-logging
	title = cryscr.4.t
	desc = cryscr.4.d
	picture = GFX_event_winter_sun
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.4.a
		add_political_power = 16
	}
}
country_event = { ## Crysal Empire asks Equestria for Crysal Fair
	id = cryscr.5
	immediate = {log = "[Root.GetName]: event cryscr.5"}#Auto-logging
	title = cryscr.5.t
	desc = cryscr.5.d
	picture = GFX_event_crystal_fair
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.5.a
		event_target:equestria = {
			country_event = { id = cryscr.6 days = 1 }
		}
	}
}
country_event = { ## Equestrian event from above
	id = cryscr.6
	immediate = {log = "[Root.GetName]: event cryscr.6"}#Auto-logging
	title = cryscr.6.t
	desc = cryscr.6.d
	picture = GFX_event_crystal_fair
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.6.a
		trigger = {
			NOT = { FROM = { has_government = fascism } }
		}
		ai_chance = {
			base = 50
			modifier = {
				factor = 100
				is_historical_focus_on = yes
			}
		}
		FROM = {
			country_event = { id = cryscr.7 days = 1 }
		}
		add_political_power = -50
	}
	option = {
		name = cryscr.6.b
		trigger = {
			NOT = { FROM = { has_government = fascism } }
		}
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		FROM = {
			country_event = { id = cryscr.8 days = 1 }
			add_opinion_modifier = { target = event_target:equestria modifier = eqs_refused_holding_games }
		}
	}
}
country_event = { ## Equestria agrees
	id = cryscr.7
	immediate = {log = "[Root.GetName]: event cryscr.7"}#Auto-logging
	title = cryscr.7.t
	desc = cryscr.7.d
	picture = GFX_event_crystal_fair
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.7.a
		add_popularity = { ideology = democratic popularity = 0.1 }
		add_political_power = 50
		hidden_effect = {
			news_event = { id = news.4 days = 10 }
			country_event = { id = crystalemp.1 days = 2 random = 96 }#days to hours applied
		}
	}
}
country_event = { ## Equestria disagrees
	id = cryscr.8
	immediate = {log = "[Root.GetName]: event cryscr.8"}#Auto-logging
	title = cryscr.8.t
	desc = cryscr.8.d
	picture = GFX_event_crystal_fair
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.8.a
		trigger = { NOT = { has_dlc = "Together for Victory"} }
		add_political_power = -50
		add_stability = -0.05
		add_popularity = { ideology = fascism popularity = 0.05 }
		add_popularity = { ideology = communism popularity = 0.05 }
		add_popularity = { ideology = neutrality popularity = 0.05 }
	}
	option = {
		name = cryscr.8.a
		trigger = { has_dlc = "Together for Victory"}
		add_autonomy_ratio = { value = -0.1 }
		add_political_power = -50
		add_stability = -0.05
		add_popularity = { ideology = fascism popularity = 0.05 }
		add_popularity = { ideology = communism popularity = 0.05 }
		add_popularity = { ideology = neutrality popularity = 0.05 }
	}
}
country_event = { ## Mi Amore Family Story
	id = cryscr.9
	immediate = {log = "[Root.GetName]: event cryscr.9"}#Auto-logging
	title = cryscr.9.t
	desc = cryscr.9.d
	picture = GFX_event_mi_amore
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.9.a
		trigger = {
			has_idea = royal_family2
		}
		swap_ideas = { remove_idea = royal_family2 add_idea = royal_family3 }
	}
	option = {
		name = cryscr.9.a
		trigger = {
			has_idea = royal_family
		}
		swap_ideas = { remove_idea = royal_family add_idea = royal_family2 }
	}
}
country_event = { ## GrandFestival
	id = cryscr.10
	immediate = {log = "[Root.GetName]: event cryscr.10"}#Auto-logging
	title = cryscr.10.t
	desc = cryscr.10.d
	picture = GFX_event_crystal_fair
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.10.a
	}
}
######################################################
country_event = { ## The Return of Sombra event chain
	id = cryscr.11
	immediate = {log = "[Root.GetName]: event cryscr.11"}#Auto-logging
	title = cryscr.11.t
	desc = cryscr.11.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
	}
	mean_time_to_happen = { 
		days = 90
		modifier = {
			factor = 0.3
			has_completed_focus = CRY_crystallinganniversary
		}
		modifier = {
			factor = 0.01
			focus_progress = { focus = CRY_grandfestival progress > 0.6 }
		}
	}
	fire_only_once = yes
	option = {
		name = cryscr.11.a
		hidden_effect = {
			country_event = { id = cryscr.12 days = 16 }
		}
	}
}
country_event = { ## The Return of Sombra event chain
	id = cryscr.12
	immediate = {log = "[Root.GetName]: event cryscr.12"}#Auto-logging
	title = cryscr.12.t
	desc = cryscr.12.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes

	#trigger = {
		#NOT = { focus_progress = { focus = CRY_communistideas progress > 0 } }
		#NOT = { has_completed_focus = CRY_communistideas }
	#}
	
	option = {
		name = cryscr.12.a
		custom_effect_tooltip = invitation_taken
		ai_chance = {
			base = 30
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		hidden_effect = {
			country_event = {
				id = cryscr.13 hours = 1
			}
		}
	}
	option = {
		name = cryscr.12.b
		custom_effect_tooltip = invitation_decline
		ai_chance = {
			base = 70
			modifier = {
				factor = 1.5
				is_subject = yes
				overlord = {
					has_completed_focus = increase_presense_inCRY
				}
			}
		}
		hidden_effect = {
			country_event = {
				id = cryscr.14 hours = 1
			}
		}
	}
	option = {
		name = cryscr.12.c
		custom_effect_tooltip = support_the_club
		ai_chance = {
			base = 0
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		hidden_effect = {
			country_event = {
				id = crystalemp.14 hours = 1
			}
		}
	}
}
country_event = { ## Take the invitation
	id = cryscr.13
	immediate = {log = "[Root.GetName]: event cryscr.13"}#Auto-logging
	title = cryscr.13.t
	desc = cryscr.13.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.13.a
		custom_effect_tooltip = invitation_saved
		set_country_flag = invitation_to_join_the_club
		set_country_flag = sakira_likes_that
		unlock_decision_tooltip = CRY_umbruminitial_d
		ai_chance = {
			base = 70
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
	option = {
		name = cryscr.13.b
		custom_effect_tooltip = invitation_thrown_away
		ai_chance = {
			base = 30
		}
	}
}
country_event = { ## Decline the invitation
	id = cryscr.14
	immediate = {log = "[Root.GetName]: event cryscr.14"}#Auto-logging
	title = cryscr.14.t
	desc = cryscr.14.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.14.a
	}
}
country_event = { ## Walk to the club place
	id = cryscr.15
	immediate = {log = "[Root.GetName]: event cryscr.15"}#Auto-logging
	title = cryscr.15.t
	desc = cryscr.15.d
	picture = GFX_event_apartment_club
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.15.a
		custom_effect_tooltip = walk_into_the_club
		hidden_effect = {
			country_event = { id = cryscr.16 hours = 1 }
		}
		ai_chance = { factor = 100 }
	}
	option = {
		name = cryscr.15.b
		custom_effect_tooltip = walk_away
		ai_chance = { factor = 0 }
	}
}
country_event = { ## Into the club
	id = cryscr.16
	immediate = {log = "[Root.GetName]: event cryscr.16"}#Auto-logging
	title = cryscr.16.t
	desc = cryscr.16.d
	picture = GFX_event_apartment_club
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.16.a
		hidden_effect = {
			country_event = { id = cryscr.17 hours = 1 }
		}
	}
}
country_event = { ## Inside the club
	id = cryscr.17
	immediate = {log = "[Root.GetName]: event cryscr.17"}#Auto-logging
	title = cryscr.17.t
	desc = cryscr.17.d
	picture = GFX_event_apartment_club
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.17.a
		modify_country_flag = { flag = sakira_likes_that value = 1 }
		hidden_effect = {
			country_event = { id = cryscr.18 hours = 1 }
		}
	}
	option = {
		name = cryscr.17.b
		hidden_effect = {
			country_event = { id = cryscr.18 hours = 1 }
		}
	}
}
country_event = { ## The Story
	id = cryscr.18
	immediate = {log = "[Root.GetName]: event cryscr.18"}#Auto-logging
	title = cryscr.18.t
	desc = cryscr.18.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.18.a
		hidden_effect = {
			country_event = { id = cryscr.19 hours = 1 }
		}
		ai_chance = { factor = 100 }
	}
}
country_event = { ## Post-Story
	id = cryscr.19
	immediate = {log = "[Root.GetName]: event cryscr.19"}#Auto-logging
	title = cryscr.19.t
	desc = cryscr.19.d
	picture = GFX_event_apartment_club
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.19.a
		hidden_effect = {
			country_event = { id = cryscr.20 hours = 2 }
		}
	}
}
country_event = { ## Out of the club
	id = cryscr.20
	immediate = {log = "[Root.GetName]: event cryscr.20"}#Auto-logging
	title = cryscr.20.t
	desc = cryscr.20.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.20.a
		custom_effect_tooltip = join_the_club_tlp
		set_country_flag = joined_the_club
		unlock_decision_tooltip = CRY_librarywork_d
		ai_chance = { factor = 100 }
	}
	option = {
		name = cryscr.20.b
		custom_effect_tooltip = reported_sombras
		ai_chance = { factor = 0 }
		hidden_effect = {
			country_event = {
				id = cryscr.21 hours = 10
			}
		}
	}
	option = {
		name = cryscr.20.c
		custom_effect_tooltip = not_reported_sombras
		hidden_effect = {
			swap_ideas = { remove_idea = sombra_threat add_idea = sombra_threat2 }
		}
		ai_chance = { factor = 0 }
	}
}
country_event = { ## Organization Arrested
	id = cryscr.21
	immediate = {log = "[Root.GetName]: event cryscr.21"}#Auto-logging
	title = cryscr.21.t
	desc = cryscr.21.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.21.a
		add_political_power = 20
		ai_chance = { factor = 100 }
		custom_effect_tooltip = less_sombra_tlp
		hidden_effect = {
			swap_ideas = { remove_idea = sombra_threat add_idea = sombra_threat_reported }
		}
	}
}
country_event = { ## Sombra Civil War if fascism support is high enough after not reporting the club
	id = cryscr.22
	immediate = {log = "[Root.GetName]: event cryscr.22"}#Auto-logging
	title = cryscr.22.t
	desc = {
		text = cryscr.22.d
		trigger = { has_government = democratic }
	}
	desc = {
		text = cryscr.22.d_com
		trigger = { has_government = communism }
	}
	desc = {
		text = cryscr.22.d_fas
		trigger = { has_government = fascism }
	}
	picture = GFX_event_sombra_return
	mean_time_to_happen = { days = 15 }
	trigger = {
		NOT = { has_global_flag = sombra_returned }
		original_tag = CRY
		has_war = no
		NOT = { has_country_flag = joined_the_club }
		OR = {
			is_subject = no
			overlord = { NOT = { has_government = fascism } }
		}
		OR = {
			has_country_leader = { ruling_only = yes name = "Radiant Hope" }
			AND = {
				OR = {
					has_idea = sombra_threat
					has_idea = sombra_threat2
					has_idea = sombra_threat_reported
				}
				fascism > 0.5
			}
		}
	}
	fire_only_once = yes
	option = {
		name = cryscr.22.a
		trigger = { NOT = { has_country_leader = { ruling_only = yes name = "Radiant Hope" } } }
		set_temp_variable = { civ_war_size = 0.5 }
		if = {
			limit = { has_idea = sombra_threat_reported }
			multiply_temp_variable = { civ_war_size = 0.3 }
		}
		custom_effect_tooltip = sombra_return_tt
		start_civil_war = {
			ideology = fascism
			size = civ_war_size
		}
		hidden_effect = { 
			random_other_country = {
				limit = { original_tag = CRY has_government = fascism }
				random_list = { 30 = { set_country_flag = ghosts_bonus } 50 = { set_country_flag = power_bonus } 20 = { set_country_flag = strength_bonus } }
				Evil_unicorn_magic = yes 
				retire_country_leader = yes
				set_party_name = { ideology = fascism name = CRY_sombra_party long_name = CRY_sombra_party }
				create_country_leader = {
					name = "King Sombra"
					expire = "1965.1.1"
					ideology = nazism
					desc = "POLITICS_SOMBRA_DESC"
					picture = "Sombra.tga"
					traits = {
						warmonger
					}
				}
				add_threat = 5
				set_cosmetic_tag = CRY_SOM
				load_focus_tree = crystalempire_sombra
				set_global_flag = sombra_returned
				if = {
					limit = { has_country_flag = ghosts_bonus }
					country_event = { id = crysom.3 days = 5 random = 240 }#days to hours applied
				}
				if = {
					limit = { has_country_flag = strength_bonus }
					country_event = { id = crysom.4 days = 5 random = 240 }#days to hours applied
				}
				if = {
					limit = { has_country_flag = power_bonus }
					country_event = { id = crysom.5 days = 5 random = 240 }#days to hours applied
				}
				add_opinion_modifier = { target = event_target:equestria modifier = mortal_enemies }
				hidden_effect = {
					load_oob = "CRY_SOM_devoted_army"
				}
				reverse_add_opinion_modifier = { target = event_target:equestria modifier = mortal_enemies }
				every_unit_leader = {
					limit = {
						OR = {
							has_id = 200
							has_id = 1043
						}
					}
					set_nationality = ROOT
				}
			}
		}
	}
	option = {
		name = cryscr.22.b
		trigger = { has_country_leader = { ruling_only = yes name = "Radiant Hope" } }
		random_list = { 30 = { set_country_flag = ghosts_bonus } 50 = { set_country_flag = power_bonus } 20 = { set_country_flag = strength_bonus } }
		Evil_unicorn_magic = yes 
		retire_country_leader = yes
		set_party_name = { ideology = fascism name = CRY_sombra_party long_name = CRY_sombra_party }
		create_country_leader = {
			name = "King Sombra"
			expire = "1965.1.1"
			ideology = nazism
			desc = "POLITICS_SOMBRA_DESC"
			picture = "Sombra.tga"
			traits = {
				warmonger
			}
		}
		add_threat = 5
		set_cosmetic_tag = CRY_SOM
		load_focus_tree = crystalempire_sombra
		set_global_flag = sombra_returned
		if = {
			limit = { has_country_flag = ghosts_bonus }
			country_event = { id = crysom.3 days = 5 random = 240 }#days to hours applied
		}
		if = {
			limit = { has_country_flag = strength_bonus }
			country_event = { id = crysom.4 days = 5 random = 240 }#days to hours applied
		}
		if = {
			limit = { has_country_flag = power_bonus }
			country_event = { id = crysom.5 days = 5 random = 240 }#days to hours applied
		}
		add_opinion_modifier = { target = event_target:equestria modifier = mortal_enemies }
		hidden_effect = {
			load_oob = "CRY_SOM_devoted_army"
		}
		reverse_add_opinion_modifier = { target = event_target:equestria modifier = mortal_enemies }
		every_unit_leader = {
			limit = {
				OR = {
					has_id = 200
					has_id = 1043
				}
			}
			retire = yes
		}
	}
}
country_event = { ## Library Work Focus
	id = cryscr.23
	immediate = {log = "[Root.GetName]: event cryscr.23"}#Auto-logging
	title = cryscr.23.t
	desc = cryscr.23.d
	picture = GFX_event_apartment_club
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.23.a
		hidden_effect = {
			country_event = { id = cryscr.24 hours = 5 }
		}
	}
}
country_event = { ## Into the library
	id = cryscr.24
	immediate = {log = "[Root.GetName]: event cryscr.24"}#Auto-logging
	title = cryscr.24.t
	desc = cryscr.24.d
	picture = GFX_event_apartment_club
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.24.a
		hidden_effect = {
			country_event = { id = cryscr.25 hours = 23 }
		}
	}
}
country_event = { ## On the way
	id = cryscr.25
	immediate = {log = "[Root.GetName]: event cryscr.25"}#Auto-logging
	title = cryscr.25.t
	desc = cryscr.25.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.25.a
		hidden_effect = {
			country_event = { id = cryscr.26 hours = 1 }
		}
	}
}
country_event = { ## Into the library
	id = cryscr.26
	immediate = {log = "[Root.GetName]: event cryscr.26"}#Auto-logging
	title = cryscr.26.t
	desc = cryscr.26.d
	picture = GFX_event_crystal_university
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.26.a
		hidden_effect = {
			country_event = { id = cryscr.27 hours = 1 }
		}
	}
}
country_event = { ## Into the library
	id = cryscr.27
	immediate = {log = "[Root.GetName]: event cryscr.27"}#Auto-logging
	title = cryscr.27.t
	desc = cryscr.27.d
	picture = GFX_event_crystal_library
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.27.a
		set_country_flag = learned_about_the_crystals
	}
}
country_event = { ## Into the library
	id = cryscr.30
	immediate = {log = "[Root.GetName]: event cryscr.30"}#Auto-logging
	title = cryscr.30.t
	desc = cryscr.30.d
	picture = GFX_event_apartment_club
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.30.a
		hidden_effect = {
			country_event = { id = cryscr.31 days = 5 }
		}
	}
	option = {
		name = cryscr.30.b
		hidden_effect = {
			country_event = { id = cryscr.32 days = 2 }
			goto_province = 11109
		}
	}
}
country_event = { ## Umbrum Cage
	id = cryscr.31
	immediate = {log = "[Root.GetName]: event cryscr.31"}#Auto-logging
	title = cryscr.31.t
	desc = cryscr.31.d
	picture = GFX_event_green_mountain
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.31.a
		hidden_effect = {
			country_event = { id = cryscr.41 hours = 1 }
		}
	}
}
country_event = { ## The Crystal Mountains
	id = cryscr.32
	immediate = {log = "[Root.GetName]: event cryscr.32"}#Auto-logging
	title = cryscr.32.t
	desc = cryscr.32.d
	picture = GFX_event_crystal_mountain
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.32.a
		add_political_power = 2
		hidden_effect = {
			country_event = { id = cryscr.33 days = 1 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves
	id = cryscr.33
	immediate = {log = "[Root.GetName]: event cryscr.33"}#Auto-logging
	title = cryscr.33.t
	desc = cryscr.33.d
	picture = GFX_event_cave
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.33.a
		hidden_effect = {
			country_event = { id = cryscr.34 days = 1 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves, Somepony has to dive
	id = cryscr.34
	immediate = {log = "[Root.GetName]: event cryscr.34"}#Auto-logging
	title = cryscr.34.t
	desc = cryscr.34.d
	picture = GFX_event_cave
	
	is_triggered_only = yes
	
	option = { ## you dive
		name = cryscr.34.a
		hidden_effect = {
			country_event = { id = cryscr.35 hours = 1 }
			modify_country_flag = { flag = sakira_likes_that value = 2 }
		}
	}
	option = { ## sakira dives
		name = cryscr.34.b
		hidden_effect = {
			country_event = { id = cryscr.36 hours = 1 }
			modify_country_flag = { flag = sakira_likes_that value = -4 }
		}
	}
	option = { ## dust dives
		name = cryscr.34.c
		hidden_effect = {
			country_event = { id = cryscr.37 hours = 1 }
			modify_country_flag = { flag = sakira_likes_that value = -1 }
		}
	}
	option = {
		name = cryscr.34.e
		hidden_effect = {
			country_event = { id = cryscr.38 hours = 1 }
			modify_country_flag = { flag = sakira_likes_that value = 4 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves, You dive
	id = cryscr.35
	immediate = {log = "[Root.GetName]: event cryscr.35"}#Auto-logging
	title = cryscr.35.t
	desc = cryscr.35.d
	picture = GFX_event_cave
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.35.a
		set_country_flag = player_sick
		hidden_effect = {
			country_event = { id = cryscr.39 days = 1 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves, Sakira dives
	id = cryscr.36
	immediate = {log = "[Root.GetName]: event cryscr.36"}#Auto-logging
	title = cryscr.36.t
	desc = cryscr.36.d
	picture = GFX_event_cave
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.36.a
		set_country_flag = sakira_sick
		hidden_effect = {
			country_event = { id = cryscr.39 days = 1 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves, Dust Dives
	id = cryscr.37
	immediate = {log = "[Root.GetName]: event cryscr.37"}#Auto-logging
	title = cryscr.37.t
	desc = cryscr.37.d
	picture = GFX_event_cave
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.37.a
		set_country_flag = dust_sick
		hidden_effect = {
			country_event = { id = cryscr.39 days = 1 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves, Sakira and you dive
	id = cryscr.38
	immediate = {log = "[Root.GetName]: event cryscr.38"}#Auto-logging
	title = cryscr.38.t
	desc = cryscr.38.d
	picture = GFX_event_cave
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.38.a
		set_country_flag = sakira_sick
		set_country_flag = player_sick
		hidden_effect = {
			country_event = { id = cryscr.39 days = 1 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves, Got the Crystal
	id = cryscr.39
	immediate = {log = "[Root.GetName]: event cryscr.39"}#Auto-logging
	title = cryscr.39.t
	desc = {
		text = cryscr.39.d_sakira
		trigger = {
			has_country_flag = sakira_sick
			NOT = { has_country_flag = player_sick }
		}
	}
	desc = {
		text = cryscr.39.d_player
		trigger = {
			has_country_flag = player_sick
			NOT = { has_country_flag = sakira_sick }
		}
	}
	desc = {
		text = cryscr.39.d_sakira_and_player
		trigger = {
			has_country_flag = player_sick
			has_country_flag = sakira_sick
		}
	}
	desc = {
		text = cryscr.39.d_dust
		trigger = {
			has_country_flag = dust_sick
		}
	}
	picture = GFX_event_crystal_mountain
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.39.a
		trigger = {
			NOT = { has_country_flag = sakira_sick }
		}
		hidden_effect = {
			country_event = { id = cryscr.40 days = 5 }
		}
	}
	option = {
		name = cryscr.39.b
		trigger = {
			has_country_flag = sakira_sick
		}
		hidden_effect = {
			country_event = { id = cryscr.40 days = 5 }
		}
	}
}
country_event = { ## The Crystal Mountains Caves, Dust Dives
	id = cryscr.40
	immediate = {log = "[Root.GetName]: event cryscr.40"}#Auto-logging
	title = cryscr.40.t
	desc = cryscr.40.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.40.a
		activate_mission = CRY_growing_the_heart
		custom_effect_tooltip = heart_will_grow
		trigger = {
			has_country_flag = sick_together
		}
		modify_country_flag = { flag = sakira_likes_that value = 1 }
		clr_country_flag = dark_heart_in_progress
	}
	option = {
		name = cryscr.40.b
		activate_mission = CRY_growing_the_heart
		custom_effect_tooltip = heart_will_grow
		trigger = {
			has_country_flag = sakira_sick
			NOT = { has_country_flag = sick_together }
		}
		clr_country_flag = dark_heart_in_progress
	}
	option = {
		name = cryscr.40.c
		activate_mission = CRY_growing_the_heart
		custom_effect_tooltip = heart_will_grow
		trigger = {
			has_country_flag = player_sick
			NOT = { has_country_flag = sick_together }
		}
		clr_country_flag = dark_heart_in_progress
	}
	option = {
		name = cryscr.40.dust
		activate_mission = CRY_growing_the_heart
		custom_effect_tooltip = heart_will_grow
		trigger = {
			has_country_flag = dust_sick
		}
		clr_country_flag = dark_heart_in_progress
	}
	option = {
		name = cryscr.40.e
		trigger = {
			has_country_flag = lake_sick
		}
		activate_mission = CRY_growing_the_heart
		custom_effect_tooltip = heart_will_grow
		clr_country_flag = dark_heart_in_progress
	}
}
country_event = { ## Meet the foals
	id = cryscr.41
	immediate = {log = "[Root.GetName]: event cryscr.41"}#Auto-logging
	title = cryscr.41.t
	desc = cryscr.41.d
	picture = GFX_event_green_mountain
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.41.a
		hidden_effect = {
			country_event = { id = cryscr.43 hours = 1 }
		}
	}
	option = {
		name = cryscr.41.b
		hidden_effect = {
			country_event = { id = cryscr.42 hours = 1 }
		}
		modify_country_flag = { flag = sakira_likes_that value = 2 }
	}
}
country_event = { ## Story of the foals
	id = cryscr.42
	immediate = {log = "[Root.GetName]: event cryscr.42"}#Auto-logging
	title = cryscr.42.t
	desc = cryscr.42.d
	picture = GFX_event_green_mountain
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.42.a
		hidden_effect = {
			country_event = { id = cryscr.44 hours = 13 }
		}
	}
}
country_event = { ## Skip the story of the foals
	id = cryscr.43
	immediate = {log = "[Root.GetName]: event cryscr.43"}#Auto-logging
	title = cryscr.43.t
	desc = cryscr.43.d
	picture = GFX_event_green_mountain
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.43.a
		add_political_power = -5
		hidden_effect = {
			country_event = { id = cryscr.44 hours = 13 }
		}
	}
}
country_event = { ## Into the mines
	id = cryscr.44
	immediate = {log = "[Root.GetName]: event cryscr.44"}#Auto-logging
	title = cryscr.44.t
	desc = cryscr.44.d
	picture = GFX_event_old_mine
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.44.a
		hidden_effect = {
			country_event = { id = cryscr.45 hours = 1 }
		}
	}
}
country_event = { ## Into the mines
	id = cryscr.45
	immediate = {log = "[Root.GetName]: event cryscr.45"}#Auto-logging
	title = cryscr.45.t
	desc = cryscr.45.d
	picture = GFX_event_old_mine
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.45.a
		hidden_effect = {
			country_event = { id = cryscr.46 hours = 1 }
		}
	}
}
country_event = { ## Into the mines
	id = cryscr.46
	immediate = {log = "[Root.GetName]: event cryscr.46"}#Auto-logging
	title = cryscr.46.t
	desc = cryscr.46.d
	picture = GFX_event_old_mine
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.46.a
		hidden_effect = {
			country_event = { id = cryscr.47 hours = 1 }
		}
	}
}
country_event = { ## Into the mines
	id = cryscr.47
	immediate = {log = "[Root.GetName]: event cryscr.47"}#Auto-logging
	title = cryscr.47.t
	desc = cryscr.47.d
	picture = GFX_event_old_mine
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.47.a
		set_country_flag = lake_sick
		hidden_effect = {
			country_event = { id = cryscr.40 days = 7 }
		}
	}
}
country_event = { ## Activated Crystals
	id = cryscr.48
	immediate = {log = "[Root.GetName]: event cryscr.48"}#Auto-logging
	title = cryscr.48.t
	desc = cryscr.48.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = cryscr.48.a
		add_political_power = 15
		set_country_flag = crystals_activated
	}
}
country_event = { ## Activated Crystals
	id = cryscr.49
	immediate = {log = "[Root.GetName]: event cryscr.49"}#Auto-logging
	title = cryscr.49.t
	desc = cryscr.49.d
	picture = GFX_event_crystal_city
	
	#trigger = {
	#	original_tag = CRY
	#	has_country_flag = umbrum_planted
	#}
	#mean_time_to_happen = { days = 70 }
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = cryscr.49.a
		add_political_power = 5
		set_country_flag = dark_heart_is_ready
		hidden_effect = {
			overlord = {
				if = {
					limit = {
						has_completed_focus = increase_presense_inCRY
					}
					country_event = { id = cryscr.50 days = 1 random = 168 }#days to hours applied
				}
			}
		}
	}
}

country_event = { ## EQS notification if they have increase presence
	id = cryscr.50
	immediate = {log = "[Root.GetName]: event cryscr.50"}#Auto-logging
	title = cryscr.50.t
	desc = cryscr.50.d
	picture = GFX_event_crystal_city
	
	#trigger = {
	#	original_tag = CRY
	#	has_country_flag = umbrum_planted
	#}
	#mean_time_to_happen = { days = 70 }
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = cryscr.50.a
	}
}

## Skipping fanfiction ###
country_event = { # Support the club
	id = crystalemp.14
	immediate = {log = "[Root.GetName]: event crystalemp.14"}#Auto-logging
	title = crystalemp.14.t
	desc = crystalemp.14.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.14.a
		add_political_power = -20
		hidden_effect = {
			country_event = {
				id = crystalemp.15 days = 10
			}
		}
	}
}
country_event = { # The club information
	id = crystalemp.15
	immediate = {log = "[Root.GetName]: event crystalemp.15"}#Auto-logging
	title = crystalemp.15.t
	desc = crystalemp.15.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crystalemp.15.a
		set_country_flag = support_the_club
	}
}
country_event = { # The club information
	id = crystalemp.16
	immediate = {log = "[Root.GetName]: event crystalemp.16"}#Auto-logging
	title = crystalemp.16.t
	desc = crystalemp.16.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = help_the_club
	}
	mean_time_to_happen = { days = 250 }
	fire_only_once = yes
	option = {
		name = crystalemp.16.a
		set_country_flag = dark_heart_is_ready
		hidden_effect = {
			overlord = {
				if = {
					limit = {
						has_completed_focus = increase_presense_inCRY
					}
					country_event = { id = cryscr.50 days = 1 random = 168 }#days to hours applied
				}
			}
		}
	}
}
############################################################
############################################################
############### Scroup Finishes ##############################
############################################################
############################################################
############################################################
############################################################
############### Sombra Starts ##############################
############################################################
############################################################
country_event = { ## Final Act - Club Member
	id = cryscr.1111
	immediate = {log = "[Root.GetName]: event cryscr.1111"}#Auto-logging
	title = cryscr.1111.t
	desc = cryscr.1111.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_war = no
		has_country_flag = CRY_crystalheartstolen_d_done
		has_country_flag = joined_the_club
		NOT = { has_global_flag = sombra_returned }
		OR = { has_idea = sombra_threat has_idea = sombra_threat2 has_idea = sombra_threat_reported }
	}
	mean_time_to_happen = { days = 10 }
	fire_only_once = yes
	option = {
		name = cryscr.1111.a
		trigger = { NOT = { has_country_flag = crystals_activated } }
		hidden_effect = {
			random_list = { 20 = { set_country_flag = larger_civil_war } 35 = { set_country_flag = medium_civil_war } 30 = { set_country_flag = small_civil_war } 15 = { set_country_flag = giant_civil_war modify_country_flag = { flag = sakira_likes_that value = 2 } } }
			country_event = {
				id = crysom.1 days = 1
			}
		}
	}
	option = {
		name = cryscr.1111.a
		trigger = { has_country_flag = crystals_activated }
		hidden_effect = {
			random_list = { 60 = { set_country_flag = larger_civil_war } 20 = { set_country_flag = medium_civil_war } 5 = { set_country_flag = small_civil_war } 15 = { set_country_flag = giant_civil_war modify_country_flag = { flag = sakira_likes_that value = 2 } } }
			country_event = {
				id = crysom.1 days = 1
			}
		}
	}
}
country_event = { # Final Act - NOT A MEMBER
	id = crysom.0
	immediate = {log = "[Root.GetName]: event crysom.0"}#Auto-logging
	title = crysom.0.t
	desc = crysom.0.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_war = no
		has_country_flag = CRY_crystalheartstolen_d_done
		has_country_flag = support_the_club
		NOT = { has_global_flag = sombra_returned }
		OR = { has_idea = sombra_threat has_idea = sombra_threat2 has_idea = sombra_threat_reported }
	}
	mean_time_to_happen = { days = 10 }
	fire_only_once = yes
	option = {
		name = crysom.0.a
		country_event = {
			id = crysom.2 days = 1
		}
		hidden_effect = {
			random_list = { 20 = { set_country_flag = larger_civil_war } 35 = { set_country_flag = medium_civil_war } 30 = { set_country_flag = small_civil_war } 5 = { set_country_flag = giant_civil_war } }
			random_list = { 30 = { set_country_flag = ghosts_bonus } 50 = { set_country_flag = power_bonus } 20 = { set_country_flag = strength_bonus } }
		}
	}
}
country_event = { ## Spell casting
	id = crysom.1
	immediate = {log = "[Root.GetName]: event crysom.1"}#Auto-logging
	title = crysom.1.t
	desc = crysom.1.d
	picture = GFX_event_sombra_return
	
	is_triggered_only = yes
	
	option = {
        name = crysom.1.a
        set_country_flag = ghosts_bonus
        country_event = {
            id = crysom.2 hours = 1
        }
    }
	option = {
		name = crysom.1.b
		set_country_flag = strength_bonus
		country_event = {
			id = crysom.2 hours = 1
		}
	}
	option = {
		name = crysom.1.c
		set_country_flag = power_bonus
		country_event = {
			id = crysom.2 hours = 1
		}
	}
}
country_event = { ## ACTUAL SOMBRA RETURN HERE AYY LMAOOOOOOOOO
	id = crysom.2
	immediate = {log = "[Root.GetName]: event crysom.2"}#Auto-logging
	title = crysom.2.t
	desc = crysom.2.d
	picture = GFX_event_sombra_return
	
	is_triggered_only = yes
	
	option = {
		name = crysom.2.a
		set_temp_variable = { civ_war_size = 0.37 }
		if = {
			limit = { has_country_flag = small_civil_war }
			set_temp_variable = { civ_war_size = 0.70 }
		}
		else_if = {
			limit = { has_country_flag = medium_civil_war }
			set_temp_variable = { civ_war_size = 0.50 }
		}
		else_if = {
			limit = { has_country_flag = giant_civil_war }
			set_temp_variable = { civ_war_size = 0.15 }
		}
		if = {
			limit = { has_government = communism }
			start_civil_war = {
				ruling_party = fascism
				ideology = communism
				size = civ_war_size
				capital = 344
				#states = { 318 139 77 140 343 143 324 141 236 339 345 }
			}
		}
		else = {
			start_civil_war = {
				ruling_party = fascism
				ideology = democratic
				size = civ_war_size
				capital = 344
				#states = { 318 139 77 140 343 143 324 141 236 339 345 }
			}
		}
		add_threat = 5
		hidden_effect = {
			random_other_country = {
				limit = { 
					original_tag = CRY
					has_government = democratic 
				}
				set_cosmetic_tag = CRY_DEM
				add_popularity = { ideology = democratic popularity = 0.3 }
				save_event_target_as = dem_CRY
			}
			every_unit_leader = {
				limit = {
					OR = {
						has_id = 200
						has_id = 1043
					}
				}
				set_nationality = event_target:dem_CRY
			}
			retire_country_leader = yes
		}
		set_party_name = { ideology = fascism name = CRY_sombra_party long_name = CRY_sombra_party }
		add_popularity = { ideology = fascism popularity = 0.2 }
		create_country_leader = {
			name = "King Sombra"
			expire = "1965.1.1"
			ideology = nazism
			desc = "POLITICS_SOMBRA_DESC"
			picture = "Sombra.tga"
			traits = {
				warmonger
			}
		}
		hidden_effect = {
			load_oob = "CRY_SOM_devoted_army"
		}
		create_corps_commander = {
			name = "Sqeeky Hooves"
			portrait_path = "gfx/leaders/CRY/SombraGeneral.tga"
			traits = { ranger }
			skill = 2
			attack_skill = 4
			defense_skill = 2
			planning_skill = 3
			logistics_skill = 3
		}
		set_cosmetic_tag = CRY_SOM
		load_focus_tree = crystalempire_sombra
		set_global_flag = sombra_returned
		add_opinion_modifier = { target = event_target:equestria modifier = mortal_enemies }
		reverse_add_opinion_modifier = { target = event_target:equestria modifier = mortal_enemies }
		hidden_effect = { 
			Evil_unicorn_magic = yes
			if = {
				limit = { has_country_flag = ghosts_bonus }
				country_event = { id = crysom.3 days = 5 random = 240 }#days to hours applied
			}
			if = {
				limit = { has_country_flag = strength_bonus }
				country_event = { id = crysom.4 days = 5 random = 240 }#days to hours applied
			}
			if = {
				limit = { has_country_flag = power_bonus }
				country_event = { id = crysom.5 days = 5 random = 240 }#days to hours applied
			}
		}
		news_event = {
			id = news.35 hours = 6
		}
	}
}
country_event = { ## Royal Guard
	id = crysom.3
	immediate = {log = "[Root.GetName]: event crysom.3"}#Autologging
	title = crysom.3.t
	desc = crysom.3.d
	picture = GFX_event_sombra_return
	
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		trigger = {
			NOT = {  has_country_flag = crystals_activated }
		}
		name = crysom.3.a
		add_timed_idea = { idea = CRY_old_guard days = 128 }
		add_manpower = 25000
		custom_effect_tooltip = ghosts_sombra_spawn_tt
		hidden_effect = {
			load_oob = "CRY_sombra_ghosts"
		}
	}
	option = {
		name = crysom.3.b
		trigger = {
			has_country_flag = crystals_activated
		}
		add_timed_idea = { idea = CRY_old_guard days = 188 }
		add_manpower = 55000
		custom_effect_tooltip = ghosts_sombra_spawn_tt
		hidden_effect = {
			load_oob = "CRY_sombra_ghosts"
		}
	}
}
country_event = { ## Strength
	id = crysom.4
	immediate = {log = "[Root.GetName]: event crysom.4"}#Auto-logging
	title = crysom.4.t
	desc = crysom.4.d
	picture = GFX_event_sombra_return
	
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = crysom.4.a
		trigger = { has_country_flag = crystals_activated }
		add_timed_idea = { idea = sombra_strength_CRY days = 300 }
	}
	option = {
		name = crysom.4.a
		trigger = { NOT = { has_country_flag = crystals_activated } }
		add_timed_idea = { idea = sombra_strength_CRY days = 180 }
	}
}
country_event = { ## Power bonus
	id = crysom.5
	immediate = {log = "[Root.GetName]: event crysom.5"}#Auto-logging
	title = crysom.5.t
	desc = crysom.5.d
	picture = GFX_event_sombra_return
	
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = crysom.5.a
		trigger = { NOT = { has_country_flag = crystals_activated } }
		add_timed_idea = { idea = CRY_sombra_power_bonus days = 180 }
	}
	option = {
		name = crysom.5.a
		trigger = { has_country_flag = crystals_activated }
		add_timed_idea = { idea = CRY_sombra_power_bonus days = 250 }
	}
}
country_event = { ## Lake getting Blind
	id = crysom.6
	immediate = {log = "[Root.GetName]: event crysom.6"}#Auto-logging
	title = crysom.6.t
	desc = crysom.6.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = lake_sick
		has_global_flag = sombra_returned
	}
	mean_time_to_happen = { days = 500 }
	fire_only_once = yes
	option = {
		name = crysom.6.a
		add_political_power = -20
		set_country_flag = lake_blind_0
	}
}
country_event = { ## Lake is Blind ;v;
	id = crysom.7
	immediate = {log = "[Root.GetName]: event crysom.7"}#Auto-logging
	title = crysom.7.t
	desc = crysom.7.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = lake_sick
		has_global_flag = sombra_returned
		has_country_flag = lake_blind_0
	}
	mean_time_to_happen = { days = 1200 }
	fire_only_once = yes
	option = {
		name = crysom.7.a
		set_country_flag = lake_blind
		clr_country_flag = lake_blind_0
	}
}
country_event = { ## You're sick you dip
	id = crysom.8
	immediate = {log = "[Root.GetName]: event crysom.8"}#Auto-logging
	title = crysom.8.t
	desc = {
		text = crysom.8.d
		trigger = { has_country_flag = player_sick
			NOT = { has_country_flag = sick_together } }
	}
	desc = {
		text = crysom.8.d_sick_together
		trigger = { has_country_flag = sick_together }
	}
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = player_sick
		has_global_flag = sombra_returned
	}
	mean_time_to_happen = { days = 500 }
	fire_only_once = yes
	option = {
		name = crysom.8.a
		trigger = { has_country_flag = player_sick
			NOT = { has_country_flag = sick_together } }
		add_political_power = -440
	}
	option = {
		name = crysom.8.b
		trigger = { has_country_flag = sick_together }
		add_political_power = -100
		set_country_flag = sakira_and_you
	}
}
country_event = { ## Dust's sick
	id = crysom.9
	immediate = {log = "[Root.GetName]: event crysom.9"}#Auto-logging
	title = crysom.9.t
	desc = crysom.9.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = dust_sick
		has_global_flag = sombra_returned
	}
	mean_time_to_happen = { days = 300 }
	fire_only_once = yes
	option = {
		name = crysom.9.a
		set_country_flag = dust_sick_1
	}
}
country_event = { ## Dust's sick
	id = crysom.10
	immediate = {log = "[Root.GetName]: event crysom.10"}#Auto-logging
	title = crysom.10.t
	desc = crysom.10.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = dust_sick_1
		has_global_flag = sombra_returned
	}
	mean_time_to_happen = { days = 400 }
	fire_only_once = yes
	option = {
		name = crysom.10.a
		clr_country_flag = dust_sick_1
		set_country_flag = dust_will_die
	}
}
country_event = { ## Dust's sick
	id = crysom.11
	immediate = {log = "[Root.GetName]: event crysom.11"}#Auto-logging
	title = crysom.11.t
	desc = crysom.11.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = dust_will_die
		has_global_flag = sombra_returned
	}
	mean_time_to_happen = { days = 200 }
	fire_only_once = yes
	option = {
		name = crysom.11.a
		set_country_flag = dust_dead
	}
}
country_event = { ## Sakira's sick
	id = crysom.1222
	immediate = {log = "[Root.GetName]: event crysom.1222"}#Auto-logging
	title = crysom.1222.t
	desc = crysom.1222.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = sakira_sick
		has_global_flag = sombra_returned
	}
	mean_time_to_happen = { days = 20 }
	fire_only_once = yes
	option = {
		name = crysom.1222.a
		add_political_power = -10
	}
	option = {
		name = crysom.1222.b
		add_political_power = -30
		modify_country_flag = { flag = sakira_likes_that value = 2 }
	}
}
country_event = { ## Sakira's sick
	id = crysom.12
	immediate = {log = "[Root.GetName]: event crysom.12"}#Auto-logging
	title = crysom.12.t
	desc = crysom.12.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = sakira_sick
		has_global_flag = sombra_returned
		NOT = { has_country_flag = sick_together }
	}
	mean_time_to_happen = { days = 300 }
	fire_only_once = yes
	option = {
		name = crysom.12.a
		add_political_power = 5
		set_country_flag = sakira_getting_better
	}
	option = {
		name = crysom.12.b
		add_political_power = -10
		set_country_flag = sakira_getting_better
		modify_country_flag = { flag = sakira_likes_that value = 2 }
	}
}
country_event = { ## Sakira is better
	id = crysom.13
	immediate = {log = "[Root.GetName]: event crysom.13"}#Auto-logging
	title = crysom.13.t
	desc = crysom.13.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = sakira_sick
		has_global_flag = sombra_returned
		has_country_flag = sakira_getting_better
		NOT = { has_country_flag = sick_together }
	}
	mean_time_to_happen = { days = 340 }
	fire_only_once = yes
	option = {
		name = crysom.13.a
		clr_country_flag = sakira_sick
	}
}
country_event = { ##Militarization
	id = crysom.14
	immediate = {log = "[Root.GetName]: event crysom.14"}#Auto-logging
	title = crysom.14.t
	desc = crysom.14.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.14.a
		random_list = { 20 = { add_political_power = -40 } 35 = { add_political_power = -20 } 30 = { add_political_power = -15 } 15 = { add_political_power = -5 } }
	}
}
country_event = { ##Army training
	id = crysom.15
	immediate = {log = "[Root.GetName]: event crysom.15"}#Auto-logging
	title = crysom.15.t
	desc = crysom.15.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.15.a
		random_list = { 20 = { add_political_power = -57 } 35 = { add_political_power = -100 } 30 = { add_political_power = -139 } 15 = { add_political_power = -30 } }
	}
}
country_event = { ##End of Crystal Civil War against Sombra, obviously
	id = crysom.16
	immediate = {log = "[Root.GetName]: event crysom.16"}#Auto-logging
	title = crysom.16.t
	desc = crysom.16.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.16.a
		add_political_power = 30
		set_global_flag = return_of_sombra
	}
}
country_event = { ## Sakira is better
	id = crysom.17
	immediate = {log = "[Root.GetName]: event crysom.17"}#Auto-logging
	title = crysom.17.t
	desc = crysom.17.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = sakira_sick
		has_country_flag = sick_together
		has_country_flag = sakira_getting_better
	}
	mean_time_to_happen = { days = 30 }
	fire_only_once = yes
	option = {
		name = crysom.17.a
		clr_country_flag = sakira_sick
		modify_country_flag = { flag = sakira_likes_that value = 1 }
	}
}
country_event = { ## Sakira is better
	id = crysom.18
	immediate = {log = "[Root.GetName]: event crysom.18"}#Auto-logging
	title = crysom.18.t
	desc = crysom.18.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_country_flag = sakira_sick
		has_country_flag = sick_together
		has_global_flag = sombra_returned
	}
	mean_time_to_happen = { days = 100 }
	fire_only_once = yes
	option = {
		name = crysom.18.a
		set_country_flag = sakira_getting_better
		modify_country_flag = { flag = sakira_likes_that value = 1 }
	}
}
country_event = { ## Conquest of Equestria
	id = crysom.19
	immediate = {log = "[Root.GetName]: event crysom.19"}#Auto-logging
	title = crysom.19.t
	desc = crysom.19.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.19.a
		if = {
			limit = { country_exists = event_target:equestria }
			create_wargoal = { type = puppet_wargoal_focus target = event_target:equestria }
		}
		set_country_flag = prepared_the_attack
	}
}
country_event = { ## Conquest of Equestria
	id = crysom.20
	immediate = {log = "[Root.GetName]: event crysom.20"}#Auto-logging
	title = crysom.20.t
	desc = {
		text = crysom.20.d_has_war_success
		trigger = {
			has_war_with = event_target:equestria
			70 = { is_controlled_by = ROOT }
		}
	}
	desc = {
		text = crysom.20.d_has_war_noluck
		trigger = {
			AND = {
				has_war_with = event_target:equestria
				70 = { is_controlled_by = event_target:equestria }
			}
		}
	}
	desc = {
		text = crysom.20.d_not_has_war
		trigger = {
			NOT = { has_war_with = event_target:equestria }
		}
	}
	picture = GFX_event_winter_sun
	
	is_triggered_only = yes
	option = {
		trigger = { NOT = { has_war_with = event_target:equestria } }
		name = crysom.20.a
		if = {
			limit = { country_exists = event_target:equestria }
			declare_war_on = { target = event_target:equestria type = puppet_wargoal_focus }
		}
	}
	option = {
		trigger = {
			has_war_with = event_target:equestria
			70 = { is_controlled_by = ROOT }
		}
		name = crysom.20.a
		add_political_power = 20
		army_experience = 15
	}
	option = {
		trigger = {
			AND = {
				has_war_with = event_target:equestria
				70 = { is_controlled_by = event_target:equestria }
			}
		}
		name = crysom.20.a
		add_political_power = -20
		army_experience = 5
	}
}
country_event = { ## Coring the old territories
	id = crysom.21
	immediate = {log = "[Root.GetName]: event crysom.21"}#Auto-logging
	title = crysom.21.t
	desc = crysom.21.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.21.a
		custom_effect_tooltip = sombra_cores
		hidden_effect = {
			every_state = {
				limit = {
					OR = {
						state = 137
						state = 138
						state = 174
						state = 136
						state = 131
						state = 175
						state = 172
						state = 173
						state = 14
						state = 73
						state = 72
						state = 59
						state = 60
						state = 61
						state = 132
						state = 170
						state = 169
						state = 180
						state = 181
						state = 174
						state = 134
						state = 135
						state = 178
						state = 74
						state = 104
						state = 183
						state = 177
						state = 182
						state = 155
						state = 154
						state = 102
						state = 157
						state = 326
						state = 160
						state = 164
						state = 237
						state = 235
						state = 163
						state = 161
						state = 153
						state = 334
						state = 240
						state = 165
						state = 225
						state = 168
						state = 167
						state = 166
						state = 332
						state = 234
						state = 57
						state = 268
						state = 267
						state = 11
						state = 317
						state = 255
						state = 273
						state = 270
						state = 346
						state = 256
						state = 274
						state = 269
						state = 253
						state = 224
						state = 56
						state = 156
						state = 70
						state = 54
						state = 133
						state = 45
						state = 233
						state = 678
						state = 176
						state = 254
					}
				}
				add_core_of = ROOT
			}
		}
	}
}
country_event = { ## Fiendship
	id = crysom.22
	immediate = {log = "[Root.GetName]: event crysom.22"}#Auto-logging
	title = crysom.22.t
	desc = { text = crysom.22.d_nlr
		trigger = { is_in_faction_with = NLR
			NOT = { is_in_faction_with = CHN is_in_faction_with = STG } } }
	
	desc = { text = crysom.22.d_chn
		trigger = { is_in_faction_with = CHN
			NOT = { is_in_faction_with = NLR is_in_faction_with = STG } } }
	
	desc = { text = crysom.22.d_stg
		trigger = { is_in_faction_with = STG
			NOT = { is_in_faction_with = NLR is_in_faction_with = CHN } } }
	
	desc = { text = crysom.22.d_stg_n_nlr
		trigger = { is_in_faction_with = STG
			is_in_faction_with = NLR
			NOT = { is_in_faction_with = CHN } } }
	
	desc = { text = crysom.22.d_stg_n_chn
		trigger = { is_in_faction_with = STG
			is_in_faction_with = CHN
			NOT = { is_in_faction_with = NLR } } }
	
	desc = { text = crysom.22.d_stg_n_chn_n_nlr
		trigger = { is_in_faction_with = STG
			is_in_faction_with = CHN is_in_faction_with = NLR } }
	
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.22.a
		every_state = {
			limit = {
				is_core_of = EQS
			}
			add_core_of = ROOT
		}
		drop_cosmetic_tag = yes
		set_cosmetic_tag = CRY_SOMIMP
	}
}
country_event = { ## Conquest of Changelings
	id = crysom.23
	immediate = {log = "[Root.GetName]: event crysom.23"}#Auto-logging
	title = crysom.23.t
	desc = crysom.23.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.23.a
		create_wargoal = {
			target = CHN type = puppet_wargoal_focus
		}
	}
	option = {
		name = crysom.23.b
		add_political_power = -20
		CHN = {
			country_event = {
				id = changelings.18 days = 1
			}
		}
	}
}
country_event = { ## Conquest of Changelings
	id = crysom.233
	immediate = {log = "[Root.GetName]: event crysom.233"}#Auto-logging
	title = crysom.233.t
	desc = crysom.233.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.233.a
		add_political_power = 30
		create_wargoal = {
			target = CHN type = puppet_wargoal_focus
		}
	}
}
country_event = { ## Changelings agreed to be puppets
	id = crysom.24
	immediate = {log = "[Root.GetName]: event crysom.24"}#Auto-logging
	title = crysom.24.t
	desc = crysom.24.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.24.a
		add_political_power = 300
		transfer_state = 319
		transfer_state = 247
		transfer_state = 246
		transfer_state = 316
		transfer_state = 322
		puppet = CHN
	}
}
country_event = { ## Alliance with Changelings
	id = crysom.25
	immediate = {log = "[Root.GetName]: event crysom.25"}#Auto-logging
	title = crysom.25.t
	desc = crysom.25.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.25.a
		add_political_power = -20
		CHN = {
			country_event = {
				id = changelings.19 days = 1
			}
		}
	}
}
country_event = { ## Alliance with Changelings Declined
	id = crysom.26
	immediate = {log = "[Root.GetName]: event crysom.26"}#Auto-logging
	title = crysom.26.t
	desc = crysom.26.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.26.a
		add_political_power = -200
	}
}
country_event = { ## Alliance with Changelings Accepted
	id = crysom.27
	immediate = {log = "[Root.GetName]: event crysom.27"}#Auto-logging
	title = crysom.27.t
	desc = crysom.27.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.27.a
		add_opinion_modifier = {
			target = CHN modifier = fiendship
		}
		CHN = {
			add_opinion_modifier = {
				target = ROOT modifier = fiendship
			}
			hidden_effect = {
				if = {
					limit = {
						CHN = { has_idea = canterlot_defeat }
					}
					swap_ideas = {
						remove_idea = canterlot_defeat
						add_idea = canterlot_defeat_but_for_friends
					}
				}
			}
		}
		set_global_flag = CHN_for_gray_pact
	}
}
country_event = { ## Gray Pact Fromed
	id = crysom.28
	immediate = {log = "[Root.GetName]: event crysom.28"}#Auto-logging
	title = crysom.28.t
	desc = { text = crysom.28.d_nlr
		trigger = { has_global_flag = NLR_for_gray_pact
			NOT = { has_global_flag = CHN_for_gray_pact has_global_flag = STG_for_gray_pact } } }
	
	desc = { text = crysom.28.d_chn
		trigger = { has_global_flag = CHN_for_gray_pact
			NOT = { has_global_flag = NLR_for_gray_pact has_global_flag = STG_for_gray_pact } } }
	
	desc = { text = crysom.28.d_stg
		trigger = { has_global_flag = STG_for_gray_pact
			NOT = { has_global_flag = NLR_for_gray_pact has_global_flag = CHN_for_gray_pact } } }
	
	desc = { text = crysom.28.d_stg_n_nlr
		trigger = { has_global_flag = STG_for_gray_pact
			has_global_flag = NLR_for_gray_pact
			NOT = { has_global_flag = CHN_for_gray_pact } } }
	
	desc = { text = crysom.28.d_stg_n_chn
		trigger = { has_global_flag = STG_for_gray_pact
			has_global_flag = CHN_for_gray_pact
			NOT = { has_global_flag = NLR_for_gray_pact } } }
	
	desc = { text = crysom.28.d_stg_n_chn_n_nlr
		trigger = { has_global_flag = STG_for_gray_pact
			has_global_flag = CHN_for_gray_pact has_global_flag = NLR_for_gray_pact } }
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.28.a
		if = {
			limit = {
				has_war_with = CHN
				has_global_flag = CHN_for_gray_pact
			}
			set_country_flag = bypass_on_peaceconference_ended
			white_peace = CHN
			clr_country_flag = bypass_on_peaceconference_ended
		}
		if = {
			limit = {
				has_global_flag = CHN_for_gray_pact
			}
			CHN = { dismantle_faction = yes }
			add_to_faction = CHN
			hidden_effect = {
				add_ai_strategy = {
					type = alliance
					id = "CHN"
					value = 999
				}
				CHN = {
					add_ai_strategy = {
						type = alliance
						id = ROOT
						value = 999
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = NLR_for_gray_pact
			}
			add_to_faction = NLR
			hidden_effect = {
				add_ai_strategy = {
					type = alliance
					id = "NLR"
					value = 999
				}
				NLR = {
					add_ai_strategy = {
						type = alliance
						id = ROOT
						value = 999
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = STG_for_gray_pact
			}
			add_to_faction = STG
			hidden_effect = {
				add_ai_strategy = {
					type = alliance
					id = "STG"
					value = 999
				}
				STG = {
					add_ai_strategy = {
						type = alliance
						id = ROOT
						value = 999
					}
				}
			}
		}
		if = {
			limit = {
				AND = {
					has_global_flag = STG_for_gray_pact
					has_global_flag = NLR_for_gray_pact
					has_global_flag = CHN_for_gray_pact
				}
			}
			add_political_power = 300
		}
	}
}
country_event = { ## Conquest of Lunar Empire
	id = crysom.29
	immediate = {log = "[Root.GetName]: event crysom.29"}#Auto-logging
	title = crysom.29.t
	desc = crysom.29.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.29.a
		create_wargoal = {
			target = NLR type = puppet_wargoal_focus
		}
	}
}
country_event = { ## Conquest of Stalliongrad
	id = crysom.30
	immediate = {log = "[Root.GetName]: event crysom.30"}#Auto-logging
	title = crysom.30.t
	desc = crysom.30.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.30.a
		create_wargoal = {
			target = STG type = puppet_wargoal_focus
		}
	}
}
country_event = { ## Alliance with NLR
	id = crysom.31
	immediate = {log = "[Root.GetName]: event crysom.31"}#Auto-logging
	title = crysom.31.t
	desc = crysom.31.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.31.a
		NLR = {
			country_event = {
				id = lunas.26 days = 1
			}
		}
	}
}
country_event = { ## NLR's response
	id = crysom.32
	immediate = {log = "[Root.GetName]: event crysom.32"}#Auto-logging
	title = crysom.32.t
	desc = {
		trigger = { has_global_flag = NLR_for_gray_pact }
		text = crysom.32.d_accept }
	desc = {
		trigger = { NOT = { has_global_flag = NLR_for_gray_pact } }
		text = crysom.32.d_decline }
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.32.a
		trigger = {
			has_global_flag = NLR_for_gray_pact
		}
		add_opinion_modifier = {
			target = NLR modifier = fiendship
		}
		NLR = {
			add_opinion_modifier = {
				target = ROOT modifier = fiendship
			}
		}
		add_political_power = 20
	}
	option = {
		name = crysom.32.b
		trigger = {
			NOT = { has_global_flag = NLR_for_gray_pact }
		}
		create_wargoal = { target = NLR type = annex_everything
		}
		add_political_power = -35
	}
}
country_event = { ## Alliance with STG
	id = crysom.33
	immediate = {log = "[Root.GetName]: event crysom.33"}#Auto-logging
	title = crysom.33.t
	desc = crysom.33.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.33.a
		STG = { country_event = { id = stalliongrad.99 days = 1 }
		}
	}
}
country_event = { ## Sinister's response
	id = crysom.34
	immediate = {log = "[Root.GetName]: event crysom.34"}#Auto-logging
	title = crysom.34.t
	desc = {
		trigger = { has_global_flag = STG_for_gray_pact }
		text = crysom.34.d_accept }
	desc = {
		trigger = { NOT = { has_global_flag = STG_for_gray_pact } }
		text = crysom.34.d_decline }
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.34.a
		trigger = {
			has_global_flag = STG_for_gray_pact
		}
		add_opinion_modifier = {
			target = STG modifier = fiendship
		}
		STG = {
			add_opinion_modifier = {
				target = ROOT modifier = fiendship
			}
		}
	}
	option = {
		name = crysom.34.b
		trigger = {
			NOT = { has_global_flag = STG_for_gray_pact }
		}
		create_wargoal = { target = STG type = puppet_wargoal_focus
		}
	}
}
country_event = { ## Marriage with Luna
	id = crysom.35
	immediate = {log = "[Root.GetName]: event crysom.35"}#Auto-logging
	title = crysom.35.t
	desc = crysom.35.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.35.a
		NLR = {
			country_event = {
				id = lunas.27 days = 7
			}
		}
		hidden_effect = {
			news_event = { id = news.36 hours = 12 }
		}
	}
}
country_event = { ## Luna's response
	id = crysom.36
	immediate = {log = "[Root.GetName]: event crysom.36"}#Auto-logging
	title = crysom.36.t
	desc = {
		trigger = { has_global_flag = Luna_for_marriage }
		text = crysom.36.d_accept }
	desc = {
		trigger = { NOT = { has_global_flag = Luna_for_marriage } }
		text = crysom.36.d_decline }
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.36.a
		trigger = {
			has_global_flag = Luna_for_marriage
		}
		set_country_flag = sombra_is_married
		add_opinion_modifier = {
			target = NLR modifier = leaders_married
		}
		NLR = {
			add_opinion_modifier = {
				target = ROOT modifier = leaders_married
			}
			give_guarantee = ROOT
		}
		give_guarantee = NLR
		diplomatic_relation = {
			country = NLR
			relation = non_aggression_pact
			active = yes
		}
		hidden_effect = {
			add_ai_strategy = {
				type = befriend
				id = "NLR"
				value = 999
			}
			add_ai_strategy = {
				type = support
				id = "NLR"
				value = 999
			}
			add_ai_strategy = {
				type = protect
				id = "NLR"
				value = 999
			}
			add_ai_strategy = {
				type = alliance
				id = "NLR"
				value = 999
			}
			add_ai_strategy = {
				type = antagonize
				id = "NLR"
				value = -999
			}
			add_ai_strategy = {
				type = conquer
				id = "NLR"
				value = -999
			}
			NLR = {
				add_ai_strategy = {
					type = befriend
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = support
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = protect
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = alliance
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = antagonize
					id = ROOT
					value = -999
				}
				add_ai_strategy = {
					type = conquer
					id = ROOT
					value = -999
				}
			}
		}
		news_event = {
			id = news.37 days = 16
		}
	}
	option = {
		name = crysom.36.b
		trigger = {
			NOT = { has_global_flag = Luna_for_marriage }
		}
		add_political_power = -150
	}
}
country_event = { ## Marriage with Chrysalis
	id = crysom.37
	immediate = {log = "[Root.GetName]: event crysom.37"}#Auto-logging
	title = crysom.37.t
	desc = crysom.37.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.37.a
		CHN = {
			country_event = {
				id = changelings.21 days = 1
			}
		}
		hidden_effect = {
			news_event = { id = news.46 hours = 6 }
		}
	}
}
country_event = { ## Chrysalis's response
	id = crysom.38
	immediate = {log = "[Root.GetName]: event crysom.38"}#Auto-logging
	title = crysom.38.t
	desc = {
		trigger = { has_global_flag = Chrysalis_for_marriage }
		text = crysom.38.d_accept }
	desc = {
		trigger = { NOT = { has_global_flag = Chrysalis_for_marriage } }
		text = crysom.38.d_decline }
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.38.a
		trigger = {
			has_global_flag = Chrysalis_for_marriage
		}
		add_opinion_modifier = {
			target = CHN modifier = leaders_married
		}
		CHN = {
			add_opinion_modifier = {
				target = ROOT modifier = leaders_married
			}
			give_guarantee = ROOT
		}
		give_guarantee = CHN
		diplomatic_relation = {
			country = CHN
			relation = non_aggression_pact
			active = yes
		}
		hidden_effect = {
			add_ai_strategy = {
				type = befriend
				id = "CHN"
				value = 999
			}
			add_ai_strategy = {
				type = support
				id = "CHN"
				value = 999
			}
			add_ai_strategy = {
				type = protect
				id = "CHN"
				value = 999
			}
			add_ai_strategy = {
				type = alliance
				id = "CHN"
				value = 999
			}
			add_ai_strategy = {
				type = antagonize
				id = "CHN"
				value = -999
			}
			add_ai_strategy = {
				type = conquer
				id = "CHN"
				value = -999
			}
			CHN = {
				add_ai_strategy = {
					type = befriend
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = support
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = protect
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = alliance
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = antagonize
					id = ROOT
					value = -999
				}
				add_ai_strategy = {
					type = conquer
					id = ROOT
					value = -999
				}
			}
		}
		news_event = {
			id = news.44 days = 16
		}
		add_political_power = 50
		set_country_flag = sombra_is_married
	}
	option = {
		name = crysom.38.b
		trigger = {
			NOT = { has_global_flag = Chrysalis_for_marriage }
		}
		add_political_power = -150
		news_event = {
			id = news.47 days = 16
		}
	}
}
country_event = { ## New Generals
	id = crysom.39
	immediate = {log = "[Root.GetName]: event crysom.39"}#Auto-logging
	title = crysom.39.t
	desc = {
		text = crysom.39.d_civil_war
		trigger = { has_civil_war = yes }
	}
	desc = {
		text = crysom.39.d_regular_war
		trigger = { has_war = yes }
	}
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = crysom.39.a
		create_corps_commander = {
			name = "Atom"
			portrait_path = "gfx/leaders/CRY/somegay.tga"
			traits = { promising_general }
			skill = 1
			attack_skill = 1
			defense_skill = 1
			planning_skill = 2
			logistics_skill = 2
		}
	}
}
country_event = { ## Bringing Back Cadence
	id = crysom.40
	immediate = {log = "[Root.GetName]: event crysom.40"}#Auto-logging
	title = crysom.40.t
	desc = crysom.40.d
	picture = GFX_event_crystal_city
	trigger = {
		original_tag = CRY
		has_government = democratic
		NOT = {
			has_country_leader = { ruling_only = yes name = "Princess Mi Amore Cadenza" }
			has_country_leader = { ruling_only = yes name = "Princess Twilight Sparkle" }
			has_country_leader = { ruling_only = yes name = "Princess Flurry Heart" }
		}
		OR = {
			NOT = { has_global_flag = royalty_executed }
			AND = {
				has_global_flag = royalty_executed
				NOT = { country_exists = event_target:solar_empire }
				NOT = { has_global_flag = SOL_twilight_converted }
			}
		}
	}
	mean_time_to_happen = { days = 1 }
	#fire_only_once = yes
	immediate = {
		every_country = {
			limit = { has_idea = royal_family_imprisoned }
			remove_ideas = royal_family_imprisoned
		}
	}
	option = {
		name = crysom.40.a
		trigger = {
			NOT = { has_global_flag = royalty_executed }
		}
		drop_cosmetic_tag = yes
		hidden_effect = {
			retire_country_leader = yes
		}
		create_country_leader = {
			name = "Princess Mi Amore Cadenza"
			desc = "CADENCE_DESC"
			picture = "Cadence.tga"
			expire = "1965.1.1"
			ideology = alicornrule
		}
		hidden_effect = {
			remove_ideas = crystal_buff
			remove_ideas = sombra_dark_magic
			remove_ideas = sombra_dark_magic1
			remove_ideas = sombra_dark_magic2
			clr_global_flag = continue_imprisonment
		}
		event_target:CRY_Shining_Armor = { set_nationality = ROOT }
	}
	option = {
		name = crysom.40.a
		trigger = {
			has_global_flag = royalty_executed
			NOT = { country_exists = event_target:solar_empire }
			NOT = { has_global_flag = SOL_twilight_converted }
		}
		drop_cosmetic_tag = yes
		hidden_effect = {
			retire_country_leader = yes
		}
		create_country_leader = {
			name = "Princess Twilight Sparkle"
			desc = "TWILIGHT_DESC"
			picture = "Twilight.tga"
			expire = "1965.1.1"
			ideology = alicornrule
			id = 1000
		}
		hidden_effect = {
			remove_ideas = crystal_buff
			remove_ideas = sombra_dark_magic
			remove_ideas = sombra_dark_magic1
			remove_ideas = sombra_dark_magic2
		}
	}
}
country_event = { ## Royal Family Captured
	id = crysom.41
	immediate = {log = "[Root.GetName]: event crysom.41"}#Auto-logging
	title = crysom.41.t
	desc = {
		text = crysom.41.d
		trigger = { has_government = fascism }
	}
	desc = {
		text = crysom.41.d_com
		trigger = { has_government = communism }
	}
	picture = GFX_event_royal_family_captured
	
	#trigger = {
	#	original_tag = CRY
	#	has_global_flag = sombra_returned
	#	has_government = fascism
	#}
	#mean_time_to_happen = { days = 5 }
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = crysom.41.a
		set_global_flag = continue_imprisonment
		event_target:equestria = {
			if = {
				limit = { has_government = democratic }
				add_ideas = royal_family_imprisoned
				if = {
					limit = { ROOT = { has_government = communism } }
					country_event = { id = equestria.45 days = 2 }
				}
			}
		}
	}
}
country_event = { ## What to do with the royal family
	id = crysom.42
	immediate = {log = "[Root.GetName]: event crysom.42"}#Auto-logging
	title = crysom.42.t
	desc = crysom.42.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = crysom.42.a
		trigger = { has_government = fascism }
		add_political_power = 150
		set_global_flag = royalty_executed
		clr_global_flag = continue_imprisonment
		every_country = {
			limit = {
				original_tag = event_target:equestria
				OR = {
					is_subject_of = event_target:equestria
					is_in_faction_with = event_target:equestria
				}
			}
			add_opinion_modifier = { modifier = executed_royalty target = ROOT }
		}
		hidden_effect = {
			if = {
				limit = { has_government = fascism }
				news_event = { id = news.cry.3 days = 3 }
			}
			else = {
				news_event = { id = news.cry.4 days = 1 }
			}
		}
	}
	option = {
		name = crysom.42.b
		add_stability = 0.05
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = crysom.42.c
		add_political_power = -50
		set_global_flag = free_the_old_royalty
		clr_global_flag = continue_imprisonment
		every_other_country = {
			limit = {
				original_tag = event_target:equestria
				OR = {
					is_subject_of = event_target:equestria
					is_in_faction_with = event_target:equestria
				}
			}
			add_opinion_modifier = { modifier = released_royalty target = ROOT }
		}
		event_target:equestria = { 	
			country_event = { id = equestria.48 days = 1 }
 		}
		hidden_effect = { news_event = { id = news.cry.5 days = 1 } }
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				has_government = fascism
			}
		}
	}
}
country_event = { ## Coronation of Flurry heart
	id = crysom.44
	immediate = {log = "[Root.GetName]: event crysom.44"}#Auto-logging
	title = crysom.44.t
	desc = {
		text = crysom.44.d
		trigger = {
			has_country_leader = { id = 1000 ruling_only = yes name = "Princess Twilight Sparkle" }
		}
	}
	desc = {
		text = crysom.43.d
		trigger = {
			NOT = { has_country_leader = { id = 1000 ruling_only = yes name = "Princess Twilight Sparkle" } }
		}
	}
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		exists = yes
		has_capitulated = no
		has_government = democratic
		date > 1020.1.1
		NOT = { has_country_leader = { ruling_only = yes name = "Princess Flurry Heart" } }
	}
	mean_time_to_happen = { days = 1 }
	fire_only_once = yes
	option = {
		trigger = {
			has_country_leader = { id = 1000 ruling_only = yes name = "Princess Twilight Sparkle" }
		}
		name = crysom.44.a
		retire_country_leader = yes
		create_country_leader = {
			name = "Princess Flurry Heart"
			desc = "FLURRYHEART_DESC"
			picture = "FlurryHeart.tga"
			expire = "1965.1.1"
			ideology = alicornrule
		}
		set_country_flag = cry_regency
		news_event = {
			id = news.38 days = 1
		}
		ai_chance = { factor = 50 }
	}
	option = {
	trigger = {
			NOT = {
		has_country_leader = { id = 1000 ruling_only = yes name = "Princess Twilight Sparkle" }
	}
		}
		name = crysom.43.a
		retire_country_leader = yes
		create_country_leader = {
			name = "Princess Flurry Heart"
			desc = "FLURRYHEART_DESC"
			picture = "FlurryHeart.tga"
			expire = "1965.1.1"
			ideology = alicornrule
		}
		news_event = {
			id = news.38 days = 1
		}
		ai_chance = { factor = 50 }
	}
	option = {
		trigger = {
			NOT = {
				has_country_leader = { id = 1000 ruling_only = yes name = "Princess Twilight Sparkle" }
			}
		}
		name = crysom.43.b
		add_political_power = 150
		ai_chance = { 
			factor = 50 
			modifier = {
				factor = 1.5
				has_country_leader = { ruling_only = yes name = "Princess Mi Amore Cadenza" }
			}
		}
	}
}
country_event = { ## Your Wedding
	id = crysom.45
	immediate = {log = "[Root.GetName]: event crysom.45"}#Auto-logging
	title = crysom.45.t
	desc = crysom.45.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_government = fascism
		has_country_flag = { flag = sakira_likes_that value > 4 }
		NOT = { has_country_flag = sakira_sick }
	}
	mean_time_to_happen = { days = 200 }
	fire_only_once = yes
	option = {
		name = crysom.45.a
		add_political_power = 40
		hidden_effect = {
			country_event = { id = crysom.47 days = 30 }
		}
	}
	option = {
		name = crysom.45.e
	}
	option = {
		name = crysom.45.k
	}
	option = {
		name = crysom.45.f
		hidden_effect = {
			country_event = { id = crysom.51 hours = 1 }
		}
	}
}
country_event = { ## Your Freindship
	id = crysom.46
	immediate = {log = "[Root.GetName]: event crysom.46"}#Auto-logging
	title = crysom.46.t
	desc = crysom.46.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		has_government = fascism
		has_country_flag = { flag = sakira_likes_that value < 5 }
		has_country_flag = { flag = sakira_likes_that value > 2 }
		NOT = { has_country_flag = sakira_sick }
	}
	mean_time_to_happen = { days = 200 }
	fire_only_once = yes
	option = {
		name = crysom.46.a
		add_political_power = -5
	}
}
country_event = { ## Your Freindship
	id = crysom.47
	immediate = {log = "[Root.GetName]: event crysom.47"}#Auto-logging
	title = { text = crysom.47.t
		trigger = { has_government = fascism } }
	title = { text = crysom.47.t_loss
		trigger = { has_government = democratic } }
	desc = { text = crysom.47.d
		trigger = { has_government = fascism } }
	desc = { text = crysom.47.d_loss
		trigger = { has_government = democratic } }
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.47.a
		trigger = { has_government = fascism }
		add_political_power = 10
	}
	option = {
		name = crysom.47.b
		trigger = { has_government = democratic }
		add_political_power = -10
	}
}
country_event = {
	id = crysom.48
	hidden = yes
	immediate = {log = "[Root.GetName]: event crysom.48"}#Auto-logging
	is_triggered_only = yes
	trigger = {
		has_focus_tree = crystalempire_sombra
		NOT = { has_country_leader = { ruling_only = yes name = "King Sombra"} }
	}
	option = {
		load_focus_tree = crystalempire
		if = {
			limit = {
				OR = {
					has_cosmetic_tag = CRY_SOMIMP
					has_cosmetic_tag = CRY_SOM
				}
			}
			drop_cosmetic_tag = yes
		}
	}
}
country_event = { ## Cadence escapes (for EQS)
	id = crysom.49
	title = crysom.49.t
	desc = crysom.49.d
	immediate = {log = "[Root.GetName]: event crysom.49"}#Auto-logging
	picture = GFX_event_crystal_city

	is_triggered_only = yes

	option = {
		name = crysom.49.a
		country_event = { days = 1 id = equestria.50 }	
	}
}
country_event = { ## Cadence escapes
	id = crysom.50
	title = crysom.50.t
	desc = {
		text = crysom.50.d
		trigger = { has_government = fascism }
	}
	desc = {
		text = crysom.50.d_com
		trigger = { has_government = communism }
	}
	immediate = {log = "[Root.GetName]: event crysom.50"}#Auto-logging
	picture = GFX_event_crystal_city

	is_triggered_only = yes

	option = {
		name = crysom.50.a
	}
}
country_event = { ## Your Wedding
	id = crysom.51
	immediate = {log = "[Root.GetName]: event crysom.51"}#Auto-logging
	title = crysom.45.t
	desc = crysom.51.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.45.a
		add_political_power = 40
		hidden_effect = {
			country_event = { id = crysom.47 days = 30 }
		}
	}
	option = {
		name = crysom.45.e
	}
	option = {
		name = crysom.45.k
	}
}
country_event = { ## Sombra-Sinister Marriage
	id = crysom.52
	immediate = {log = "[Root.GetName]: event crysom.52"}#Auto-logging
	title = {
		text = crysom.52.t_sombra
		trigger = { tag = CRY }
	}
	title = {
		text = crysom.52.t_sinister
		trigger = { tag = STG }
	}
	desc = {
		text = crysom.52.d_sombra
		trigger = { tag = CRY }
	}
	desc = {
		text = crysom.52.d_sinister
		trigger = { tag = STG }
	}
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.52.a_sinister
		trigger = { tag = STG }
		ai_chance = { factor = 1 }
		CRY = { country_event = { days = 1 id = crysom.53 } }
	}
	option = {
		name = crysom.52.b_sinister
		trigger = { tag = STG }
		ai_chance = { factor = 2 }
		CRY = { country_event = { days = 1 id = crysom.53 } }
		set_global_flag = sinister_for_marriage_with_sombra
	}
	option = {
		name = crysom.52.a_sombra
		trigger = { tag = CRY }
		ai_chance = { factor = 1 }
		STG = { country_event = { days = 1 id = crysom.54 } }
	}
	option = {
		name = crysom.52.b_sombra
		trigger = { tag = CRY }
		ai_chance = { factor = 2 }
		STG = { country_event = { days = 1 id = crysom.54 } }
		set_global_flag = sombra_for_marriage_with_sinister
	}
}
country_event = { ## SOMBRA GETS ANSWER FROM SINISTER
	id = crysom.53
	immediate = {log = "[Root.GetName]: event crysom.53"}#Auto-logging
	title = {
		text = crysom.53.t_sinister_agreed
		trigger = { has_global_flag = sinister_for_marriage_with_sombra }
	}
	title = {
		text = crysom.53.t_sinister_declined
		trigger = { NOT = { has_global_flag = sinister_for_marriage_with_sombra } }
	}
	desc = {
		text = crysom.53.d_sinister_agreed
		trigger = { has_global_flag = sinister_for_marriage_with_sombra }
	}
	desc = {
		text = crysom.53.d_sinister_declined
		trigger = { NOT = { has_global_flag = sinister_for_marriage_with_sombra } }
	}
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.53.a
		trigger = { has_global_flag = sinister_for_marriage_with_sombra }
		news_event = { days = 1 id = news.cry.6 }
		add_political_power = 50
		add_opinion_modifier = {
			target = STG modifier = leaders_married
		}
		STG = {
			add_opinion_modifier = {
				target = ROOT modifier = leaders_married
			}
			give_guarantee = ROOT
		}
		give_guarantee = STG
		diplomatic_relation = {
			country = STG
			relation = non_aggression_pact
			active = yes
		}
		hidden_effect = {
			add_ai_strategy = {
				type = befriend
				id = "STG"
				value = 999
			}
			add_ai_strategy = {
				type = support
				id = "STG"
				value = 999
			}
			add_ai_strategy = {
				type = protect
				id = "STG"
				value = 999
			}
			add_ai_strategy = {
				type = alliance
				id = "STG"
				value = 999
			}
			add_ai_strategy = {
				type = antagonize
				id = "STG"
				value = -999
			}
			add_ai_strategy = {
				type = conquer
				id = "STG"
				value = -999
			}
			STG = {
				add_ai_strategy = {
					type = befriend
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = support
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = protect
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = alliance
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = antagonize
					id = ROOT
					value = -999
				}
				add_ai_strategy = {
					type = conquer
					id = ROOT
					value = -999
				}
			}
		}
	}
	option = {
		name = crysom.53.b
		trigger = { NOT = { has_global_flag = sinister_for_marriage_with_sombra } }
	}
}
country_event = { ## SINISTER GETS ANSWER FROM SOMBRA
	id = crysom.54
	immediate = {log = "[Root.GetName]: event crysom.54"}#Auto-logging
	title = {
		text = crysom.54.t_sombra_agreed
		trigger = { has_global_flag = sombra_for_marriage_with_sinister }
	}
	title = {
		text = crysom.54.t_sombra_declined
		trigger = { NOT = { has_global_flag = sombra_for_marriage_with_sinister } }
	}
	desc = {
		text = crysom.54.d_sombra_agreed
		trigger = { has_global_flag = sombra_for_marriage_with_sinister }
	}
	desc = {
		text = crysom.54.d_sombra_declined
		trigger = { NOT = { has_global_flag = sombra_for_marriage_with_sinister } }
	}
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crysom.54.a
		trigger = { has_global_flag = sombra_for_marriage_with_sinister }
		news_event = { days = 1 id = news.cry.6 }
		add_political_power = 50
		add_opinion_modifier = {
			target = CRY modifier = leaders_married
		}
		CRY = {
			add_opinion_modifier = {
				target = ROOT modifier = leaders_married
			}
			give_guarantee = ROOT
		}
		give_guarantee = CRY
		diplomatic_relation = {
			country = CRY
			relation = non_aggression_pact
			active = yes
		}
		hidden_effect = {
			add_ai_strategy = {
				type = befriend
				id = "CRY"
				value = 999
			}
			add_ai_strategy = {
				type = support
				id = "CRY"
				value = 999
			}
			add_ai_strategy = {
				type = protect
				id = "CRY"
				value = 999
			}
			add_ai_strategy = {
				type = alliance
				id = "CRY"
				value = 999
			}
			add_ai_strategy = {
				type = antagonize
				id = "CRY"
				value = -999
			}
			add_ai_strategy = {
				type = conquer
				id = "CRY"
				value = -999
			}
			CRY = {
				add_ai_strategy = {
					type = befriend
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = support
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = protect
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = alliance
					id = ROOT
					value = 999
				}
				add_ai_strategy = {
					type = antagonize
					id = ROOT
					value = -999
				}
				add_ai_strategy = {
					type = conquer
					id = ROOT
					value = -999
				}
			}
		}
	}
	option = {
		name = crysom.54.b
		trigger = { NOT = { has_global_flag = sombra_for_marriage_with_sinister } }
	}
}
############################################################
############################################################
############### Sombra Finishes ##############################
############################################################
############################################################

country_event = {
	id = crystalemp.1
	immediate = {log = "[Root.GetName]: event crystalemp.1"}#Auto-logging
	title = crystalemp.1.t
	desc = crystalemp.1.d
	picture = GFX_event_crystal_fair
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	option = {
		name = crystalemp.1.a
		add_political_power = 300
		add_stability = 0.07
	}
}
## Case of Com Civil War in event_target:equestria
country_event = {
	id = crystalemp.2
	immediate = {log = "[Root.GetName]: event crystalemp.2"}#Auto-logging
	title = crystalemp.2.t
	desc = crystalemp.2.d
	picture = GFX_event_gardening
	
	trigger = {
		original_tag = CRY
		any_other_country = {
			original_tag = EQS
			has_civil_war = yes
			has_government = communism
		}
		NOT = { has_global_flag = sombra_returned }
		is_subject = yes
		overlord = {
			original_tag = EQS
		}
	}
	mean_time_to_happen = { days = 2 }
	
	fire_only_once = yes
	
	option = {
		name = crystalemp.2.a
		trigger = { is_ai = no }
		set_cosmetic_tag = CRY_COM
		end_puppet_this = yes
		hidden_effect = {
			set_capital = 152
			start_civil_war = {
				ruling_party = communism
				ideology = democratic
				size = 0.6
				#states = { 147 144 142 141 55 77 64 98 236 150 }
				capital = 53
			}
			random_other_country = {
				limit = {
					has_government = democratic
					original_tag = CRY
					has_civil_war = yes
				}
				set_cosmetic_tag = CRY_DEM
				save_event_target_as = dem_CRY
			}
			every_unit_leader = {
				limit = {
					OR = {
						has_id = 200
						has_id = 1043
					}
				}
				set_nationality = event_target:dem_CRY
			}
			news_event = { id = news.cry.0 days = 1 }
		}
	}
	option = {
		name = crystalemp.2.b
		trigger = { is_ai = no }
		end_puppet_this = yes
		hidden_effect = {
			start_civil_war = {
				ruling_party = democratic
				ideology = communism
				size = 0.4
				capital = 152
				#states = { 145 152 151 149 146 324 143 140 139 318 }
			}
			random_other_country = {
				limit = {
					has_government = communism
					original_tag = CRY
					has_civil_war = yes
				}
				set_cosmetic_tag = CRY_COM
				every_unit_leader = {
					limit = {
						OR = {
							has_id = 200
							has_id = 1043
						}
					}
					set_nationality = ROOT
				}
			}
			news_event = { id = news.cry.0 days = 1 }
		}
	}
}
country_event = { ## STG/EQS asks of Union
	id = crystalemp.3
	immediate = {log = "[Root.GetName]: event crystalemp.3"}#Auto-logging
	title = crystalemp.3.t
	desc = crystalemp.3.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.3.a
		custom_effect_tooltip = GAME_OVER_TT
		FROM = {
			effect_tooltip = {
				annex_country = { target = FROM transfer_troops = yes }
			}
			hidden_effect = {
				country_event = {
					id = stalliongrad.63 days = 2
				}
			}
		}
		ai_chance = { factor = 2
			modifier = {
				factor = 0
				OR = {
					FROM = { is_subject = yes }
					FROM = { has_government = democratic }
				}
			}
		}
	}
	option = {
		name = crystalemp.3.c
		FROM = {
			effect_tooltip = {
				puppet = FROM
			}
			hidden_effect = {
				set_country_flag = make_CRY_a_puppet
				country_event = {
					id = stalliongrad.63 days = 2
				}
			}
		}
		ai_chance = { factor = 3
			modifier = {
				factor = 0
				OR = {
					FROM = { is_subject = yes }
					FROM = { has_government = democratic }
				}
			}
		}
	}
	option = {
		name = crystalemp.3.b
		ai_chance = { factor = 2.5 }
		add_political_power = 150
		add_stability = 0.05
		hidden_effect = {
			country_event = {
				id = stalliongrad.64 days = 2
			}
		}
	}
}
country_event = { ## STG/EQS asks of Union
	id = crystalemp.4
	immediate = {log = "[Root.GetName]: event crystalemp.4"}#Auto-logging
	title = crystalemp.4.t
	desc = crystalemp.4.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.4.a
		ai_chance = { factor = 100 }
		event_target:equestria = {
			country_event = { id = eqscom.16 days = 1 }
		}
	}
	option = {
		name = crystalemp.4.b
		ai_chance = { factor = 0 }
		add_political_power = 200
	}
}
###Sombra Events (revolt)
country_event = { #cry_umbruminitial info
	id = crystalemp.5
	immediate = {log = "[Root.GetName]: event crystalemp.5"}#Auto-logging
	title = crystalemp.5.t
	desc = crystalemp.5.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.5.a
		country_event = { id = crystalemp.6 days = 7}
	}
}
country_event = { #Possesed ponies. What to do?
	id = crystalemp.6
	immediate = {log = "[Root.GetName]: event crystalemp.6"}#Auto-logging
	title = crystalemp.6.t
	desc = crystalemp.6.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { #Look for cure
		name = crystalemp.6.a
		ai_chance = { factor = 100 }
		set_country_flag = cry_cured
		country_event = { id = crystalemp.11 days = 21}
	}
	
	option = { #Isolate ponies
		name = crystalemp.6.b
		ai_chance = { factor = 0 }
		set_country_flag = cry_isolated
		country_event = { id = crystalemp.7 days = 1}
	}
}
country_event = { #More possesed
	id = crystalemp.7
	immediate = {log = "[Root.GetName]: event crystalemp.7"}#Auto-logging
	title = crystalemp.7.t
	desc = crystalemp.7.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = crystalemp.7.a
		complete_national_focus = cry_umbrummilitia
		add_ideas = sombrish_resistance
	}
}
country_event = {
	id = crystalemp.8
	immediate = {log = "[Root.GetName]: event crystalemp.8"}#Auto-logging
	title = crystalemp.8.t
	desc = crystalemp.8.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.8.a
		
	}
}

country_event = {
	id = crystalemp.10
	immediate = {log = "[Root.GetName]: event crystalemp.10"}#Auto-logging
	title = crystalemp.10.t
	desc = crystalemp.10.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.10.a
		add_political_power = -50
		#remove_ideas = royalfamily_imprisioned
		set_global_flag = free_the_old_royalty
		event_target:equestria = { 
			add_opinion_modifier  = { target = ROOT modifier = cry_accepted_demmands } 
			country_event = { id = equestria.46 days = 1 }
		}
		ai_chance = { 
			factor = 60 
			modifier = {
				factor = 0
				has_government = fascism
			}
		}
		
	}
	option = {
		name = crystalemp.10.b
		event_target:equestria = {
			add_opinion_modifier  = {
				target = ROOT
				modifier = cry_refused_demmands
			}
			country_event = { id = equestria.47 days = 1 }
		}
		
		custom_effect_tooltip = crystalemp.10.b.tt
		ai_chance = { factor = 40 }
	}
}

country_event = {
	id = crystalemp.11
	immediate = {log = "[Root.GetName]: event crystalemp.11"}#Auto-logging
	title = crystalemp.11.t
	desc = crystalemp.11.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	trigger = { has_country_flag = cry_cured}
	
	option = {
		name = crystalemp.11.a
		complete_national_focus = CRY_umbrumdefeat
	}
}

country_event = { #Independence Event / SEND TO EQS!
	id = crystalemp.12
	immediate = {log = "[Root.GetName]: event crystalemp.12"}#Auto-logging
	title = crystalemp.12.t
	desc = crystalemp.12.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.12.a
		end_puppet = FROM
		#set_autonomy = { target = CRY autonomy_state = autonomy_free }
		ai_chance = { factor = 70 }
	}
	option = {
		name = crystalemp.12.b
		end_puppet = FROM
		#set_autonomy = { target = CRY autonomy_state = autonomy_free }
		create_wargoal = { type = puppet_wargoal_focus target = FROM }
		ai_chance = { factor = 30 }
	}
}

country_event = { # Equestria isolates
	id = crystalemp.13
	immediate = {log = "[Root.GetName]: event crystalemp.13"}#Auto-logging
	title = crystalemp.13.t
	desc = crystalemp.13.d
	picture = GFX_event_gardening
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.13.a
		add_ideas = isolated
	}
	
	option = {
		name = crystalemp.13.b
		remove_ideas = royal_family_imprisoned
	}
}

country_event = { ##
	id = crystalemp.18
	immediate = {log = "[Root.GetName]: event crystalemp.18"}#Auto-logging
	title = crystalemp.18.t
	desc = crystalemp.18.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.18.a
		add_ideas = magical_power
	}
}
country_event = { ## Magical Power!
	id = crystalemp.19
	immediate = {log = "[Root.GetName]: event crystalemp.19"}#Auto-logging
	title = crystalemp.19.t
	desc = crystalemp.19.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.19.a
		country_event = {
			id = crystalemp.19 days = 1
		}
	}
}
country_event = { ## Independence
	id = crystalemp.20
	immediate = {log = "[Root.GetName]: event crystalemp.20"}#Auto-logging
	title = crystalemp.20.t
	desc = crystalemp.20.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = { ## FREE
		name = crystalemp.20.a
		trigger = { has_dlc = "Together for Victory"}
		end_puppet_this = yes
		overlord = {
			country_event = { id = equestria.58 days = 1 }
		}
	}
	option = { ## DOMINION
		name = crystalemp.20.b
		trigger = { has_dlc = "Together for Victory"}
		overlord = {
			set_autonomy = { target = FROM autonomy_state = autonomy_dominion }
		}
		hidden_effect = { set_country_flag = CRY_referendum_dominion }
	}
	option = { ### FREE NO DLCS
		name = crystalemp.20.a
		trigger = { NOT = { has_dlc = "Together for Victory" } }
		overlord = {
			country_event = { id = equestria.58 days = 1 }
		}
		end_puppet_this = yes
	}
}
country_event = { ## Subordination
	id = crystalemp.21
	immediate = {log = "[Root.GetName]: event crystalemp.21"}#Auto-logging
	title = crystalemp.21.t
	desc = crystalemp.21.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	trigger = {
		is_subject = yes
		overlord = { original_tag = EQS }
	}
	option = {
		name = crystalemp.21.a
		trigger = { has_dlc = "Together for Victory"}
		overlord = {
			set_autonomy = { target = FROM autonomy_state = autonomy_puppet }
		}
		ai_chance = { factor = 80 }
	}
	option = {
		name = crystalemp.21.a
		trigger = { NOT = { has_dlc = "Together for Victory"} }
		add_political_power = 100
		ai_chance = { factor = 80 }
	}
	option = { ## get annexed
		name = crystalemp.21.b
		trigger = {
			overlord = { is_ai = no }
			is_ai = no
		}
		ai_chance = { factor = 20 }
		effect_tooltip = {
			if = {
				limit = {
					is_ai = no
					overlord = { is_ai = yes }
				}
				overlord = { change_tag_from = ROOT }
			}
			else = {
				custom_effect_tooltip = GAME_OVER_TT
			}
		}
		overlord = {
			country_event = { id = equestria.57 days = 1 }
		}
	}
	option = { ## get annexed
		name = crystalemp.21.b
		trigger = {
			OR = {
				overlord = { is_ai = no }
				overlord = { is_ai = yes }
			}
			is_ai = yes
		}
		ai_chance = { factor = 20 }
		overlord = {
			country_event = { id = equestria.57 days = 1 }
		}
	}
}
country_event = { ## Join Equestrian faction
	id = crystalemp.22
	immediate = {log = "[Root.GetName]: event crystalemp.22"}#Auto-logging
	title = crystalemp.22.t
	desc = crystalemp.22.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crystalemp.22.a
		ai_chance = { factor = 100 }
	}
	option = {
		name = crystalemp.22.b
		add_political_power = 50
		leave_faction = yes
		ai_chance = { factor = 0 }
	}
}
country_event = {
	id = crystalemp.23
	immediate = {log = "[Root.GetName]: event crystalemp.23"}#Auto-logging
	title = crystalemp.23.t
	desc = crystalemp.23.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		is_subject_of = CHN
		has_government = fascism
	}
	fire_only_once = yes
	mean_time_to_happen = { days = 1 }
	option = {
		name = crystalemp.23.a
		set_cosmetic_tag = CRY_CHN
		set_country_flag = is_changeling_puppet
		add_political_power = -340
		add_stability = -0.1
		hidden_effect = {
			remove_opinion_modifier = { target = CHN modifier = embargo }
			CHN = { remove_opinion_modifier = { target = ROOT modifier = embargo } }
		}
		ai_chance = { factor = 100 }
	}
}

country_event = { ## Join Equestrian faction
	id = crystalemp.24
	immediate = {log = "[Root.GetName]: event crystalemp.24"}#Auto-logging
	hidden = yes
	
	trigger = {
		original_tag = CRY
		owns_state = 344
		344 = { is_capital = no }
	}
	mean_time_to_happen = { days = 1 }
	option = {
		set_capital = 344
	}
}

news_event = { ## Kraccdown
	id = crystalemp.25
	immediate = {log = "[Root.GetName]: event crystalemp.25"}#Auto-logging
	title = crystalemp.25.t
	desc = crystalemp.25.d
	picture = GFX_news_event_crystal_fair
	
	is_triggered_only = yes
	option = {
		name = crystalemp.25.a
		trigger = { 
			OR = {
				tag = FROM 
				is_in_faction_with = FROM
				is_subject_of = FROM
				has_government = democratic
			}
		}
	}
	option = {
		name = crystalemp.25.b
		trigger = { 
			NOT = {
				tag = FROM 
				is_in_faction_with = FROM
				is_subject_of = FROM
				has_government = democratic
			}
		}
	}
}

country_event = {
	id = crystalemp.26
	immediate = {log = "[Root.GetName]: event crystalemp.26"}#Auto-logging
	title = crystalemp.26.t
	desc = crystalemp.26.d
	picture = GFX_event_crystal_city
	
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = crystalemp.26.a
		remove_ideas = sombra_threat
		hidden_effect = {
			remove_ideas = { 
				sombra_threat2
				sombra_threat_reported
			}
			news_event = { id = crystalemp.25 hours = 6 }
		}
		add_stability = -0.05
		add_autonomy_ratio = { value = -0.1 }
	}
}

country_event = {
	id = crystalemp.27
	immediate = {log = "[Root.GetName]: event crystalemp.27"}#Auto-logging
	title = crystalemp.27.t
	desc = crystalemp.27.d
	picture = GFX_event_crystal_city
	
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = crystalemp.27.a
		hidden_effect = {
			country_event = { id = crystalemp.28 hours = 1 }
		}
	}
	option = {
		name = crystalemp.27.b
		hidden_effect = {
			country_event = { id = crystalemp.29 hours = 1 }
		}
	}
}

country_event = {
	id = crystalemp.28
	immediate = {log = "[Root.GetName]: event crystalemp.28"}#Auto-logging
	title = crystalemp.28.t
	desc = crystalemp.28.d
	picture = GFX_event_crystal_city
	
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = crystalemp.28.a
		custom_effect_tooltip = cult_killed
		remove_ideas = sombra_threat
		hidden_effect = {
			remove_ideas = { 
				sombra_threat2
				sombra_threat_reported
			}
			news_event = { id = crystalemp.25 hours = 6 }
		}
		add_stability = -0.05
		add_autonomy_ratio = { value = -0.1 }
	}
	option = {
		name = crystalemp.28.b
		trigger = {
			has_country_flag = { flag = sakira_likes_that value > 3 }
		}
		custom_effect_tooltip = cult_killed
		remove_ideas = sombra_threat
		hidden_effect = {
			remove_ideas = { 
				sombra_threat2
				sombra_threat_reported
			}
			news_event = { id = crystalemp.25 hours = 6 }
		}
		add_stability = -0.05
		add_autonomy_ratio = { value = -0.1 }
	}
}

country_event = {
	id = crystalemp.29
	immediate = {log = "[Root.GetName]: event crystalemp.29"}#Auto-logging
	title = crystalemp.29.t
	desc = crystalemp.29.d
	picture = GFX_event_crystal_city
	
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = crystalemp.29.a
		custom_effect_tooltip = cult_killed
		remove_ideas = sombra_threat
		hidden_effect = {
			remove_ideas = { 
				sombra_threat2
				sombra_threat_reported
			}
			news_event = { id = crystalemp.25 hours = 6 }
		}
		add_stability = -0.05
		add_autonomy_ratio = { value = -0.1 }
	}
}
#### CRYSTAL COMMUNISTS ####

country_event = { ## Communist Crystal Ponies
	id = crycom.1
	immediate = {log = "[Root.GetName]: event crycom.1"}#Auto-logging
	title = crycom.1.t
	desc = crycom.1.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.1.a
		add_ideas = communist_influence
		hidden_effect = {
			country_event = {
				id = crycom.11 days = 20
			}
		}
	}
}
country_event = { ## Communist Crystal Ponies # Elections
	id = crycom.2
	immediate = {log = "[Root.GetName]: event crycom.2"}#Auto-logging
	title = crycom.2.t
	desc = crycom.2.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.2.a
		country_event = {
			id = crycom.3 days = 14
		}
	}
}
country_event = { ## Communist Crystal Ponies # Elections
	id = crycom.3
	immediate = {log = "[Root.GetName]: event crycom.3"}#Auto-logging
	title = crycom.3.t
	desc = { text = crycom.3.d_yes_com
		trigger = {
			communism > 0.499
		}
	}
	desc = { text = crycom.3.d_no_com
		trigger = {
			communism < 0.5
		}
	}
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			communism > 0.499
		}
		name = crycom.3.a
		set_politics = { ruling_party = communism elections_allowed = no }
		end_puppet_this = yes
		leave_faction = yes
		hidden_effect = {
			random_list = { 50 = { add_political_power = 50 } 50 = { add_political_power = 100 } }
			add_ideas = CRY_inexperienced_officers
			remove_ideas = royal_family
			remove_ideas = royal_family3
			remove_ideas = royal_family2
			remove_ideas = equestrian_overlord
			remove_ideas = equestrian_overlord2
			end_puppet_this = yes
			leave_faction = yes
			event_target:CRY_Shining_Armor = { set_nationality = event_target:equestria }
			set_cosmetic_tag = CRY_COM
			country_event = {
				id = crycom.9 hours = 3
			}
			#news_event = { id = news.cry.1 days = 1 }
			set_global_flag = free_the_old_royalty
			clr_global_flag = continue_imprisonment
			event_target:equestria = {
				country_event = { id = equestria.48 days = 5 }
			}
			#hidden_effect = { news_event = { id = news.cry.5 days = 5 } }
		}
	}
	option = {
		trigger = {
			communism < 0.5
		}
		name = crycom.3.b
		set_temp_variable = { civ_war_size = party_popularity@communism }
		add_to_temp_variable = { civ_war_size = 0.1 }
		clamp_variable = { var = civ_war_size min = 0.4 max = 0.6 }
		start_civil_war = {
			ruling_party = communism
			ideology = democratic
			size = civ_war_size
		}
		add_threat = 10
		add_popularity = { ideology = communism popularity = 0.2 }
		random_other_country = {
			limit = { original_tag = CRY
				has_government = democratic }
			set_cosmetic_tag = CRY_DEM
			add_popularity = { ideology = democratic popularity = 0.3 }
			save_event_target_as = dem_CRY
		}
		reverse_add_opinion_modifier = { target = event_target:equestria modifier = hostility }
		hidden_effect = {
			every_unit_leader = {
				limit = {
					OR = {
						has_id = 200
						has_id = 1043
					}
				}
				set_nationality = event_target:dem_CRY
			}
			news_event = { id = news.cry.0 days = 1 }
		}
		set_cosmetic_tag = CRY_COM
	}
}
country_event = { ## Stalliongrad's advisory
	id = crycom.4
	immediate = {log = "[Root.GetName]: event crycom.4"}#Auto-logging
	title = crycom.4.t
	desc = crycom.4.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.4.a
		trigger = {
			NOT = { STG = { has_country_flag = darkwing_elected } }
		}
		STG = {
			country_event = { id = stalliongrad.100 hours = 6 }
		}
	}
	option = {
		name = crycom.4.b
		trigger = {
			NOT = { STG = { has_country_flag = darkwing_elected } }
		}
		add_political_power = 100
	}
	option = {
		name = crycom.4.c
		trigger = {
			STG = { has_country_flag = darkwing_elected }
		}
		add_political_power = 100
	}
}
country_event = { ## STG agrees
	id = crycom.5
	immediate = {log = "[Root.GetName]: event crycom.5"}#Auto-logging
	title = crycom.5.t
	desc = crycom.5.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.5.a
		add_political_power = 50
		add_timed_idea = { idea = stalliongradian_advisors days = 710 }
		set_country_flag = STG_agreed_cooperation
	}
}
country_event = { ## Stalliongrad's advisory rejected
	id = crycom.6
	immediate = {log = "[Root.GetName]: event crycom.6"}#Auto-logging
	title = crycom.6.t
	desc = crycom.6.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.6.a
		add_political_power = -60
	}
}
country_event = { ## Research Agreement
	id = crycom.7
	immediate = {log = "[Root.GetName]: event crycom.7"}#Auto-logging
	title = crycom.7.t
	desc = crycom.7.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	option = {
		name = crycom.7.a
		trigger = {
			has_dlc = "Together for Victory"
		}
		add_to_tech_sharing_group = crystalempireresearch
		STG = { add_to_tech_sharing_group = crystalempireresearch }
		add_political_power = 70
		add_tech_bonus = {
			name = armor_bonus
			bonus = 0.5
			uses = 1
			category = armor
		}
		add_tech_bonus = {
			name = industry
			bonus = 0.25
			uses = 1
			category = industry
		}
		STG = {
			add_tech_bonus = {
				name = armor_bonus
				bonus = 0.5
				uses = 1
				category = armor
			}
		}
	}
	option = {
		name = crycom.7.a
		trigger = {
			NOT ={
				has_dlc = "Together for Victory"
			}
		}
		add_political_power = 50
		add_tech_bonus = {
			name = armor_bonus
			bonus = 0.5
			uses = 2
			category = armor
		}
		add_tech_bonus = {
			name = industrial_bonus
			bonus = 0.25
			uses = 1
			category = industry
		}
		STG = {
			add_tech_bonus = {
				name = armor_bonus
				bonus = 0.5
				uses = 2
				category = armor
			}
		}
	}
}
country_event = { ## Remove sombra therat
	id = crycom.8
	immediate = {log = "[Root.GetName]: event crycom.8"}#Auto-logging
	title = crycom.8.t
	desc = crycom.8.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.8.a
		add_political_power = -200
		remove_ideas = sombra_threat
		hidden_effect = {
			remove_ideas = sombra_threat2
			remove_ideas = sombra_threat_reported
		}
	}
}
country_event = { ## Independence
	id = crycom.9
	immediate = {log = "[Root.GetName]: event crycom.9"}#Auto-logging
	title = crycom.9.t
	desc = crycom.9.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.9.a
		random_list = { 25 = { add_political_power = 50 } 25 = { add_political_power = -50 } 25 = { add_political_power = 1 } 25 = { add_political_power = -60 } }
		news_event = {
			id = news.41 days = 1
		}
	}
}
country_event = { ## Stalliongrad's advisory rejected
	id = crycom.10
	immediate = {log = "[Root.GetName]: event crycom.10"}#Auto-logging
	title = crycom.10.t
	desc = crycom.10.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = crycom.10.a
	}
}
country_event = { ## Stalliongrad's advisory rejected
	id = crycom.11
	immediate = {log = "[Root.GetName]: event crycom.11"}#Auto-logging
	title = crycom.11.t
	desc = crycom.11.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.11.a
		add_popularity = { ideology = communism popularity = 0.1 }
	}
}
country_event = { ## Stalliongrad's advisory rejected
	id = crycom.12
	immediate = {log = "[Root.GetName]: event crycom.12"}#Auto-logging
	title = crycom.12.t
	desc = crycom.12.d
	picture = GFX_event_crystal_city
	
	trigger = {
		original_tag = CRY
		communism > 0.43
		has_completed_focus = CRY_communistideas
	}
	mean_time_to_happen = { days = 1 }
	fire_only_once = yes
	option = {
		name = crycom.12.a
		add_popularity = { ideology = communism popularity = 0.02 }
	}
}
country_event = { ## Stalliongrad's advisory rejected
	id = crycom.13
	immediate = {log = "[Root.GetName]: event crycom.13"}#Auto-logging
	title = crycom.13.t
	desc = crycom.13.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.13.a
		add_popularity = { ideology = communism popularity = 0.1 }
	}
}
country_event = { ## FORM UNION
	id = crycom.14
	immediate = {log = "[Root.GetName]: event crycom.14"}#Auto-logging
	title = crycom.14.t
	desc = crycom.14.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.14.a
		if = { limit = { STG = { exists = yes has_government = communism } }
			STG = { country_event = crycom.15 } }
		if = { limit = { STL = { exists = yes has_government = communism } }
			STL = { country_event = crycom.15 } }
		event_target:equestria = { country_event = crycom.15 }
	}
}
country_event = { ## FORM UNION
	id = crycom.15
	immediate = {log = "[Root.GetName]: event crycom.15"}#Auto-logging
	title = crycom.15.t
	desc = crycom.15.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = { # accept annexation
		name = crycom.15.a
		FROM = {
			country_event = crycom.16
		}
	}
	option = { # decline annexation
		name = crycom.15.b
		FROM = {
			country_event = crycom.17
		}
	}
}
country_event = { ## FORM UNION ACCEPTED
	id = crycom.16
	immediate = {log = "[Root.GetName]: event crycom.16"}#Auto-logging
	title = crycom.16.t
	desc = crycom.16.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.16.a
		trigger = { is_ai = no }
		annex_country = { target = FROM transfer_troops = yes }
		every_state = {
			limit = { is_core_of = FROM }
			add_core_of = ROOT
		}
		set_cosmetic_tag = EQS_COM
	}
	option = {
		name = crycom.16.a
		trigger = { is_ai = yes }
		if = {
			limit = {
				FROM = {
					OR = {
						original_tag = EQS
						original_tag = STG
					}
				}
			}
			FROM = {
				annex_country = { target = ROOT transfer_troops = yes }
				every_state = {
					limit = { is_core_of = ROOT }
					add_core_of = FROM
				}
			}
		}
		else = {
			annex_country = { target = FROM transfer_troops = yes }
			every_state = {
				limit = { is_core_of = FROM }
				add_core_of = ROOT
			}
		}
	}
}
country_event = { ## FORM UNION Declined
	id = crycom.17
	immediate = {log = "[Root.GetName]: event crycom.17"}#Auto-logging
	title = crycom.17.t
	desc = crycom.17.d
	picture = GFX_event_crystal_city
	
	is_triggered_only = yes
	
	option = {
		name = crycom.17.a
		add_political_power = -20
	}
}
