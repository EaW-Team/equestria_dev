add_namespace = MGY_Lore
add_namespace = MGY_FocusEconomy
add_namespace = MGY_Politics
add_namespace = MGY_RoyalDiet

##################
# Lore-Dumping Events
##################

# Event appears on startup, drops exposition on what's been going on.
country_event = {
	id = MGY_Lore.1
	title = MGY_Lore.1.title
	desc = MGY_Lore.1.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_ruins

	option = {
		# Tell me about politics
		name = MGY_Lore.1.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.2.a
		hidden_effect = {
			country_event = MGY_Lore.4
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.2.b
		hidden_effect = {
			country_event = MGY_Lore.3
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.1.b
		
	}
}

# Event on the mainstream politics
country_event = {
	
	id = MGY_Lore.2
	title = MGY_Lore.2.title
	desc = MGY_Lore.2.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_harmony

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.2.a
		hidden_effect = {
			country_event = MGY_Lore.4
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.2.b
		hidden_effect = {
			country_event = MGY_Lore.3
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.2.c
		
	}
}

# Event on the socialists
country_event = {
	
	id = MGY_Lore.3
	title = MGY_Lore.3.title
	desc = MGY_Lore.3.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_socialism

	option = {
		# Tell me about the mainstream
		name = MGY_Lore.3.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}
	}

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.3.b
		hidden_effect = {
			country_event = MGY_Lore.4
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.3.c
		
	}
}

# Event on the reactionaries
country_event = {
	
	id = MGY_Lore.4
	title = MGY_Lore.4.title
	desc = MGY_Lore.4.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_reactionary

	option = {
		# Tell me about the mainstream
		name = MGY_Lore.4.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.4.b
		custom_effect_tooltip = MGY_LearnAboutSocialistsPolitics_tt
		hidden_effect = {
			country_event = MGY_Lore.3
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.4.c
		
	}
}

##################
# Economy Events
##################

# "Decoupling from the Stater"
country_event = {
	id = MGY_FocusEconomy.1
	title = MGY_FocusEconomy.1.title
	desc = MGY_FocusEconomy.1.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_coins

	trigger = {
		733 = {
			is_owned_and_controlled_by = ROOT
		}
		735 = {
			is_owned_and_controlled_by = ROOT
		}
	}

	option = {
		name = MGY_FocusEconomy.1.a

		custom_effect_tooltip = MGY_DoubleSpace_tt
		every_country = {
			limit = {
				OR = {
					tag = HIP
					tag = EQS
					is_in_faction_with = EQS
				}
			}
			add_opinion_modifier = {
				target = ROOT
				modifier = MGY_adopted_bit
			}
		}
		custom_effect_tooltip = MGY_DoubleSpace_tt
		735 = {
			add_extra_state_shared_building_slots = -1
			remove_building = {
				type = industrial_complex
				level = 1
			}
		}
		733 = {
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
			}
		}
	}
}

# Recovery Improves!
country_event = {
	id = MGY_FocusEconomy.21	
	title = MGY_FocusEconomy.21.title
	desc = MGY_FocusEconomy.21.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = {
		name = MGY_FocusEconomy.21.a
		effect_tooltip = {
			swap_ideas = {
				remove_idea = MGY_legacy_of_storm1
				add_idea = MGY_legacy_of_storm2
			}
		}
	}
}

# We continue to recover!
country_event = {
	id = MGY_FocusEconomy.22
	title = MGY_FocusEconomy.22.title
	desc = MGY_FocusEconomy.22.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = {
		name = MGY_FocusEconomy.22.a
		effect_tooltip = {
			swap_ideas = {
				remove_idea = MGY_legacy_of_storm2
				add_idea = MGY_legacy_of_storm3
			}
		}
	}
}

# We have recovered!
country_event = {
	id = MGY_FocusEconomy.23
	title = MGY_FocusEconomy.23.title
	desc = MGY_FocusEconomy.23.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = { 
		name = MGY_FocusEconomy.23.a
		effect_tooltip = {
			remove_ideas = MGY_legacy_of_storm3
		}
		add_stability = 0.05
		add_war_support = 0.05
	}
}

# Fate of the Commission
country_event = {
	id = MGY_FocusEconomy.31
	title = MGY_FocusEconomy.31.title
	desc = MGY_FocusEconomy.31.desc

	is_triggered_only = yes

	trigger = {
		has_idea = MGY_industrialconcern_commission
	}

	# 
	option = { 
		# Remove the commission
		name = MGY_FocusEconomy.31.a
		
		add_stability = 0.05
		custom_effect_tooltip = MGY_DoubleSpace_tt
		remove_ideas = MGY_industrialconcern_commission
	}

	option = {
		# Keep the commission, for now BUT you can ONLY remove the commission later
		name = MGY_FocusEconomy.31.b
		custom_effect_tooltip = MGY_OnlyRemoveCommissionOnFocus_tt
		custom_effect_tooltip = MGY_DoubleSpace_tt
		swap_ideas = {
			remove_idea = MGY_industrialconcern_commission
			add_idea = MGY_industrialconcern_nationalisedcommission
		}
	}

	# Follow-up events
	after = {
		hidden_effect = {
			country_event = {
				# Foreign investors get pissed
				id = MGY_FocusEconomy.32
				days = 10
				random_days = 20
			}
			country_event = {
				# Commission has issues
				id = MGY_FocusEconomy.33
				days = 210
				random_days = 100
			}
		}
	}
}

# Foreign Interests Protest Dissolution of Commission
country_event = {
	id = MGY_FocusEconomy.32
	title = MGY_FocusEconomy.32.title
	desc = {
		trigger = {
			NOT = {
				has_idea = MGY_industrialconcern_nationalisedcommission
			}
		}
		text = MGY_FocusEconomy.32.desc_abolition
	}
	desc = {
		trigger = {
			has_idea = MGY_industrialconcern_nationalisedcommission
		}
		text = MGY_FocusEconomy.32.desc_nationalisation
	}

	trigger = {
		has_idea = MGY_IndebtedEconomy
	}

	is_triggered_only = yes

	# option = {
	# 	# Bribe the investors (this leads to an investigation)
	# 	name = MGY_FocusEconomy.32.a

	# 	custom_effect_tooltip = MGY_FocusEconomy.32_investigationrisk_tt
	# 	custom_effect_tooltip = MGY_DoubleSpace_tt
	# 	add_political_power = -20
	# 	hidden_effect = {
	# 		random_list = {
	# 			20 = { # Investigation will be clean
					
	# 			}
	# 			80 = { # Investigation will expose the bribe
	# 				set_country_flag = MGY_corruptcommission_flag
	# 			}
	# 		}
	# 		country_event = {
	# 			id = MGY_FocusEconomy.35
	# 			days = 40
	# 			random_days = 120
	# 		}
	# 	}
	# }

	option = {
		# Bribe the investors
		name = MGY_FocusEconomy.32.a

		trigger = {
			has_idea = MGY_industrialconcern_nationalisedcommission
		}

		swap_ideas = {
			remove_idea = MGY_industrialconcern_nationalisedcommission
			add_idea = MGY_industrialconcern_corruptcommission
		}
	}

	option = {
		# Bribe the investors - alt
		name = MGY_FocusEconomy.32.a

		trigger = {
			NOT = {
				has_idea = MGY_industrialconcern_nationalisedcommission
			}
		}

		add_political_power = -25
		add_popularity = {
			ideology = ROOT
			popularity = -0.05
		}
	}


	option = {
		# Offer them expemtions - leads to protests from the farmers
		name = MGY_FocusEconomy.32.b

		if = {
			limit = {
				any_owned_state = {
					MGY_Farms > 0
				}
			}
			custom_effect_tooltip = MGY_FocusEconomy.32_riotrisk_tt
			custom_effect_tooltip = MGY_DoubleSpace_tt
			country_event = {
				id = MGY_FocusEconomy.321
				days = 7
				random_days = 21
			}	
		}
		else = {
			add_stability = -0.05
		}
	}

	option = {
		# Refuse!
		name = MGY_FocusEconomy.32.c
		if = {
			limit = {
				has_idea = MGY_IndebtedEconomy
				NOT = {
					has_idea = MGY_industrialconcern_nationalisedcommission
				}
			}
			add_to_variable = {
				var = MGY_DebtPaymentCost_var
				value = 50
				tooltip = MGY_DebtPaymentCost_var_tt
			}
		}
		else_if = {
			limit = {
				has_idea = MGY_PoliticalUnrest
				NOT = {
					has_idea = MGY_industrialconcern_nationalisedcommission
				}
			}
			if = {
				limit = {
					industrial_complex > 1
					any_owned_state = {
						industrial_complex > 0
					}
				}
				random_owned_state = {
					MGY_IncreaseStateUnrest_medium_effect = yes
					remove_building = {
						type = industrial_complex
						level = 1
					}
				}
			}
			else = {
				random_owned_state = {
					MGY_IncreaseStateUnrest_medium_effect = yes
				}
			}
		}
		else = {
			every_country = {
			limit = {
				OR = {
					AND = {
						OR = {
							original_tag = WNG
							original_tag = EQS
							original_tag = HIP
						}
						has_government = ROOT
					}
					AND = {
						is_subject_of = WNG
						WNG = {
							has_government = ROOT
						}
					}
					AND = {
						is_subject_of = EQS
						EQS = {
							has_government = ROOT
						}
					}
					AND = {
						is_subject_of = HIP
						HIP = {
							has_government = ROOT
						}
					}
				}
			}	
			add_opinion_modifier = {
				target = ROOT
				modifier = MGY_angryoverprotectionism
			}
		}
		every_country = {
			limit = {
					OR = {
						AND = {
							OR = {
								original_tag = WNG
								original_tag = EQS
								original_tag = HIP
							}
							NOT = {
								has_government = ROOT
							}
						}
						AND = {
							is_subject_of = WNG
							WNG = {
								NOT = {
									has_government = ROOT
								}
							}
						}
						AND = {
							is_subject_of = EQS
							EQS = {
								NOT = {
									has_government = ROOT
								}
							}
						}
						AND = {
							is_subject_of = HIP
							HIP = {
								NOT = {
									has_government = ROOT
								}
							}
						}
					}
				}	
				add_opinion_modifier = {
					target = ROOT
					modifier = MGY_outragedoverprotectionism
				}
				send_embargo = ROOT
			}
		}
	}
}

# Farmers Protest additional export licenses!
country_event  = {
	id = MGY_FocusEconomy.321
	title = MGY_FocusEconomy.321.title
	desc = MGY_FocusEconomy.321.desc

	is_triggered_only = yes

	trigger = {
		OR ={
			has_idea = MGY_IndebtedEconomy
			has_idea = MGY_industrialconcern_nationalisedcommission
			has_idea = MGY_industrialconcern_corruptcommission
			has_idea = MGY_industrialconcern_deflatedcommission
			has_idea = MGY_industrialconcern_bankruptcommission
		}
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					any_owned_state = {
						MGY_Farms > 0
					}
				}
				random_owned_state = {
					limit = {
						MGY_Farms > 0
					}
					save_event_target_as = MGY_EVENT_TARGET
				}
			}
			else = {
				random_owned_state = {
					save_event_target_as = MGY_EVENT_TARGET
				}
			}
		}
	}

	option = {
		# Send soldiers!
		name = MGY_FocusEconomy.321.a

		add_stability = -0.025	

		hidden_effect = {
			add_to_temp_variable = {
				MGY_dummy_tempvar = ROOT.max_manpower_k 
			}
			divide_temp_variable = {
				MGY_dummy_tempvar = -200
			}
			add_manpower = MGY_dummy_tempvar
		}
		event_target:MGY_EVENT_TARGET = {
			if = {
				limit = {
					owner = {
						has_idea = MGY_PoliticalUnrest
					}
				}
				MGY_IncreaseStateUnrest_medium_effect = yes
			}
			custom_effect_tooltip = MGY_DoubleSpace_tt
			damage_building = {
				type = industrial_complex
				damage = 0.5
			}
			damage_building = {
				type = infrastructure
				damage = 0.5
			}
		}
	}

	option = {
		# let them riot...
		name = MGY_FocusEconomy.321.b
	
		add_stability = -0.05
		event_target:MGY_EVENT_TARGET = {
			if = {
				limit = {
					owner = {
						has_idea = MGY_PoliticalUnrest
					}
				}
				MGY_IncreaseStateUnrest_small_effect = yes
			}
			custom_effect_tooltip = MGY_DoubleSpace_tt
			damage_building = {
				type = industrial_complex
				damage = 4
			}
			damage_building = {
				type = infrastructure
				damage = 1
			}
			damage_building = {
				type = MGY_Farms
				damage = 2
			}
		}
	}
}

# Money Troubles (If the bank isn't there, worries over run-away inflation)
country_event = {
	id = MGY_FocusEconomy.33
	title = MGY_FocusEconomy.33.title
	desc = MGY_FocusEconomy.33.desc

	is_triggered_only = yes

	trigger = {
		OR = {
			has_idea = MGY_industrialconcern_nationalisedcommission
			has_idea = MGY_industrialconcern_corruptcommission
		}
		has_idea = MGY_IndebtedEconomy
		NOT = {
			has_completed_focus = MGY_MaregyptBank
		}
	}

	option = {
		# Sell more shares!
		name = MGY_FocusEconomy.33.a

		add_to_variable = {
			var = MGY_DebtPaymentCost_var
			value = 25
			tooltip = MGY_DebtPaymentCost_var_tt
		}
	}

	option = {
		# Slash the Budget
		name = MGY_FocusEconomy.33.b
		
		if = {
			limit = {
				has_idea = MGY_industrialconcern_nationalisedcommission
			}
			swap_ideas = {
				remove_idea = MGY_industrialconcern_nationalisedcommission
				add_idea = MGY_industrialconcern_deflatedcommission
			}
		}
		else = {
			swap_ideas = {
				remove_idea = MGY_industrialconcern_corruptcommission
				add_idea = MGY_industrialconcern_bankruptcommission
			}
		}
	}

	option = {
		# Cut back on public spending!
		name = MGY_FocusEconomy.33.c
		
		trigger = {
			OR = {
				has_idea = MGY_PoliticalUnrest
				has_stability > 0
			}
		}

		if = {
			limit = {
				has_idea = MGY_PoliticalUnrest
			}
			every_owned_state = {
				limit = {
					is_core_of = ROOT
					check_variable = {
						MGY_StateUnrest_var < 100
					}
				}
				random_select_amount = 4
				MGY_IncreaseStateUnrest_small_effect = yes
			}
		}
		else = {
			add_stability = -0.05
			add_war_support = -0.05
		}
	}
}

# Corruption in the commission
# country_event = {
# 	id = MGY_FocusEconomy.35
# 	title = {
# 		trigger = {
# 			has_country_flag = MGY_corruptcommission_flag
# 		}
# 		text = MGY_FocusEconomy.35_corruptionexposed_title
# 	}
# 	title = {
# 		trigger = {
# 			NOT = {
# 				has_country_flag = MGY_corruptcommission_flag
# 			}
# 		}
# 		text = MGY_FocusEconomy.35_cleancommission_title
# 	}
# 	desc = {
# 		trigger = {
# 			has_country_flag = MGY_corruptcommission_flag
# 		}
# 		text = MGY_FocusEconomy.35_corruptionexposed_desc
# 	}
# 	desc = {
# 		trigger = {
# 			NOT = {
# 				has_country_flag = MGY_corruptcommission_flag
# 			}
# 		}
# 		text = MGY_FocusEconomy.35_cleancommission_desc
# 	}

# 	is_triggered_only = yes

# 	option = {
# 		# Can't believe we got caught...
# 		trigger = {
# 			has_country_flag = MGY_corruptcommission_flag
# 		}

# 		name = MGY_FocusEconomy.35.a

# 		add_political_power = -50
# 		add_war_support = -0.03
# 		add_stability = -0.03
# 		custom_effect_tooltip = MGY_DoubleSpace_tt
# 		add_popularity = {
# 			ideology = ROOT
# 			popularity = -0.05
# 		}
# 	}

# 	option = {
# 		# Cover it up!
# 		trigger = {
# 			has_country_flag = MGY_corruptcommission_flag
# 		}

# 		name = MGY_FocusEconomy.35.b

# 		if = {
# 			limit = {
# 				has_country_flag = MGY_PoliticalUnrest
# 			}
# 			add_stability = -0.025
# 			custom_effect_tooltip = MGY_DoubleSpace_tt
# 			every_state = {
# 				limit = {
# 					is_core_of = ROOT
# 					check_variable = {
# 						MGY_StateUnrest_var < 100
# 					}
# 				}
# 				random_select_amount = 3
# 				MGY_IncreaseStateUnrest_small_effect = yes
# 			}
# 		}
# 		else = {
# 			add_stability = -0.025
# 			custom_effect_tooltip = MGY_DoubleSpace_tt
# 			add_popularity = {
# 				ideology = ROOT
# 				popularity = -0.05
# 			}	
# 		}
# 	}

# 	option = {
# 		# can't believe we got away with it!
# 		trigger = {
# 			NOT = {
# 				has_country_flag = MGY_corruptcommission_flag
# 			}
# 		}

# 		name = MGY_FocusEconomy.35.c
# 	}
# }


# Census of [YEAR]
country_event = {
	id = MGY_FocusEconomy.4
	title = MGY_FocusEconomy.4.title
	desc = MGY_FocusEconomy.4.desc

	is_triggered_only = yes

	# 
	option = { 
		name = MGY_FocusEconomy.4.a
		
	}
}

# Farmers Protest Expropriation
country_event = {
	id = MGY_FocusEconomy.5
	title = MGY_FocusEconomy.5.title
	desc = MGY_FocusEconomy.5.desc

	is_triggered_only = yes

	# 
	option = { 
		name = MGY_FocusEconomy.5.a
		
	}
}

# Farmers Go Bankrupt - Makes Poverty Worse
country_event = {
	id = MGY_FocusEconomy.6
	title = MGY_FocusEconomy.6.title
	desc = MGY_FocusEconomy.6.desc

	is_triggered_only = yes

	# 
	option = { 
		name = MGY_FocusEconomy.6.a
		
	}
}

# Land Tenure Chain - Begins
country_event = {
	id = MGY_FocusEconomy.71
	title = MGY_FocusEconomy.71.title
	desc = MGY_FocusEconomy.71.desc

	is_triggered_only = yes

	# 
	option = { 
		name = MGY_FocusEconomy.71.a
		
	}
}

# Politics - Common

country_event = { # Premeptive Censorship (choose to collaborate and weaken the socialists or do nothing)
	id = MGY_Politics.1
	title = MGY_Politics.1.title
	desc = MGY_Politics.1.desc

	is_triggered_only = yes
	fire_only_once = yes
}

country_event = { # Basis of a Coalition (choose to favour agrarians or southern nomarchs)
	id = MGY_Politics.2
	title = MGY_Politics.2.title
	desc = MGY_Politics.2.desc

	is_triggered_only = yes
	fire_only_once = yes
}

country_event = { # The Royal Tour
	id = MGY_Politics.3
	title = MGY_Politics.3.title
	desc = MGY_Politics.3.desc

	is_triggered_only = yes
	fire_only_once = yes
}

country_event = { # The King Adresses the Cabinet
	id = MGY_Politics.4
	title = MGY_Politics.4.title
	desc = MGY_Politics.4.desc

	is_triggered_only = yes
	fire_only_once = yes
}

# The Royal Diet

country_event = {
	id = MGY_RoyalDiet.10
	title = MGY_RoyalDiet.10.title
	desc = MGY_RoyalDiet.10.desc

	is_triggered_only = yes
	fire_only_once = yes
}

country_event = {
	id = MGY_RoyalDiet.2
	title = MGY_RoyalDiet.2.title
	desc = MGY_RoyalDiet.2.desc

	is_triggered_only = yes
	fire_only_once = yes
}