add_namespace = MGY_Lore
add_namespace = MGY_FocusEconomy

##################
# Lore-Dumping Events
##################

# Event appears on startup, drops exposition on what's been going on.
country_event = {
	id = MGY_Lore.1
	title = MGY_Lore.1.title
	desc = MGY_Lore.1.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_ruins

	option = {
		# Tell me about politics
		name = MGY_Lore.1.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.2.a
		hidden_effect = {
			country_event = MGY_Lore.4
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.2.b
		hidden_effect = {
			country_event = MGY_Lore.3
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.1.b
		
	}
}

# Event on the mainstream politics
country_event = {
	
	id = MGY_Lore.2
	title = MGY_Lore.2.title
	desc = MGY_Lore.2.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_harmony

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.2.a
		hidden_effect = {
			country_event = MGY_Lore.4
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.2.b
		hidden_effect = {
			country_event = MGY_Lore.3
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.2.c
		
	}
}

# Event on the socialists
country_event = {
	
	id = MGY_Lore.3
	title = MGY_Lore.3.title
	desc = MGY_Lore.3.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_socialism

	option = {
		# Tell me about the mainstream
		name = MGY_Lore.3.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}
	}

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.3.b
		hidden_effect = {
			country_event = MGY_Lore.4
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.3.c
		
	}
}

# Event on the reactionaries
country_event = {
	
	id = MGY_Lore.4
	title = MGY_Lore.4.title
	desc = MGY_Lore.4.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_reactionary

	option = {
		# Tell me about the mainstream
		name = MGY_Lore.4.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.4.b
		custom_effect_tooltip = MGY_LearnAboutSocialistsPolitics_tt
		hidden_effect = {
			country_event = MGY_Lore.3
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.4.c
		
	}
}

##################
# Economy Events
##################

# "The Last days of the Mint"
country_event = {
	id = MGY_FocusEconomy.1
	title = MGY_FocusEconomy.1.title
	desc = MGY_FocusEconomy.1.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_coins

	option = {
		name = MGY_FocusEconomy.1.a

		add_timed_idea = {
			idea = MGY_AbandonnedStater
			days = 270
		}
		custom_effect_tooltip = MGY_DoubleSpace_tt
		every_country = {
			limit = {
				OR = {
					tag = HIP
					tag = EQS
					is_in_faction_with = EQS
				}
			}
			add_opinion_modifier = {
				target = ROOT
				modifier = MGY_adopted_bit
			}
		}
	}
}

# Recovery Improves!
country_event = {
	id = MGY_FocusEconomy.2
	title = MGY_FocusEconomy.2.title
	desc = MGY_FocusEconomy.2.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = {
		name = MGY_FocusEconomy.2.a
		effect_tooltip = {
			swap_ideas = {
				remove_idea = MGY_legacy_of_storm1
				add_idea = MGY_legacy_of_storm2
			}
		}
	}
}

# We continue to recover!
country_event = {
	id = MGY_FocusEconomy.3
	title = MGY_FocusEconomy.3.title
	desc = MGY_FocusEconomy.3.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = {
		name = MGY_FocusEconomy.3.a
		effect_tooltip = {
			swap_ideas = {
				remove_idea = MGY_legacy_of_storm2
				add_idea = MGY_legacy_of_storm3
			}
		}
	}
}

# We have recovered!
country_event = {
	id = MGY_FocusEconomy.4
	title = MGY_FocusEconomy.4.title
	desc = MGY_FocusEconomy.4.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = { 
		name = MGY_FocusEconomy.4.a
		effect_tooltip = {
			remove_ideas = MGY_legacy_of_storm3
		}
		add_stability = 0.05
		add_war_support = 0.05
	}
}

# About Maregypt's Agriculture
country_event = {
	id = MGY_FocusEconomy.5
	title = MGY_FocusEconomy.5.title
	desc = MGY_FocusEconomy.5.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_farmland

	option = { 
		name = MGY_FocusEconomy.5.a
		
		hidden_effect = {
			country_event = {
				id = MGY_FocusEconomy.6
				days = 21
			}
		}
	}
}

# Devaluation leads to uncertainty amongst farmers
country_event = {
	id = MGY_FocusEconomy.6
	title = MGY_FocusEconomy.6.title
	desc = MGY_FocusEconomy.6.desc

	is_triggered_only = yes

	timeout_days = 14

	immediate = {
		hidden_effect = {
			country_event = {
				id = MGY_FocusEconomy.7
				days = 60
			}
		}
	}

	picture = GFX_event_mgy_farmland

	option = { #Surely this cannot get worse?
		name = MGY_FocusEconomy.6.a

		add_stability = -0.03
		add_popularity = {
			ideology = ROOT
			popularity = -0.05
		}

		every_owned_state = {
			limit = {
				has_dynamic_modifier = {
					modifier = MGY_MODIFIER_LocalUnrest_Dynmod
				}
			}
			random_select_amount = 3
			MGY_IncreaseStateUnrest_small_effect = yes
		}
	}

	option = { #We have to do something!
		name = MGY_FocusEconomy.6.b

		add_political_power = -50
		add_popularity = {
			ideology = ROOT
			popularity = -0.03
		}

		if = {
			limit = {
				has_idea = MGY_PoliticalUnrest
			}
			every_owned_state = {
				limit = {
					has_dynamic_modifier = {
					modifier = MGY_MODIFIER_LocalUnrest_Dynmod
					}
				}
				random_select_amount = 3
				MGY_IncreaseStateUnrest_small_effect = yes
			}
		}

		hidden_effect = {
			set_country_flag = MGY_IntervenedToHelpPeasants_flag
		}
	}
}

# Competing Leads to Crashes
country_event = {
	id = MGY_FocusEconomy.7
	title = MGY_FocusEconomy.7.title
	desc = {
		text = MGY_FocusEconomy.7a.desc
		trigger = {
			has_country_flag = MGY_IntervenedToHelpPeasants_flag
		}
	}
	desc = {
		text = MGY_FocusEconomy.7b.desc
		trigger = {
			NOT = {
				has_country_flag = MGY_IntervenedToHelpPeasants_flag
			}
		}
	}

	is_triggered_only = yes

	picture = GFX_event_mgy_drought
	
	immediate = {
		hidden_effect = {
			set_country_flag = MGY_FarmingCrisis_flag
		}
	}

	option = { # Damnit!
		name = MGY_FocusEconomy.7.a
		add_stability = -0.05
		if = {
			limit = {
				has_idea = MGY_PoliticalUnrest
			}
			every_owned_state = {
				limit = {
					has_dynamic_modifier = {
					modifier = MGY_MODIFIER_LocalUnrest_Dynmod
					}
				}
				random_select_amount = 3
				MGY_IncreaseStateUnrest_medium_effect = yes
			}
		}
		#
		custom_effect_tooltip = MGY_DoubleSpace_tt
		increase_poverty = yes
		#
		activate_mission = MGY_FarmingCrisisMission_dec
		if = {
			limit = {
				has_country_flag = MGY_IntervenedToHelpPeasants_flag
			}
			custom_effect_tooltip = MGY_IntervenedToHelpPeasants_tt
			add_days_mission_timeout = {
				mission = MGY_FarmingCrisisMission_dec
				days = 120
			}
		}
		custom_override_tooltip = {
			tooltip = {
				localization_key = MGY_UnlockDecisionTooltip_tt
				DECISION = MGY_FarmingCrisisBuyGrainAtLoss_dec
			}
		}
		custom_override_tooltip = {
			tooltip = {
				localization_key = MGY_UnlockDecisionTooltip_tt
				DECISION = MGY_FarmingCrisisIssueLoans_dec
			}
		}
	}
}

# Fate of the Commission
country_event = {
	id = MGY_FocusEconomy.8
	title = MGY_FocusEconomy.8.title
	desc = MGY_FocusEconomy.8.desc

	is_triggered_only = yes

	# Ask Equestria for Additional Loans...	 
	option = { 
		name = MGY_FocusEconomy.8.a
		trigger = {
			EQS = {
				exists = yes
				is_puppet = no
				NOT = {
					has_war_with = ROOT
				}
			}
		}
		custom_effect_tooltip = MGY_ReachOutToEquestria_tt
		custom_effect_tooltip = if_they_accept_tt
		effect_tooltip = {
			add_ideas = MGY_DebtsToEquestria
			custom_effect_tooltip = MGY_DoubleSpace_tt
			custom_effect_tooltip = MGY_CheaperDebtDecisions_tt
			custom_effect_tooltip = MGY_DebtsRemovedWhenSettled_tt
		}
		custom_effect_tooltip = if_they_refuse_tt
		effect_tooltip = {
			add_stability = -0.05
		}
		hidden_effect = {
			EQS = {
				country_event = {
					id = MGY_FocusEconomy.802
					days = 10
				}
			}
		}
	}

	# Ask Hippogriffia for Additional Loans...	 
	option = { 
		name = MGY_FocusEconomy.8.b
		trigger = {
			HIP = {
				exists = yes
				is_puppet = no
				NOT = {
					has_war_with = ROOT
				}
			}
		}
		custom_effect_tooltip = MGY_ReachOutToHippogriffia_tt
		custom_effect_tooltip = if_they_accept_tt
		effect_tooltip = {
			add_ideas = MGY_DebtsToHippogriffia
			custom_effect_tooltip = MGY_DoubleSpace_tt
			custom_effect_tooltip = MGY_CheaperDebtDecisions_tt
			custom_effect_tooltip = MGY_DebtsRemovedWhenSettled_tt
		}
		custom_effect_tooltip = if_they_refuse_tt
		effect_tooltip = {
			add_stability = -0.05
		}
		hidden_effect = {
			HIP = {
				country_event = {
					id = MGY_FocusEconomy.802
					days = 10
				}
			}
		}
	}

	# Wingbardy
	option = { 
		name = MGY_FocusEconomy.8.c
		trigger = {
			WNG = {
				exists = yes
				is_puppet = no
				NOT = {
					has_war_with = ROOT
				}
			}
		}
		custom_effect_tooltip = MGY_ReachOutToWingbardy_tt
		custom_effect_tooltip = if_they_accept_tt
		effect_tooltip = {
			add_ideas = MGY_DebtsToWingbardy
			custom_effect_tooltip = MGY_DoubleSpace_tt
			custom_effect_tooltip = MGY_CheaperDebtDecisions_tt
			custom_effect_tooltip = MGY_DebtsRemovedWhenSettled_tt
		}
		custom_effect_tooltip = if_they_refuse_tt
		effect_tooltip = {
			add_stability = -0.05
		}
		hidden_effect = {
			WNG = {
				country_event = {
					id = MGY_FocusEconomy.802
					days = 10
				}
			}
		}
	}

	# We Can do this on our own!
	option = { 
		name = MGY_FocusEconomy.8.d
		add_popularity = {
			ideology = ROOT
			popularity = 0.03
		}
	}
}

# Fate of the Commission - Recepient Event
country_event = {
	id = MGY_FocusEconomy.801
	title = MGY_FocusEconomy.801.title
	desc = MGY_FocusEconomy.801.desc

	is_triggered_only = yes

	# Of course we will help! (AI will ALWAYS accept this)
	option = { 
		name = MGY_FocusEconomy.801.a

		if = {
			limit = {
				is_ai = no
			}
			add_political_power = -25
		}

		if = {
			limit = {
				original_tag = EQS
			}
			effect_tooltip = {
				MGY = {add_ideas = MGY_DebtsToEquestria
				
				}
			}	
		}
		else_if = {
			limit = {
				original_tag = HIP
			}
			effect_tooltip = {
				MGY = {
					add_ideas = MGY_DebtsToHippogriffia
				}
			}	
		}
		else_if = {
			limit = {
				original_tag = WNG
			}
			effect_tooltip = {
				MGY = {
					add_ideas = MGY_DebtsToWingbardy
				}
			}	
		}

		hidden_effect = {
			PREV = {
				country_event = MGY_FocusEconomy.802
			}
		}
	}

	# We are not made of money!
	option = { 
		name = MGY_FocusEconomy.801.b
		hidden_effect = {
			PREV = {
				country_event = MGY_FocusEconomy.803
			}
		}
	}
}

# Fate of the Commission - Recipient Accepted
country_event = {
	id = MGY_FocusEconomy.802
	title = MGY_FocusEconomy.802.title
	desc = MGY_FocusEconomy.802.desc

	is_triggered_only = yes

	# Fantastic!
	option = { 
		name = MGY_FocusEconomy.801.a
		if = {
			limit = {
				PREV = {
					original_tag = EQS
				}
			}
			add_ideas = MGY_DebtsToEquestria
		}
		else_if = {
			limit = {
				PREV = {
					original_tag = HIP
				}
			}
			add_ideas = MGY_DebtsToHippogriffia
		}
		else_if = {
			limit = {
				PREV = {
					original_tag = WNG_antonino_proletarino
				}
			}
			add_ideas = MGY_DebtsToWingbardy
		}
	}
}

# Fate of the Commission - Recipient Refused
country_event = {
	id = MGY_FocusEconomy.803
	title = MGY_FocusEconomy.803.title
	desc = MGY_FocusEconomy.803.desc

	is_triggered_only = yes

	# Damn it
	option = { 
		name = MGY_FocusEconomy.803.a
		add_stability = -0.05
	}
}