add_namespace = MGY_Lore
add_namespace = MGY_FocusEconomy

##################
# Lore-Dumping Events
##################

# Event appears on startup, drops exposition on what's been going on.
country_event = {
	id = MGY_Lore.1
	title = MGY_Lore.1.title
	desc = MGY_Lore.1.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_ruins

	option = {
		# Tell me about politics
		name = MGY_Lore.1.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.2.a
		hidden_effect = {
			country_event = MGY_Lore.4
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.2.b
		hidden_effect = {
			country_event = MGY_Lore.3
		}

		trigger = {
			NOT = {
				is_ai = yes
			}
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.1.b
		
	}
}

# Event on the mainstream politics
country_event = {
	
	id = MGY_Lore.2
	title = MGY_Lore.2.title
	desc = MGY_Lore.2.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_harmony

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.2.a
		hidden_effect = {
			country_event = MGY_Lore.4
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.2.b
		hidden_effect = {
			country_event = MGY_Lore.3
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.2.c
		
	}
}

# Event on the socialists
country_event = {
	
	id = MGY_Lore.3
	title = MGY_Lore.3.title
	desc = MGY_Lore.3.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_socialism

	option = {
		# Tell me about the mainstream
		name = MGY_Lore.3.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}
	}

	option = {
		# Tell me about the reactionaries
		name = MGY_Lore.3.b
		hidden_effect = {
			country_event = MGY_Lore.4
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.3.c
		
	}
}

# Event on the reactionaries
country_event = {
	
	id = MGY_Lore.4
	title = MGY_Lore.4.title
	desc = MGY_Lore.4.desc

	is_triggered_only = yes

	picture = GFX_event_mgy_reactionary

	option = {
		# Tell me about the mainstream
		name = MGY_Lore.4.a
		hidden_effect = {
			country_event = MGY_Lore.2
		}
	}

	option = {
		# Tell me about the socialists
		name = MGY_Lore.4.b
		custom_effect_tooltip = MGY_LearnAboutSocialistsPolitics_tt
		hidden_effect = {
			country_event = MGY_Lore.3
		}
	}

	option = {
		# Play the game already!
		name = MGY_Lore.4.c
		
	}
}

##################
# Economy Events
##################

# "What Little the Locusts Left"
country_event = {
	id = MGY_FocusEconomy.1
	title = MGY_FocusEconomy.1.title
	desc = MGY_FocusEconomy.1.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = {
		name = MGY_FocusEconomy.1.a
	}
}

# Recovery Improves!
country_event = {
	id = MGY_FocusEconomy.2
	title = MGY_FocusEconomy.2.title
	desc = MGY_FocusEconomy.2.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = {
		name = MGY_FocusEconomy.2.a
		effect_tooltip = {
			swap_ideas = {
				remove_idea = zebrica_legacy_of_storm1
				add_idea = zebrica_legacy_of_storm2
			}
		}
	}
}

# We continue to recover!
country_event = {
	id = MGY_FocusEconomy.3
	title = MGY_FocusEconomy.3.title
	desc = MGY_FocusEconomy.3.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = {
		name = MGY_FocusEconomy.3.a
		effect_tooltip = {
			swap_ideas = {
				remove_idea = zebrica_legacy_of_storm2
				add_idea = zebrica_legacy_of_storm3
			}
		}
	}
}

# We have recovered!
country_event = {
	id = MGY_FocusEconomy.4
	title = MGY_FocusEconomy.4.title
	desc = MGY_FocusEconomy.4.desc

	is_triggered_only = yes

	# picture = GFX_event_mgy_abandonnedvillage

	option = { 
		name = MGY_FocusEconomy.4.a
		effect_tooltip = {
			remove_ideas = zebrica_legacy_of_storm3
		}
		add_stability = 0.05
		add_war_support = 0.05
	}
}

# Devaluation leads to uncertainty amongst farmers
country_event = {
	id = MGY_FocusEconomy.5
	title = MGY_FocusEconomy.5.title
	desc = MGY_FocusEconomy.5.desc

	is_triggered_only = yes

	timeout_days = 14

	immediate = {
		hidden_effect = {
			country_event = {
				id = MGY_FocusEconomy.6
				days = 21
			}			
		}
	}

	picture = GFX_event_mgy_farmland

	option = { #Surely this cannot get worse?
		name = MGY_FocusEconomy.5.a

		add_stability = -0.03
		add_popularity = {
			ideology = ROOT
			popularity = -0.05
		}

		every_owned_state = {
			limit = {
				has_dynamic_modifier = {
					modifier = MGY_MODIFIER_LocalUnrest_Dynmod
				}
			}
			random_select_amount = 3
			MGY_IncreaseStateUnrest_small_effect = yes
		}
	}

	option = { #We have to do something!
		name = MGY_FocusEconomy.5.b

		add_political_power = -50
		add_popularity = {
			ideology = ROOT
			popularity = -0.03
		}

		if = {
			limit = {
				has_idea = MGY_PoliticalUnrest
			}
			every_owned_state = {
				limit = {
					has_dynamic_modifier = {
					modifier = MGY_MODIFIER_LocalUnrest_Dynmod
					}
				}
				random_select_amount = 3
				MGY_IncreaseStateUnrest_small_effect = yes
			}
		}

		hidden_effect = {
			set_country_flag = MGY_IntervenedToHelpPeasants_flag
		}
	}
}

# Competing Leads to Crashes
country_event = {
	id = MGY_FocusEconomy.6
	title = MGY_FocusEconomy.6.title
	desc = {
		text = MGY_FocusEconomy.6a.desc
		trigger = {
			has_country_flag = MGY_IntervenedToHelpPeasants_flag
		}
	}
	desc = {
		text = MGY_FocusEconomy.6b.desc
		trigger = {
			NOT = {
				has_country_flag = MGY_IntervenedToHelpPeasants_flag
			}
		}
	}

	is_triggered_only = yes

	picture = GFX_event_mgy_drought
	
	immediate = {
		hidden_effect = {
			set_country_flag = MGY_FarmingCrisis_flag
		}
	}

	option = { # Damnit!
		name = MGY_FocusEconomy.6.a
		add_stability = -0.05
		if = {
			limit = {
				has_idea = MGY_PoliticalUnrest
			}
			every_owned_state = {
				limit = {
					has_dynamic_modifier = {
					modifier = MGY_MODIFIER_LocalUnrest_Dynmod
					}
				}
				random_select_amount = 3
				MGY_IncreaseStateUnrest_medium_effect = yes
			}
		}
		#
		custom_effect_tooltip = MGY_DoubleSpace_tt
		increase_poverty = yes
		#
		activate_mission = MGY_FarmingCrisisMission_dec
		if = {
			limit = {
				has_country_flag = MGY_IntervenedToHelpPeasants_flag
			}
			custom_effect_tooltip = MGY_IntervenedToHelpPeasants_tt
			add_days_mission_timeout = {
				mission = MGY_FarmingCrisisMission_dec
				days = 120
			}
		}
		custom_override_tooltip = {
			tooltip = {
				localization_key = MGY_UnlockDecisionTooltip_tt
				DECISION = MGY_FarmingCrisisBuyGrainAtLoss_dec
			}
		}
		custom_override_tooltip = {
			tooltip = {
				localization_key = MGY_UnlockDecisionTooltip_tt
				DECISION = MGY_FarmingCrisisIssueLoans_dec
			}
		}
	}
}