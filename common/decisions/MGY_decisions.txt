MGY_GranaryOfZebrica_cat = {
	# Granary of Zebrica - debug
	MGY_debugGranarySetup_dec = {
		priority = 2000
		visible = {
			is_debug = yes
		}

		complete_effect = {
			custom_effect_tooltip = MGY_debugGranarySetup_tt
			hidden_effect = {
				MGY_Granary_Setup_effect = yes
				MGY_Granary_CalcPercentageGain_effect = yes
				MGY_Granary_CalcPercentageMax_effect = yes
				MGY_Granary_CheckFoodNeeds_effects = yes
			}
		}
	}
	MGY_debugFocusUnlock_dec = {
		priority = 1000
		complete_effect = {
			complete_national_focus = MGY_AgrarianCensus
		}
		visible = {
			is_debug = yes
			NOT = {
				has_completed_focus = MGY_AgrarianCensus
			}
		}
	}
	MGY_debugFocusRelock_dec = {
		priority = 1000
		complete_effect = {
			uncomplete_national_focus = {
				focus = MGY_AgrarianCensus
				uncomplete_children = yes
			}
		}
		visible = {
			has_completed_focus = MGY_AgrarianCensus
			is_debug = yes
		}
	}
	MGY_debugGranaryNegativeFood_dec = {
		priority = 1000
		visible = {
			is_debug = yes
		}

		complete_effect = {
			set_variable = {
				MGY_Grain_var = -10
				tooltip = MGY_Grain_var_set_tt
			}
			MGY_Granary_CheckFoodNeeds_effects = yes
		}
	}
	MGY_debugGranaryPositiveFood_dec = {
		priority = 1000
		visible = {
			is_debug = yes
		}

		complete_effect = {
			set_variable = {
				MGY_Grain_var = 10
				tooltip = MGY_Grain_var_set_tt
			}
			MGY_Granary_CheckFoodNeeds_effects = yes
		}
	}
	MGY_debugGranaryIncreaseGrainFactor_dec = {
		priority = 1000
		visible = {
			is_debug = yes
		}

		days_remove = 10

		modifier = {
			MGY_Grain_increase_factor_modifier = 0.05
		}

		complete_effect = {
			hidden_effect = {
				add_to_variable = {
					MGY_Grain_increase_factor_var = 0.05
				}
				#
				MGY_Granary_CalcPercentageGain_effect = yes
				MGY_Granary_CalcPercentageMax_effect = yes
			}
		}

		remove_effect = {
			hidden_effect = {
				add_to_variable = {
					MGY_Grain_increase_factor_var = -0.05
				}
				#
				MGY_Granary_CalcPercentageGain_effect = yes
				MGY_Granary_CalcPercentageMax_effect = yes
			}
		}

	}
	# Granary of Zebrica
	MGY_GrannaryOfZebrica_SellGrain_Dec = {
		priority = 100

		icon = GFX_decision_generic_political_discourse

		days_remove = 60

		custom_cost_trigger = {
			always = yes
		}
		custom_cost_text = MGY_GranaryWheatCost_tt

		targets_dynamic = yes
		target_trigger = {
			FROM = {
				OR = {
					tag = EQS
					tag = HIP
					is_subject_of = EQS
					is_subject_of = HIP
					has_country_flag = MGY_GrainPartner_flag
				}
				NOT = {
					is_subject_of = ROOT
				}
			}
		}

		available = {
			NOT = {
				is_embargoing = FROM
			}
			FROM = {
				NOT = {
					has_war_with = ROOT
				}
				NOT = {
					is_embargoing = ROOT
				}
				OR = {
					has_opinion = {
						target = ROOT
						value > 24
					}
					is_in_faction_with = ROOT
				}
			}
		}

		cancel_effect = {
			add_to_variable = {
				MGY_Grain_var = 100
				tooltip = MGY_Grain_var_tt
			}
		}

		cancel_trigger = {
			OR = {
				is_embargoing = FROM
				FROM = {
					is_embargoing = ROOT
				}
				FROM = {
					has_war_with = ROOT
				}
			}
		}

		target_root_trigger = {
			OR = {
				is_debug = yes
				has_completed_focus = MGY_AgrarianCensus
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: COMPLETE EFFECT MGY_GrannaryOfZebrica_SellGrain_Dec"
			#
			add_to_variable = {
				MGY_Grain_var = -100
				tooltip = MGY_Grain_var_tt
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: COMPLETE EFFECT MGY_GrannaryOfZebrica_SellGrain_Dec"
			add_cic = 5000
			add_political_power = 10
		}
	}
	MGY_GranaryOfZebrica_ExpandGranaries_Dec = {
		priority = 100

		icon = GFX_MGY_Granary_dec
		
		on_map_mode = map_only
		state_target = yes
		days_remove = 40

		fire_only_once = yes

		visible = {
			FROM ={
				has_state_flag = MGY_clearedforagrigculture_flag
			}
		}
		target_root_trigger = {
			OR = {
				is_debug = yes
				has_completed_focus = MGY_AgrarianCensus
			}
		}
		target_trigger = {
			FROM = {
				is_controlled_by = ROOT
				is_owned_by = ROOT
			}
		}
		target_array = owned_states

		cost = MGY_GranaryPolCost_var

		available = {
			custom_trigger_tooltip = {
				tooltip = MGY_CanOnlyTakeOnce_tt
			}
			custom_override_tooltip = {
				tooltip = {
					localization_key = MGY_AvailableCivilianFactories_tt
					FACTORIES = 2
				}
				num_of_available_civilian_factories > 1
			}
			custom_trigger_tooltip = {
				tooltip = MGY_GranaryPonypowerCostSmall_tt	
				OR = {
					has_manpower = MGY_GranaryPonypowerSmallCost_var
					has_manpower > MGY_GranaryPonypowerSmallCost_var
				}
			}
		}
		
		modifier = {
			civilian_factory_use = 3
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: COMPLETE EFFECT MGY_GranaryOfZebrica_ExpandGranaries_Dec"
			hidden_effect = {
				# Temp variables to properly handle the cost
				set_temp_variable = {
					MGY_decisionCost_tempvar = MGY_GranaryPolCost_var
				}
				multiply_temp_variable = {
					MGY_decisionCost_tempvar = -1
				}
				add_political_power = MGY_decisionCost_tempvar
				set_temp_variable = {
					MGY_decisionCost_tempvar = MGY_GranaryPonypowerSmallCost_var
				}
				multiply_temp_variable = {
					MGY_decisionCost_tempvar = -1
				}
				add_manpower = MGY_decisionCost_tempvar
			}
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: REMOVE EFFECT MGY_GranaryOfZebrica_ExpandGranaries_Dec"
			MGY_Granary_CalcPercentageGain_effect = yes
			MGY_Granary_CalcPercentageMax_effect = yes
			#
			add_to_variable = {
				value = 45
				var = MGY_Grain_max_var
				tooltip = MGY_Grain_max_var_tt
			}
			#
			hidden_effect = {
				set_temp_variable = {
					MGY_GranaryPonyPowerReturn_tempvar = MGY_GranaryPonypowerSmallCost_var
				}
				multiply_temp_variable = {
					MGY_GranaryPonyPowerReturn_tempvar = 0.9
				}
			}
			custom_effect_tooltip = MGY_DoubleSpace_tt
			custom_effect_tooltip = MGY_GranaryPonyPowerReturn_tt
			add_manpower = MGY_GranaryPonyPowerReturn_tempvar
		}

		cancel_trigger = {
			FROM = {
				OR = {
					NOT = {
						is_owned_by = ROOT
					}
					NOT = {
						is_controlled_by = ROOT
					}
				}
			}
		}
	}
	MGY_GranaryOfZebrica_IncreaseProduction_Dec = {
		priority = 100

		icon = GFX_MGY_Ponypower_dec
		
		on_map_mode = map_only
		state_target = yes
		days_remove = 40

		visible = {
			FROM ={
				has_state_flag = MGY_clearedforagrigculture_flag
			}
		}
		target_root_trigger = {
			OR = {
				is_debug = yes
				has_completed_focus = MGY_AgrarianCensus
			}
		}
		target_trigger = {
			FROM = {
				is_controlled_by = ROOT
				is_owned_by = ROOT
			}
		}
		target_array = owned_states

		cost = MGY_GranaryPolCost_var

		available = {
			custom_trigger_tooltip = {
				tooltip = MGY_GranaryPonypowerCostLarge_tt
				OR = {
					has_manpower = MGY_GranaryPonypowerLargeCost_var
					has_manpower > MGY_GranaryPonypowerLargeCost_var
				}
			}
		}
		
		modifier = {
			MGY_Grain_increase_factor_modifier = 0.05
			war_support_factor = -0.03
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: COMPLETE EFFECT MGY_GranaryOfZebrica_IncreaseProduction_Dec"
			hidden_effect = {
				# Temp variables to properly handle the cost
				set_temp_variable = {
					MGY_decisionCost_tempvar = MGY_GranaryPolCost_var
				}
				multiply_temp_variable = {
					MGY_decisionCost_tempvar = -1
				}
				add_political_power = MGY_decisionCost_tempvar
				set_temp_variable = {
					MGY_decisionCost_tempvar = MGY_GranaryPonypowerLargeCost_var
				}
				multiply_temp_variable = {
					MGY_decisionCost_tempvar = -1
				}
				add_manpower = MGY_decisionCost_tempvar
				#
				add_to_variable = {
					MGY_Grain_increase_factor_var = 0.05
				}
			}
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: REMOVE EFFECT MGY_GranaryOfZebrica_IncreaseProduction_Dec"
			MGY_Granary_CalcPercentageGain_effect = yes
			MGY_Granary_CalcPercentageMax_effect = yes
			#
			hidden_effect = {
				set_temp_variable = {
					MGY_GranaryPonyPowerReturn_tempvar = MGY_GranaryPonypowerLargeCost_var
				}
				multiply_temp_variable = {
					MGY_GranaryPonyPowerReturn_tempvar = 0.8
				}
				#
				add_to_variable = {
					MGY_Grain_increase_factor_var = -0.05
				}
			}
			custom_effect_tooltip = MGY_GranaryPonyPowerReturn_tt
			add_manpower = MGY_GranaryPonyPowerReturn_tempvar
		}

		cancel_trigger = {
			FROM = {
				OR = {
					NOT = {
						is_owned_by = ROOT
					}
					NOT = {
						is_controlled_by = ROOT
					}
				}
			}
		}

		cancel_effect = {
			add_to_variable = {
				MGY_Grain_increase_factor_var = -0.1
			}
		}
	}
}