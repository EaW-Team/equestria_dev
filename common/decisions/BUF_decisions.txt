BUF_steal_states_from_equestria = {
	BUF_core_empire = {
		icon = rifles_appleloosa
		allowed = {
			original_tag = BUF
		}
		cost = 150
		fire_only_once = yes
		ai_will_do = {
			factor = 160
		}
		available = {
			hidden_trigger = {
				AND = {
			19 = { is_controlled_by = BUF }
			20 = { is_controlled_by = BUF }
			21 = { is_controlled_by = BUF }
			22 = { is_controlled_by = BUF }
			23 = { is_controlled_by = BUF }
			85 = { is_controlled_by = BUF }
			42 = { is_controlled_by = BUF }
			71 = { is_controlled_by = BUF }
			44 = { is_controlled_by = BUF }
			47 = { is_controlled_by = BUF }
			51 = { is_controlled_by = BUF }
			92 = { is_controlled_by = BUF }
			43 = { is_controlled_by = BUF }
			91 = { is_controlled_by = BUF }
			49 = { is_controlled_by = BUF }
			93 = { is_controlled_by = BUF }
			80 = { is_controlled_by = BUF }
				}
			}
		}
		visible = {
			hidden_trigger = {
				AND = {
			19 = { is_controlled_by = BUF }
			20 = { is_controlled_by = BUF }
			21 = { is_controlled_by = BUF }
			22 = { is_controlled_by = BUF }
			23 = { is_controlled_by = BUF }
			85 = { is_controlled_by = BUF }
			42 = { is_controlled_by = BUF }
			71 = { is_controlled_by = BUF }
			44 = { is_controlled_by = BUF }
			47 = { is_controlled_by = BUF }
			51 = { is_controlled_by = BUF }
			92 = { is_controlled_by = BUF }
			43 = { is_controlled_by = BUF }
			91 = { is_controlled_by = BUF }
			49 = { is_controlled_by = BUF }
			93 = { is_controlled_by = BUF }
			80 = { is_controlled_by = BUF }
				}
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BUF_core_empire"
			add_timed_idea = { idea = BUF_pony_integration days = 365 }
			19 = { add_core_of = BUF }
			20 = { add_core_of = BUF }
			21 = { add_core_of = BUF }
			22 = { add_core_of = BUF }
			23 = { add_core_of = BUF }
			85 = { add_core_of = BUF }
			42 = { add_core_of = BUF }
			71 = { add_core_of = BUF }
			44 = { add_core_of = BUF }
			47 = { add_core_of = BUF }
			51 = { add_core_of = BUF }
			92 = { add_core_of = BUF }
			43 = { add_core_of = BUF }
			91 = { add_core_of = BUF }
			49 = { add_core_of = BUF }
			93 = { add_core_of = BUF }
			80 = { add_core_of = BUF }
			set_cosmetic_tag = BUF_EMPIRE
			set_country_flag = buf_empire_formed
			custom_effect_tooltip = form_buffalo_empire
		}
	}

}

BUF_balance_of_power_category = {



	BUF_appeal_to_the_buffalo_spirit = {
		priority = 39

		icon = GFX_decision_generic_civil_support

		ai_will_do = {
			base = 0.5
			modifier = {
				factor = 10
				OR = {
					has_stability < 0.2
					power_balance_value = {
						id = BUF_power_balance
						value < -0.5
					}
				}
			}
			modifier = {
				factor = 0
				check_variable = { BUF_appeal_to_the_buffalo_spirit_dec_cost > 200 }
				has_political_power < 400
			}
		}

		allowed = {
			original_tag = BUF
		}

		available = {
			has_war = yes
			if = {
				limit = {
					has_country_leader = {
						character = BUF_chief_thunderhooves
						ruling_only = yes
					}
				}
				has_completed_focus = BUF_eleventh_year_of_thunderhooves
			}
		}

		visible = {

		}

		days_re_enable = 360

		days_remove = 180

		cost = BUF_appeal_to_the_buffalo_spirit_dec_cost

		modifier = {
			mobilization_speed = 0.35
		}

		complete_effect = {
			BUF_bop_very_high_increase_effect = yes

			#Increase cost
			multiply_variable = { BUF_appeal_to_the_buffalo_spirit_dec_cost = BUF_bop_decision_cost_multiplier }
			custom_effect_tooltip = BUF_appeal_to_the_buffalo_spirit_cost_increase_tt
		}
	}

	BUF_entice_the_masses = {
		priority = 38

		icon = GFX_decision_eng_propaganda_campaigns

		ai_will_do = {
			base = 0.5
			# modifier = {
			# 	factor = 10
			# 	OR = {
			# 		FIN_is_historical_ai = yes
			# 		AND = {
			# 			FIN_is_fascist_ai = yes
			# 			has_government = fascism
			# 		}
			# 		AND = {
			# 			FIN_is_communist_ai = yes
			# 			has_government = communism
			# 		}
			# 		AND = {
			# 			FIN_is_democratic_ai = yes
			# 			has_government = democratic
			# 		}	
			# 	}
			# 	power_balance_value = {
			# 		id = FIN_power_balance
			# 		value < 0
			# 	}
			# }
			# modifier = {
			# 	add = 10
			# 	FIN_is_historical_ai = yes
			# 	NOT = { has_completed_focus = FIN_the_lone_wolf }
			# 	has_government = neutrality
			# 	NOT = {
			# 		has_country_leader = {
			# 			ruling_only = yes
			# 			character = FIN_pehr_evind_svinhufvud
			# 		}
			# 	}
			# 	neutrality < 0.85
			# }
			modifier = {
				factor = 0
				check_variable = { BUF_entice_the_masses_dec_cost > 200 }
				has_political_power < 400
			}
		}

		allowed = {
			original_tag = BUF
		}

		available = {
			if = {
				limit = {
					has_country_leader = {
						character = BUF_chief_thunderhooves
						ruling_only = yes
					}
				}
				has_completed_focus = BUF_eleventh_year_of_thunderhooves
			}
		}

		visible = {

		}

		days_re_enable = 360

		cost = BUF_entice_the_masses_dec_cost

		complete_effect = {
			add_popularity = {
				ideology = ROOT
				popularity = 0.1
			}
			BUF_bop_medium_increase_effect = yes

			#Increase cost
			multiply_variable = { BUF_entice_the_masses_dec_cost = BUF_bop_decision_cost_multiplier }
			custom_effect_tooltip = BUF_entice_the_masses_cost_increase_tt
		}
	}

	BUF_organize_the_opposition = {
		priority = 30

		icon = GFX_decision_generic_political_discourse

		ai_will_do = {
			base = 0
		}

		allowed = {
			original_tag = BUF
		}

		available = {
			has_war = no
			if = {
				limit = {
					has_country_leader = {
						character = BUF_chief_thunderhooves
						ruling_only = yes
					}
				}
				has_completed_focus = BUF_eleventh_year_of_thunderhooves
			}
		}

		visible = {

		}

		days_re_enable = 360

		cost = BUF_organize_the_opposition_dec_cost

		complete_effect = {
			BUF_bop_high_decrease_effect = yes

			add_popularity = {
				ideology = ROOT
				popularity = -0.05
			}

			#Increase cost
			multiply_variable = { BUF_organize_the_opposition_dec_cost = BUF_bop_decision_cost_multiplier }
			custom_effect_tooltip = BUF_organize_the_opposition_cost_increase_tt
		}
	}
}
BUF_partisan_tactics_category = {
	BUF_prepare_partisan_tactics_in_state = {
		icon = generic_operation

		priority = 10

		state_target = any_controlled_state

		on_map_mode = map_and_decisions_view

		target_array = ROOT.core_states

		target_trigger = {
			FROM = {
				BUF_state_is_valid_for_partisan_tactics = yes
				NOT = { has_dynamic_modifier = { modifier = BUF_partisan_tactics_modifier } }
			}
		}

		visible = {
			FROM = {
				is_controlled_by = ROOT
			}
		}
		
		cancel_if_not_visible = yes

		custom_cost_trigger = {
			command_power > BUF_partisan_decision_cost_for_trigger
			has_political_power > BUF_partisan_decision_cost_for_trigger
		}
		custom_cost_text = BUF_partisan_tactics_decision_cost_dynamic_cp_pp
		ai_hint_pp_cost = 25 #It increases every time this decision is taken though

		days_remove = 15

		available = {
			FROM = {
				NOT = { has_dynamic_modifier = { modifier = BUF_partisan_tactics_modifier } }
				is_controlled_by = ROOT
			}
		}

		cancel_trigger = {
			FROM = {
				NOT = { is_controlled_by = ROOT }
			}
		}

		cancel_effect = {
			#Reset cost
			hidden_effect = {
				divide_variable = { BUF_partisan_decision_cost = BUF_partisan_decision_cost_increase }
				set_variable = { BUF_partisan_decision_cost_for_trigger = BUF_partisan_decision_cost } #For trigger purposes
				subtract_from_variable = { BUF_partisan_decision_cost_for_trigger = 1 } 
			}
		}

		complete_effect = {
			#Cost increase
			hidden_effect = {
				set_temp_variable = { BUF_remove_mana_cost = BUF_partisan_decision_cost }
				multiply_temp_variable = { BUF_remove_mana_cost = -1 }
				add_command_power = BUF_remove_mana_cost
				add_political_power = BUF_remove_mana_cost
				
				multiply_variable = { BUF_partisan_decision_cost = BUF_partisan_decision_cost_increase }
				set_variable = { BUF_partisan_decision_cost_for_trigger = BUF_partisan_decision_cost } #For trigger purposes
				subtract_from_variable = { BUF_partisan_decision_cost_for_trigger = 1 } 
			}

			custom_effect_tooltip = BUF_partisan_tactics_cost_increase_tt
		}

		remove_effect = {
			FROM = {	
				add_dynamic_modifier = { modifier = BUF_partisan_tactics_modifier }
			}
		}

		ai_will_do = {
			base = 0.1
			modifier = {
				factor = 10
				FROM = {
					any_neighbor_state = {
						controller = {
							original_tag = SCS
						}
					}
				}
			}
			modifier = {
				factor = 10
				FROM = {
					any_neighbor_state = {
						controller = {
							has_war_with = ROOT
						}
					}
				}
			}
			modifier = {
				factor = 10
				FROM = {
					NOT = { is_fully_controlled_by = ROOT }
				}
			}
		}
	}

	BUF_cancel_partisan_tactics_in_state = {
		icon = GFX_decision_FIN_stop_motti_tactics

		priority = 1

		state_target = europe # needed because it might hit non-owned or non-controlled states

		on_map_mode = map_and_decisions_view

		target_array = ROOT.core_states

		target_trigger = {
			FROM = {
				has_dynamic_modifier = { modifier = BUF_partisan_tactics_modifier }
			}
		}

		available = {
			FROM = {
				has_dynamic_modifier = { modifier = BUF_partisan_tactics_modifier }
			}
		}

		complete_effect = {
			FROM = {	
				remove_dynamic_modifier = { modifier = BUF_partisan_tactics_modifier }
			}

			#Cost decrease
			hidden_effect = {
				divide_variable = { BUF_partisan_decision_cost = BUF_partisan_decision_cost_increase }
				set_variable = { BUF_partisan_decision_cost_for_trigger = BUF_partisan_decision_cost } #For trigger purposes
				subtract_from_variable = { BUF_partisan_decision_cost_for_trigger = 1 } 
			}

			custom_effect_tooltip = BUF_partisan_tactics_cost_decrease_tt
		}

		ai_will_do = {
			base = 0.1
			modifier = {
				factor = 1000
				FROM = {
					is_fully_controlled_by = ROOT
					all_neighbor_state = {
						controller = {
							NOT = { has_war_with = ROOT }
						}
					}
				}
			}
		}
	}
}

BUF_elder_partisan_infiltration = {
	BUF_prepare_elder_infiltration_in_state = {
		icon = generic_operation

		priority = 10

		state_target = europe

		on_map_mode = map_and_decisions_view

		target_array = EQS.core_states

		target_trigger = {
			FROM = {
				BUF_state_is_southwestern_territory = yes
				is_core_of = EQS
			}
		}
		allowed = {
			original_tag = BUF
		}
		visible = {
			FROM = {
				any_neighbor_state = {
					is_core_of = BUF
				}
			}
		}
		
		cancel_if_not_visible = yes

		custom_cost_trigger = {
			command_power > 35
			has_political_power > 35
		}
		custom_cost_text = BUF_prepare_elder_infiltration_in_state_cost_dynamic_cp_pp
		ai_hint_pp_cost = 35
		
		days_remove = 30

		available = {
			FROM = {
				any_neighbor_state = {
					is_core_of = BUF
				}
			}
		}

		complete_effect = {
			#Cost
			hidden_effect = {
				add_command_power = -35
				add_political_power = -35
			}
		}

		remove_effect = {
			FROM = {	
				remove_core_of = EQS
				add_core_of = BUF
				force_enable_resistance = {
					occupier = EQS
					occupied = BUF
				}
				start_resistance = BUF
			}
		}

		ai_will_do = {
			base = 10
		}
	}

	EQS_end_elder_infiltration_in_state = {
		icon = generic_operation

		priority = 10

		state_target = europe

		on_map_mode = map_and_decisions_view

		target_array = EQS.core_states

		target_trigger = {
			FROM = {
				BUF_state_is_southwestern_territory = yes
				NOT = {
					is_core_of = EQS
				}
			}
		}

		allowed = {
			original_tag = EQS
		}
		visible = {
			FROM = {
				any_neighbor_state = {
					is_core_of = EQS
				}
			}
		}
		
		cancel_if_not_visible = yes

		custom_cost_trigger = {
			command_power > 35
			has_political_power > 35
		}
		custom_cost_text = BUF_prepare_elder_infiltration_in_state_cost_dynamic_cp_pp
		ai_hint_pp_cost = 35
		
		days_remove = 30

		available = {
			FROM = {
				any_neighbor_state = {
					is_core_of = EQS
				}
			}
		}

		complete_effect = {
			#Cost
			hidden_effect = {
				add_command_power = -35
				add_political_power = -35
			}
		}

		remove_effect = {
			FROM = {	
				add_core_of = EQS
				remove_core_of = BUF
				force_disable_resistance = BUF
				cancel_resistance = yes
			}
		}

		ai_will_do = {
			base = 10
		}
	}

}