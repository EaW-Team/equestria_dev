NCH_spy_game= {
	
	NCH_inevitable_crisis = {

		priority = 10

		icon = generic_ignite_civil_war

		days_mission_timeout = 280

		fire_only_once = yes

		available = {
			OR = { #needs a tooltip, either 7 trade partners or 2 nations rejected
				check_variable = { NCH_trade_partners_iter > 7 }
				check_variable = { NCH_trade_refusals > 1 }
			}
		}

		allowed = {
			original_tag = NCH
		}

		activation = {
			has_country_flag = NCH_start_trading_flag
			NOT = { has_global_flag = NCH_crisis_flag }
		}

		cancel_if_not_visible = yes

		is_good = no

		timeout_effect = {
			country_event = greneclyf_trade.34
		}

		complete_effect = {
			country_event = greneclyf.28
		}
	}
	
	NCH_infiltrate_FBK = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				455 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				455 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				455 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				455 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = FBK
			}
		}

		targets = { FBK }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_our_old_friends }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				455 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 455
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 455.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_our_old_friends }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			455 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_BAK = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				649 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				649 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				649 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				649 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = BAK
			}
		}

		targets = { BAK }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_bakara }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				649 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 649
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 649.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_bakara }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			649 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_DEP = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				544 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				544 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				544 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				544 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = DEP
			}
		}

		targets = { DEP }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_deponya }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				544 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 544
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 544.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_deponya }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			544 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_DMT = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				637 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				637 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				637 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				637 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = DMT
			}
		}

		targets = { DMT }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_diamond_dogs }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				637 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 637
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 637.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_diamond_dogs }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			637 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_FRE = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				580 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				580 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				580 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				580 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = FRE
			}
		}

		targets = { FRE }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag		
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				580 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}
		
		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag	
			NOT = { has_completed_focus = NCH_trade_ponaidhean }
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 580
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 580.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			580 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_LCT = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				387 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				387 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				387 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				387 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}

		target_trigger = {
			FROM = {
				tag = LCT
			}
		}

		targets = { LCT }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_lake_city }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				387 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 387
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 387.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_lake_city }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			387 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_NIM = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				645 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				645 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				645 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				645 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = NIM
			}
		}

		targets = { NIM }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_nimbusia }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				645 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 645
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 645.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_nimbusia }	
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			645 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_RCT = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				619 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				619 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				619 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				619 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = RCT
			}
		}

		targets = { RCT }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_river_republic }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				619 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 619
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 619.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_river_republic }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			619 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}

	NCH_infiltrate_WIT = {

		icon = {
			key = nch_spylevel_none
			trigger = {
				617 = {
					check_variable = { var = NCH_spylevel value = 0 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_weak
			trigger = {
				617 = {
					check_variable = { var = NCH_spylevel value = 1 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_strong
			trigger = {
				617 = {
					check_variable = { var = NCH_spylevel value = 2 compare = equals }
				}
			}
		}
		icon = {
			key = nch_spylevel_total
			trigger = {
				617 = {
					check_variable = { var = NCH_spylevel value = 3 compare = equals }
				}
			}
		}
		
		target_trigger = {
			FROM = {
				tag = WIT
			}
		}

		targets = { WIT }
		
		target_root_trigger = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_wittenland }			
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = NCH_increase_spylevel_trigger_tt
				617 = { check_variable = { var = NCH_spylevel value = 3 compare = less_than } }
			}
			NOT = {
				has_country_flag = NCH_already_expanding_influence_flag
			}
		}

		highlight_states = { 
			highlight_state_targets = {
				state = 617
			}
		}

		on_map_mode = map_and_decisions_view

		cost = 617.NCH_spylevel_cost?10

		fire_only_once = no

		days_remove = 14

		visible = {
			NOT = { has_global_flag = NCH_crisis_flag }
			has_country_flag = NCH_start_trading_flag
			has_country_flag = NCH_spy_game_flag
			NOT = { has_completed_focus = NCH_trade_wittenland }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = NCH_already_expanding_influence_flag
		}

		remove_effect = {
			617 = {
				if = {
					limit = { check_variable = { NCH_spylevel = 0 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.6
					}				
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 1 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.7
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 2 } }
					NCH = {
						custom_effect_tooltip = NCH_expand_influence_tt
						country_event = greneclyf_spy_game.8
					}
				}
				else_if = {
					limit = { check_variable = { NCH_spylevel = 3 } }
					custom_effect_tooltip = NCH_maxed_out_influence
				}
				hidden_effect = {
					if = {
						limit = { check_variable = { NCH_spylevel < 3 } }
						
						add_to_variable = { var = NCH_spylevel value = 1 }
					}
					NCH_spylevel_tooltip = yes
					NCH_spylevel_cost_calculation = yes
				}
			}
			clr_country_flag = NCH_already_expanding_influence_flag
		}
		
		cancel_effect = {
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = NCH_already_expanding_influence_flag
					}
					clr_country_flag = NCH_already_expanding_influence_flag
				}
			}
		}

		ai_will_do = {
			base = 110
			modifier = {
				is_historical_focus_on = yes
				factor = 10
			}
		}
	}
}

NCH_trade_crisis = {
	NCH_trade_crisis_timer = {

		priority = 10

		icon = generic_ignite_civil_war

		days_mission_timeout = 60

		fire_only_once = yes

		available = {
			has_country_flag = NCH_Crisis_Solved
		}

		allowed = {
			original_tag = NCH
		}

		activation = {
			has_global_flag = NCH_crisis_flag
			NOT = { has_country_flag = NCH_Crisis_Solved }
		}

		cancel_if_not_visible = yes

		is_good = no

		timeout_effect = {
			country_event = greneclyf_trade_crisis.10
		}

		complete_effect = {
			custom_effect_tooltip = NCH_crisis_solve_tooltip
		}
	}
}

#NCH_coach_oiren = {
#
#	icon = generic_army_support
#
#	allowed = {
#		original_tag = NCH
#	}
#	available = {
#		has_country_leader = { ruling_only = yes name = "Queen Oiren" }
#	}
#	visible = {
#		has_country_leader = { ruling_only = yes name = "Queen Oiren" }
#	}
#	cost = 0
#	fire_only_once = yes
#	ai_will_do = {
#		factor = 1
#	}
#	complete_effect = {
#		
#		add_war_support = 0.1
#		add_stability = -0.05
#	}
#}

Remove_NCH_trade_category = {
	Remove_NCH_trade = {
		icon = decision_infiltrate_state

		cost = 50
		ai_will_do = {

			factor = 1

			modifier = {
				has_idea = NCH_trading_with_NCH_harmonic
				factor = 0.01
			}
			modifier = {
				has_idea = NCH_trading_with_NCH_fascist
				factor = 80
			}
		}


		fire_only_once = yes

		visible = {
			is_trading_with_NCH = yes
		}
		target_root_trigger = {
			is_trading_with_NCH = yes
		}
		targets = { NCH }
		target_trigger = {
			FROM = { tag = NCH }
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision Remove_NCH_trade target: [From.GetName]"
			if = {
				limit = {
					has_idea = NCH_trading_with_NCH_harmonic
				}
				remove_ideas = NCH_trading_with_NCH_harmonic
			}

			if = {
				limit = {
					has_idea = NCH_trading_with_NCH_fascist
				}
				remove_ideas = NCH_trading_with_NCH_fascist
			}

			remove_opinion_modifier = {
				modifier = NCH_negative_trading target = FROM
			}
			remove_opinion_modifier = {
				modifier = trading target = FROM
			}

			FROM = {
				country_event = greneclyf.61
				hidden_effect = {
					add_to_variable = {
						var = NCH_trade_partners_iter
						value = -1
					}
					add_to_variable = { var = NCH_trade_refusals value = 1 }
				}
				NCH_get_trading_idea = yes
			}
		}
	}
}

NCH_crisis_category = {
	NCH_crisis = {
		icon = griffon_bandits
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			check_variable = {
				var = NCH_Crisis_Resolve_Points
				value = 4
				compare = equals
			}
		}
		activation = {
			has_country_flag = NCH_having_crisis_flag
		}
		is_good = no
		days_mission_timeout = 140
		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout NCH_crisis"
			country_event = greneclyf_crisis.24
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision NCH_crisis"
			country_event = greneclyf_crisis.25
		}
	}
}

NCH_key_to_success = { 

	NCH_steel_bugsmere = {
		icon = steel
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation2 
		}

		highlight_states = {
			highlight_state_targets = {
				state = 669
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = steel
				amount = 3
				state = 669
			}
		}
	}

	NCH_steel_moonshine = {
		icon = steel
		cost = 30
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation2 
			has_completed_focus = NCH_unite_the_economies
		}

		highlight_states = {
			highlight_state_targets = {
				state = 603
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = steel
				amount = 6
				state = 603
			}
		}
	}

	NCH_tung_ochme = {
		icon = tungsten
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation2 
			has_completed_focus = NCH_unite_the_economies
		}

		highlight_states = {
			highlight_state_targets = {
				state = 572
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = tungsten
				amount = 2
				state = 572
			}
		}
	}

	NCH_alum_blosmport = {
		icon = aluminium
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation3
		}

		highlight_states = {
			highlight_state_targets = {
				state = 670
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = aluminium
				amount = 4
				state = 670
			}
		}
	}

	NCH_chrom_bugsmere = {
		icon = chromium
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation3
		}

		highlight_states = {
			highlight_state_targets = {
				state = 669
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = chromium
				amount = 4
				state = 669
			}
		}
	}

	NCH_steel_losthope = {
		icon = steel
		cost = 50
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation3 
			has_completed_focus = NCH_unite_the_economies
		}

		highlight_states = {
			highlight_state_targets = {
				state = 569
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = steel
				amount = 10
				state = 569
			}
		}
	}

	NCH_alum_losthope = {
		icon = aluminium
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation4
			has_completed_focus = NCH_unite_the_economies
		}

		highlight_states = {
			highlight_state_targets = {
				state = 569
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = aluminium
				amount = 4
				state = 569
			}
		}
	}

	NCH_tung_losthope = {
		icon = tungsten
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
		available = {
			has_tech = excavation4
			has_completed_focus = NCH_unite_the_economies
		}

		highlight_states = {
			highlight_state_targets = {
				state = 569
			}
		}

		days_remove = 7 #subject to change

		modifier = { #subject to change
			civilian_factory_use = 2 
		}
		
		remove_effect = {
			add_resource = {
				type = tungsten
				amount = 3
				state = 569
			}
		}
	}

}

### TODO - ADD ICONS

NCH_restoring_cenhelm = {

	NCH_planning_restoration = {
		icon = scroll
		allowed = { tag = NCH }
		fire_only_once = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision NCH_planning_restoration"
			ROOT = {
				country_event = {
					id = greneclyf_FBK_radical.2
					days = 1 
				}
			}
			set_country_flag = NCH_FBK_liberation_plan #the plan should probably be available only after a while and not when you execute the decision
		}
	}

	NCH_prepare_the_army = {
		icon = generic_prepare_civil_war
		cost = 15
		allowed = { tag = NCH }
		fire_only_once = yes

		available = {
			has_country_flag = NCH_FBK_liberation_plan
		}
	
		modifier = {
			max_planning_factor = 0.1
			planning_speed = 0.1
		}

		days_remove = 45

		remove_effect = {
			custom_effect_tooltip = NCH_army_prepared_flag
			set_country_flag = NCH_army_prepared_flag
		}
	}

	NCH_prepare_the_navy = {
		icon = generic_naval
		cost = 15
		allowed = { tag = NCH }
		fire_only_once = yes

		available = {
			has_country_flag = NCH_FBK_liberation_plan
		}
	
		modifier = {
			naval_invasion_planning_bonus_speed = 0.3
		}

		days_remove = 21

		remove_effect = {
			custom_effect_tooltip = NCH_navy_prepared_flag
			set_country_flag = NCH_navy_prepared_flag
		}
	}

	NCH_FBK_liberation = {
		icon = generic_nationalism
		cost = 30
		allowed = { tag = NCH }
		fire_only_once = yes

		available = {
			has_country_flag = NCH_army_prepared_flag
			has_country_flag = NCH_navy_prepared_flag
		}

		days_remove = 21
	
		remove_effect = {
			ROOT = {
				create_wargoal = {
					type = topple_government
					target = FBK
				}
				declare_war_on = {
					target = FBK
					type = topple_government
				}
			}
			hidden_effect = {
				ROOT = {
					country_event = {
						id = greneclyf_FBK_radical.3
						days = 7
					}
				}
				set_variable = { NCH_casualties = casualties }
				set_global_flag = NCH_radical_FBK_war
			}
		}

		war_with_on_remove = FBK
	}

}

NCH_investments_in_FBK = {

	NCH_connect_dogtown = {
		icon = railroad
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
	
		modifier = {
			civilian_factory_use = 2
		}

		days_remove = 30

		remove_effect = {
			build_railway = {
				level = 1
				build_only_on_allied = yes
				fallback = yes
				path = { 7737 4849 4576 12421 }
				start_province = 7737
				target_province = 12421
			}
		}
	}

	NCH_connect_blackwater = {
		icon = railroad
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
	
		modifier = {
			civilian_factory_use = 2
		}

		days_remove = 30

		remove_effect = {
			build_railway = {
				level = 1
				build_only_on_allied = yes
				fallback = yes
				path = { 3962 4067 4153 12352 10512 12493 12056 12421 }
				start_province = 3962
				target_province = 12421
			}
			set_country_flag = NCH_blackwater_connected
		}
	}

	NCH_connect_losthope = {
		icon = railroad
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes

		available = {
			has_country_flag = NCH_blackwater_connected
		}
	
		modifier = {
			civilian_factory_use = 2
		}

		days_remove = 30

		remove_effect = {
			build_railway = {
				level = 1
				build_only_on_allied = yes
				fallback = yes
				path = { 4074 7659 7314 10880 9865 11847 9859 3962 }
				start_province = 4074
				target_province = 3962
			}
		}
	}

	NCH_farbrook_buildup = {
		icon = generic_factory
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
	
		modifier = {
			civilian_factory_use = 3
		}

		days_remove = 30

		remove_effect = {
			455 = {
				if = {
					limit = {
						free_building_slots = {
							building = industrial_complex
							size < 4
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 4
				}
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
				add_building_construction = {
					type = dockyard
					level = 2
					instant_build = yes
				}
			}
		}
	}

	NCH_dogtown_buildup = {
		icon = generic_factory
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
	
		modifier = {
			civilian_factory_use = 3
		}

		days_remove = 30

		remove_effect = {
			603 = {
				if = {
					limit = {
						free_building_slots = {
							building = industrial_complex
							size < 2
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 2
				}
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
	}
	
	NCH_blackwater_buildup = {
		icon = generic_factory
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
	
		modifier = {
			civilian_factory_use = 3
		}

		days_remove = 30

		remove_effect = {
			571 = {
				if = {
					limit = {
						free_building_slots = {
							building = industrial_complex
							size < 2
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 2
				}
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = dockyard
					level = 1
					instant_build = yes
				}
			}
		}
	}

	NCH_losthope_buildup = {
		icon = generic_factory
		cost = 25
		allowed = { tag = NCH }
		fire_only_once = yes
	
		modifier = {
			civilian_factory_use = 3
		}

		days_remove = 30

		remove_effect = {
			569 = {
				if = {
					limit = {
						free_building_slots = {
							building = industrial_complex
							size < 2
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 2
				}
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
				add_building_construction = {
					type = dockyard
					level = 1
					instant_build = yes
				}
			}
		}
	}
}