@STG_DW_REGION_FILL = 3
@STG_DW_REGION_SELECT = 1
@STG_DW_REGION_HOME = 2

scripted_gui = {
	stg_politics_sgui_1 = {
		context_type = decision_category
		window_name = "stg_politics_sgui_1_window"
	}
	
	stg_politics_sgui_2 = {
		context_type = decision_category
		window_name = "stg_politics_sgui_2_window"
	}
	
	
	
	# stg_hunger_sgui = {
	# 	context_type = decision_category
	# 	window_name = "stg_hunger_pb_cat"
		
	# 	properties = {
	# 		hunger_level_stg = {
	# 			frame = hunger_level_100
	# 		}
	# 	}
	# }
	
	stg_politics_parties_gui = {
		context_type = decision_category
		window_name = "stg_politics_parties_gui_win"
		
		properties = {
			STG_left_op_pb = { 
				frame = STG_left_opposition_support 
			}
			STG_centre_op_pb = {
				frame = STG_main_party_support
			}
			STG_right_op_pb = {
				frame = STG_right_opposition_support
			}
		}
	}

	stg_agitprop_ui = {
		context_type = decision_category
		window_name = "stg_propaganda_campaigns_ui_window"
		
		dynamic_lists = { 	
			propaganda_slots_grid = {
				array = STG_agitprop_posters_array
				entry_container = stg_propaganda_slot_entry
				value = STG_agit_value
				index = STG_agit_index
			}
			
		}
		
		triggers = {
			STG_prop_poster_aged_overlay_visible = {
				check_variable = { STG_array_aging^STG_agit_index > 0 }
			}
		}
			
		properties = {
			STG_prop_poster = {
				image = GFX_STG_poster_[?STG_agit_value]
			}
			STG_prop_poster_aged_overlay = {
				image = GFX_STG_poster_overlay_[?STG_array_aging^STG_agit_index]
			}
		}
	}

	STG_DW_reforms_gui = {
		window_name = "STG_DW_reforms_gui_win"
		context_type = decision_category
		#context_type = player_context

		dirty = STD_DW_update_reform_gui

		visible = {
			has_country_flag = STG_DW_minigame_enabled
		}
	}

	STG_DW_regional_influence_gui = {
		window_name = "STG_DW_regional_influence_gui_win"
		context_type = player_context
		#context_type = decision_category

		dirty = STG_DW_update_regional_influence_gui

		visible = {
			has_country_flag = STG_DW_minigame_regional_influence_enabled
		}

		dynamic_lists = {
			STG_DW_region_gridbox = {
				array = STG_DW_regions_array
				index = STG_DW_region_index
				value = STG_DW_region_value
				change_scope = no
				entry_container = STG_DW_regional_influence_region_win
			}

			STG_DW_region_list_gridbox = {
				array = STG_DW_region_list_array
				index = STG_DW_region_list_index
				value = STG_DW_region_list_value
				change_scope = no
				entry_container = "STG_DW_regional_influence_information_[?STG_DW_region_list_id]_win"
			}
		}

		triggers = {
			region_button_visible = {
				always = yes
				set_temp_variable = { temp_region_frame = STG_DW_regions_array^STG_DW_region_index }
				multiply_temp_variable = { temp_region_frame = 255 }
				divide_temp_variable = { temp_region_frame = 100 }
				round_temp_variable = temp_region_frame
				multiply_temp_variable = { temp_region_frame = 4 }
				if = {
					limit = {
						check_variable = { STG_DW_region_index = STG_DW_region_selected }
					}

					add_to_temp_variable = { temp_region_frame = @STG_DW_REGION_SELECT }
				} else_if = {
					limit = {
						check_variable = { STG_DW_region_index = 0 }
					}

					add_to_temp_variable = { temp_region_frame = @STG_DW_REGION_HOME }
				} else = {
					add_to_temp_variable = { temp_region_frame = @STG_DW_REGION_FILL }
				}
				add_to_temp_variable = { temp_region_frame = 1 }
			}

			# Details window visible
			details_background_visible = {
				has_country_flag = STG_DW_building_description_visible
			}
			details_building_icon_visible = {
				has_country_flag = STG_DW_building_description_visible
			}
			details_building_name_visible = {
				has_country_flag = STG_DW_building_description_visible
			}
			details_building_desc_visible = {
				has_country_flag = STG_DW_building_description_visible
			}

		}

		properties = {
			region_button = {
				image = "GFX_STG_DW_reform_region_[?STG_DW_region_index]"
				frame = temp_region_frame
			}

			building_entry_button = {
				image = "GFX_STG_DW_reform_building_[?STG_DW_region_list_value]"
				frame = 1
			}

			details_building_icon = {
				image = "GFX_STG_DW_reform_building_[?STG_DW_details_building_id]"
			}
		}

		effects = {
			region_button_click = {
				if = {
					limit = {
						check_variable = { STG_DW_region_selected = STG_DW_region_index }
					}

					set_variable = { STG_DW_region_selected = -1 }
					STG_DW_display_region_list_f = yes
				} else = {
					set_variable = { STG_DW_region_selected = STG_DW_region_index }
					STG_DW_display_building_list_f = yes
					STG_DW_get_available_building_slot_f = yes
				}

				if = {
					limit = {
						check_variable = { STG_DW_region_selected = -1 }
					}
					set_temp_variable = { temp_region_id = 99 }
				} else = {
					set_temp_variable = { temp_region_id = STG_DW_region_selected }
				}
				meta_effect = {
					text = {
						set_variable = {
							STG_DW_selected_region_displayed_name = token:STG_DW_reform_region_name_[REGION_ID]
						}
					}

					REGION_ID = "[?temp_region_id]"
				}
				
				add_to_variable = { STG_DW_update_regional_influence_gui = 1 }
			}

			information_select_button_click = {
				set_variable = { STG_DW_region_selected = STG_DW_region_list_index }
				STG_DW_display_building_list_f = yes
				STG_DW_get_available_building_slot_f = yes
			}

			building_entry_button_click = {
				if = {
					limit = {
						has_country_flag = STG_DW_building_description_visible
						check_variable = { STG_DW_details_building_id = STG_DW_region_list_value }
					}

					clr_country_flag = STG_DW_building_description_visible
				} else = {

					set_country_flag = STG_DW_building_description_visible
					set_variable = { STG_DW_details_building_id = STG_DW_region_list_value }
				}

				add_to_variable = { STG_DW_update_regional_influence_gui = 1 }
			}

			building_entry_button_shift_click = {
				if = {
					limit = {
						is_debug = yes
					}

					if = {
						limit = {
							check_variable = { STG_DW_region_list_value = 3 }
						}

						set_variable = { STG_DW_region_list_array^STG_DW_region_list_index = 0 }
					} else = {
						add_to_variable = { STG_DW_region_list_array^STG_DW_region_list_index = 1 }
					}
				}

				add_to_variable = { STG_DW_update_regional_influence_gui = 1 }
			}
		}
	}
	
	STG_karamelka_reforms_gui = {
		
		context_type = decision_category
		window_name = "stg_caramelka_reforms_window"
		
		properties = {
			reforms_needle = {
				frame = STG_reforms_needle_frame
			}
			reforms_value = {
				frame = STG_reforms_needle_frame
			}
		}
	}
	
	STG_COMECON_gui = {
	
		context_type = decision_category
		window_name = "stg_comecon_window"
		
		dynamic_lists = {
			STG_COMECON_majors_list = {
				array = STG_COMECON_majors_array
				entry_container = STG_CC_major_entry
				value = scc_major_value
				index = scc_major_index
				change_scope = yes 
			}
			STG_COMECON_minors_list = {
				array = STG_COMECON_minors_array
				entry_container = STG_CC_minor_entry
				value = scc_minor_value
				index = scc_minor_index
				change_scope = yes 
			}
		}
		
		properties = {
			STG_CC_major_flag = {
				image = "[?scc_major_value.GetFlag]"
			}
			STG_CC_minor_flag = {
				image = "[?scc_minor_value.GetFlag]"
			}
		}
		
		effects = {
		
		}
		
		triggers = {
		
		}	
	}
	
	STG_comecon_btn_gui = {
		
		context_type = player_context
		window_name = "stg_comecon_panel_gui"
		parent_window_name = "MapmodesInterface_Ingame"
		
		visible = {
			has_country_flag = available_comecon_flag
		}
		
		effects = {
			stg_comecon_control_click = {
				if = {
					limit = {
						has_country_flag = stg_comecon_is_visible
					}
					clr_country_flag = stg_comecon_is_visible
				}
				else = { 
					set_country_flag = stg_comecon_is_visible 
				}
			}
		}
		
	}
	
	STG_alert_scripted_gui = {
		context_type = player_context
		window_name = "stg_comecon_available_decisions_alert"
		
		visible = {
			STG_has_available_sev_decisions = yes 
		}
		
		effects = {
			stg_sev_decision_alert_right_click = {
				set_country_flag = { flag = comecon_alert_hidden value = 1 days = 30 }
			}
			stg_sev_decision_alert_click = {
				set_country_flag = stg_comecon_is_visible
			}
		}
		
		
	}
	
	STG_comecon_scripted_gui = {
	
		context_type = player_context
		window_name = "STG_comecon_container_main"
		
		visible = {
			has_country_flag = stg_comecon_is_visible
		}
		
		dynamic_lists = {
			STG_COMECON_majors_list = {
				array = STG.STG_comecon_majors_list
				entry_container = STG_CC_major_entry
				value = scc_major_value
				index = scc_major_index
				change_scope = yes 
			}
			STG_COMECON_minors_list = {
				array = STG.STG_comecon_minors_list
				entry_container = STG_CC_minor_entry
				value = scc_minor_value
				index = scc_minor_index
				change_scope = yes 
			}
			STG_COMECON_decisions_list = {
				array = STG.STG_comecon_categories_array
				entry_container = STG_CC_category_entry
			}
			STG_COMECON_decisions_heavyeq_list = {
				array = STG.STG_comecon_categories_heavyeq_array
				entry_container = STG_CC_category_entry
			}
			STG_COMECON_decisions_misc_list = {
				array = STG.STG_comecon_categories_misc_array
				entry_container = STG_CC_decision_entry
			}
		}
		properties = {
			STG_CC_major_flag = {
				image = "[?scc_major_value.GetFlag]"
			}
			STG_CC_minor_flag = {
				image = "[?scc_minor_value.GetFlag]"
			}
			STG_comecon_progress_l2 = {
				frame = "STG.STG_comecon_progress_l2_var"
			}
			STG_comecon_progress_l3 = {
				frame = "STG.STG_comecon_progress_l3_var"
			}
			STG_comecon_progress_l4 = {
				frame = "STG.STG_comecon_progress_l4_var"
			}
			STG_comecon_progress_l5 = {
				frame = "STG.STG_comecon_progress_l5_var"
			}
		}
		effects = {
			STG_CC_category_click = {
				STG_sev_lock_deicision_effect = yes 
				meta_effect = {
					text = {
						STG_sev_effect_[X] = yes 
					}
					X = "[?v]"
				}
			}
			STG_CC_decision_click = {
				STG_sev_lock_deicision_effect = yes 
				meta_effect = {
					text = {
						STG_sev_effect_[X] = yes 
					}
					X = "[?v]"
				}
				force_update_dynamic_modifier = yes 
			}
			
			STG_debug_levels_effect_click = {
				add_to_variable = { comecon_current_xp = 51 }
				STG_add_frames = yes 
				if = {
					limit = {
						check_variable = { var = comecon_current_xp value = comecon_xp_to_lvl compare = greater_than_or_equals }
					}
					STG_lvlup_comecon = yes 
				}
				
			}
		}
		
		triggers = {
			STG_CC_category_click_enabled = {
				STG_check_actual_cat_flags = yes 
			}
			STG_CC_decision_click_enabled = {
				STG_check_actual_cat_flags = yes 
			}
			STG_debug_levels_effect_visible = {
				is_debug = yes 
			}
		}
	}
	
	STG_equestrian_revolution_gui = {
		
		context_type = decision_category
		window_name = "STG_eqrev_window"
		
		dynamic_lists = {
			STG_eqsrev_selector = {
				array = STG.STG_rev_targets
				entry_container = STG_eqsrev_selector_btn
				value = v
				index = i
			}
		}
		
		effects = {
			STG_eqsrev_select_state_click = {
				set_variable = { STG_rev_target_state = v }
			}
		}
		
		properties = {
			STG_eqsrev_frame_target = {
				image = "[STGGetRevolutionTarget]"
				frame = STG_rev_target_state:rev_chance_frame
			}
			STG_eqsrev_target_labor_strength = {
				frame = STG_rev_target_state:eqsrev_labor_strength
			}
			STG_eqsrev_target_pop_support = {
				frame = STG_rev_target_state:eqsrev_population_support
			}
			STG_eqsrev_target_royal_resistance = {
				frame = STG_rev_target_state:eqsrev_royal_power
			}
		}
		
	}

	#==============================#
	### Karamelka's advisors GUI ###
	#==============================#
	# Made by Scars

	stg_Karamelkas_Advisors = {
		context_type = decision_category
		window_name = "STG_Karamelkas_Advisors"
		dirty = KRMLK_dirty

		dynamic_lists = {
			advisors_gridbox = {
				array = KRMLK_active_advisors
				entry_container = stg_advisors_entry
				value = advisor_v
				index = advisor_i
			}
		}

		triggers = {
			glow_visible = {
				has_variable = KRMLK_currently_selecting_index
				check_variable = { KRMLK_currently_selecting_index = advisor_i }
			}
		}

		properties = {
			advisor = {
				x = KRMLK_advisors_x^advisor_i
				y = KRMLK_advisors_y^advisor_i
				image = "GFX_[?advisor_v.GetTokenKey]"
			}
			glow = {
				x = KRMLK_advisors_x^advisor_i
				y = KRMLK_advisors_y^advisor_i
			}
		}

		effects = {
			advisor_click = {
				if = {
					limit = {
						check_variable = { advisor_v = token:STG_KRMLK_no_advisor }
					}
					set_variable = { KRMLK_currently_selecting_index = advisor_i }
				}
				add_to_variable = { KRMLK_dirty = 0.01 }
			}
		}
	}
	stg_Karamelkas_Advisors_Select_Outside = {
		context_type = player_context
		window_name = STG_Karamelkas_Advisors_Select_Outside
	}
	stg_Karamelkas_Advisors_Select = {
		context_type = player_context
		window_name = STG_Karamelkas_Advisors_Select
		parent_window_name = STG_Karamelkas_Advisors_Select_Outside
		dirty = KRMLK_dirty
		visible = { has_variable = KRMLK_currently_selecting_index }
		dynamic_lists = {
			select_advisors_gridbox = {
				array = KRMLK_available_advisors
				entry_container = "stg_advisors_selection_entry"
				value = selection_v
				index = selection_i
			}
		}
		properties = {
			icon = {
				image = "GFX_[?selection_v.GetTokenKey]"
			}
		}
		effects = {
			button_click = {
				set_variable = { KRMLK_active_advisors^KRMLK_currently_selecting_index = selection_v }
				add_ideas = token:selection_v
				remove_from_array = { KRMLK_available_advisors = selection_v }

				clear_variable = KRMLK_currently_selecting_index
				add_to_variable = { KRMLK_dirty = 0.01 }
			}

			close_button_click = {
				clear_variable = KRMLK_currently_selecting_index
				add_to_variable = { KRMLK_dirty = 0.01 }
			}
		}
	}
}