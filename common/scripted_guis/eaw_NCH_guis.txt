scripted_gui = {
	NCH_republican_gui = {
		context_type = decision_category
		window_name = "NCH_republican_gui_window"

		visible = {
			has_country_flag = NCH_republican_decisions
		}

		properties = {
			cader_portrait = {
				frame = cader_gui_frames
			}
			fennore_portrait = {
				frame = fennore_gui_frames
			}
			eolan_portrait = {
				frame = eolan_gui_frames
			}
		}
	}
	animated_flag_ui_medium_diplo = {
		window_name = "animated_flag_ui_medium_diplo"
		context_type = selected_country_context
		parent_window_name = countrydiplomacyview
			 
		visible = {
			has_country_flag = NCH_sunderer_burning_flag
		}
	}
	animated_flag_ui = {
		window_name = "animated_flag"
		context_type = player_context
			 
		visible = {
			has_country_flag = NCH_sunderer_burning_flag
		}  
	}
	miracle_mana_ui = {
		window_name = "miracle_mana_window"
		context_type = player_context
		parent_window_name = top_bar

		visible = {
			has_country_flag = NCH_miracles_enabled
		}
	}
	wrath_mana_ui = {
		window_name = "wrath_mana_window"
		context_type = player_context
		parent_window_name = top_bar

		visible = {
			has_country_flag = NCH_hatred_enabled
		}
	}
	miracle_menu_open_button = {
		window_name = "miracle_menu_button"
		context_type = player_context
		parent_window_name = top_bar

		visible = {
			has_country_flag = NCH_miracles_enabled
		}

		effects = {
			miracle_starting_list_button_type_click = {
				if = {
					limit = {
						NOT = {
							has_country_flag = NCH_miracle_menu_opened
						}
						has_country_flag = NCH_slana_start_decisions
					}
					set_country_flag = NCH_miracle_menu_opened
					set_country_flag = NCH_miracle_menu_opened_once
				}
				else_if = {
					limit = {
						has_country_flag = NCH_miracle_menu_opened
					}
					clr_country_flag = NCH_miracle_menu_opened
				}
			}
		}
	}
	miracle_menu_alert = {
		window_name = "miracle_menu_button_alert"
		context_type = player_context

		visible = {
			NOT = { has_country_flag = NCH_miracle_menu_opened_once }
			has_country_flag = NCH_slana_start_decisions
		}
	}
	miracle_menu = {
		window_name = "miracle_menu"
		context_type = player_context

		visible = {
			has_country_flag = NCH_miracle_menu_opened
			has_country_flag = NCH_slana_start_decisions
		}

		effects = {
			miracle_close_button_click = {
				clr_country_flag = NCH_miracle_menu_opened
			}
			miracle_industry_of_the_faithful_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_industry_of_the_faithful
				}
				hidden_effect = {
					unlock_national_focus = NCH_industry_of_the_faithful
				}
				set_country_flag = NCH_industry_of_the_faithful_slana
				random_core_state = {
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = industrial_complex
						level = 4
						instant_build = yes
					}
				}
				custom_effect_tooltip = NCH_150_days_timer_tt
				effect_tooltip = {
					if = {
						limit = {
							has_idea = pre_industrial_society
						}
						swap_ideas = {
							remove_idea = pre_industrial_society
							add_idea = outdated_industry
						}
					}
					else = {
						swap_ideas = {
							remove_idea = outdated_industry
							add_idea = modern_society
						}
					}
				}
				country_event = {
					id = greneclyf_sunderer.12
					days = 150
				}
			}
			miracle_educate_the_masses_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_educate_the_masses
				}
				hidden_effect = {
					unlock_national_focus = NCH_educate_the_masses
				}
				custom_effect_tooltip = NCH_100_days_timer_tt
				effect_tooltip = {
					add_manpower = 2500
					if = {
						limit = {
							has_idea = lack_of_scientists1
						}
						swap_ideas = {
							remove_idea = lack_of_scientists1
							add_idea = lack_of_scientists2
						}
					}
					else_if = {
						limit = {
							has_idea = lack_of_scientists2
						}
						swap_ideas = {
							remove_idea = lack_of_scientists2
							add_idea = lack_of_scientists3
						}
					}
					else = {
						swap_ideas = {
							remove_idea = lack_of_scientists3
							add_idea = no_lack_of_scientists
						}
					}
				}
				hidden_effect = {
					NCH = {
						country_event = {
							id = greneclyf_development.3
							days = 100
						}
					}
				}
				set_country_flag = NCH_educate_the_masses_cast
			}
			miracle_tackling_poverty_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_tackling_poverty
				}
				hidden_effect = {
					unlock_national_focus = NCH_tackling_poverty
				}
				custom_effect_tooltip = NCH_100_days_timer_tt
				effect_tooltip = {
					add_manpower = 3500
					if = {
						limit = {
							has_idea = poverty3
						}
						swap_ideas = {
							remove_idea = poverty3
							add_idea = poverty4
						}
					}
					else_if = {
						limit = {
							has_idea = poverty4
						}
						swap_ideas = {
							remove_idea = poverty4
							add_idea = poverty5
						}
					}
					else = {
						swap_ideas = {
							remove_idea = poverty5
							add_idea = no_poverty
						}
					}
					if = {
						limit = {
							has_country_flag = NCH_slana_has_eolans_support
						}
						effect_tooltip = {
							unlock_national_focus = NCH_the_private_beneficiaries
						}
					}
				}
				set_country_flag = NCH_slana_tackled_poverty
				hidden_effect = {
					NCH = {
						country_event = {
							id = greneclyf_development.4
							days = 100
						}
					}
				}
				set_country_flag = NCH_taclking_poverty_cast
			} 
			miracle_elicit_eolans_support_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_elicit_eolans_support
				}
				hidden_effect = {
					unlock_national_focus = NCH_elicit_eolans_support
				}
				if = {
					limit = {
						has_country_flag = NCH_slana_tackled_poverty
					}
					clr_country_flag = NCH_slana_tackled_poverty
					set_country_flag = NCH_sunderer_dealth_with_poverty_and_eolan
					effect_tooltip = {
						unlock_national_focus = NCH_the_private_beneficiaries
					}
				}
				else = {
					set_country_flag = NCH_slana_has_eolans_support
				}
				country_event = {
					id = greneclyf_sunderer.26
					days = 0
				}
				add_advisor_role = {
					character = NCH_eolan
					activate = no
					advisor = {
						slot = political_advisor
						cost = 150
						idea_token = NCH_eolan
						traits = {
							NCH_big_shot_of_blosmport
						}
					}
				}
				custom_effect_tooltip = NCH_slana_additional_treelet_eolan_tt
				show_ideas_tooltip = NCH_eolan_charity
			}
			miracle_faceoff_with_fennore_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_faceoff_with_fennore
				}
				hidden_effect = {
					unlock_national_focus = NCH_faceoff_with_fennore
				}
				add_political_power = 25
				country_event = {
					id = greneclyf_sunderer.27
					days = 0
				}
				if = {
					limit = {
						has_idea = NCH_blindfold_starting
					}
					remove_ideas = NCH_blindfold_starting
				}
				if = {
					limit = {
						has_idea = NCH_blindfold_pacified
					}
					remove_ideas = NCH_blindfold_pacified
				}
				if = {
					limit = {
						has_idea = NCH_blindfold_unamused
					}
					remove_ideas = NCH_blindfold_unamused
				}
				if = {
					limit = {
						has_idea = NCH_blindfold_angry
					}
					remove_ideas = NCH_blindfold_angry
				}
				add_timed_idea = {
					idea = NCH_fennore_promoting_sunderer_idea
					days = 365
				}
			}
			miracle_finding_feilean_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_finding_felian
				}
				hidden_effect = {
					unlock_national_focus = NCH_finding_felian
				}
				if = {
					limit = {
						has_country_flag = NCH_gytha_dead
					}
					country_event = {
						id = greneclyf_sunderer.28
						days = 1
					}
				}
				else = {
					country_event = {
						id = greneclyf_sunderer.29
						days = 1
					}
				}
			}
			miracle_meeting_murchbagh_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_meeting_murchbagh
				}
				hidden_effect = {
					unlock_national_focus = NCH_meeting_murchbagh
				}
				country_event = {
					id = greneclyf_sunderer.18
					days = 0
				}
				if = {
					limit = {
						NOT = { has_country_flag = NCH_slana_rallied_the_people }
					}
					set_country_flag = NCH_slana_met_with_murchbagh
				}
				if = {
					limit = {
						has_country_flag = NCH_slana_rallied_the_people
					}
					set_country_flag = NCH_let_slana_deal_with_cait_and_rally_the_people
					clr_country_flag = NCH_slana_rallied_the_people
				}
			}
			miracle_rallying_the_people_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_rallying_the_people
				}
				hidden_effect = {
					unlock_national_focus = NCH_rallying_the_people
				}
				custom_effect_tooltip = NCH_100_days_timer_tt
				effect_tooltip = {
					add_manpower = 5000
					if = {
						limit = {
							has_idea = poverty3
						}
						swap_ideas = {
							remove_idea = poverty3
							add_idea = poverty4
						}
					}
					else_if = {
						limit = {
							has_idea = poverty4
						}
						swap_ideas = {
							remove_idea = poverty4
							add_idea = poverty5
						}
					}
					else = {
						swap_ideas = {
							remove_idea = poverty5
							add_idea = no_poverty
						}
					}
				}
				hidden_effect = {
					NCH = {
						country_event = {
							id = greneclyf_development.4
							days = 100
						}
					}
				}
				set_country_flag = NCH_rallying_the_people_cast
			}
			miracle_gathering_the_intelligentsia_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_gathering_the_intelligentsia
				}
				hidden_effect = {
					unlock_national_focus = NCH_gathering_the_intelligentsia
				}
				add_tech_bonus = {
					bonus = 2
					uses = 2
					category = computing_tech
				}
				custom_effect_tooltip = NCH_100_days_timer_tt
				effect_tooltip = {
					if = {
						limit = {
							has_idea = better_science_base
						}
						swap_ideas = {
							remove_idea = better_science_base
							add_idea = big_science_base
						}
					}
					else = {
						swap_ideas = {
							remove_idea = big_science_base
							add_idea = proper_science_base
						}
					}
				}
				hidden_effect = {
					NCH = {
						country_event = {
							id = greneclyf_development.1
							days = 100
						}
					}
				}
			}
			miracle_defeating_illiteracy_button_click = {
				add_political_power = -50
				custom_effect_tooltip = NCH_sunderer_charge_use
				add_to_variable = { NCH_sunderer_charges = -1 }
				effect_tooltip = {
					complete_national_focus = NCH_defeating_illiteracy
				}
				hidden_effect = {
					unlock_national_focus = NCH_defeating_illiteracy
				}
				add_research_slot = 1
				custom_effect_tooltip = NCH_150_days_timer_tt
				effect_tooltip = {
					if = {
						limit = {
							has_idea = lack_of_scientists1
						}
						swap_ideas = {
							remove_idea = lack_of_scientists1
							add_idea = lack_of_scientists2
						}
					}
					else_if = {
						limit = {
							has_idea = lack_of_scientists2
						}
						swap_ideas = {
							remove_idea = lack_of_scientists2
							add_idea = lack_of_scientists3
						}
					}
					else = {
						swap_ideas = {
							remove_idea = lack_of_scientists3
							add_idea = no_lack_of_scientists
						}
					}
				}
			}
		}

		triggers = {
			miracle_industry_of_the_faithful_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_educate_the_masses
				OR = {
					has_completed_focus = NCH_toiling_for_a_nation
					has_completed_focus = NCH_the_private_beneficiaries
				}
				NOT = { has_completed_focus = NCH_industry_of_the_faithful }
			}
			miracle_educate_the_masses_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_adressing_the_economy
				NOT = { has_completed_focus = NCH_educate_the_masses }
			}
			miracle_tackling_poverty_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_adressing_the_economy
				NOT = { has_completed_focus = NCH_tackling_poverty }
			}
			miracle_elicit_eolans_support_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_dealing_with_the_cpm
				NOT = { has_completed_focus = NCH_elicit_eolans_support }
			}
			miracle_faceoff_with_fennore_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_dealing_with_the_cpm
				NOT = { has_completed_focus = NCH_faceoff_with_fennore }
			}
			miracle_finding_feilean_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_handling_the_council_of_royals
				NOT = { has_completed_focus = NCH_finding_felian }
			}
			miracle_meeting_murchbagh_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_handling_the_council_of_royals
				NOT = { has_completed_focus = NCH_meeting_murchbagh }
			}
			miracle_rallying_the_people_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_comforting_the_masses
				NOT = { has_completed_focus = NCH_rallying_the_people }
			}
			miracle_gathering_the_intelligentsia_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				has_completed_focus = NCH_comforting_the_masses
				NOT = { has_completed_focus = NCH_gathering_the_intelligentsia }
			}
			miracle_defeating_illiteracy_button_click_enabled = {
				has_political_power > 49
				NCH_miracle_charges = yes
				OR = {
					has_completed_focus = NCH_reaching_the_masses
					has_completed_focus = NCH_fomenting_a_new_generation
				}
				NOT = { has_completed_focus = NCH_defeating_illiteracy }
			}
			#miracle_faceoff_with_fennore_button_shine_visible = { #MIRACLE MASK VISIBILITY TRIGGER
				#has_political_power > 49
				#NCH_miracle_charges = yes
				#has_completed_focus = NCH_dealing_with_the_cpm
				#NOT = { has_completed_focus = NCH_faceoff_with_fennore }
			#}
		}
	}
}