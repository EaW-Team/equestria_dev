# Contain the scripted gui for the debug interface

scripted_gui = {
	VED_debug_interface_top_button_scripted_gui = {
		window_name = VED_debug_interface_top_button_gui
		parent_window_token = top_bar
		context_type = player_context
		dirty = dummy_never_updated

		visible = {
			has_country_flag = VED_activated_debug_gui
		}

		effects = {
			debug_button_click = {
				if = {
					limit = { has_country_flag = VED_display_debug_interface }
					clr_country_flag = VED_display_debug_interface
				} else = {
					set_country_flag = VED_display_debug_interface
				}
			}
		}
	}

	VED_debug_interface_scripted_gui = {
		window_name = VED_debug_interface_gui
		context_type = player_context
		dirty = VED_debug_interface_update

		dynamic_lists = {
			debug_interface_tab_buttons_gridbox = {
				entry_container = "VED_debug_interface_button_tabs_gui"
				array = VED_debug_interface_tab_button_array
				index = VED_debug_interface_tab_button_index
				value = VED_debug_interface_tab_button_value
			}

			debug_interface_content_gridbox = {
				entry_container = "VED_debug_interface_tab_[?VED_debug_interface_current_tab]_gui"
				array = VED_debug_interface_content_array
				index = VED_debug_interface_content_index
				value = VED_debug_interface_content_value
			}
		}

		visible = {
			has_country_flag = VED_display_debug_interface
		}

		effects = {
			tab_button_click = {
				set_variable = { VED_debug_interface_current_tab = VED_debug_interface_tab_button_index }
				f_VED_debug_interface_update_display = yes
			}

			# Diary log tab
			diary_log_entry_refresh_button_click = {
				f_VED_log_entries_database_setup = yes

				# Debug logs
				log = "Refreshed diary log entries. Number of quests : [?VED_diary_quest_log_entries_array^num]"
				for_each_loop = {
					array = VED_diary_quest_log_entries_array

					log = "Quest [?i] : nb of entries [?v]"
				}
			}
			diary_log_entry_reset_list_button_click = {
				#clear_array = VED_quest_diary_tab_3_left_log_array
				#resize_array = { VED_quest_diary_tab_3_left_log_array = 2 }
				#clear_array = VED_quest_diary_tab_3_right_log_array
				#resize_array = { VED_quest_diary_tab_3_right_log_array = 4 }
				#f_VED_refresh_diary_gui = yes

				set_variable = { VED_debug_log_date = global.date }
				f_VED_reset_adventure_log = yes
				set_variable = { VED_quest_diary_tab_3_current_page = 0 }
				set_temp_variable = { i_page_nb = 0 }
				f_VED_refresh_adventure_log_display = yes
				f_VED_refresh_diary_gui = yes
				log = "#"
				log = "#"
			}
			diary_log_entry_add_click = {
				set_temp_variable = { i_quest_id = VED_debug_interface_diary_log_selected_quest }
				set_temp_variable = { i_entry_id = VED_debug_interface_diary_log_selected_entry }
				set_temp_variable = { i_location = token:VED_dummy_loc }
				set_temp_variable = { i_date = VED_debug_log_date }
				add_to_variable = { VED_debug_log_date = 1 }
				log = "Adding entry [?i_quest_id]:[?i_entry_id]"
				f_VED_add_entry_adventure_log = yes
				set_temp_variable = { i_page_nb = VED_quest_diary_tab_3_current_page }
				f_VED_refresh_adventure_log_display = yes
				f_VED_refresh_diary_gui = yes
			}
			diary_log_entry_line_nb_button_click = {
				f_VED_debug_interface_update_display = yes
			}
			# Quest selection
			diary_log_entry_select_less5_quest_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_quest = -5 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^num }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_quest
					min = 0
					max = t_max_quest
				}
				set_variable = { VED_debug_interface_diary_log_selected_entry = 0 }
				f_VED_debug_interface_update_display = yes
			}
			diary_log_entry_select_less1_quest_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_quest = -1 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^num }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_quest
					min = 0
					max = t_max_quest
				}
				set_variable = { VED_debug_interface_diary_log_selected_entry = 0 }
				f_VED_debug_interface_update_display = yes
			}
			diary_log_entry_select_add1_quest_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_quest = 1 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^num }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_quest
					min = 0
					max = t_max_quest
				}
				set_variable = { VED_debug_interface_diary_log_selected_entry = 0 }
				f_VED_debug_interface_update_display = yes
			}
			diary_log_entry_select_add5_quest_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_quest = 5 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^num }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_quest
					min = 0
					max = t_max_quest
				}
				set_variable = { VED_debug_interface_diary_log_selected_entry = 0 }
				f_VED_debug_interface_update_display = yes
			}
			# Entry selection
			diary_log_entry_select_less5_entry_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_entry = -5 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^VED_debug_interface_diary_log_selected_quest }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_entry
					min = 0
					max = t_max_quest
				}
				f_VED_debug_interface_update_display = yes
			}
			diary_log_entry_select_less1_entry_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_entry = -1 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^VED_debug_interface_diary_log_selected_quest }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_entry
					min = 0
					max = t_max_quest
				}
				f_VED_debug_interface_update_display = yes
			}
			diary_log_entry_select_add1_entry_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_entry = 1 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^VED_debug_interface_diary_log_selected_quest }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_entry
					min = 0
					max = t_max_quest
				}
				f_VED_debug_interface_update_display = yes
			}
			diary_log_entry_select_add5_entry_button_click = {
				add_to_variable = { VED_debug_interface_diary_log_selected_entry = 5 }
				set_temp_variable = { t_max_quest = VED_diary_quest_log_entries_array^VED_debug_interface_diary_log_selected_quest }
				add_to_temp_variable = { t_max_quest = -1 }
				clamp_variable = {
					var = VED_debug_interface_diary_log_selected_entry
					min = 0
					max = t_max_quest
				}
				f_VED_debug_interface_update_display = yes
			}
		}
	}
}