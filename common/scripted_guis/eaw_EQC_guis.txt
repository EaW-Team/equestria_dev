scripted_gui = {

	EQC_parliament_gui = {
		context_type = decision_category
		window_name = "EQC_parliament_decision_window"
		dirty = EQC_parliament_dirty
		
		dynamic_lists = {
			parliament_popularities = {
				array = EQC_party_token_array
				entry_container = EQC_parliament_party_popularity_entry
				value = w
				index = i
			}
			parliament_parties = {
				array = EQC_party_token_array
				entry_container = EQC_parliament_party_entry
				value = w
				index = i
			}
		}
		
		triggers = {
			parliament_coalition_button_click_enabled = {
				OR = {
					check_variable = { EQC_coalition_party_index = i }
					check_variable = { EQC_coalition_party_index = -1 }
				}
				NOT = { 
					has_country_flag = EQC_parliament_popup_visible 
					check_variable = { EQC_selected_party = i }
				}
			}
		}

		effects = {
			parliament_coalition_button_click = {
				if = {
					limit = {
						check_variable = { EQC_coalition_party_index = i }
					}
					set_variable = { EQC_popup_header = token:break_coalition_with }
					set_country_flag = EQC_parliament_popup_visible
				}
				else = {
					set_variable = { EQC_party_coalition_partner_array^i = 2 }
					set_variable = { EQC_coalition_party_index = i }
					set_variable = { EQC_popup_header = token:form_coalition_with }
					set_country_flag = EQC_parliament_popup_visible
				}
				add_to_variable = { EQC_parliament_dirty = 0.01 }
			}
		}

		properties = {
			parliament_party_popularity_icon = {
				image = "GFX_EQC_popularity_[?w.GetTokenKey]"
				frame = EQC_party_popularity_frames_array^i
			}
			parliament_party_icon = {
				image = "GFX_EQC_parliament_icon_[?w.GetTokenKey]"
			}
			parliament_coalition_button = {
				frame = EQC_party_coalition_partner_array^i
			}
		}
	}
	
	EQC_parliament_popup = {
		window_name = "EQC_parliament_popup_window"
		context_type = player_context
		
		visible = {
			has_country_flag = EQC_parliament_popup_visible
		}
		
		effects = {
			confirm_btn_click = {
				if = {
					limit = {
						check_variable = { EQC_popup_header = token:break_coalition_with }
					}
					set_temp_variable = { temp_token = EQC_party_token_array^EQC_coalition_party_index }	#Have to do this retarded shit, thanks PDX.
					add_to_array = { EQC_party_opinion@var:temp_token = -25 }
					add_to_array = { EQC_party_opinion_loc@var:temp_token = token:broke_coalition_modifier }
					EQC_calculate_total_relations = yes
					
					set_variable = { EQC_party_coalition_partner_array^EQC_coalition_party_index = 1 }
					set_variable = { EQC_coalition_party_index = -1 }
				}
				add_to_variable = { EQC_parliament_dirty = 0.01 }
				clr_country_flag = EQC_parliament_popup_visible
			}
			cancel_btn_click = {
				if = {
					limit = {
						check_variable = { EQC_popup_header = token:form_coalition_with }
					}
					set_variable = { EQC_party_coalition_partner_array^EQC_coalition_party_index = 1 }
					set_variable = { EQC_coalition_party_index = -1 }
				}
				add_to_variable = { EQC_parliament_dirty = 0.01 }
				clr_country_flag = EQC_parliament_popup_visible
			}
		}
		
		properties = {
			parliament_party_icon = {
				image = "GFX_EQC_parliament_icon_[?EQC_party_token_array^EQC_coalition_party_index.GetTokenKey]"
			}
		}
	}
}
