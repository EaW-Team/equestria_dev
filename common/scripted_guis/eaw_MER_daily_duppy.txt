scripted_gui = {
	MER_daily_duppy_gui = {
		window_name = "MER_daily_duppy_gui"
		context_type = decision_category
		dirty = MER_DDP_Dirty
		
		dynamic_lists = {
			phase_folders = {
				entry_container = MER_DDP_phase_folder_entry
				array = MER_DDP_phase_folder_array
				index = k
				value = phase_id
			}
			phase_window_box = {
				entry_container = "MER_daily_duppy_gui_window_[?selected_phase]"
				array = MER_DDP_box_dummy_array
			}
		}

		effects = {
			pile_click = {
				if = {
					limit = {
						has_country_flag = MER_DDP_P1_popup_show
					}
					clr_country_flag = MER_DDP_P1_popup_show
				}
				else = {
					set_country_flag = MER_DDP_P1_popup_show
				}
				add_to_variable = { MER_DDP_Dirty = 0.001 }
			}
			button_entry_click = {
				set_variable = { selected_phase = phase_id }
				clr_country_flag = MER_DDP_P1_popup_show
				add_to_variable = { MER_DDP_Dirty = 0.001 }
			}
		}

		triggers = {
			button_entry_click_enabled = {
				# Temporary variable calculation for frame
				if = {
					limit = {
						check_variable = { selected_phase = phase_id }
					}
					set_temp_variable = { folder_frame = 1 }
					set_temp_variable = { icon_y = 0 }
				}
				else = {
					set_temp_variable = { folder_frame = 2 }
					set_temp_variable = { icon_y = 3 }
				}
			}
			pile_click_enabled = {
				NOT = {
					check_variable = { MER_DDP_P1_active_card > 0 }
					check_variable = { MER_DDP_P1_cooldown_remaining_days > 0 }
				}
			}
			card_activation_indicator_left_visible = {
				check_variable = { MER_DDP_P1_active_card > 0 }
			}
			card_activation_indicator_right_visible = {
				check_variable = { MER_DDP_P1_active_card > 0 }
			}
		}

		properties = {
			card_displayed = {
				image = "GFX_MER_DDP_[?MER_DDP_P1_active_card]"
			}
			card_activation_indicator_left = {
				frame = MER_DDP_P1_card_activation_frame
			}
			card_activation_indicator_right = {
				frame = MER_DDP_P1_card_activation_frame
			}
			button_entry = {
				frame = folder_frame
			}
			# phase_icon_entry = {
			# 	frame = folder_frame
			# 	y = icon_y
			# }
		}
	}
	MER_daily_duppy_gui_popup_outside = {
		window_name = "MER_daily_duppy_gui_popup_outside"
		context_type = player_context
		parent_window_token = decision_tab
		dirty = MER_DDP_Dirty
		visible = { has_country_flag = MER_DDP_Active }
	}
	MER_daily_duppy_gui_popup = {
		window_name = "MER_daily_duppy_gui_popup"
		context_type = player_context
		parent_window_name = MER_daily_duppy_gui_popup_outside_instance
		dirty = MER_DDP_Dirty
		visible = { has_country_flag = MER_DDP_P1_popup_show }

		effects = {
			card_1_click = {
				set_variable = { MER_DDP_P1_active_card = 1 }
				set_temp_variable = { temp_activation_days = 30 }
				MER_DDP_P1_activate_card = yes
				add_ideas = MER_DDP_card_1

				clr_country_flag = MER_DDP_P1_popup_show
				add_to_variable = { MER_DDP_Dirty = 0.001 }
			}
			card_2_click = {
				set_variable = { MER_DDP_P1_active_card = 2 }
				set_temp_variable = { temp_activation_days = 30 }
				MER_DDP_P1_activate_card = yes
				add_ideas = MER_DDP_card_2
				
				clr_country_flag = MER_DDP_P1_popup_show
				add_to_variable = { MER_DDP_Dirty = 0.001 }
			}
			card_3_click = {
				set_variable = { MER_DDP_P1_active_card = 3 }
				set_temp_variable = { temp_activation_days = 30 }
				MER_DDP_P1_activate_card = yes
				add_ideas = MER_DDP_card_3
				
				clr_country_flag = MER_DDP_P1_popup_show
				add_to_variable = { MER_DDP_Dirty = 0.001 }
			}
			card_4_click = {
				set_variable = { MER_DDP_P1_active_card = 4 }
				set_temp_variable = { temp_activation_days = 30 }
				MER_DDP_P1_activate_card = yes
				add_ideas = MER_DDP_card_4
				
				clr_country_flag = MER_DDP_P1_popup_show
				add_to_variable = { MER_DDP_Dirty = 0.001 }
			}
		}
	}
}