#!focus:interface\eaw_goals.gfx
#!gfx:interface\eaw_goals.gfx

focus_tree = {
	id = crystalempire
	country = {
		factor = 0
		modifier = {
			add = 10
			original_tag = CRY
		}
	}
	default = no
	continuous_focus_position = { x = 1400 y = 2200 }
	shared_focus = CRY_dawn_on_crystal_empire
	shared_focus = CRY_military
	shared_focus = CRY_a_looming_war
}
focus_tree = {
	id = crystalempire_sombra
	country = {
		factor = 0
	}
	default = no
	continuous_focus_position = { x = 1200 y = 1500 }
	shared_focus = CRY_the_king_of_monsters
	# RADIANT STUFF
	shared_focus = CRY_but_hardly_a_day_for_me
	shared_focus = CRY_no_waste_of_resources
	shared_focus = CRY_kindness_for_the_royals
	shared_focus = CRY_revise_occupation_policy
	shared_focus = CRY_increase_social_mobility
	shared_focus = CRY_down_to_indentured_servitude
	shared_focus = CRY_end_internal_fear_magic
	shared_focus = CRY_magic_healthcare
	shared_focus = CRY_draft_a_constitution
	shared_focus = CRY_regional_democracy
	shared_focus = CRY_butcher_the_butcherers

	shared_focus = CRY_military
	inlay_window = {
		id = eaw_CRY_radiant_demands
		position = { x = 1573 y = 413 }
	}
}
focus_tree = {
	id = crystalempire_sombra_alt
	country = {
		factor = 0
	}
	default = no
	continuous_focus_position = { x = 1200 y = 1500 }
	shared_focus = CRY_the_king_of_monsters
	shared_focus = CRY_military
}

focus_tree = {
	id = CRY_sombra_sad
	country = {
		factor = 0
	}
	default = no
	continuous_focus_position = { x = 1200 y = 1500 }
	shared_focus = CRY_my_hollow_victory
}

focus_tree = {
	id = CRY_true_sombra
	country = {
		factor = 0
	}
	default = no
	continuous_focus_position = { x = 1200 y = 1500 }
	shared_focus = CRY_the_truth_revealed
}

shared_focus = { #Review of the last year
	id = CRY_dawn_on_crystal_empire
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 4
	x = 0
	y = 1
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_dawn_on_crystal_empire"
		add_political_power = 75		
		add_autonomy_score = {
			value = 40
			localization = CRY_dawn_on_crystal_empire
		}
		country_event = newcrystals.1
	}
}
shared_focus = { #Review of the last year
	id = CRY_crystal_fair
	icon = GFX_goal_crystal_fair
	cost = 4
	x = -1
	y = 1
	relative_position_id = CRY_dawn_on_crystal_empire
	prerequisite = {
		focus = CRY_dawn_on_crystal_empire
	}
	bypass = {
		EQS = {
			has_completed_focus = Crystal_Fair
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystal_fair"
		add_stability = 0.1
		add_political_power = 50
		hidden_effect = {
			news_event = news.4
		}
	}
}
shared_focus = { #Some simple Equestrianization
	id = CRY_early_equestrian_influence
	icon = GFX_goal_crystal_fair
	cost = 4
	x = -1
	y = 1
	relative_position_id = CRY_crystal_fair
	prerequisite = {
		focus = CRY_crystal_fair
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_early_equestrian_influence"
	}
}
shared_focus = { #support Thorax
	id = CRY_thoraxian_friendship
	icon = GFX_goal_crystal_fair
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_crystal_fair
	prerequisite = {
		focus = CRY_crystal_fair
	}
	prerequisite = {
		focus = CRY_equestria_games
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_thoraxian_friendship"
		if = {
			limit = {
				country_exists = CCN
			}
			# boost to CCN
		}
		else = {
			# something else
		}
	}
}
shared_focus = { #stop being poor
	id = CRY_poverty_effort
	icon = GFX_goal_crystal_fair
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_equestria_games
	prerequisite = {
		focus = CRY_equestria_games
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_poverty_effort"
		decrease_poverty = yes
	}
}
shared_focus = { #try to get along with various neighbors
	id = CRY_good_neighbor_policy
	icon = GFX_goal_crystal_fair
	cost = 4
	x = -1
	y = 1
	relative_position_id = CRY_early_equestrian_influence
	prerequisite = {
		focus = CRY_early_equestrian_influence
	}
	mutually_exclusive = {
		focus = CRY_southern_ties
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_good_neighbor_policy"
	}
}
shared_focus = { #stick with equestria diplomacy
	id = CRY_southern_ties
	icon = GFX_goal_crystal_fair
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_early_equestrian_influence
	prerequisite = {
		focus = CRY_early_equestrian_influence
	}
	mutually_exclusive = {
		focus = CRY_good_neighbor_policy
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_southern_ties"
	}
}

shared_focus = { #letting people own the land they work
	id = CRY_homestead_principle
	icon = GFX_goal_crystal_fair
	cost = 4
	x = -1
	y = 1
	relative_position_id = CRY_poverty_effort
	prerequisite = {
		focus = CRY_poverty_effort
	}
	mutually_exclusive = {
		focus = CRY_crown_lands
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_homestead_principle"
	}
}
shared_focus = { #the crown owns the land and leases it to the people
	id = CRY_crown_lands
	icon = GFX_goal_crystal_fair
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_poverty_effort
	prerequisite = {
		focus = CRY_poverty_effort
	}
	mutually_exclusive = {
		focus = CRY_homestead_principle
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crown_lands"
	}
}

shared_focus = { #befriending the mountain weirdos
	id = CRY_people_in_the_mountains
	icon = GFX_goal_crystal_fair
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_good_neighbor_policy
	prerequisite = {
		focus = CRY_good_neighbor_policy
		focus = CRY_southern_ties
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_people_in_the_mountains"
	}
}

shared_focus = { #calming ponies about the sombra stuff
	id = CRY_dispel_sombras_ghost
	icon = GFX_goal_crystal_fair
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_homestead_principle
	prerequisite = {
		focus = CRY_homestead_principle
		focus = CRY_crown_lands
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_people_in_the_mountains"
		add_stability = 0.15
	}
}

shared_focus = { #Review of the last year
	id = CRY_equestria_games
	icon = GFX_goal_equestria_games
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_dawn_on_crystal_empire
	available = {
		EQS = {
			exists = yes
			has_government = democratic
		}
	}
	bypass = {
		EQS = {
			has_completed_focus = Friendship_Games
		}
	}
	prerequisite = {
		focus = CRY_dawn_on_crystal_empire
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_equestria_games"
		add_political_power = 150
		# TODO flavor event
	}
}
###############
### HARMONY ###
###############
shared_focus = { #harmony path starts
	id = CRY_the_way_of_harmony
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 4
	x = 1
	y = 4
	relative_position_id = CRY_crystal_fair
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_thoraxian_friendship
	}
	prerequisite = {
		focus = CRY_people_in_the_mountains
	}
	prerequisite = {
		focus = CRY_dispel_sombras_ghost
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_way_of_harmony"
		swap_ideas = {
			remove_idea = CRY_royal_family
			add_idea = CRY_royal_family2
		}
		
		add_autonomy_score = {
			value = 20
			localization = CRY_the_way_of_harmony
		}
		custom_effect_tooltip = CRY_puppet_now_available
		hidden_effect = {
			country_event = { id = crycom.1 days = 8 }
		}
	}
}
shared_focus = { #simp for eqs
	id = CRY_equestrian_tutelage
	icon = GFX_goal_cry_celestia
	cost = 5
	x = -4
	y = 1
	relative_position_id = CRY_the_way_of_harmony
	ai_will_do = {
		factor = 8
	}
	available = {
		EQS = {
			exists = yes
			has_government = democratic
		}
	}
	mutually_exclusive = {
		focus = CRY_on_our_own_hooves
	}
	prerequisite = {
		focus = CRY_the_way_of_harmony
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_equestrian_tutelage"
		if = {
			limit = {
				has_idea = CRY_equestrian_overlord_new
			}
			swap_ideas = {
				remove_idea = CRY_equestrian_overlord_new
				add_idea = CRY_equestrian_overlord_research
			}
		}
		else_if = {
			limit = {
				has_idea = CRY_equestrian_overlord_proper
			}
			swap_ideas = {
				remove_idea = CRY_equestrian_overlord_proper
				add_idea = CRY_equestrian_overlord_proper_research
			}
		}
	}
}
shared_focus = { #set up own currency
	id = CRY_crystal_bit
	icon = GFX_goal_griffon_rusty_coin
	cost = 5
	x = -5
	y = 3
	relative_position_id = CRY_equestrian_tutelage
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_adopt_the_equestrian_bit
	}
	prerequisite = {
		focus = CRY_multipolar_concept
		focus = CRY_demand_the_referendum
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystal_bit"
		###Gives autonomy boost and spirit that lowers a bit of consumer goods, also makes hiring companies a little cheaper. Could also give a little bit of stability in the spirit.
		add_autonomy_score = {
			value = 50
			localization = CRY_crystal_bit
		}
		add_ideas = CRY_crystal_bit_idea
	}
}
shared_focus = { #adopt equestrian currency
	id = CRY_adopt_the_equestrian_bit
	icon = GFX_goal_canterlot_coin
	cost = 5
	x = -3
	y = 3
	relative_position_id = CRY_equestrian_tutelage
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_crystal_bit
	}
	available = {
		EQS = {
			exists = yes
			has_government = democratic
		}
	}
	prerequisite = {
		focus = CRY_multipolar_concept
		focus = CRY_demand_the_referendum
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_adopt_the_equestrian_bit"
		add_offsite_building = { type = industrial_complex level = 3 }
		add_ideas = CRY_equestrian_bit_idea
		###Gives a few factories but also gives a spirit that increases trade with overlord (extra_trade_to_overlord_factor) and adds consumer goods.
	}
}
shared_focus = { #set up the bank
	id = CRY_the_crystal_bank
	icon = GFX_goal_PLB_central_bank
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_adopt_the_equestrian_bit
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_adopt_the_equestrian_bit
		focus = CRY_crystal_bit
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_crystal_bank"
		###Unnlocks special company "Crystal Bank", increases the funds gained by a few of your MIO's and makes MIO policy cheaper. For non-DLC modifiers it could have some production buffs and maybe a consumer goods reduction. This could also be included in the DLC version of the company.
		if = {
			limit = {
				has_dlc = "Arms Against Tyranny"
			}
			custom_effect_tooltip = available_industrial_concern
			show_ideas_tooltip = the_crystal_bank_dlc
		}
		else = {
			custom_effect_tooltip = available_industrial_concern
			show_ideas_tooltip = the_crystal_bank
		}
	}
}
shared_focus = { #building up on our own
	id = CRY_on_our_own_hooves
	icon = GFX_goal_crystal_heart
	cost = 5
	x = 4
	y = 1
	relative_position_id = CRY_the_way_of_harmony
	ai_will_do = {
		factor = 8
	}
	bypass = {
		EQS = {
			NOT = {
				exists = yes
			    has_government = democratic
			}
		}
	}
	mutually_exclusive = {
		focus = CRY_equestrian_tutelage
	}
	prerequisite = {
		focus = CRY_the_way_of_harmony
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_on_our_own_hooves"
		if = {
			limit = {
				has_idea = CRY_equestrian_overlord_new
			}
			swap_ideas = {
				remove_idea = CRY_equestrian_overlord_new
				add_idea = CRY_equestrian_overlord_autom
			}
		}
		else_if = {
			limit = {
				has_idea = CRY_equestrian_overlord_proper
			}
			swap_ideas = {
				remove_idea = CRY_equestrian_overlord_proper
				add_idea = CRY_equestrian_overlord_proper_autom
			}
		}
	}
}
shared_focus = { #building up on our own agriculture
	id = CRY_expand_our_agricultural_sector
	icon = GFX_focus_AUS_agriculture
	cost = 5
	x = -11
	y = 3
	relative_position_id = CRY_equestrian_tutelage
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_increase_imports
	}
	prerequisite = {
		focus = CRY_multipolar_concept
		focus = CRY_demand_the_referendum
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_expand_our_agricultural_sector"
		add_autonomy_score = {
			value = 100
			localization = CRY_expand_our_agricultural_sector
		}
		add_ideas = CRY_agricultre_expanded
		country_event = newcrystals.20
		##Cadance decides to utilize pegasi and weather manipulation to further expand the Empire's ability to stand on its own, would give spirit where less resources go to the market, and give out of supply and core supply buffs as well as direct autonomy.
	}
}
shared_focus = { #deciding on importing more Equestrian supply
	id = CRY_increase_imports
	icon = GFX_goal_KTZ_a_trade_with_the_world
	cost = 5
	x = -9
	y = 3
	relative_position_id = CRY_equestrian_tutelage
	ai_will_do = {
		factor = 8
	}
	available = {
		EQS = {
			exists = yes
			has_government = democratic
		}
	}
	mutually_exclusive = {
		focus = CRY_expand_our_agricultural_sector
	}
	prerequisite = {
		focus = CRY_multipolar_concept
		focus = CRY_demand_the_referendum
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_increase_imports"
		add_autonomy_score = {
			value = -100
			localization = CRY_increase_imports
		}
		add_political_power = 100
		add_ideas = CRY_imports_boosted

		##Cadance decides to import more Equestrian supply and food. This gives buffs to railway, infra, and supply hub construction and supply range, gives some direct political power. In the negative side, it gives a tad bit of consumer goods as a well as directly remove autonomy.
	}
}
shared_focus = { #getting people to move to CRY
	id = CRY_entice_outsiders
	icon = GFX_CES_resume_free_migration
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_increase_imports
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_increase_imports
		focus = CRY_expand_our_agricultural_sector
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_entice_outsiders"
		add_manpower = 25000
		145 = {
			increase_state_category = yes
			add_manpower = 100000
			add_victory_points = {
				province = 6066
				value = 2
			}
		}
		add_timed_idea = {
			idea = CRY_influx_of_new_money
			days = 365
		}
		##With food secured Cadance decides to entice some outsiders to move into CRY in order to increase the Empire's population now that she can handle it. Should give a handful of pop to some states and direct manpower as well as a timed consumer goods idea and maybe a monthly pop modifier here too. Maybe she could build a new town here to accomodate some of them.
	}
}

shared_focus = { #getting people to move to CRY
	id = CRY_aid_the_yaks
	icon = GFX_CES_resume_free_migration
	cost = 5
	x = 2
	y = 0
	relative_position_id = CRY_increase_imports
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_multipolar_concept
		focus = CRY_demand_the_referendum
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_aid_the_yaks"
		add_relation_modifier = {
			target = JAK
			modifier = CRY_grand_crystal_intervention
		}
		
	}
}
shared_focus = { #plan to develop other cities outside of crystal city
	id = CRY_multipolar_concept
	icon = GFX_goal_cry_free_trade
	cost = 5
	x = 4
	y = 2
	relative_position_id = CRY_equestrian_tutelage
	
	mutually_exclusive = {
		focus = CRY_demand_the_referendum
	}
	allow_branch = {
		NOT = {
			has_completed_focus = CRY_demand_the_referendum
		}
	}
		
	offset = {
		
		y = 0
		x = 0
		trigger = { has_completed_focus = CRY_multipolar_concept }
	}
	
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_equestrian_tutelage
		focus = CRY_on_our_own_hooves
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_multipolar_concept"
		unlock_decision_category_tooltip = CRY_connecting_cities
		custom_effect_tooltip = CRY_colony_now_available
		swap_ideas = {
			remove_idea = CRY_commie_unrest
			add_idea = CRY_commie_less_unrest
		}
	}
}
shared_focus = { #focus about asking equestrian investors for help
	id = CRY_equestrian_investors
	icon = GFX_goal_cry_factory_cel
	cost = 7
	x = -1
	y = 1
	relative_position_id = CRY_equestrian_tutelage
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_prioritize_our_industry
	}
	prerequisite = {
		focus = CRY_equestrian_tutelage
		focus = CRY_on_our_own_hooves
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_equestrian_investors"
		# yes this is a ton but you won't be getting much of it until MUCH later
		# because the spirit makes EQS steal even more of your industry
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
		one_random_arms_factory = yes
		one_random_arms_factory = yes
		one_random_arms_factory = yes
		add_tech_bonus = {
			name = industrial_bonus
			category = industry
			uses = 2
			bonus = 0.5
		}
		
		add_autonomy_score = {
			value = -100
			localization = CRY_equestrian_investors
		}
		add_ideas = CRY_equestrian_investors_idea
	}
}
shared_focus = { #focus about relying on your own industry instead
	id = CRY_prioritize_our_industry
	icon = GFX_goal_cry_factory
	cost = 7
	x = 1
	y = 1
	relative_position_id = CRY_equestrian_tutelage
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_equestrian_investors
	}
	prerequisite = {
		focus = CRY_equestrian_tutelage
		focus = CRY_on_our_own_hooves
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_prioritize_our_industry"
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
		one_random_arms_factory = yes
		add_autonomy_score = {
			value = 100
			localization = CRY_equestrian_investors
		}
		add_ideas = CRY_prioritize_our_industry_idea
	}
}
shared_focus = { #focus about the fifth pony race
	id = CRY_the_fifth_race
	icon = GFX_goal_cry_rising_storm
	cost = 7
	x = 1
	y = 1
	relative_position_id = CRY_on_our_own_hooves
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_a_part_of_something_greater
	}
	prerequisite = {
		focus = CRY_equestrian_tutelage
		focus = CRY_on_our_own_hooves
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_fifth_race"
		add_ideas = CRY_fifth_race_idea
		country_event = newcrystals.2
	}
}
shared_focus = { #focus about not making crystal ponies into their own race
	id = CRY_a_part_of_something_greater
	icon = GFX_goal_som_equestria
	cost = 7
	x = -1
	y = 1
	relative_position_id = CRY_on_our_own_hooves
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_the_fifth_race
	}
	prerequisite = {
		focus = CRY_equestrian_tutelage
		focus = CRY_on_our_own_hooves
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_part_of_something_greater"
		add_ideas = CRY_something_greater_idea
	}
}
shared_focus = { #plan to develop rainbow falls' tourist industry
	id = CRY_develop_rainbow_falls
	icon = GFX_goal_rainbow_falls
	cost = 5
	x = 4
	y = 1
	relative_position_id = CRY_multipolar_concept
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_multipolar_concept
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_develop_rainbow_falls"
		unlock_decision_tooltip = CRY_develop_rainbow_falls_dec
		add_ideas = CRY_crystal_tourism
		custom_effect_tooltip = GRE_encourage_tourism_tt
	}
}
shared_focus = { #plan to develop Mi Amore into a future Crystal City
	id = CRY_develop_mi_amore
	icon = GFX_focus_SWE_urbanization
	cost = 5
	x = 2
	y = 1
	relative_position_id = CRY_multipolar_concept
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_multipolar_concept
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_develop_mi_amore"
		unlock_decision_tooltip = CRY_develop_mi_amore_dec
		add_ideas = CRY_crystal_construction
	}
}
shared_focus = { #plan to develop Ponytown into a university city
	id = CRY_develop_ponytown
	icon = GFX_goal_ITA_urban
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_multipolar_concept
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_multipolar_concept
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_develop_ponytown"
		unlock_decision_tooltip = CRY_develop_ponytown_dec
		add_ideas = CRY_ponytown_science
	}
}
shared_focus = { #plan to develop Quebuck into an industrial city
	id = CRY_develop_quebuck
	icon = GFX_goal_rct_expand_the_city
	cost = 5
	x = -2
	y = 1
	relative_position_id = CRY_multipolar_concept
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_multipolar_concept
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_develop_quebuck"
		unlock_decision_tooltip = CRY_develop_quebuck_dec
		add_ideas = CRY_quebuck_industry
	}
}
shared_focus = { #plan to develop Hedgewards into an electricity producer
	id = CRY_develop_hedgewards
	icon = GFX_focus_generic_hydroelectric_energy
	cost = 5
	x = -4
	y = 1
	relative_position_id = CRY_multipolar_concept
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_multipolar_concept
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_develop_hedgewards"
		unlock_decision_tooltip = CRY_develop_hedgewards_dec
		324 = {
			add_building_construction = {
				type = dam
				level = 1
				instant_build = yes
				province = {
					id = 9236
				}
			}
			custom_effect_tooltip = {
				localization_key = building_state_modifier|dam
				INDENT = "    "
			}
			
		}

	}
}
shared_focus = { #all decisions to develop places have been taken and completed
	id = CRY_a_concept_realized
	icon = GFX_goal_crystal_empire_symbol_flowers
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_develop_ponytown
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_develop_ponytown
	}
	prerequisite = {
		focus = CRY_develop_quebuck
	}
	prerequisite = {
		focus = CRY_develop_hedgewards
	}
	prerequisite = {
		focus = CRY_develop_mi_amore
	}
	prerequisite = {
		focus = CRY_develop_rainbow_falls
	}
	available = {
		has_country_flag = CRY_rainbow_falls_developed
		has_country_flag = CRY_mi_amore_developed
		has_country_flag = CRY_ponytown_developed
		has_country_flag = CRY_quebuck_developed
		has_country_flag = CRY_hedgewards_developed
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_concept_realized"
		custom_effect_tooltip = CRY_consolidation_spirit
		add_ideas = CRY_multipolarity_achieved
		hidden_effect = {
			remove_ideas = {
				CRY_crystal_construction
				CRY_crystal_tourism
				CRY_ponytown_science
				CRY_quebuck_industry
			}
		}
	}
}
shared_focus = { #focus about the City itself
	id = CRY_world_metropolis
	icon = GFX_goal_cry_world_metropolis
	cost = 7
	x = 0
	y = 1
	relative_position_id = CRY_a_concept_realized
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_a_concept_realized
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_world_metropolis"
		increase_society_development = yes
		344 = {
			increase_state_category = yes
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
			if = {
				limit = {
					free_building_slots = {
						building = infrastructure
						size > 0
					}
				}
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
		345 = {
			increase_state_category = yes
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
			if = {
				limit = {
					free_building_slots = {
						building = infrastructure
						size > 0
					}
				}
				add_building_construction = {
					type = infrastructure
					level = 1
					instant_build = yes
				}
			}
		}
		custom_effect_tooltip = CRY_dominion_now_available
	}
}
shared_focus = { #focus about collaborating with the unions
	id = CRY_cooperate_with_unions
	icon = GFX_goal_cry_welfare
	cost = 5
	x = -2
	y = 1
	relative_position_id = CRY_a_concept_realized
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_a_concept_realized
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_cooperate_with_unions"
		swap_ideas = {
			remove_idea = CRY_commie_less_unrest
			add_idea = CRY_commie_cooperation
		}
	}
}
shared_focus = { #focus about preparing to fight the lings
	id = CRY_a_threat_we_know_well
	icon = GFX_goal_som_changeling
	cost = 5
	x = 2
	y = 1
	relative_position_id = CRY_a_concept_realized
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_a_concept_realized
	}
	available = {
		CHN = {
			is_subject = no
			has_government = fascism
		}
		has_country_flag = CRY_thorax_arrived
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_threat_we_know_well"
		add_ideas = CRY_experienced_anti_changeling_behavior
	}
}
shared_focus = { #focus about the Crystal City-Canterlot railway
	id = CRY_crystal_canterlot_railway
	icon = GFX_goal_cry_train
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_world_metropolis
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_world_metropolis
	}
	available = {
		can_build_railway = {
			start_province = 489
			target_province = 11164
		}
		can_build_railway = {
			start_province = 11164
			target_province = 3162
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystal_canterlot_railway"
		build_railway = {
			level = 2
			fallback = yes
			path = { 489 11788 6013 11065 11126 6480 3119 11208 61 11115 11164  }
			start_province = 489
			target_province = 11164
		}
		build_railway = {
			level = 2
			fallback = yes
			path = { 489 11788 6013 11065 11126 6480 3119 11208 61 11115 11164  }
			start_province = 11164
			target_province = 3162
		}
		149 = {
			add_building_construction = {
				level = 1
				type = supply_node
				instant_build = yes
				province = 6480
			}
		}
	}
}
shared_focus = { #focus about accepting Equestria as ruler
	id = CRY_under_their_wing
	icon = GFX_goal_cry_subordination
	cost = 5
	x = -1
	y = 2
	relative_position_id = CRY_world_metropolis
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_referendum
	}
	prerequisite = {
		focus = CRY_world_metropolis
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_under_their_wing"
		one_random_arms_factory = yes
		one_random_industrial_complex = yes
		custom_effect_tooltip = CRY_free_now_available
	}
}
shared_focus = { #focus about the referendum for freedom
	id = CRY_referendum
	icon = GFX_goal_cry_referendum
	cost = 5
	x = 1
	y = 2
	relative_position_id = CRY_world_metropolis
	ai_will_do = {
		factor = 8
	}
	mutually_exclusive = {
		focus = CRY_under_their_wing
	}
	prerequisite = {
		focus = CRY_world_metropolis
	}
	available = {
		compare_autonomy_state > autonomy_colony
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_referendum"
		country_event = newcrystals.4
	}
}
shared_focus = { #focus about cadance declaring her "victory" 
	id = CRY_mi_amore_forever
	icon = GFX_goal_cry_miamore
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_referendum
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_referendum
		focus = CRY_under_their_wing
	}
	available = {
		is_subject = no
		has_idea = proper_science_base
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_mi_amore_forever"
		unlock_decision_tooltip = CRY_end_equestrian_dependence
		add_country_leader_trait = princess_of_ponies
		add_popularity = {
			ideology = democratic
			popularity = 0.15
		}
		swap_ideas = {
			remove_idea = CRY_royal_family2
			add_idea = CRY_royal_family3
		}
		if = {
			limit = {
				has_completed_focus = CRY_referendum
			}
			country_event = newcrystals.5
		}
		else = {
			country_event = newcrystals.6
		}
	}
}
shared_focus = { #focus about cadance declaring her "victory" 
	id = CRY_greater_economic_ties
	icon = GFX_goal_cry_strengthen_ties
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_under_their_wing
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_under_their_wing
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_greater_economic_ties"
		add_tech_bonus = {
			name = industrial_bonus
			bonus = 0.65
			uses = 3
			category = industry
		}
		if = {
			limit = {
				has_dlc = "Arms Against Tyranny"
			}    
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = CRY_small_arms_concern_organization
			mio:CRY_small_arms_concern_organization = {
				add_mio_size = 1
				add_mio_funds = 500
			}
		}
		else = {
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = small_arms_concern
		}
	}
}
shared_focus = { #focus about cadance looking around for non-harmonics
	id = CRY_a_statement
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_referendum
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_referendum
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_statement"
		unlock_decision_category_tooltip = CRY_direct_intervention
		add_ideas = CRY_internationalist_harmony
	}
}


shared_focus = { #focus about cadance working with equestrian military contractors
	id = CRY_equestrian_branch_offices
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_greater_economic_ties
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_greater_economic_ties
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_equestrian_branch_offices"
		if = {
			limit = {
				has_dlc = "Arms Against Tyranny"
			}    
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_shoof_organization
			mio:EQS_shoof_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_mustang_organization
			mio:EQS_mustang_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_sirius_organization
			mio:EQS_sirius_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_wonderbolt_concern_organization
			mio:EQS_wonderbolt_concern_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_stratus_organization
			mio:EQS_stratus_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_cloudsdale_research_organization
			mio:EQS_cloudsdale_research_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_northern_organization
			mio:EQS_northern_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_ultramarine_organization
			mio:EQS_ultramarine_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_macintosh_organization
			mio:EQS_macintosh_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_fillydelphia_arms_organization
			mio:EQS_fillydelphia_arms_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = EQS_star_energy_organization
			mio:EQS_star_energy_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
		}
		else = {
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = mustang
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = shoof
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = sirius
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = star_energy
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = macintosh
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = fillydelphia_arms
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = wonderbolt_concern
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = cloudsdale_research
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = northern
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = EQS_ultramarine
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = EQS_stratus
		}
	}
}

shared_focus = { #focus about cadance inviting regular ponies into the crystal palace
	id = CRY_open_crystal_palace
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_mi_amore_forever
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_mi_amore_forever
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_open_crystal_palace"
		add_political_power = 50
		add_stability = 0.05
		add_popularity = {
			ideology = democratic
			popularity = 0.05
		}
		country_event = newcrystals.21
	}
}
shared_focus = { #focus about cadance sending ponies abroad to fight evil
	id = CRY_harmonic_volunteer_corps
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_a_statement
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_a_statement
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_harmonic_volunteer_corps"
		add_ideas = CRY_harmonic_volunteers
		
	}
}
shared_focus = { #focus about cadance doing more joint training with EQS
	id = CRY_strength_military_coop
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_equestrian_branch_offices
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_equestrian_branch_offices
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_strength_military_coop"
		# TODO military buffs
	}
}

shared_focus = { #focus about cadance signing a free trade agreement with EQS
	id = CRY_equestrian_free_trade
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_open_crystal_palace
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_open_crystal_palace
	}
	
	prerequisite = {
		focus = CRY_equestrian_branch_offices
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_equestrian_free_trade"
		custom_effect_tooltip = CRY_crystal_free_trade_tp ##TODO make new tooltip so it doesnt say "free trade" but something better
		add_ideas = CRY_the_crystal_trade_agreement
		add_ideas = CRY_free_trade
		set_country_flag = TRD_forced_market
	}
}
shared_focus = { #focus about cadance declaring that tyranny anywhere is a threat to harmony everywhere
	id = CRY_cadance_doctrine
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_open_crystal_palace
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_open_crystal_palace
	}
	
	prerequisite = {
		focus = CRY_harmonic_volunteer_corps
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_cadance_doctrine"
		swap_ideas = {
			remove_idea = CRY_harmonic_volunteers
			add_idea = CRY_attero_dominatus
		}
	}
}
shared_focus = { #focus about cadance sharing the crystal research with the world
	id = CRY_crystallographic_research_fairs
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_open_crystal_palace
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_open_crystal_palace
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystallographic_research_fairs"
		
		# research buffs and event
	}
}
shared_focus = { #focus about cadance cooperating with her new puppet regimes in the north
	id = CRY_work_with_locals
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_harmonic_volunteer_corps
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_harmonic_volunteer_corps
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_work_with_locals"
		add_ideas = CRY_local_cooperation
	}
}
shared_focus = { #focus about making it super easy to migrate between EQS and CRY
	id = CRY_right_of_free_movement
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_strength_military_coop
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_strength_military_coop
	}
	
	prerequisite = {
		focus = CRY_equestrian_free_trade
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_right_of_free_movement"
		add_ideas = CRY_free_movement
	}
}
shared_focus = { #focus about railways and diplo stuff
	id = CRY_connecting_the_north
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_crystallographic_research_fairs
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_cadance_doctrine
	}
	
	prerequisite = {
		focus = CRY_work_with_locals
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_connecting_the_north"
		# railroads through puppets and diplo bonuses
	}
}
shared_focus = { #big story event
	id = CRY_new_empire_new_millennium
	icon = GFX_goal_cry_manehattan
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_crystallographic_research_fairs
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_crystallographic_research_fairs
	}
	
	prerequisite = {
		focus = CRY_right_of_free_movement
		focus = CRY_connecting_the_north
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_new_empire_new_millennium"
		# big story event
	}
}
shared_focus = { #focus about preparing for future festivities
	id = CRY_prepare_the_festivities
	icon = GFX_goal_eqc_shelter_celestia
	cost = 2
	x = -2
	y = 4
	relative_position_id = CRY_equestrian_tutelage
	available = {
		has_war = no
	}
	prerequisite = {
		focus = CRY_multipolar_concept
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_prepare_the_festivities"
		add_stability = 0.05
		country_event = newcrystals.7
	}
}
shared_focus = { #focus about really modernizing the country
	id = CRY_from_the_annals_of_history
	icon = GFX_goal_TBK_AF_holy_texts
	cost = 2
	x = 10
	y = 4
	relative_position_id = CRY_equestrian_tutelage
	prerequisite = {
		focus = CRY_multipolar_concept
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_from_the_annals_of_history"
		add_war_support = 0.05
		country_event = newcrystals.8
	}
}
shared_focus = { #focus about amethyst university
	id = CRY_research_effort
	icon = GFX_goal_cry_eqs_tech_share
	cost = 5
	x = -2
	y = 1
	relative_position_id = CRY_from_the_annals_of_history
	prerequisite = {
		focus = CRY_from_the_annals_of_history
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_research_effort"
		decrease_illiteracy = yes
		if = {
			limit = {
				amount_research_slots < 5
			}
			add_research_slot = 1
			custom_effect_tooltip = CZE_war_college_effect_2_tt
		}
	}
}
shared_focus = { #focus about magical machines in industry
	id = CRY_magical_machinations
	icon = GFX_goal_unicorn_academy
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_research_effort
	available = {
		has_completed_focus = CRY_magicalconceptions
		has_completed_focus = CRY_machinisation
	}
	prerequisite = {
		focus = CRY_research_effort
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magical_machinations"
		effect_tooltip = {
			modify_building_resources = {
				building = arms_factory
				resource = crystals
				amount = -1
			}
			modify_building_resources = {
				building = industrial_complex
				resource = crystals
				amount = -1
			}
			modify_building_resources = {
				building = dockyard
				resource = crystals
				amount = -1
			}
		}
		add_ideas = CRY_crystal_powered_factories
		hidden_effect = {
			set_variable = {
				CRY_crystal_powered_factories_cost_mod = num_of_factories
			}
			multiply_variable = {
				CRY_crystal_powered_factories_cost_mod = -1
			}
			add_dynamic_modifier = {
				modifier = CRY_crystal_powered_factories_cost
			}
		}
	}
}
shared_focus = { #focus about special forces
	id = CRY_crystal_guard
	icon = GFX_goal_crystal_empire
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_research_effort
	prerequisite = {
		focus = CRY_research_effort
	}
	prerequisite = {
		focus = CRY_equestrian_military_staff
		focus = CRY_with_our_own_ponies
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystal_guard"
		if = {
			limit = {
				has_dlc = "Arms Against Tyranny"
			}
			add_doctrine_cost_reduction = {
				name = special_forces_bonus
				cost_reduction = 0.75
				uses = 1
				category = special_forces_doctrine
			}
			add_tech_bonus = {
				name = special_forces_bonus
				bonus = 0.75
				uses = 1
				category = special_forces_tech
			}
		}
		else = {
			add_tech_bonus = {
				name = special_forces_bonus
				bonus = 1.0
				uses = 1
				category = special_forces_tech
			}
		}
		if = {
			limit = {
				NOT = {
					has_tech = tech_pegasi
				}
			}
			set_technology = {
				tech_pegasi = 1
				popup = no
			}
		}
		else = {
			add_tech_bonus = {
				name = pegasi_tech
				uses = 1
				bonus = 2
				category = pegasi_tech
			}
		}
		division_template = {
			name = "Crystal Pegasi"
			regiments = { 
				pegasi = { x = 0 y = 0 }
				pegasi = { x = 0 y = 1 }
				pegasi = { x = 0 y = 2 }
				pegasi = { x = 0 y = 3 }
				pegasi = { x = 1 y = 0 }
				pegasi = { x = 1 y = 1 }
				pegasi = { x = 1 y = 2 }
				pegasi = { x = 1 y = 3 }
				pegasi = { x = 2 y = 0 }
				pegasi = { x = 2 y = 1 }
				pegasi = { x = 2 y = 2 }
				pegasi = { x = 2 y = 3 }
			}
			
			support = {
				engineer = { x = 0 y = 0 }
				artillery = { x = 0 y = 1 }
				anti_air = { x = 0 y = 2 }
			}
		}
		capital_scope = {

			create_unit = {
				division = "name = \"1st Crystal Pegasi\" division_template = \"Crystal Pegasi\" start_experience_factor = 0.6"
				owner = CRY
				count = 1
				allow_spawning_on_enemy_provs = no
			}
			
			create_unit = {
				division = "name = \"2nd Crystal Pegasi\" division_template = \"Crystal Pegasi\" start_experience_factor = 0.6"
				owner = CRY
				count = 1
				allow_spawning_on_enemy_provs = no
			}
			
			create_unit = {
				division = "name = \"3rd Crystal Pegasi\" division_template = \"Crystal Pegasi\" start_experience_factor = 0.6"
				owner = CRY
				count = 1
				allow_spawning_on_enemy_provs = no
			}
		}
		country_event = newcrystals.9
	}
}
shared_focus = { #focus about using amore and further building a crystal identity
	id = CRY_amore
	icon = GFX_goal_miamore
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_crystal_guard
	mutually_exclusive = {
		focus = CRY_as_she_would
	}
	prerequisite = {
		focus = CRY_crystal_guard
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_amore"
		custom_effect_tooltip = JAK_expansion_take_states_tt
		add_tech_bonus = {
			name = race_tech
			uses = 2
			bonus = 0.75
			category = race_tech
		}
		
		add_autonomy_score = {
			value = 100
			localization = CRY_amore
		}
		country_event = newcrystals.17
	}
}
shared_focus = { #focus about following Celestia's and Equestria's way of governance
	id = CRY_as_she_would
	icon = GFX_PLB_HY_CELESTIA
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_crystal_guard
	mutually_exclusive = {
		focus = CRY_amore
	}
	prerequisite = {
		focus = CRY_crystal_guard
	}
	available = {
		EQS = {
			exists = yes
			has_government = democratic
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_as_she_would"
		custom_effect_tooltip = CRY_reduce_puppet_cost
		add_tech_bonus = {
			name = electronics_bonus
			uses = 2
			bonus = 0.75
			category = electronics
		}
		every_owned_state = {
			limit = {
				impassable = no
				OR = {
					has_state_category = wasteland
					has_state_category = pastoral
					has_state_category = rural
				}
			}
			increase_state_category = yes
		}
		add_autonomy_score = {
			value = -100
			localization = CRY_as_she_would
		}
		country_event = newcrystals.18
	}
}
shared_focus = { #focus about selling crystals
	id = CRY_crystal_commerce
	icon = GFX_goal_generic_crystals
	cost = 3
	x = 1
	y = 1
	relative_position_id = CRY_crystal_services
	prerequisite = {
		focus = CRY_crystal_services
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystal_commerce"
		unlock_decision_category_tooltip = CRY_commerce_cat
		custom_effect_tooltip = CRY_unlocked_trading
	}
}
shared_focus = { #focus about agency
	id = CRY_crystal_services
	icon = GFX_goal_cry_evil_genius
	cost = 5
	x = 3
	y = 1
	relative_position_id = CRY_research_effort
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_equestrian_military_staff
		focus = CRY_with_our_own_ponies
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystal_services"
		if = {
			limit = {
				has_dlc = "La Resistance"
				has_intelligence_agency = no
			}
			create_intelligence_agency = {
				name = "Crystal Services"
				icon = GFX_intelligence_agency_logo_generic_2
			}
			gain_random_agency_upgrade = yes
		}
		else_if = {
			limit = {
				has_dlc = "La Resistance"
				has_intelligence_agency = yes
			}
			gain_random_agency_upgrade = yes
			gain_random_agency_upgrade = yes
		}
		else = {
			add_ideas = CRY_crystal_services_idea
		}
	}
}
shared_focus = { #focus about using magic to make techs better
	id = CRY_arcane_technologies_institute
	icon = GFX_goal_CTL_magic
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_with_our_own_ponies
	available = {
		has_completed_focus = CRY_magicalconceptions
		has_completed_focus = CRY_machinisation
	}
	prerequisite = {
		focus = CRY_with_our_own_ponies
		focus = CRY_equestrian_military_staff
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_arcane_technologies_institute"
		#unlock_decision_category_tooltip = CRY_magical_technologies
		custom_effect_tooltip = CRY_crystal_tech_blurb

		custom_effect_tooltip = {
			localization_key = SP_UNLOCK_PROJECT
			PROJECT = sp_magic_bullets
		}
		custom_effect_tooltip = {
			localization_key = SP_UNLOCK_PROJECT
			PROJECT = sp_magical_air_defense
		}
		custom_effect_tooltip = {
			localization_key = SP_UNLOCK_PROJECT
			PROJECT = sp_translucency
		}
		custom_effect_tooltip = {
			localization_key = magical_facility_construction_tt
			temp_facility_state_loc = "[150.GetName]"
			temp_facility_province_loc = "[150.GetCapitalVictoryPointName]"
		}
		hidden_effect = {
			if = {
				limit = { 
					150 = {
						is_fully_controlled_by = ROOT
						can_construct_building = magical_facility
					}
				}
				150 = {
					add_building_construction = {
						type = magical_facility
						level = 1
						instant_build = yes
						province = 185
					}
				}
			}
		}
		add_breakthrough_progress = {
			specialization = specialization_magical
			value = 0.5
		}
	}
}
shared_focus = { #focus about requesting equestrian help for army
	id = CRY_equestrian_military_staff
	icon = GFX_goal_cry_eqs_hat
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_from_the_annals_of_history
	ai_will_do = {
		factor = 8
	}
	prerequisite = {
		focus = CRY_from_the_annals_of_history
	}
	mutually_exclusive = {
		focus = CRY_with_our_own_ponies
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_equestrian_military_staff"
		add_ideas = equestrian_advisors
		custom_effect_tooltip = harmony_advisors_cry
		hidden_effect = {
			load_oob = CRY_equestrian_help
		}
		add_autonomy_score = {
			value = -100
			localization = CRY_equestrian_military_staff
		}
	}
}
shared_focus = { #focus about going it alone when it comes to army
	id = CRY_with_our_own_ponies
	icon = GFX_goal_generic_pony_volunteer
	cost = 5
	x = 2
	y = 1
	relative_position_id = CRY_from_the_annals_of_history
	mutually_exclusive = {
		focus = CRY_equestrian_military_staff
	}
	prerequisite = {
		focus = CRY_from_the_annals_of_history
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_with_our_own_ponies"
		add_ideas = CRY_our_own_army
		division_template = {
			name = "Crystal Divisions"
			regiments = { 
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
				infantry = { x = 0 y = 3 }
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 }
				infantry = { x = 1 y = 2 }
				infantry = { x = 1 y = 3 }
				infantry = { x = 2 y = 0 }
				infantry = { x = 2 y = 1 }
			}
			
			support = {
				engineer = { x = 0 y = 0 }
				artillery = { x = 0 y = 1 }
			}
		}
		capital_scope = {
			create_unit = {
				division = "name = \"1st Crystal Division\" division_template = \"Crystal Divisions\" start_experience_factor = 0.3"
				owner = CRY
				count = 1
				allow_spawning_on_enemy_provs = no
			}
			create_unit = {
				division = "name = \"2nd Crystal Division\" division_template = \"Crystal Divisions\" start_experience_factor = 0.3"
				owner = CRY
				count = 1
				allow_spawning_on_enemy_provs = no
			}
		}
		add_autonomy_score = {
			value = 100
			localization = CRY_with_our_own_ponies
		}
	}
}
shared_focus = { #focus about winter solstice
	id = CRY_winter_solstice
	icon = GFX_goal_winter_sun
	cost = 4
	x = -2
	y = 1
	relative_position_id = CRY_prepare_the_festivities
	available = {
		custom_trigger_tooltip = {
			tooltip = CRY_has_festivity_days_tt
			NOT = {
				has_country_flag = CRY_has_festivity
			}
		}
		has_war = no
	}
	prerequisite = {
		focus = CRY_prepare_the_festivities
	}
	bypass = {
		date > 1007.11.3
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_winter_solstice"
		set_country_flag = {
			flag = CRY_has_festivity
			days = 80
			value = 1
		}
		country_event = newcrystals.14
	}
}
shared_focus = { #focus about fishing
	id = CRY_the_riverside_industry
	icon = GFX_tradegoods
	cost = 4
	x = -1
	y = 1
	relative_position_id = CRY_winter_solstice
	prerequisite = {
		focus = CRY_winter_solstice
		focus = CRY_crystalling_anniversary
		focus = CRY_grand_festival
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_riverside_industry"
		one_random_industrial_complex = yes
		custom_effect_tooltip = BRA_brown_water_navy_idea_bonus_tt
		hidden_effect = {
			set_technology = {
				ToA_river_boats_tech = 1
			}
		}
		navy_experience = 35
	}
}
shared_focus = { #focus about crystalling
	id = CRY_crystalling_anniversary
	icon = GFX_goal_crystalling
	cost = 4
	x = 0
	y = 1
	relative_position_id = CRY_prepare_the_festivities
	available = {
		custom_trigger_tooltip = {
			tooltip = CRY_has_festivity_days_tt
			NOT = {
				has_country_flag = CRY_has_festivity
			}
		}
	}
	prerequisite = {
		focus = CRY_prepare_the_festivities
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystalling_anniversary"
		set_country_flag = {
			flag = CRY_has_festivity
			days = 80
			value = 1
		}
		add_political_power = 120
		add_war_support = 0.05
		
		add_autonomy_score = {
			value = 50
			localization = CRY_crystalling_anniversary
		}
		country_event = newcrystals.19
	}
}
shared_focus = { #focus about grand festival
	id = CRY_grand_festival
	icon = GFX_goal_cry_festival
	cost = 4
	x = 2
	y = 1
	relative_position_id = CRY_prepare_the_festivities
	available = {
		custom_trigger_tooltip = {
			tooltip = CRY_has_festivity_days_tt
			NOT = {
				has_country_flag = CRY_has_festivity
			}
		}
		has_war = no
	}
	prerequisite = {
		focus = CRY_prepare_the_festivities
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_grand_festival"
		country_event = { id = newcrystals.16 days = 1 }
		set_country_flag = {
			flag = CRY_has_festivity
			days = 80
			value = 1
		}
		add_timed_idea = {
			idea = grand_festival
			days = 30
		}
	}
}
shared_focus = { #focus about increasing the production of cultural-related stuff
	id = CRY_cultural_products
	icon = GFX_focus_CHL_enlarge_the_textile_industries
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_grand_festival
	prerequisite = {
		focus = CRY_winter_solstice
		focus = CRY_crystalling_anniversary
		focus = CRY_grand_festival
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_cultural_products"
		add_ideas = CRY_all_weather_gear
		decrease_poverty = yes
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
	}
}
shared_focus = { #focus about winter solstice
	id = CRY_combat_the_dark_spectre
	icon = GFX_goal_dark_heart
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_winter_solstice
	prerequisite = {
		focus = CRY_winter_solstice
		focus = CRY_crystalling_anniversary
		focus = CRY_grand_festival
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_combat_the_dark_spectre"
		add_political_power = 50
		add_command_power = 25
		army_experience = 25
		set_country_flag = CRY_get_rid_of_sombra_in_progress
		unlock_decision_tooltip = CRY_arrest_sombraists
	}
}
shared_focus = { #focus about volunteers buff
	id = CRY_volunteers
	icon = GFX_goal_cry_deep_integration
	cost = 4
	x = 3
	y = 1
	relative_position_id = CRY_winter_solstice
	prerequisite = {
		focus = CRY_winter_solstice
		focus = CRY_crystalling_anniversary
		focus = CRY_grand_festival
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_volunteers"
		add_ideas = CRY_volunteer_army
	}
}
shared_focus = { #focus about increasing the power of the heart
	id = CRY_the_power_of_the_heart
	icon = GFX_goal_crystal_heart_cry
	cost = 4
	x = -1
	y = 1
	relative_position_id = CRY_combat_the_dark_spectre
	prerequisite = {
		focus = CRY_combat_the_dark_spectre
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_combat_the_dark_spectre"
		53 = {
			add_building_construction = {
				type = anti_air_building
				level = 2
				instant_build = yes
			}
			add_extra_state_shared_building_slots = 1
		}
		344 = {
			add_building_construction = {
				type = anti_air_building
				level = 2
				instant_build = yes
			}
			add_extra_state_shared_building_slots = 1
		}
		345 = {
			add_building_construction = {
				type = anti_air_building
				level = 2
				instant_build = yes
			}
			add_extra_state_shared_building_slots = 1
		}
		if = {
			limit = {
				has_dlc = "Gotterdammerung"
			}
			53 = {
				add_building_construction = {
					type = stronghold_network
					level = 1
					instant_build = yes
				}
			}
			344 = {
				add_building_construction = {
					type = stronghold_network
					level = 1
					instant_build = yes
				}
			}
			345 = {
				add_building_construction = {
					type = stronghold_network
					level = 1
					instant_build = yes
				}
			}
		}
	}
}
shared_focus = { #focus about refugees from yaks
	id = CRY_yak_refugees
	icon = GFX_focus_great_yak
	cost = 4
	x = -1
	y = 1
	relative_position_id = CRY_volunteers
	prerequisite = {
		focus = CRY_volunteers
	}
	available = {
		YAK = {
			OR = {
				exists = no
				has_country_leader = {
					character = YAK_karsak_sukhbataar
					ruling_only = yes
				}
			}
		}
		JAK = {
			OR = {
				exists = no
				has_government = fascism
			}
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_yak_refugees"
		add_timed_idea = {
			idea = CRY_yak_exiles
			days = 180
		}
	}
}
shared_focus = { #focus about refugees from stg
	id = CRY_stg_refugees
	icon = GFX_goal_stg_cry
	cost = 4
	x = 1
	y = 1
	relative_position_id = CRY_volunteers
	prerequisite = {
		focus = CRY_volunteers
	}
	
	available = {
		STG = {
			OR = {
				has_government = fascism
				has_country_leader = {
					character = STG_sinister_serov
					ruling_only = yes
				}
			}
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stg_refugees"
		add_timed_idea = {
			idea = CRY_stg_exiles
			days = 180
		}
	}
}
###############
### COMMIES ###
###############
# shared_focus = { #commie path starts
# 	id = CRY_the_crystal_labor_movement
# 	icon = GFX_goal_crystal_empire_symbol_cry
# 	cost = 5
# 	x = -10
# 	y = 1
# 	offset = {
# 		trigger = {
# 			has_completed_focus = CRY_the_crystal_labor_movement
# 		}
# 		x = 6
# 		y = 0
# 	}
# 	relative_position_id = CRY_crystal_fair
# 	ai_will_do = {
# 		factor = 8
# 	}
# 	prerequisite = {
# 		focus = CRY_crystal_fair
# 	}
# 	prerequisite = {
# 		focus = CRY_equestria_games
# 	}
	
# 	mutually_exclusive = {
# 		focus = CRY_the_way_of_harmony
# 	}
# 	allow_branch = {
# 		NOT = {
# 			has_completed_focus = CRY_the_way_of_harmony
# 		}
# 	}
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_crystal_labor_movement"
# 		country_event = { id = crycom.5 days = 1 }
# 		add_stability = -0.05
# 		add_popularity = {
# 			ideology = communism
# 			popularity = 0.1
# 		}		
# 		swap_ideas = {
# 			remove_idea = CRY_commie_unrest
# 			add_idea = CRY_commies_very_unrested
# 		}
# 		unlock_decision_category_tooltip = CRY_crossroads_of_destiny_cry_cat
# 		add_autonomy_score = {
# 			value = 100
# 			localization = CRY_the_crystal_labor_movement
# 		}
# 		custom_effect_tooltip = CRY_puppet_now_available

# 	}
# }
# shared_focus = {
# 	id = CRY_communistideas
# 	icon = GFX_goal_crystal_commies
# 	cost = 5
# 	prerequisite = {
# 		focus = CRY_the_crystal_labor_movement
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 	}
# 	ai_will_do = {
# 		base = 8
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_the_crystal_labor_movement
# 	x = -1
# 	y = 1
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_communistideas"
# 		add_timed_idea = { idea = communist_influence days = 270 } 
# 		country_event = {
# 			id = crycom.5 days = 2
# 		}
# 		add_stability = -0.025
# 		custom_effect_tooltip = CRY_colony_now_available
# 	}
# }

# shared_focus = {
# 	id = CRY_comrevolution
# 	icon = GFX_goal_cry_democratic
# 	cost = 5
# 	prerequisite = {
# 		focus = CRY_the_crystal_labor_movement
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_the_crystal_labor_movement
# 	x = 1
# 	y = 1
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_comrevolution"
# 		country_event = { id = crycom.6 days = 1 }
# 		add_stability = -0.025
# 		add_popularity = { ideology = communism popularity = 0.1}
# 		add_autonomy_score = {
# 			value = 200
# 			localization = CRY_comrevolution
# 		}
# 	}
# }

# shared_focus = {
# 	id = CRY_plead_with_cadance
# 	icon = GFX_goal_cry_democratic
# 	cost = 5
# 	prerequisite = {
# 		focus = CRY_comrevolution
# 	}
# 	prerequisite = {
# 		focus = CRY_communistideas
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_the_crystal_labor_movement
# 	x = 0
# 	y = 2
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_comrevolution"
# 		add_autonomy_score = {
# 			value = 250
# 			localization = CRY_comrevolution
# 		}
# 		custom_effect_tooltip = CRY_dominion_now_available
# 	}
# }

# shared_focus = {
# 	id = CRY_invite_the_famous_ponies
# 	icon = GFX_goal_stg_cry
# 	cost = 3
# 	prerequisite = {
# 		focus = CRY_communistideas
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_communistideas
# 	x = -1
# 	y = 1
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_invite_the_famous_ponies"
# 		country_event = {
# 			id = crycom.7 days = 1
# 		}
# 	}
# }

# shared_focus = {
# 	id = CRY_general_strike_in_crystal_city
# 	icon = GFX_goal_stg_cry
# 	cost = 3
# 	prerequisite = {
# 		focus = CRY_communistideas
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_communistideas
# 	x = 0
# 	y = 2
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_general_strike_in_crystal_city"
# 		add_autonomy_score = {
# 			value = 300
# 			localization = CRY_general_strike_in_crystal_city
# 		}
# 		add_ideas = CRY_general_strike
# 	}
# }

# shared_focus = {
# 	id = CRY_force_mayor_snap_elections
# 	icon = GFX_goal_stg_cry
# 	cost = 3
# 	prerequisite = {
# 		focus = CRY_comrevolution
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_comrevolution
# 	x = 0
# 	y = 2
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_force_mayor_snap_elections"
# 		add_autonomy_score = {
# 			value = 300
# 			localization = CRY_force_mayor_snap_elections
# 		}
# 		custom_effect_tooltip = available_political_advisor
# 		show_ideas_tooltip = CRY_poet_of_the_revolution
# 	}
# }
# shared_focus = {
# 	id = CRY_wheel_cooperative
# 	icon = GFX_goal_stg_cry
# 	cost = 3
# 	prerequisite = {
# 		focus = CRY_comrevolution
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_comrevolution
# 	x = 1
# 	y = 1
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_comrevolution"
# 		#event where crystal ponies, inspirited by ideas of Marks, organazing their cooperative in the city, and Artcic Lily wants that ponies should know about it and wanna write their story by millionary exemplares! 
# 		country_event = {				
# 			id = crycom.10 days = 1
# 		}
# 		add_ideas = CRY_cooperatives
# 	}
# }
shared_focus = {
	id = CRY_demand_the_referendum
	icon = GFX_goal_stg_cry
	cost = 10
	prerequisite = {
		focus = CRY_equestrian_tutelage
	}
	available = {
		NOT = { has_government = fascism }
		NOT = {
			has_country_flag = CRY_solar_governorship 
			has_country_flag = CRY_lunar_governorship 
		}
		has_war = no
		communism > 0.5
		OR = {
			compare_autonomy_state > autonomy_colony
			custom_trigger_tooltip = {
				tooltip = CRY_more_STG_influence
				check_variable = {
					STG.stg_crossroads_of_destiny_influence > EQS.eqs_crossroads_of_destiny_influence
				}
			}
		}
	}
	ai_will_do = {
		base = 5
	}
	bypass = {
		has_government = communism
	}
		
	mutually_exclusive = {
		focus = CRY_multipolar_concept
	}
	allow_branch = {
		NOT = {
			has_completed_focus = CRY_multipolar_concept
		}
	}
		
	offset = {
		x = 24
		y = 0
		trigger = { has_completed_focus = CRY_demand_the_referendum }
	}
	
	relative_position_id = CRY_equestrian_tutelage
	x = -19
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_comrevolution"
		country_event = {
			id = crycom.11 days = 1
		}
		add_ideas = CRY_inexperienced_officers
	}
}

# shared_focus = {
# 	id = CRY_work_for_a_free_crystalia
# 	icon = GFX_goal_stg_cry
# 	cost = 5
# 	prerequisite = {
# 		focus = CRY_communistideas
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_communistideas
# 	x = -2
# 	y = 2
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_general_strike_in_crystal_city"
# 		add_autonomy_score = {
# 			value = 500
# 			localization = CRY_work_for_a_free_crystalia
# 		}
# 	}
# }

# shared_focus = {
# 	id = CRY_connections_with_the_commune
# 	icon = GFX_goal_stg_cry
# 	cost = 5
# 	prerequisite = {
# 		focus = CRY_comrevolution
# 	}
# 	available = {
# 		NOT = { has_government = fascism }
# 		NOT = {
# 			has_country_flag = CRY_solar_governorship 
# 			has_country_flag = CRY_lunar_governorship 
# 		}
# 		has_war = no
# 	}
# 	ai_will_do = {
# 		base = 5
# 	}
# 	bypass = {
# 		has_government = communism
# 	}
# 	relative_position_id = CRY_comrevolution
# 	x = 2
# 	y = 2
# 	completion_reward = {
# 		log = "[GetDateText]: [Root.GetName]: Focus CRY_connections_with_the_commune"
# 		add_autonomy_score = {
# 			value = 500
# 			localization = CRY_connections_with_the_commune
# 		}
# 	}
# }

### arctic lily ###
shared_focus = {
	id = CRY_welfare
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_demand_the_referendum
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_demand_the_referendum
	x = -4
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		# custom_effect_tooltip = available_political_advisor
		# show_ideas_tooltip = ponies_act
	}
}
shared_focus = {
	id = CRY_the_power_of_voice_the_power_of_vote
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_demand_the_referendum
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_demand_the_referendum
	x = -6
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		
	}
}
shared_focus = {
	id = CRY_slow_collectivisation
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_welfare
	}
	prerequisite = {
		focus = CRY_the_power_of_voice_the_power_of_vote
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_welfare
	x = -3
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		
	}
}
shared_focus = {
	id = CRY_careful_cooperation_with_other_neighbors
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_welfare
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_welfare
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		
	}
}
shared_focus = {
	id = CRY_socialst_press
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_slow_collectivisation
	}
	prerequisite = {
		focus = CRY_careful_cooperation_with_other_neighbors
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_slow_collectivisation
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		
	}
}
shared_focus = {
	id = CRY_security_for_our_citizens
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_socialst_press
	}
	prerequisite = {
		focus = CRY_destroy_sombra_soup
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_socialst_press
	x = 1
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		
	}
}
shared_focus = {
	id = CRY_magic_of_proletariat
	icon = GFX_goal_cry_com_magic
	cost = 10
	prerequisite = {
		focus = CRY_demand_the_referendum
	}
	available = {
		has_government = communism
	}
	ai_will_do = {
		factor = 20
	}
	relative_position_id = CRY_demand_the_referendum
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magic_of_proletariat"
		add_ideas = magic_of_proletariat
	}
}
shared_focus = {
	id = CRY_vote_for_syndicates
	icon = GFX_goal_cry_com_magic
	cost = 10
	prerequisite = {
		focus = CRY_magic_of_proletariat
	}
	available = {
		has_government = communism
	}
	ai_will_do = {
		factor = 20
	}
	relative_position_id = CRY_magic_of_proletariat
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magic_of_proletariat"
		
	}
}
shared_focus = {
	id = CRY_crystalscom
	icon = GFX_goal_cry_com_crystals
	cost = 10
	prerequisite = {
		focus = CRY_magic_of_proletariat
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_magic_of_proletariat
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystalscom"
		add_ideas = CRY_communist_crystals
	}
	search_filters = { FOCUS_FILTER_ARMY_BONUS }
}
shared_focus = {
	id = CRY_synchrophasetron
	icon = GFX_goal_cry_com_sync
	cost = 10
	prerequisite = {
		focus = CRY_crystalscom
	}
	prerequisite = {
		focus = CRY_vote_for_syndicates
	}
	ai_will_do = {
		factor = 20
	}
	relative_position_id = CRY_crystalscom
	x = -1
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_synchrophasetron"
		add_ideas = CRY_synchrophasetron_bonus
	}
}
shared_focus = {
	id = CRY_seek_the_best_specialists
	icon = GFX_goal_cry_com_magic
	cost = 10
	prerequisite = {
		focus = CRY_synchrophasetron
	}
	available = {
		has_government = communism
	}
	ai_will_do = {
		factor = 20
	}
	relative_position_id = CRY_synchrophasetron
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magic_of_proletariat"
		
	}
}
shared_focus = {
	id = CRY_development_of_magical_military_industry
	icon = GFX_goal_cry_com_magic
	cost = 10
	prerequisite = {
		focus = CRY_seek_the_best_specialists
	}
	prerequisite = {
		focus = CRY_proletary
	}
	available = {
		has_government = communism
	}
	ai_will_do = {
		factor = 20
	}
	relative_position_id = CRY_seek_the_best_specialists
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magic_of_proletariat"
		
	}
}
shared_focus = {
	id = CRY_the_largest_center_of_research_on_equus
	icon = GFX_goal_cry_com_sync
	cost = 10
	prerequisite = {
		focus = CRY_synchrophasetron
	}
	relative_position_id = CRY_synchrophasetron
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_altersource"
		swap_ideas = { add_idea = CRY_synchrophasetron_bonus1 remove_idea = CRY_synchrophasetron_bonus }
	}
}

shared_focus = {
	id = CRY_pyatiletka
	icon = GFX_goal_cry_five_year_plan
	cost = 10
	prerequisite = {
		focus = CRY_demand_the_referendum
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_demand_the_referendum
	x = 6
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_pyatiletka"
		add_timed_idea = { idea = CRY_five_year_plan days = 1800 }
		#TODO selection_effect event, where you can choose the strongest option of this spirit, if Cadance leave CRY. If not - event where Cadance using her authority to stop that plan
	}
}
shared_focus = {
	id = CRY_collectivisation
	icon = GFX_goal_cry_com_agriculture
	cost = 10
	prerequisite = {
		focus = CRY_demand_the_referendum
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_demand_the_referendum
	x = 4
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_collectivisation"
		add_timed_idea = { idea = collectivization_effort3 days = 800 }
		#TODO selection_effect event, where you can choose the strongest option of this spirit, if Cadance leave CRY. If not - event where Cadance using her authority to stop that plan
	}
}
shared_focus = {
	id = CRY_party_solves_the_problems
	icon = GFX_goal_cry_com_agriculture
	cost = 10
	prerequisite = {
		focus = CRY_collectivisation
	}
	prerequisite = {
		focus = CRY_pyatiletka
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_collectivisation
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_collectivisation"
		#TODO selection_effect event, where you can choose the strongest option (increasing party power) of this spirit, if Cadance leave CRY. If not - event where Cadance using her authority to stop that plan
	}
}
shared_focus = {
	id = CRY_we_must_fight_for_our_freedom
	icon = GFX_goal_cry_com_agriculture
	cost = 10
	prerequisite = {
		focus = CRY_collectivisation
	}
	prerequisite = {
		focus = CRY_pyatiletka
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_collectivisation
	x = 3
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_collectivisation"
		
	}
}
shared_focus = {
	id = CRY_closer_cooperation_with_severyanian_comrades
	icon = GFX_goal_cry_com_agriculture
	cost = 10
	prerequisite = {
		focus = CRY_party_solves_the_problems
	}
	prerequisite = {
		focus = CRY_we_must_fight_for_our_freedom
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_party_solves_the_problems
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_collectivisation"
		
	}
}
shared_focus = {
	id = CRY_red_crystal_star_manufacturing
	icon = GFX_goal_cry_com_agriculture
	cost = 10
	prerequisite = {
		focus = CRY_closer_cooperation_with_severyanian_comrades
	}
	prerequisite = {
		focus = CRY_prepare_workers_to_defence
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_closer_cooperation_with_severyanian_comrades
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_collectivisation"
		#TODO, make visible options for tank MiO and more funds for every tank/plane/motorized MiOs
	}
}
### left common branch ###
shared_focus = {
	id = CRY_researchagreement
	icon = GFX_goal_cry_com_atom
	cost = 10
	prerequisite = {
		focus = CRY_welfare
		focus = CRY_collectivisation
	}
	ai_will_do = {
		factor = 15
	}
	relative_position_id = CRY_demand_the_referendum
	x = -3
	y = 2
	available = {
		has_country_flag = STG_agreed_cooperation
		has_government = communism
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_researchagreement"
		#TODO this will be an focus, which you should choose the option of education programs. What should affect on other focuses. Cooperation research could stay too
		#TODO first option is fast mass education, which should kill your economy on a year or something, but completly remove problem, Should make stronger your industrial focuses
		#TODO second option is gradually eucation, slower increasing of science base, but no hard debuffs. Should make stronger your military bonuses, but some industrial will be locked by science base conditions.
		country_event = {
			id = crycom.7 days = 1
		}
		STG = {
			country_event = {
				id = stalliongrad.101 days = 1 }
		}
	}
}
shared_focus = {
	id = CRY_ministry
	icon = GFX_goal_cry_com_ministry
	cost = 10
	prerequisite = {
		focus = CRY_researchagreement
	}
	ai_will_do = {
		factor = 15
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_researchagreement
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_ministry"
		#TODO make this focus avalible after mass education, if that option was choosed
		#TODO or make this focus reducing the size of army and army groups for every commander, will increase leader expirience gain and division expirience, but will block CRY_proletary until you get some casualities or army XP during the war with major
		add_ideas = ministry_of_defense
		army_experience = 25
		add_doctrine_cost_reduction = {
			name = land_doc_bonus
			cost_reduction = 0.5
			uses = 2
			category = land_doctrine
		}
	}
	search_filters = { FOCUS_FILTER_MANPOWER FOCUS_FILTER_WAR_SUPPORT }
}
shared_focus = {
	id = CRY_destroy_sombra_soup
	icon = GFX_goal_cry_sombra_threat_destroyed
	cost = 10
	prerequisite = {
		focus = CRY_ministry
	}
	relative_position_id = CRY_ministry
	x = -2
	y = 1
	bypass = {
		NOT = {
			has_idea = CRY_sombra_threat
			has_idea = CRY_sombra_threat2
			has_idea = CRY_sombra_threat3
			has_idea = CRY_sombra_threat4
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_destroy_sombra_soup"
		effect_tooltip = {
			add_political_power = -200
			CRY_remove_sombra_threat = yes
		}
		country_event = {
			id = crycom.8 days = 20		#should eb something flavor with arresting them
		}
	}
	search_filters = { FOCUS_FILTER_POLITICAL }
}
shared_focus = {
	id = CRY_research_commie
	icon = GFX_goal_cry_com_atom
	cost = 12
	prerequisite = {
		focus = CRY_ministry
	}
	available = {
		has_government = communism
	}
	ai_will_do = {
		factor = 20
	}
	bypass = {
		NOT = { amount_research_slots < 5 }
	}
	relative_position_id = CRY_ministry
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_research_commie"
		if = {
			limit = {
				amount_research_slots < 5
			}
			add_research_slot = 1
			custom_effect_tooltip = CZE_war_college_effect_2_tt
		}
		#TODO focus should be available only after you deal with at least half of education program
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_proletary
	icon = GFX_goal_cry_star
	cost = 10
	prerequisite = {
		focus = CRY_research_commie
	}
	ai_will_do = {
		factor = 15
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_research_commie
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_proletary"
		swap_ideas = {
			remove_idea = CRY_inexperienced_officers
			add_idea = CRY_military_school
		}
		hidden_effect = {
			remove_ideas = communist_influence
		}
		add_ideas = CRY_ponies_army
	}
	search_filters = { FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_MANPOWER }
}
shared_focus = {
	id = CRY_question_about_payment_for_nationalization
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_security_for_our_citizens
		focus = CRY_proletary
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_proletary
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		#TODO, event which should let you pay for enterprizes to EQS or NLR in exchange for non-agression pact
	}
}
shared_focus = {
	id = CRY_project_RoboGolem
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_seek_the_best_specialists
	}
	prerequisite = {
		focus = CRY_development_of_magical_military_industry
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_development_of_magical_military_industry
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		#TODO Magical Robot Golem project!
	}
}
shared_focus = {
	id = CRY_crystals_in_exchange_for_high_technolihies
	icon = GFX_goal_cry_welfare
	cost = 10
	prerequisite = {
		focus = CRY_development_of_magical_military_industry
		focus = CRY_question_about_payment_for_nationalization
	}
	available = {
		has_government = communism
		has_war_together_with = EQS
	}
	relative_position_id = CRY_development_of_magical_military_industry
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_welfare"
		
	}
}
### right common branch ###
shared_focus = {
	id = CRY_stgadvisory
	icon = GFX_goal_cry_stalliongrad
	cost = 10
	prerequisite = {
		focus = CRY_magic_of_proletariat
	}
	ai_will_do = {
		factor = 15
	}
	available = {
		has_government = communism
	}
	bypass = {
		STG = {
			OR = {
				has_country_flag = darkwing_elected
				NOT = { has_government = communism }
				exists = no
			}
		}
	}
	relative_position_id = CRY_magic_of_proletariat
	x = 3
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stgadvisory"
		country_event = {
			id = crycom.4 days = 1
		}
		# if = {
		# 	limit = { has_country_flag = larger_civil_war }
		# 	unlock_decision_tooltip = CRY_miamorefate_d
		# }
		#TODO if STG agree to help, it gets a debuff reducing %pp and consumer goods for 1-2 years, but while this spirit is active you'll get more bonuses from industrial focuses 
	}
}
shared_focus = {
	id = CRY_stgindustry
	icon = GFX_goal_cry_com_industry
	cost = 10
	prerequisite = {
		focus = CRY_stgadvisory
	}
	relative_position_id = CRY_stgadvisory
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stgindustry"
		add_ideas = trade_relations_with_stalliongrad
		#TODO, spirit should avalible only if STG agree on your suggestion. Then it will be permanent.
		#TODO, focus should be locked, until your solve education problem at least for 40%
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = arms_factory
					size > 0
					include_locked = yes
				}
				OR = {
					is_in_home_area = yes
					NOT = {
						owner = {
							any_owned_state = {
								free_building_slots = {
									building = arms_factory
									size > 0
									include_locked = yes
								}
								is_in_home_area = yes
							}
						}
					}
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = arms_factory
				level = 2
				instant_build = yes
			}
		}
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = industrial_complex
					size > 0
					include_locked = yes
				}
				OR = {
					is_in_home_area = yes
					NOT = {
						owner = {
							any_owned_state = {
								free_building_slots = {
									building = industrial_complex
									size > 0
									include_locked = yes
								}
								is_in_home_area = yes
							}
						}
					}
				}
			}
			add_extra_state_shared_building_slots = 3
			add_building_construction = {
				type = industrial_complex
				level = 3
				instant_build = yes
			}
		}
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = infrastructure
					size > 0
				}
				OR = {
					is_in_home_area = yes
					NOT = {
						owner = {
							any_owned_state = {
								free_building_slots = {
									building = infrastructure
									size > 0
								}
								is_in_home_area = yes
							}
						}
					}
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = infrastructure
				level = 2
				instant_build = yes
			}
		}
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = infrastructure
					size > 0
				}
				OR = {
					is_in_home_area = yes
					NOT = {
						owner = {
							any_owned_state = {
								free_building_slots = {
									building = infrastructure
									size > 0
								}
								is_in_home_area = yes
							}
						}
					}
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = infrastructure
				level = 2
				instant_build = yes
			}
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_the_crystal_combinate
	icon = GFX_goal_cry_com_industry
	cost = 10
	prerequisite = {
		focus = CRY_stgindustry
	}
	relative_position_id = CRY_stgindustry
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stgindustry"
		#TODO, more factories in Crystal City or some kind of production spirit? Maybe both?
		#TODO, focus should be locked, until your solve education problem at least for 60%
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_prepare_workers_to_defence
	icon = GFX_goal_cry_com_industry
	cost = 10
	prerequisite = {
		focus = CRY_stgindustry
	}
	relative_position_id = CRY_stgindustry
	x = 2
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stgindustry"
		#TODO, focus should be locked, until your solve education problem at least for 70%
		#TODO, open decisions for building fortifications in Crystal City and supply hubs around
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_magical_automatization_of_the_mines
	icon = GFX_goal_cry_com_industry
	cost = 10
	prerequisite = {
		focus = CRY_the_crystal_combinate
	}
	relative_position_id = CRY_the_crystal_combinate
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stgindustry"
		#TODO, some spirit which decrasing production retention and growth, also construction speed, but increasing max efficiency and factory output
		#TODO, focus should be locked, until your solve education problem at least for 90%
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_altersource
	icon = GFX_goal_altersource
	cost = 10
	prerequisite = {
		focus = CRY_the_largest_center_of_research_on_equus
	}
	prerequisite = {
		focus = CRY_magical_automatization_of_the_mines
	}
	relative_position_id = CRY_the_largest_center_of_research_on_equus
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_altersource"
		swap_ideas = { add_idea = CRY_synchrophasetron_bonus1 remove_idea = CRY_synchrophasetron_bonus }
		#TODO nuclear facility here and breaktrough bonuse, also nobuses for magical facility
		#TODO, focus should be locked, until your solve education problem
	}
}
shared_focus = {
	id = CRY_termonuclear_energy
	icon = GFX_goal_altersource
	cost = 10
	prerequisite = {
		focus = CRY_altersource
	}
	prerequisite = {
		focus = CRY_the_largest_center_of_research_on_equus
	}
	relative_position_id = CRY_altersource
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_altersource"
		#TODO, focus should be locked, until your solve education problem
		#TODO, more sweet bonuses for nuclear energy projects
	}
}
shared_focus = {
	id = CRY_industry_servers_the_regular_ponies
	icon = GFX_goal_cry_com_industry
	cost = 10
	prerequisite = {
		focus = CRY_magical_automatization_of_the_mines
		focus = CRY_red_crystal_star_manufacturing
	}
	relative_position_id = CRY_magical_automatization_of_the_mines
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stgindustry"
		
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_the_peoples_megapolis
	icon = GFX_goal_cry_com_industry
	cost = 10
	prerequisite = {
		focus = CRY_industry_servers_the_regular_ponies
		focus = CRY_altersource
	}
	relative_position_id = CRY_industry_servers_the_regular_ponies
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_stgindustry"
		
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_socialist_union
	icon = GFX_goal_cry_socialist_union
	cost = 10
	prerequisite = {
		focus = CRY_crystals_in_exchange_for_high_technolihies
		focus = CRY_synchrophasetron
		focus = CRY_project_RoboGolem
		focus = CRY_termonuclear_energy
		focus = CRY_the_peoples_megapolis
	}
	available = {
		has_government = communism
	}
	relative_position_id = CRY_synchrophasetron
	x = 0
	y = 4
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_socialist_union"
		if = {
			limit = {
				STG = {
					OR = {
						exists = no
						NOT = { has_government = communism }
					}
				}
			}
			set_rule = { can_create_factions = yes }
			create_faction = "Socialist_Union"
		}
		#TODO or some nice cooperation_spirit, or, if EQS is under Nightmare/Daybreaker something for defence agaisnt them
	}
	search_filters = { FOCUS_FILTER_POLITICAL }
}
shared_focus = {
	id = CRY_libeartion_of_yakistan
	icon = GFX_goal_cry_socialist_union
	cost = 10
	prerequisite = {
		focus = CRY_crystals_in_exchange_for_high_technolihies
		focus = CRY_the_peoples_megapolis
		focus = CRY_project_RoboGolem
		focus = CRY_termonuclear_energy
	}
	available = {
		has_government = communism
		YAK = { NOT = { has_government = communism } }
	}
	bypass = {
		has_government = communism
		YAK = { has_government = communism }
	}
	relative_position_id = CRY_synchrophasetron
	x = -2
	y = 4
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_socialist_union"
		#TODO, liberate yaks, if there non harmonist or communist goverment
	}
	search_filters = { FOCUS_FILTER_POLITICAL }
}
shared_focus = {
	id = CRY_libeartion_of_stalliongrad
	icon = GFX_goal_cry_socialist_union
	cost = 10
	prerequisite = {
		focus = CRY_crystals_in_exchange_for_high_technolihies
		focus = CRY_the_peoples_megapolis
		focus = CRY_project_RoboGolem
		focus = CRY_termonuclear_energy
	}
	available = {
		has_government = communism
		STG = { NOT = { has_government = communism } }
	}
	bypass = {
		has_government = communism
		STG = { has_government = communism }
	}
	relative_position_id = CRY_synchrophasetron
	x = 2
	y = 4
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_socialist_union"
		#TODO liberate and core STG, if it was captured by non-communist
	}
	search_filters = { FOCUS_FILTER_POLITICAL }
}
shared_focus = {
	id = CRY_union
	icon = GFX_goal_cry_com_union
	cost = 10
	prerequisite = {
		focus = CRY_socialist_union
	}
	relative_position_id = CRY_socialist_union
	x = 0
	y = 1
	available = {
		has_government = communism
		EQS = {
			has_government = communism
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_union"
		country_event = crycom.14
		#TODO, something cool
	}
}
##############
### SOMBRA ###
##############
shared_focus = { #sombra starts - RADIANT HOPE ALIVE
	id = CRY_the_king_of_monsters
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 7
	x = 7
	y = 1
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_king_of_monsters"
		add_ideas = sombra_strength_CRY
		hidden_effect = {
			country_event = {
				id = crystalsombra.24
				days = 120
			}

		}
	}
}
# army sub-tree
shared_focus = { #sombra examines the new world
	id = CRY_a_thousand_years_passed
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 3
	x = -5
	y = 1
	relative_position_id = CRY_the_king_of_monsters
	prerequisite = {
		focus = CRY_the_king_of_monsters
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_thousand_years_passed"
		swap_ideas = {
			remove_idea = CRY_a_millennium_gone
			add_idea = CRY_beginning_to_catch_up
		}
		increase_society_development = yes
		country_event = crystalsombra.23
	}
}

shared_focus = { #sombra reviews motorized proposals
	id = CRY_speed_tactics
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -2
	y = 1
	relative_position_id = CRY_a_thousand_years_passed
	prerequisite = {
		focus = CRY_a_thousand_years_passed
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_armor_wonderweapons"
		one_random_arms_factory = yes
		custom_effect_tooltip = TBK_equestrian_car_tech_tp
		hidden_effect = {
			set_technology = {
				popup = no
				TBK_equestrian_car_tech = 1
			}
			fix_weapon_techs = yes
		}
	}
}

shared_focus = { #sombra reviews mech proposals
	id = CRY_armored_recovery_vehicles
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_speed_tactics
	prerequisite = {
		focus = CRY_speed_tactics
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_armor_wonderweapons"
		one_random_arms_factory = yes
		set_technology = { popup = yes CRY_equipment_capture = 1 }
		custom_effect_tooltip = tech_effect|CRY_equipment_capture
	}
}
shared_focus = { #sombra reviews tank proposals
	id = CRY_armor_wonderweapons
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_speed_tactics
	prerequisite = {
		focus = CRY_speed_tactics
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_armor_wonderweapons"
		one_random_arms_factory = yes
		set_technology = { popup = yes MAN_all_terrain_panzer_tracks = 1 }
		custom_effect_tooltip = MAN_all_terrain_panzer_tracks_buff
	}
}
shared_focus = { #sombra reviews artillery proposals
	id = CRY_big_guns_som
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_a_thousand_years_passed
	prerequisite = {
		focus = CRY_a_thousand_years_passed
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_big_guns_som"
		one_random_arms_factory = yes
		set_technology = { popup = yes MAN_electrometerological_weapons_technology = 1 }
		custom_effect_tooltip = MAN_electrometerological_weapons_technology_buff
	}
}

shared_focus = { #sombra reviews infantry proposals
	id = CRY_the_common_soldier
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 2
	y = 1
	relative_position_id = CRY_a_thousand_years_passed
	prerequisite = {
		focus = CRY_a_thousand_years_passed
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_common_soldier"
		one_random_arms_factory = yes
		set_technology = { popup = yes CRY_sombra_unending_legion = 1}
		custom_effect_tooltip = tech_effect|CRY_sombra_unending_legion
	}
}

shared_focus = { #sombra reviews support proposals
	id = CRY_the_non_combat_tools
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 2
	relative_position_id = CRY_a_thousand_years_passed
	prerequisite = {
		focus = CRY_big_guns_som
	}
	prerequisite = {
		focus = CRY_the_common_soldier
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_non_combat_tools"
		one_random_arms_factory = yes
		set_technology = { popup = yes lotta_svard_tech = 1}
		custom_effect_tooltip = tech_effect|lotta_svard_tech
	}
}

shared_focus = { #sombra reviews fighter proposals
	id = CRY_conquer_the_skies
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_the_non_combat_tools
	prerequisite = {
		focus = CRY_the_non_combat_tools
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_conquer_the_skies"
		one_random_arms_factory = yes
		set_technology = { popup = yes CRY_conquer_the_skies_tech = 1}
		custom_effect_tooltip = tech_effect|CRY_conquer_the_skies_tech 
	}
}

shared_focus = { #sombra reviews CAS proposals
	id = CRY_rain_death_upon_them
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_the_non_combat_tools
	prerequisite = {
		focus = CRY_conquer_the_skies
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_rain_death_upon_them"
		one_random_arms_factory = yes
		set_technology = { popup = yes CRY_rain_death_upon_them_tech = 1}
		custom_effect_tooltip = tech_effect|CRY_rain_death_upon_them_tech
	}
}

shared_focus = { #sombra reviews tac proposals
	id = CRY_air_interdiction
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_conquer_the_skies
	prerequisite = {
		focus = CRY_conquer_the_skies
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_air_interdiction"
		one_random_arms_factory = yes
		set_technology = { popup = yes CRY_air_interdiction_tech = 1}
		custom_effect_tooltip = tech_effect|CRY_air_interdiction_tech
	}
}

shared_focus = { #sombra starts finally building a navy
	id = CRY_oceanic_ambitions
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_rain_death_upon_them
	prerequisite = {
		focus = CRY_rain_death_upon_them
	}
	available = {
		any_controlled_state_is_coastal = yes
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_oceanic_ambitions"
		one_random_arms_factory = yes
		set_technology = { popup = yes CRY_oceanic_ambitions_tech = 1}
		custom_effect_tooltip = tech_effect|CRY_oceanic_ambitions_tech
	}
}


shared_focus = { #sombra does navy stuff
	id = CRY_minelaying_warfare
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_oceanic_ambitions
	prerequisite = {
		focus = CRY_oceanic_ambitions
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_minelaying_warfare"
		add_ideas = CRY_coastal_defence_idea
		if = {
			limit = {
				has_dlc = "Man the Guns"
			}
			add_tech_bonus = {
				name = navy_bonus
				bonus = 1.0
				uses = 2
				category = naval_mines
			}
		}
	}
}

shared_focus = { #sombra does MBTs
	id = CRY_modern_tank_designs
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_minelaying_warfare
	prerequisite = {
		focus = CRY_minelaying_warfare
	}
	prerequisite = {
		focus = CRY_massive_industrialization
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_modern_tank_designs"
		if = {
			limit = {
				has_dlc = "Arms Against Tyranny"
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = CRY_future_tanks_manufacturer_organization
			mio:CRY_future_tanks_manufacturer_organization = {
				add_mio_size = 2
				add_mio_funds = 800
			}
		}
		else = {
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = CRY_future_tanks_manufacturer
		}
		add_tech_bonus = {
			name = armor_bonus
			category = armor
			uses = 2
			ahead_reduction = 2
			bonus = 2
		}
	}
}
# magic sub-tree
shared_focus = { #sombra starts the mind control
	id = CRY_or_a_day_for_them
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 3
	x = 5
	y = 1
	relative_position_id = CRY_the_king_of_monsters
	prerequisite = {
		focus = CRY_the_king_of_monsters
	}
	
	available = {
		has_completed_focus = CRY_a_thousand_years_passed
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_but_hardly_a_day_for_me"
		swap_ideas = {
			remove_idea = CRY_beginning_to_catch_up
			add_idea = CRY_starting_to_figure_it_out
		}
		add_ideas = sombra_dark_magic0
		add_to_variable = {
			CRY_sombra_darkness = 1
		}
		custom_effect_tooltip = CRY_increase_darkness
		custom_effect_tooltip = CRY_no_more_crisis
		set_country_flag = BAT_no_crisises
		country_event = crystalsombra.26
	}
}
shared_focus = { #sombra talks about how smart he is
	id = CRY_the_genius_that_is_me
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -2
	y = 1
	relative_position_id = CRY_or_a_day_for_them
	prerequisite = {
		focus = CRY_or_a_day_for_them
	}
	
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_genius_that_is_me"
		if = {
			limit = {
				amount_research_slots < 5
			}
			add_research_slot = 1
			custom_effect_tooltip = CZE_war_college_effect_2_tt
		}
		custom_effect_tooltip = available_industrial_concern
		show_ideas_tooltip = amethyst_university
		add_ideas = evil_genius
	}
}

shared_focus = { #sombra recruits scientists, engineers, and scholars to his cause with promises of a better life
	id = CRY_scientist_clique
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_or_a_day_for_them
	prerequisite = {
		focus = CRY_or_a_day_for_them
	}
	
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_scientist_clique"
		add_breakthrough_points = {
			specialization = all
			value = 1
		}
	}
}

shared_focus = { #sombra proclaims his goals: conquest of the continent with radiant by his side
	id = CRY_unchained_ambition
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 2
	relative_position_id = CRY_or_a_day_for_them
	prerequisite = {
		focus = CRY_or_a_day_for_them
	}
	
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_unchained_ambition"
		custom_effect_tooltip = JAK_expansion_take_states_tt
		add_named_threat = {
			threat = 10
			name = claimed_the_continent
		}
		add_political_power = 200
		custom_effect_tooltip = CRY_claims_on_equus
		hidden_effect = {
			every_state = {
				limit = {
					is_on_continent = europe
					NOT = {
						is_core_of = ROOT
						state = 1196 # we don't need les meridiennes
						state = 1197
						state = 1198
					}
				}
				add_claim_by = ROOT
			}
		}
		news_event = {
			id = crystalnews.3
			days = 1
		}
	}
}


shared_focus = { #sombra assembles a royal court
	id = CRY_a_court_worthy_of_me
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 2
	y = 1
	relative_position_id = CRY_or_a_day_for_them
	prerequisite = {
		focus = CRY_or_a_day_for_them
	}
	
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_court_worthy_of_me"
		set_country_flag = CRY_awesome_advisors
		custom_effect_tooltip = available_political_advisor
		if = {
			limit = {
				has_character = CRY_som_advisor1
			}
			show_ideas_tooltip = CRY_som_advisor1
		}
		show_ideas_tooltip = CRY_som_advisor2
		show_ideas_tooltip = CRY_som_advisor3
		show_ideas_tooltip = CRY_som_advisor4
	}
}

shared_focus = { #sombra starts investigating nukes
	id = CRY_the_atomic_project
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_scientist_clique
	prerequisite = {
		focus = CRY_scientist_clique
	}
	prerequisite = {
		focus = CRY_unchained_ambition
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_atomic_project"
		add_breakthrough_points = {
			specialization = specialization_nuclear
			value = 2
		}
		add_tech_bonus = {
			name = secret_bonus
			bonus = 1
			uses = 1
			category = nuclear
		}
	}
}


shared_focus = { #sombra develops new kinds of magic
	id = CRY_diversity_magical_studies
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_unchained_ambition
	prerequisite = {
		focus = CRY_unchained_ambition
	}
	
	prerequisite = {
		focus = CRY_a_court_worthy_of_me
	}
	
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_diversity_magical_studies"
		
		add_scientist_role = {
			character = CRY_grim_fate
			scientist = {
				traits = { scientist_trait_brilliant_theorist scientist_trait_resourceful }
				skills = { specialization_magical = 2 }
			}
		}
		custom_effect_tooltip = CRY_crystal_tech_blurb

		custom_effect_tooltip = {
			localization_key = SP_UNLOCK_PROJECT
			PROJECT = sp_magic_bullets
		}
		custom_effect_tooltip = {
			localization_key = SP_UNLOCK_PROJECT
			PROJECT = sp_magical_air_defense
		}
		custom_effect_tooltip = {
			localization_key = SP_UNLOCK_PROJECT
			PROJECT = sp_translucency
		}
		custom_effect_tooltip = {
			localization_key = magical_facility_construction_tt
			temp_facility_state_loc = "[150.GetName]"
			temp_facility_province_loc = "[150.GetCapitalVictoryPointName]"
		}
		hidden_effect = {
			if = {
				limit = { 
					150 = {
						is_fully_controlled_by = ROOT
						can_construct_building = magical_facility
					}
				}
				150 = {
					add_building_construction = {
						type = magical_facility
						level = 1
						instant_build = yes
						province = 185
					}
				}
			}
		}
		add_breakthrough_progress = {
			specialization = specialization_magical
			value = 0.5
		}
	}
}


shared_focus = { #sombra develops industrial companies
	id = CRY_a_vision_of_the_future
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_diversity_magical_studies
	prerequisite = {
		focus = CRY_diversity_magical_studies
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_vision_of_the_future"
		if = {
			limit = {
				has_dlc = "Arms Against Tyranny"
			}    
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = CRY_darkar_design_organization
			mio:CRY_darkar_design_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = CRY_citrum_organization
			mio:CRY_citrum_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = CRY_nyx_organization
			mio:CRY_nyx_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
			custom_effect_tooltip = available_mio_tt
			show_mio_tooltip = CRY_ventus_organization
			mio:CRY_ventus_organization = {
				add_mio_size = 1
				add_mio_funds = 350
			}
		}
		else = {
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = darkar_design
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = citrum
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = nyx
			custom_effect_tooltip = available_designer
			show_ideas_tooltip = ventus
		}
	}
}


shared_focus = { #sombra specializes in fear magic
	id = CRY_fear_the_darkness
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_scientist_clique
	prerequisite = {
		focus = CRY_scientist_clique
	}
	prerequisite = {
		focus = CRY_the_genius_that_is_me
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_fear_the_darkness"
		swap_ideas = {
			remove_idea = sombra_dark_magic0
			add_idea = sombra_dark_magic
		}
		add_to_variable = {
			CRY_sombra_darkness = 1
		}
		custom_effect_tooltip = CRY_increase_darkness
		set_country_flag = unlocked_sombra_occupation
		custom_effect_tooltip = CRY_sombra_occupation_tt
		swap_ruler_traits = {
			remove = sombra_trait
			add = sombra_leader
		}
	}
}

shared_focus = { #sombra investigates rockets
	id = CRY_terror_weapons
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_fear_the_darkness
	prerequisite = {
		focus = CRY_fear_the_darkness
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_terror_weapons"
		swap_ideas = {
			remove_idea = evil_genius
			add_idea = evil_genius2
		}
		if = {
			limit = {
				has_tech = experimental_rockets
			}
			add_tech_bonus = {
				name = rocket_bonus
				bonus = 1.0
				uses = 1
				category = rocketry
			}
			add_breakthrough_progress = {
				specialization = specialization_air
				value = 0.5
			}
		}
		else = {
			set_technology = {
				experimental_rockets = 1
			}
		}
		random_owned_controlled_state = {
			add_building_construction = {
				type = rocket_site
				instant_build = yes
				level = 1
			}
		}
		random_owned_controlled_state = {
			add_building_construction = {
				type = rocket_site
				instant_build = yes
				level = 1
			}
		}
		random_owned_controlled_state = {
			add_building_construction = {
				type = rocket_site
				instant_build = yes
				level = 1
			}
		}
		country_event = crystalsombra.30
	}
}


shared_focus = { #sombra gets more magic
	id = CRY_ever_greater_magic
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_terror_weapons
	prerequisite = {
		focus = CRY_terror_weapons
	}
	prerequisite = {
		focus = CRY_the_atomic_project
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_ever_greater_magic"
		swap_ideas = {
			remove_idea = sombra_dark_magic
			add_idea = sombra_dark_magic1
		}
		add_to_variable = {
			CRY_sombra_darkness = 1
		}
		custom_effect_tooltip = CRY_increase_darkness
	}
}


shared_focus = { #sombra gets even more magic
	id = CRY_maximum_magical_power
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_a_deal_with_vraks
	prerequisite = {
		focus = CRY_a_deal_with_vraks
	}
	prerequisite = {
		focus = CRY_ever_greater_magic
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_maximum_magical_power"
		swap_ideas = {
			remove_idea = sombra_dark_magic1
			add_idea = sombra_dark_magic2
		}
		add_to_variable = {
			CRY_sombra_darkness = 1
		}
		custom_effect_tooltip = CRY_increase_darkness
	}
}

shared_focus = { #sombra gets even more magic
	id = CRY_magical_industrial_tech
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_a_deal_with_vraks
	prerequisite = {
		focus = CRY_maximum_magical_power
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_maximum_magical_power"
		effect_tooltip = {
			modify_building_resources = {
				building = arms_factory
				resource = crystals
				amount = -1
			}
			modify_building_resources = {
				building = industrial_complex
				resource = crystals
				amount = -1
			}
			modify_building_resources = {
				building = dockyard
				resource = crystals
				amount = -1
			}
		}
		add_ideas = CRY_crystal_powered_factories
		hidden_effect = {
			set_variable = {
				CRY_crystal_powered_factories_cost_mod = num_of_factories
			}
			multiply_variable = {
				CRY_crystal_powered_factories_cost_mod = -1
			}
			add_dynamic_modifier = {
				modifier = CRY_crystal_powered_factories_cost
			}
		}

	}
}


# expansion sub-tree
shared_focus = { #sombra analyzes the future
	id = CRY_but_my_enemies_have_not_rested
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 3
	x = 0
	y = 1
	relative_position_id = CRY_the_king_of_monsters
	prerequisite = {
		focus = CRY_the_king_of_monsters
	}
	available = {
		has_completed_focus = CRY_or_a_day_for_them
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_but_hardly_a_day_for_me"
		remove_ideas = CRY_starting_to_figure_it_out
		create_faction = faction_gray_pact
		set_country_flag = has_super_force_attack
		set_country_flag = has_super_last_stand
		custom_effect_tooltip = super_combat_abilities_tt
		custom_effect_tooltip = SOL_Faith_Sacrifice_Worship_tp
		hidden_effect = {
			set_technology = {
				popup = no
				berserker_charge = 1
			}
			set_rule = {
				can_use_kamikaze_pilots = yes
			}
			set_country_flag = kamikaze_flag
		}
		custom_effect_tooltip = kamikaze_focus_tooltip
		country_event = crystalsombra.25
	}
}

shared_focus = { #sombra declares on EQS and friends
	id = CRY_war_plan_south
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -2
	y = 2
	relative_position_id = CRY_but_my_enemies_have_not_rested
	prerequisite = {
		focus = CRY_but_my_enemies_have_not_rested
	}
	prerequisite = {
		focus = CRY_the_common_soldier
	}
	
	available = {
		has_war = no
	}
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		if = {
			limit = {
				EQS = {
					exists = yes
					has_government = democratic
				}
				has_active_mission = CRY_radiant_wants_focus
			}
			country_event = {
				id = crystalsombra.27
				days = 5
			}
			# event of radiant begging for no invasion of EQS
			# two versions - one for ECW, one for no ECW
		}
	}
	bypass = {
		OR = {
			has_war_with = EQS
			has_war_with = NLR
			has_war_with = event_target:equestria
		}
	}
	will_lead_to_war_with = EQS
	will_lead_to_war_with = NLR
	will_lead_to_war_with = VAN
	will_lead_to_war_with = SCS
	will_lead_to_war_with = BAL
	will_lead_to_war_with = CES
	will_lead_to_war_with = JUN
	will_lead_to_war_with = NMS
	will_lead_to_war_with = TEM
	will_lead_to_war_with = LSP
	will_lead_to_war_with = BUF
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_war_plan_south"
		
		if = {
			limit = {
				country_exists = NLR
			}
			hidden_effect = {
				create_wargoal = {
					target = NLR type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = NLR
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = CRY_left_equestria_alone
				}
			}
			if = {
				limit = { country_exists = EQS }
				hidden_effect = {
					create_wargoal = {
						target = EQS type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = EQS
				}
			}
			hidden_effect = {
				every_country_with_original_tag = {
					original_tag_to_check = EQS
					limit = { NOT = { tag = EQS } }
					ROOT = {
						create_wargoal = {
							target = PREV type = annex_everything
						}
						declare_war_on = {
							type = annex_everything
							target = PREV
						}
					}
				}
			}
			if = {
				limit = {
					country_exists = VAN
				}
				
				hidden_effect = {
					create_wargoal = {
						target = VAN type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = VAN
				}
			}
			if = {
				limit = { country_exists = SCS }
				hidden_effect = {
					create_wargoal = {
						target = SCS type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = SCS
				}
			}
			if = {
				limit = { country_exists = BAL  }
				hidden_effect = {
					create_wargoal = {
						target = BAL type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = BAL
				}
			}
			if = {
				limit = { country_exists = CES }
				hidden_effect = {
					create_wargoal = {
						target = CES type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = CES
				}
			}
			if = {
				limit = {
					country_exists = NMS
				}
				hidden_effect = {
					create_wargoal = {
						target = NMS type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = NMS
				}
			}
			if = {
				limit = { country_exists = JUN }
				hidden_effect = {
					create_wargoal = {
						target = JUN type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = JUN
				}
			}
			if = {
				limit = { country_exists = TEM }
				hidden_effect = {
					create_wargoal = {
						target = TEM type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = TEM
				}
			}
			if = {
				limit = { country_exists = LSP }
				hidden_effect = {
					create_wargoal = {
						target = LSP type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = LSP
				}
			}
			if = {
				limit = { country_exists = BUF }
				hidden_effect = {
					create_wargoal = {
						target = BUF type = annex_everything
					}
				}
				declare_war_on = {
					type = annex_everything
					target = BUF
				}
			}
		}

	}
}

shared_focus = { #sombra builds supply hubs
	id = CRY_northeastern_logistics_support
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 1
	relative_position_id = CRY_but_my_enemies_have_not_rested
	prerequisite = {
		focus = CRY_but_my_enemies_have_not_rested
	}
	ai_will_do = {
		factor = 8
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_northeastern_logistics_support"
		build_railway = {
			level = 1
			fallback = yes
			path = { 9485 6408 9501 415 4452 }
			start_province = 9485
			target_province = 4452
		}
		if = {
			limit = { 
				140 = {
					NOT = {
						any_province_building_level = {
							province = {
								id = 4402
							}
							building = supply_node
							level > 0
						}
					}
				}
			}
			140 = {
				add_building_construction = {
					level = 1
					type = supply_node
					instant_build = yes
					province = 4402
				}
			}
		}
		if = {
			limit = { 
				236 = {
					NOT = {
						any_province_building_level = {
							province = {
								id = 4452
							}
							building = supply_node
							level > 0
						}
					}
				}
			}
			236 = {
				add_building_construction = {
					level = 1
					type = supply_node
					instant_build = yes
					province = 4452
				}
			}
		}
	}
}
shared_focus = { #sombra declares on STG and friends
	id = CRY_war_plan_east
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 3
	relative_position_id = CRY_but_my_enemies_have_not_rested
	prerequisite = {
		focus = CRY_but_my_enemies_have_not_rested
	}
	prerequisite = {
		focus = CRY_northeastern_logistics_support
	}
	ai_will_do = {
		factor = 8
	}
	
	available = {
		has_war = no
	}
	
	bypass = {
		has_war_with = STG
		has_war_with = STL
	}
	will_lead_to_war_with = STG
	will_lead_to_war_with = STL
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_war_plan_east"

		if = {
			limit = { country_exists = STG }
			hidden_effect = {
				create_wargoal = {
					target = STG type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = STG
			}
		}
		if = {
			limit = {
				country_exists = STL
			}
			hidden_effect = {
				create_wargoal = {
					target = STL type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = STL
			}
		}
	}
}

shared_focus = { #sombra develops anti-pony tactics
	id = CRY_counter_pony_tactics
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_war_plan_east
	prerequisite = {
		focus = CRY_war_plan_south
		focus = CRY_war_plan_east
	}
	prerequisite = {
		focus = CRY_the_non_combat_tools
	}
	ai_will_do = {
		factor = 8
	}
	
	available = {
		OR = {
			has_war_with = STG
			has_war_with = EQS
			has_war_with = NLR
		}
	}
	bypass = {
		STG = {
			exists = no
		}
		EQS = {
			exists = no
		}
		NLR = {
			exists = no
		}
	}
	bypass_effect = {
		add_ideas = CRY_anti_pony_tactics_developed
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_counter_pony_tactics"
		add_ideas = CRY_anti_pony_tactics_developed
	}
}


shared_focus = { #sombra begins his industrialization game
	id = CRY_massive_industrialization
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_counter_pony_tactics
	prerequisite = {
		focus = CRY_counter_pony_tactics
	}
	prerequisite = {
		focus = CRY_rain_death_upon_them
	}
	ai_will_do = {
		factor = 8
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_massive_industrialization"
		# :whatyoudeserve:
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
		one_random_industrial_complex = yes
		one_random_arms_factory = yes
		one_random_arms_factory = yes
		one_random_arms_factory = yes
		one_random_arms_factory = yes
	}
}


shared_focus = { #sombra starts to core
	id = CRY_coring_what_we_can
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_war_plan_east
	prerequisite = {
		focus = CRY_war_plan_east
		focus = CRY_war_plan_north
	}
	ai_will_do = {
		factor = 8
	}
	
	available = {
		OR = {
			STG = {
				exists = no
			}
			AND = {
				EQS = {
					exists = no
				}
				NLR = {
					exists = no
				}
			}
			
			AND = {
				JAK = {
					exists = no
				}
				YAK = {
					exists = no
				}
			}
			
			AND = {
				CHN = {
					exists = no
				}
				CCN = {
					exists = no
				}
			}
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_counter_pony_tactics"
		# some cores!
		unlock_decision_category_tooltip = CRY_old_territory
		custom_effect_tooltip = CRY_dark_magic_coring
	}
}

shared_focus = { #sombra declares on YAK and friends
	id = CRY_war_plan_north
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 3
	relative_position_id = CRY_but_my_enemies_have_not_rested
	prerequisite = {
		focus = CRY_but_my_enemies_have_not_rested
	}
	
	prerequisite = {
		focus = CRY_northeastern_logistics_support
	}
	ai_will_do = {
		factor = 8
	}
	available = {
		has_war = no
	}
	bypass = {
		has_war_with = YAK
		has_war_with = JAK
	}
	will_lead_to_war_with = YAK
	will_lead_to_war_with = JAK
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_war_plan_north"
		custom_effect_tooltip = CRY_sombra_war_on_non_supremacist
		if = {
			limit = { country_exists = YAK }
			hidden_effect = {
				create_wargoal = {
					target = YAK type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = YAK
			}
		}
		if = {
			limit = {
				country_exists = JAK
				JAK = {
					is_in_faction = no
					has_country_leader = {
						character = YAK_khan_koletiv
						ruling_only = yes
					}
				}
			}
			JAK = {
				country_event = crystalsombra.29
			}
		}
		else_if = {
			limit = {
				country_exists = JAK
			}
			
			hidden_effect = {
				create_wargoal = {
					target = JAK type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = JAK
			}
		}
	}
}
shared_focus = { #sombra declares on CHN and friends
	id = CRY_war_plan_west
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 2
	y = 2
	relative_position_id = CRY_but_my_enemies_have_not_rested
	prerequisite = {
		focus = CRY_but_my_enemies_have_not_rested
	}
	
	prerequisite = {
		focus = CRY_the_genius_that_is_me
	}
	ai_will_do = {
		factor = 8
	}
	available = {
		has_war = no
	}
	bypass = {
		OR = {
			has_war_with = CHN
			has_war_with = CCN
		}
	}
	will_lead_to_war_with = CHN
	will_lead_to_war_with = CCN
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_war_plan_west"

		if = {
			limit = { country_exists = CHN }
			hidden_effect = {
				create_wargoal = {
					target = CHN type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = CHN
			}
		}
		if = {
			limit = { country_exists = CCN }
			hidden_effect = {
				create_wargoal = {
					target = CCN type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = CCN
			}
		}
	}
}

shared_focus = { #sombra gets logistics buffs
	id = CRY_preparing_for_northern_operations
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_war_plan_north
	prerequisite = {
		focus = CRY_war_plan_north
		focus = CRY_war_plan_west
	}
	
	prerequisite = {
		focus = CRY_fear_the_darkness
	}
	ai_will_do = {
		factor = 8
	}
	available = {
		OR = {
			has_war_with = CHN
			has_war_with = CCN
		}
	}
	
	bypass = {
		CHN = {
			exists = no
		}
		CCN = {
			exists = no
		}
	}
	bypass_effect = {
		add_ideas = crystal_buff
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_preparing_for_northern_operations"
		add_ideas = crystal_buff
	}
}

shared_focus = { #sombra meets with queen of vraks
	id = CRY_a_deal_with_vraks
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_preparing_for_northern_operations
	prerequisite = {
		focus = CRY_preparing_for_northern_operations
	}
	prerequisite = {
		focus = CRY_terror_weapons
	}
	available = {
		controls_state = 259
	}
	ai_will_do = {
		factor = 8
	}
	
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_deal_with_vraks"
		CHN = {
			every_core_state = {
				limit = {
					NOT = {
						is_core_of = ROOT
					}
				}
				add_compliance = 10
				add_resistance = -10
				add_resistance_target = -10
			}
		}
		add_doctrine_cost_reduction = {
			cost_reduction = 0.4
			category = land_doctrine
			name = land_doctrine
			uses = 1
		}
		add_doctrine_cost_reduction = {
			cost_reduction = 0.4
			category = air_doctrine
			name = air_doctrine
			uses = 2
		}
	}
}




shared_focus = { #sombra mops up
	id = CRY_final_war_plan
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 2
	y = 2
	relative_position_id = CRY_counter_pony_tactics
	available = {
		has_completed_focus = CRY_war_plan_east
		has_completed_focus = CRY_war_plan_north
		has_completed_focus = CRY_war_plan_south
		has_completed_focus = CRY_war_plan_west
		has_war = no
	}
	prerequisite = {
		focus = CRY_counter_pony_tactics
	}
	prerequisite = {
		focus = CRY_preparing_for_northern_operations
	}
	prerequisite = {
		focus = CRY_coring_what_we_can
	}
	ai_will_do = {
		factor = 8
	}
	
	
	bypass = {
		has_war_with = PNG
		has_war_with = PLB
		has_war_with = OLE
		has_war_with = GRF
		has_war_with = GFF
		has_war_with = PCB
		has_war_with = DRG
	}
	will_lead_to_war_with = PNG
	will_lead_to_war_with = PLB
	will_lead_to_war_with = OLE
	will_lead_to_war_with = GRF
	will_lead_to_war_with = GFF
	will_lead_to_war_with = PCB
	will_lead_to_war_with = DRG
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_final_war_plan"
		custom_effect_tooltip = CRY_sombra_war_on_non_supremacist

		if = {
			limit = {
				country_exists = PNG
				PNG = {
					is_in_faction = no
					has_government = fascism
				}
			}
			PNG = {
				country_event = crystalsombra.29
			}
		}
		else_if = {
			limit = {
				country_exists = PNG
			}
			hidden_effect = {
				create_wargoal = {
					target = PNG type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = PNG
			}
		}
		if = {
			limit = {
				country_exists = PLB
				PLB = {
					is_in_faction = no
					has_government = fascism
				}
			}
			PLB = {
				country_event = crystalsombra.29
			}
		}
		else_if = {
			limit = {
				country_exists = PLB
			}
			hidden_effect = {
				create_wargoal = {
					target = PLB type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = PLB
			}
		}
		if = {
			limit = {
				has_country_flag = CRY_left_equestria_alone
				country_exists = EQS
			}
			unlock_decision_tooltip = CRY_fabricate_a_southern_incident
		}
		if = {
			limit = {
				country_exists = OLE
			}
			hidden_effect = {
				create_wargoal = {
					target = OLE type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = OLE
			}
		}
		if = {
			limit = {
				country_exists = GRF
			}
			hidden_effect = {
				create_wargoal = {
					target = GRF type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = GRF
			}
		}
		if = {
			limit = {
				country_exists = GFF
			}
			hidden_effect = {
				create_wargoal = {
					target = GFF type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = GFF
			}
		}
		if = {
			limit = {
				country_exists = PCB
			}
			hidden_effect = {
				create_wargoal = {
					target = PCB type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = PCB
			}
		}
		if = {
			limit = {
				country_exists = DRG
			}
			hidden_effect = {
				create_wargoal = {
					target = DRG type = annex_everything
				}
			}
			declare_war_on = {
				type = annex_everything
				target = DRG
			}
		}
	}
}


shared_focus = { # what do we do with the places we can't core?
	id = CRY_the_matter_of_our_lands
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	relative_position_id = CRY_final_war_plan
	prerequisite = {
		focus = CRY_final_war_plan
	}
	prerequisite = {
		focus = CRY_modern_tank_designs
	}
	prerequisite = {
		focus = CRY_magical_industrial_tech
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_matter_of_our_lands"
		add_ideas = CRY_regional_administrators
	}
}

shared_focus = { #sombra happy ending - radiant stays
	id = CRY_with_her_by_my_side
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	relative_position_id = CRY_down_to_indentured_servitude
	prerequisite = {
		focus = CRY_the_matter_of_our_lands
	}
	mutually_exclusive = {
		focus = CRY_without_her
	}
	continue_if_invalid = yes
	available = {
		has_completed_focus = CRY_down_to_indentured_servitude
		has_completed_focus = CRY_end_internal_fear_magic
		has_active_mission = CRY_radiant_wants_focus
		custom_trigger_tooltip = {
			tooltip = JAK_form_equus_check
			if = {
				limit = {
					has_country_flag = CRY_left_equestria_alone
				}
				all_of = {
					array = global.europe_states
					var:v = {
						OR = {
							is_owned_by_ROOT_or_ally = yes
							is_core_of = EQS
							state = 1196 # we don't need les meridiennes
							state = 1197
							state = 1198
						}
					}
				}
			}
			else = {
					
				all_of = {
					array = global.europe_states
					var:v = {
						OR = {
							is_owned_by_ROOT_or_ally = yes
							state = 1196 # we don't need les meridiennes
							state = 1197
							state = 1198
						}
					}
				}
			}
		}
	}
	ai_will_do = {
		factor = 8
	}
	
	cancelable = no
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_with_her_by_my_side"
		custom_effect_tooltip = CRY_days_end
		country_event = crystalsombra.28
	}
}


shared_focus = { #sombra sad ending - radiant leaves
	id = CRY_without_her
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	relative_position_id = CRY_end_internal_fear_magic
	prerequisite = {
		focus = CRY_the_matter_of_our_lands
	}
	
	mutually_exclusive = {
		focus = CRY_with_her_by_my_side
	}
	available = {
		NOT = {
			has_active_mission = CRY_radiant_wants_focus
		}
		custom_trigger_tooltip = {
			tooltip = JAK_form_equus_check
			all_of = {
				array = global.europe_states
				var:v = {
					OR = {
						is_owned_by_ROOT_or_ally = yes
						state = 1196 # we don't need les meridiennes
						state = 1197
						state = 1198
					}
				}
			}
		}
	}
	ai_will_do = {
		factor = 8
	}
	cancelable = no
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_without_her"
		# THIS IS WHERE THE CIVIL WAR CAN START
		if = { 
			limit = {
				has_country_flag = CRY_radiant_imprisoned
			}
			country_event = crystalsombra.33
		}
		else = {
			country_event = crystalsombra.34
		}
	}
}

### RADIANT HOPE STUFF

### ADD TEXTICONS FOR UNIQUE BANNERS

# radiant and reforms sub-tree
shared_focus = { #sombra reflects
	id = CRY_but_hardly_a_day_for_me
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 3
	x = 0
	y = 1
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_northeastern_logistics_support
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_the_king_of_monsters
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_but_hardly_a_day_for_me"
		custom_effect_tooltip = CRY_days_boost
		country_event = radianthope.1
	}
}


shared_focus = { # cadance, shining, and flurry are downgraded from maximum-security prison to house arrest in a mountain villa
	id = CRY_kindness_for_the_royals
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_the_non_combat_tools
	ai_will_do = {
		factor = 8
	}

	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_but_hardly_a_day_for_me
	}
	
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_kindness_for_the_royals"
		custom_effect_tooltip = CRY_days_boost
		country_event = radianthope.2
	}
}
shared_focus = { # where radiant starts doing wide-spread healing
	id = CRY_no_waste_of_resources
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_war_plan_west
	ai_will_do = {
		factor = 8
	}

	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_but_hardly_a_day_for_me
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_no_waste_of_resources"
		decrease_poverty = yes
		custom_effect_tooltip = CRY_days_boost
		add_ideas = CRY_widespread_healing
	}
}

shared_focus = { # maybe we shouldn't be so comedically evil to our invaded population?
	id = CRY_revise_occupation_policy
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_war_plan_east
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_kindness_for_the_royals
		has_completed_focus = CRY_no_waste_of_resources
		has_completed_focus = CRY_fear_the_darkness
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_revise_occupation_policy"
		custom_effect_tooltip = CRY_days_boost
		set_country_flag = no_brutal_oppression_allowed
		custom_effect_tooltip = brutal_oppression_remove_tt
		custom_effect_tooltip = CRY_reduce_occupation_law

	}
}


shared_focus = { # maybe it'd nice to do intensive talent-hunting programs for kids so we can get more scholars
	id = CRY_increase_social_mobility
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 0
	y = 2
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_war_plan_north
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_kindness_for_the_royals
		has_completed_focus = CRY_no_waste_of_resources
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_increase_social_mobility"
		custom_effect_tooltip = CRY_days_boost
		decrease_illiteracy = yes
		swap_ideas = {
			remove_idea = CRY_widespread_healing
			add_idea = CRY_widespread_healing_2
		}
		### decreases some production things
	}
}


shared_focus = { # maybe we should implement universal healthcare because i am literally the strongest healer on the planet
	id = CRY_magic_healthcare
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_massive_industrialization
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_revise_occupation_policy
		has_completed_focus = CRY_increase_social_mobility
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magic_healthcare"
		custom_effect_tooltip = CRY_days_boost
		swap_ideas = {
			remove_idea = CRY_widespread_healing_2
			add_idea = CRY_widespread_healing_3
		}
	}
}

shared_focus = { # maybe we should write some kind of description of rights and responsibilities
	id = CRY_draft_a_constitution
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_increase_social_mobility
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_revise_occupation_policy
		has_completed_focus = CRY_increase_social_mobility
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_draft_a_constitution"
		custom_effect_tooltip = CRY_days_boost
		add_stability = -0.2
	}
}

shared_focus = { # maybe we should let ponies elect their local mayor
	id = CRY_regional_democracy
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 1
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_magic_healthcare
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_magic_healthcare
		has_completed_focus = CRY_draft_a_constitution
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_regional_democracy"
		custom_effect_tooltip = CRY_days_boost
		add_political_power = -200
	}
}

shared_focus = { # maybe we should publicly execute a few of our nastiest underlings
	id = CRY_butcher_the_butcherers
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 1
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_draft_a_constitution
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_magic_healthcare
		has_completed_focus = CRY_draft_a_constitution
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_butcher_the_butcherers"
		custom_effect_tooltip = CRY_days_boost
		add_war_support = -0.2
		country_event = crystalsombra.31
	}
}

shared_focus = { # maybe we should replace slavery with indentured servitude
	id = CRY_down_to_indentured_servitude
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = -1
	y = 3
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_revise_occupation_policy
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_regional_democracy
		has_completed_focus = CRY_butcher_the_butcherers
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_down_to_indentured_servitude"
		custom_effect_tooltip = CRY_days_boost
		swap_ideas = {
			remove_idea = CRY_widespread_healing_3
			add_idea = CRY_widespread_healing_4
		}
		swap_ideas = {
			remove_idea = slavery_economy
			add_idea = war_economy
		}
	}
}


shared_focus = { # maybe we should stop using fear magic on our own people
	id = CRY_end_internal_fear_magic
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 5
	x = 1
	y = 3
	text_icon = CRY_radiant_hope_focus_style
	relative_position_id = CRY_increase_social_mobility
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		CRY_radiant_mission_boost = yes
	}
	available = {
		has_country_flag = CRY_radiant_made_demands
		has_completed_focus = CRY_regional_democracy
		has_completed_focus = CRY_butcher_the_butcherers
		has_completed_focus = CRY_maximum_magical_power
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_Ddown_to_indentured_servitude"
		custom_effect_tooltip = CRY_days_boost
		swap_ideas = {
			remove_idea = sombra_dark_magic2
			add_idea = sombra_dark_magic3
		}
	}
}

#######################
### HOPELESS SOMBRA ###
#######################
shared_focus = { #sombra fakeout - RADIANT HOPE DEAD
	id = CRY_my_hollow_victory
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 11
	x = 7
	y = 1
	ai_will_do = {
		factor = 8
	}
	select_effect = {
		country_event = {
			id = sadsombra.1
			days = 7
		}
		country_event = {
			id = sadsombra.4
			days = 28
		}
		country_event = {
			id = sadsombra.5
			days = 49
		}
		country_event = {
			id = sadsombra.6
			days = 70
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_my_hollow_victory"
		custom_effect_tooltip = CRY_hopeless
	}
}

shared_focus = {
	id = CRY_the_truth_revealed
	icon = GFX_goal_crystal_empire_symbol_cry
	cost = 3
	x = 7
	y = 1
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_the_truth_revealed"
		swap_ideas = {
			remove_idea = CRY_broken_like_amore
			add_idea = CRY_new_purpose
		}
		hidden_effect = {
			country_event = sadsombra.9
		}
	}
}

shared_focus = {
	id = CRY_rabia_rises
	icon = GFX_CES_the_all_consuming_shadow
	cost = 3
	x = 0
	y = 1
	relative_position_id = CRY_the_truth_revealed
	prerequisite = {
		focus = CRY_the_truth_revealed
	}
	allow_branch = {
		has_country_flag = CRY_rabia_rules
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_rabia_rises"
	}
}
shared_focus = {
	id = CRY_a_nation_of_tears
	icon = GFX_CES_perfect_the_art_of_duplication
	cost = 3
	x = -5
	y = 1
	relative_position_id = CRY_rabia_rises
	prerequisite = {
		focus = CRY_rabia_rises
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_nation_of_tears"
		add_stability = -0.2
		country_event = sadsombra.7
	}
}

shared_focus = {
	id = CRY_a_land_of_suffering
	icon = GFX_CES_enshroud_the_land
	cost = 3
	x = 0
	y = 1
	relative_position_id = CRY_rabia_rises
	prerequisite = {
		focus = CRY_rabia_rises
	}
	
	available = {
		has_completed_focus = CRY_a_nation_of_tears
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_land_of_suffering"
		add_stability = -0.2
		country_event = sadsombra.8
	}
}

shared_focus = {
	id = CRY_a_world_of_hatred
	icon = GFX_CES_through_the_void
	cost = 3
	x = 5
	y = 1
	relative_position_id = CRY_rabia_rises
	prerequisite = {
		focus = CRY_rabia_rises
	}
	
	available = {
		has_completed_focus = CRY_a_land_of_suffering
	}
	ai_will_do = {
		factor = 8
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_world_of_hatred"
		add_stability = -0.2
		swap_ideas = {
			remove_idea = slavery_economy
			add_idea = CRY_doomsday_economy
		}
		country_event = sadsombra.12
	}
}

############################
### COMMIE/HARMONIST JFT ###
############################
joint_focus = { #Forts
	id = CRY_a_looming_war
	icon = GFX_goal_crystal_fair
	cost = 4
	x = 0
	y = 12
	text_icon = RIV_focus_style
	available = {
		OR = {
			threat > 0.4
			has_war_with_major = yes
		}
		CRY_joint_trigger = yes
	}
	offset = {
		
		y = 0
		x = 4
		trigger = { has_focus_tree = stalliongrad }
	}
	
	offset = {
		
		y = 0
		x = 6
		trigger = { has_completed_focus = CRY_the_crystal_labor_movement }
	}
	
	offset = {
		
		y = 0
		x = 8
		trigger = {
			has_focus_tree = equestria_focus
			is_EQS_SOL = yes
		}
	}
	offset = {
		
		y = 5
		x = -5
		trigger = {
			has_focus_tree = crystalempire
		}
	}
	
	offset = {
		
		y = -3
		x = 5
		trigger = {
			has_focus_tree = equestria_focus
			is_EQS_SOL = no
		}
	}
	joint_trigger = {
		CRY_joint_trigger = yes
	}
	completion_reward_joint_originator = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_a_looming_war"
		every_controlled_state = {
			limit = {
				any_neighbor_state = {
					is_controlled_by_ROOT_or_ally = no
				}
			}
			add_building_construction = {
				type = bunker
				level = 2
				instant_build = yes
				province = {
					all_provinces = yes
					limit_to_border = yes
				}
			}
		}
	}
	completion_reward_joint_member = {
		every_controlled_state = {
			limit = {
				any_neighbor_state = {
					is_controlled_by_ROOT_or_ally = no
				}
			}
			add_building_construction = {
				type = bunker
				level = 1
				instant_build = yes
				province = {
					all_provinces = yes
					limit_to_border = yes
				}
			}
		}
	}
}
joint_focus = {
	id = CRY_synchronicity
	icon = GFX_goal_crystal_fair
	cost = 6
	x = -1
	y = 3
	text_icon = RIV_focus_style
	prerequisite = {
		focus = CRY_a_looming_war
	}
	relative_position_id = CRY_a_looming_war
	available = {
		has_tech = atomic_research
		CRY_joint_trigger = yes
	}
	
	joint_trigger = {
		CRY_joint_trigger = yes
	}

	completion_reward_joint_originator = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_synchronicity"
		add_breakthrough_progress = {
			value = 1
			specialization = specialization_nuclear
		}
	}
	completion_reward_joint_member = {
		add_breakthrough_progress = {
			value = 0.5
			specialization = specialization_nuclear
		}
	}
}
joint_focus = {
	id = CRY_magic_potential
	icon = GFX_goal_crystal_fair
	cost = 6
	x = 1
	y = 3
	text_icon = RIV_focus_style
	prerequisite = {
		focus = CRY_a_looming_war
	}
	relative_position_id = CRY_a_looming_war
	available = {
		has_tech = magical_weapons
		CRY_joint_trigger = yes
	}
	
	joint_trigger = {
		CRY_joint_trigger = yes
	}
	completion_reward_joint_originator = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magic_potential"
		add_breakthrough_progress = {
			value = 1
			specialization = specialization_magical
		}
	}
	completion_reward_joint_member = {
		add_breakthrough_progress = {
			value = 0.5
			specialization = specialization_magical
		}
	}
}
####################
### SHARED STUFF ###
####################

shared_focus = { #Military training (Manpower+, Discipline+)
	id = CRY_military
	icon = GFX_goal_cry_military
	cost = 7
	x = 30
	y = 1
	ai_will_do = {
		factor = 8
	}
	offset = {
		trigger = { has_focus_tree = crystal_empire_solar_focus }
		x = -4
		y = 0
	}
	offset = {
		trigger = { has_focus_tree = crystalempire_sombra }
		x = 4
		y = 0
	}
	offset = {
		trigger = { has_focus_tree = crystal_empire_lunar_focus }
		x = -4
		y = 0
	}
	available = {
		if = {
			limit = {
				has_focus_tree = crystalempire_sombra
			}
			has_completed_focus = CRY_the_king_of_monsters
		}
		else_if = {
			limit = {
				has_focus_tree = crystalempire
			}
			has_completed_focus = CRY_dawn_on_crystal_empire
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_military"
		add_manpower = 15000
		add_ideas = army_morale
		army_experience = 50
		if = {
			limit = { 
				is_ai = yes 
				NOT = {
					has_idea = tot_economic_mobilisation
					has_idea = war_economy
					has_idea = partial_economic_mobilisation
					has_idea = slavery_economy
				}
			}
			add_political_power = -150
			add_ideas = partial_economic_mobilisation
		}
	}
	search_filters = { FOCUS_FILTER_MANPOWER FOCUS_FILTER_ARMY_BONUS }
}
shared_focus = { ## some bonus or more factories i guesss
	id = CRY_strength
	icon = GFX_goal_cry_factory
	cost = 7
	prerequisite = {
		focus = CRY_the_king_of_monsters
		focus = CRY_dawn_on_crystal_empire
		focus = CRY_SOL_new_management
		focus = CRY_NLR_night_shroud
	}
	ai_will_do = {
		factor = 90
	}
	offset = {
		trigger = { has_focus_tree = crystal_empire_solar_focus }
		x = -4
		y = 0
	}
	offset = {
		trigger = { has_focus_tree = crystal_empire_lunar_focus }
		x = -4
		y = 0
	}
	offset = {
		trigger = { has_focus_tree = crystalempire_sombra }
		x = 4
		y = 0
	}
	available = {
		53 = { is_owned_and_controlled_by = ROOT }
	}
	x = 20
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_strength"
		decrease_poverty = yes
		53 = { 
			increase_state_category = yes
			add_extra_state_shared_building_slots = 1
			add_building_construction = { 
				type = industrial_complex
				level = 3
				instant_build = yes 
			}
		}
		add_tech_bonus = {
			name = industrial_bonus
			bonus = 1.0
			uses = 1
			category = industry
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}
shared_focus = { ## bonus there
	id = CRY_innovations
	icon = GFX_goal_cry_innovation
	cost = 7
	prerequisite = {
		focus = CRY_strength
	}
	ai_will_do = {
		factor = 90
	}
	relative_position_id = CRY_strength
	x = 0
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_innovations"
		increase_science_base = yes
		hidden_effect = {
			if = {
				limit = {
					has_idea = CRY_equestrian_overlord_new
				}
				swap_ideas = {
					remove_idea = CRY_equestrian_overlord_new
					add_idea = CRY_equestrian_overlord_proper
				}
			}
			else_if = {
				limit = {
					has_idea = CRY_equestrian_overlord_autom
				}
				swap_ideas = {
					remove_idea = CRY_equestrian_overlord_autom
					add_idea = CRY_equestrian_overlord_proper_autom
				}
			}
			else_if = {
				limit = {
					has_idea = CRY_equestrian_overlord_research
				}
				swap_ideas = {
					remove_idea = CRY_equestrian_overlord_research
					add_idea = CRY_equestrian_overlord_proper_research
				}
			}
		}
		add_tech_bonus = {
			name = electronics_bonus
			bonus = 1.0
			uses = 2
			category = electronics
		}
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = { # open material designers
	id = CRY_concerns
	icon = GFX_goal_cry_list
	cost = 7
	prerequisite = {
		focus = CRY_innovations
	}
	ai_will_do = {
		factor = 9
	}
	allow_branch = {
		OR = {
			has_government = democratic
			has_government = communism
		}
	}
	relative_position_id = CRY_innovations
	x = 0
	y = 1
	available = {
		OR = {
			has_government = democratic
			has_government = communism
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_concerns"
		### we should add a bunch of designers/MIOs here
		add_tech_bonus = {
			name = infantry_weapons_bonus
			bonus = 1.0
			uses = 2
			category = infantry_weapons
		}
		add_tech_bonus = {
			name = industrial_bonus
			bonus = 1.0
			uses = 1
			category = industry
		}
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = { ## resear
	id = CRY_rndinstitute
	icon = GFX_goal_cryacademy
	cost = 10
	prerequisite = {
		focus = CRY_innovations
	}
	ai_will_do = {
		factor = 9
	}
	relative_position_id = CRY_innovations
	x = 2
	y = 2
	offset = {
		trigger = { has_focus_tree = crystal_empire_solar_focus }
		x = 0
		y = -1
	}
	offset = {
		trigger = { has_focus_tree = crystal_empire_lunar_focus }
		x = 0
		y = -1
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_rndinstitute"
		decrease_illiteracy = yes
		if = {
			limit = {
				amount_research_slots < 5
			}
			add_research_slot = 1
			custom_effect_tooltip = CZE_war_college_effect_2_tt
		}
		custom_effect_tooltip = available_industrial_concern
		show_ideas_tooltip = amethyst_university
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_magicalconceptions
	icon = GFX_goal_magical_conception
	cost = 7
	prerequisite = {
		focus = CRY_rndinstitute
	}
	ai_will_do = {
		factor = 9
	}
	relative_position_id = CRY_rndinstitute
	x = -2
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magicalconceptions"
		add_tech_bonus = {
			name = unicorn_bonus
			bonus = 2.0
			uses = 2
			category = unicorn_tech
		}
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_magicalsource
	icon = GFX_goal_magic_cry
	cost = 7
	prerequisite = {
		focus = CRY_magicalconceptions
	}
	ai_will_do = {
		factor = 9
	}
	relative_position_id = CRY_rndinstitute
	x = -2
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_magicalsource"
		add_ideas = magical_power
	}
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_mining
	icon = GFX_goal_pickaxe
	cost = 14
	prerequisite = {
		focus = CRY_steel_factories_in_crystal_city
	}
	ai_will_do = {
		factor = 9
	}
	relative_position_id = CRY_innovations
	x = -2
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_mining"
		add_resource = {
			type = aluminium
			amount = 20
			state = 139
		}
		add_resource = {
			type = chromium
			amount = 20
			state = 236
		}
		add_resource = {
			type = crystals
			amount = 20
			state = 141
		}
		add_resource = {
			type = steel
			amount = 20
			state = 345
		}
		add_resource = {
			type = tungsten
			amount = 20
			state = 318
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}
shared_focus = {
	id = CRY_steel_factories_in_crystal_city
	icon = GFX_goal_cry_factory
	cost = 10
	prerequisite = {
		focus = CRY_innovations
	}
	ai_will_do = {
		factor = 9
	}
	available = {
		345 = { is_owned_and_controlled_by = ROOT }
	}
	relative_position_id = CRY_innovations
	x = -2
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_steel_factories_in_crystal_city"
		increase_society_development = yes
		add_resource = {
			type = steel
			amount = 25
			state = 345
		}
		345 = { 
			add_extra_state_shared_building_slots = 2
			add_building_construction = { 
				type = industrial_complex
				level = 1
				instant_build = yes 
			}
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}
shared_focus = {
	id = CRY_industry_f
	icon = GFX_goal_cry_factory
	cost = 10
	prerequisite = {
		focus = CRY_military
	}
	available = {

	}
	ai_will_do = {
		factor = 20
	}
	relative_position_id = CRY_military
	x = 0
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_industry_f"
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = arms_factory
					size > 0
					include_locked = yes
				}
				OR = {
					is_in_home_area = yes
					NOT = {
						owner = {
							any_owned_state = {
								free_building_slots = {
									building = arms_factory
									size > 0
									include_locked = yes
								}
								is_in_home_area = yes
							}
						}
					}
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = industrial_complex
					size > 0
					include_locked = yes
				}
				OR = {
					is_in_home_area = yes
					NOT = {
						owner = {
							any_owned_state = {
								free_building_slots = {
									building = industrial_complex
									size > 0
									include_locked = yes
								}
								is_in_home_area = yes
							}
						}
					}
				}
			}
			increase_state_category = yes
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}
shared_focus = {
	id = CRY_crystals
	icon = GFX_goal_cry_harm_crystals
	cost = 10
	prerequisite = {
		focus = CRY_rndinstitute
	}
	ai_will_do = {
		factor = 15
	}
	allow_branch = {
		OR = {
			has_government = democratic
			has_government = communism
		}
	}
	relative_position_id = CRY_rndinstitute
	x = 0
	y = 1
	available = {
		OR = {
			has_government = democratic
			has_government = communism
		}
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_crystals"
		add_ideas = CRY_harmony_crystals
	}
	search_filters = { FOCUS_FILTER_ARMY_BONUS FOCUS_FILTER_INDUSTRY }
}
shared_focus = {
	id = CRY_heavytanks
	icon = GFX_goal_cry_heavy_tanks
	cost = 10
	prerequisite = {
		focus = CRY_industry_f
		focus = CRY_crystals
	}
	ai_will_do = {
		factor = 15
	}
	available = {
		OR = {
			has_government = democratic
			has_government = communism
		}
	}
	allow_branch = {
		OR = {
			has_government = democratic
			has_government = communism
		}
	}
	relative_position_id = CRY_industry_f
	x = 0
	y = 4
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_heavytanks"
		add_tech_bonus = {
			name = armor_bonus
			bonus = 1.0
			uses = 2
			category = cat_heavy_armor
		}
		add_tech_bonus = {
			name = cat_anti_tank
			bonus = 1.0
			uses = 1
			category = cat_anti_tank
		}
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_newpowersource
	icon = GFX_goal_magic_cry
	cost = 10
	prerequisite = {
		focus = CRY_crystals
	}
	ai_will_do = {
		factor = 15
	}
	relative_position_id = CRY_rndinstitute
	x = 0
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_newpowersource"
		if = {
			limit = {
				has_tech = atomic_research
			}
			add_breakthrough_progress = {
				specialization = specialization_nuclear
				value = 0.375
			}
		}
		else = {
			add_tech_bonus = {
				name = secret_bonus
				bonus = 0.75
				uses = 1
				category = nuclear
			}
		}
	}
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_sciencerevolution
	icon = GFX_goal_cry_sciencerevolution
	cost = 10
	prerequisite = {
		focus = CRY_newpowersource
		focus = CRY_magicalsource
	}
	ai_will_do = {
		factor = 15
	}
	relative_position_id = CRY_rndinstitute
	x = -2
	y = 3
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_sciencerevolution"
		custom_effect_tooltip = {
			localization_key = nuclear_facility_construction_tt
			temp_facility_state_loc = "[345.GetName]"
			temp_facility_province_loc = "[345.GetCapitalVictoryPointName]"
		}
		hidden_effect = {
			if = {
				limit = { 
					345 = {
						is_fully_controlled_by = ROOT
						can_construct_building = nuclear_facility
					}
				}
				345 = {
					add_building_construction = {
						type = nuclear_facility
						level = 1
						instant_build = yes
						province = 11788
					}
				}
			}
		}
		add_ideas = CRY_science
		add_tech_bonus = {
			name = jet_bonus
			bonus = 1.0
			uses = 1
			category = jet_technology
		}
		add_breakthrough_progress = {
			specialization = specialization_air
			value = 0.5
		}
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_fortifications
	icon = GFX_goal_cry_forts
	cost = 10
	prerequisite = {
		focus = CRY_military
	}
	relative_position_id = CRY_military
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_fortifications"
		add_timed_idea = { idea = CRY_fortifications_bonus days = 365 }
		add_tech_bonus = {
			category = cat_fortification
			bonus = 1
			uses = 2
			name = cat_fortification
		}
		344 = {
			add_building_construction = {
				type = anti_air_building
				level = 1
				instant_build = yes
			}
		}
		53 = {
			add_building_construction = {
				type = anti_air_building
				level = 1
				instant_build = yes
			}
		}
		345 = {
			add_building_construction = {
				type = anti_air_building
				level = 1
				instant_build = yes
			}
		}
	}
}
shared_focus = {
	id = CRY_big_guns
	icon = GFX_goal_artillery_factories
	cost = 7
	prerequisite = {
		focus = CRY_military
	}
	relative_position_id = CRY_military
	x = -1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_big_guns"
		add_tech_bonus = {
			category = artillery
			bonus = 0.5
			uses = 4
			name = artillery_bonus
		}
	}
}

shared_focus = {
	id = CRY_promote_new_officers
	icon = GFX_goal_officers
	cost = 7
	prerequisite = {
		focus = CRY_military
	}
	relative_position_id = CRY_military
	x = -2
	y = 2
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_promote_new_officers"
		add_ideas = CRY_new_officers
	}
}

shared_focus = {
	id = CRY_shinings_theory
	icon = GFX_goal_doctrine_tank_warfare
	cost = 7
	prerequisite = {
		focus = CRY_military
	}
	relative_position_id = CRY_military
	x = 2
	y = 2
	dynamic = yes
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_shinings_theory"
		add_doctrine_cost_reduction = {
			cost_reduction = 0.4
			category = land_doctrine
			name = land_doctrine
			uses = 3
		}
	}
}
shared_focus = {
	id = CRY_gunfactories
	icon = GFX_goal_cry_gunfactories
	cost = 10
	prerequisite = {
		focus = CRY_industry_f
	}
	available = {
		has_war = yes
	}
	relative_position_id = CRY_industry_f
	x = 2
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_gunfactories"
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = arms_factory
					size > 0
					include_locked = yes
				}
				OR = {
					is_in_home_area = yes
					NOT = {
						owner = {
							any_owned_state = {
								free_building_slots = {
									building = arms_factory
									size > 0
									include_locked = yes
								}
								is_in_home_area = yes
							}
						}
					}
				}
			}
			increase_state_category = yes
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 3
				instant_build = yes
			}
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}

shared_focus = {
	id = CRY_land_military_research
	icon = GFX_goal_cry_gunfactories
	cost = 7
	prerequisite = {
		focus = CRY_gunfactories
	}
	relative_position_id = CRY_gunfactories
	x = -1
	y = 1
	
	mutually_exclusive = {
		focus = CRY_crystal_might
	}
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_land_military_research"
		custom_effect_tooltip = {
			localization_key = land_facility_construction_tt
			temp_facility_state_loc = "[98.GetName]"
			temp_facility_province_loc = "[98.GetCapitalVictoryPointName]"
		}
		hidden_effect = {
			if = {
				limit = { 
					98 = {
						is_fully_controlled_by = ROOT
						can_construct_building = land_facility
					}
				}
				98 = {
					add_building_construction = {
						type = land_facility
						level = 1
						instant_build = yes
						province = 9485
					}
				}
			}
		}
		add_breakthrough_progress = {
			value = 0.5
			specialization = specialization_land
		}
	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}

shared_focus = {
	id = CRY_crystal_might
	icon = GFX_goal_cry_gunfactories
	cost = 7
	prerequisite = {
		focus = CRY_gunfactories
	}
	mutually_exclusive = {
		focus = CRY_land_military_research
	}
	relative_position_id = CRY_gunfactories
	x = 1
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_land_military_research"
		every_owned_state = {
			limit = {
				crystals > 0
			}
			add_resource = {
				type = crystals
				amount = 5
			}
		}
		add_tech_bonus = {
			name = magic_bonus
			category = magical_tech
			uses = 2
			bonus = 0.5
		}
		add_breakthrough_progress = {
			value = 0.5
			specialization = specialization_magical
		}

	}
	search_filters = { FOCUS_FILTER_INDUSTRY }
}
shared_focus = {
	id = CRY_machinisation
	icon = GFX_goal_cry_mechanization
	cost = 10
	prerequisite = {
		focus = CRY_rndinstitute
		focus = CRY_industry_f
	}
	relative_position_id = CRY_rndinstitute
	x = 2
	y = 1
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_machinisation"
		add_tech_bonus = {
			name = motorized_bonus
			bonus = 2.0
			uses = 1
			category = cat_mechanized_equipment
		}
		add_tech_bonus = {
			name = motorized_bonus
			bonus = 2.0
			uses = 1
			ahead_reduction = 2
			category = cat_mechanized_equipment
		}
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_aviation
	icon = GFX_goal_cry_aviation
	cost = 10
	prerequisite = {
		focus = CRY_magicalsource
		focus = CRY_newpowersource
	}
	relative_position_id = CRY_rndinstitute
	x = 0
	y = 3
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_aviation"
		if = {
            limit = {
                has_dlc = "By Blood Alone"
            }
			add_tech_bonus = {
				name = fighter_bonus
				bonus = 1.0
				uses = 1
				category = light_air
			}
		}
		else = {
			add_tech_bonus = {
				name = fighter_bonus
				bonus = 1.0
				uses = 1
				category = light_fighter
			}
		}
		if = {
            limit = {
                has_dlc = "By Blood Alone"
            }
			add_tech_bonus = {
				name = medium_air
				bonus = 0.75
				uses = 1
				category = medium_air
			}
			add_tech_bonus = {
				name = cat_air_guns
				bonus = 0.5
				uses = 1
				category = cat_air_guns
			}
		}
		else = {
			add_tech_bonus = {
				name = fighter_bonus
				bonus = 1.0
				uses = 1
				category = cat_heavy_fighter
			}
		}

	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}
shared_focus = {
	id = CRY_rocketengineering
	icon = GFX_goal_cry_rocketry
	cost = 10
	prerequisite = {
		focus = CRY_aviation
		focus = CRY_sciencerevolution
	}
	relative_position_id = CRY_rndinstitute
	x = -1
	y = 4
	completion_reward = {
		log = "[GetDateText]: [Root.GetName]: Focus CRY_rocketengineering"
		add_tech_bonus = {
			name = flocke_von_schnee
			bonus = 2.0
			uses = 2
			category = rocketry
		}
		add_breakthrough_progress = {
			specialization = specialization_air
			value = 0.5
		}
	}
	search_filters = { FOCUS_FILTER_RESEARCH }
}