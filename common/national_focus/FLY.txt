focus_tree = {
    id = FLY_wartime_tree
    country = {
        factor = 0
        modifier = {
            add = 10
            has_country_flag = FLY_filldelphia
        }
    }
    default = no
    continuous_focus_position = { x = 2000 y = 0 }
    shared_focus = FLY_birth_of_republic
}

### STARTING FOCUS TREE ###

    shared_focus = {
        id = FLY_birth_of_republic
        icon = GFX_goal_generic_harmony
        cost = 1
        x = 10
        y = 0

        ai_will_do = {
            factor = 10
        }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_birth_of_republic"
            custom_effect_tooltip = FLY_start_focus_tp
        }
    }

    shared_focus = {
        id = FLY_fillydelphia_royal_guard
        icon = GFX_goal_unknown
        cost = 2
        x = -3
        y = 1
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_fillydelphia_royal_guard"
            custom_effect_tooltip = FLY_fillydelphia_royal_guard_tp
            hidden_effect = {
                load_oob = "FLY_ex_eup"
            }
        }
    }

    shared_focus = {
        id = FLY_secure_garrisons
        icon = GFX_goal_unknown
        cost = 2
        x = -1
        y = 1
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_secure_garrisons"
            add_equipment_to_stockpile = {
                type = infantry_equipment_1
                amount = 900
                producer = EQS
            }
            add_equipment_to_stockpile = {
                type = infantry_equipment_0
                amount = 1200
                producer = EQS
            }
            add_equipment_to_stockpile = {
                type = artillery_equipment
                amount = 70
                producer = EQS
            }
            add_equipment_to_stockpile = {
                type = support_equipment
                amount = 200
                producer = EQS
            }
        }
    }
    
    shared_focus = {
        id = FLY_war_effort
        icon = GFX_goal_unknown
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_fillydelphia_royal_guard

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_fillydelphia_royal_guard focus = FLY_secure_garrisons }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_war_effort"
            add_ideas = FLY_industrial_war_effort
        }
    }
        
    shared_focus = {
        id = FLY_convince_ponies
        icon = GFX_goal_unknown
        cost = 1
        x = 0
        y = 2
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_convince_ponies"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
            custom_effect_tooltip = FLY_unlock_legitimacy_continuous_focus
        }
    }
            
    shared_focus = {
        id = FLY_congress_procedures
        icon = GFX_goal_unknown
        cost = 2
        x = 3
        y = 1
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_congress_procedures"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 5
            }
            custom_effect_tooltip = FLY_add_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy = FLY_legitimacy_temp
            }
            add_political_power = 150
        }
    }
                
    shared_focus = {
        id = FLY_lyra_speech
        icon = GFX_goal_unknown
        cost = 2
        x = -1
        y = 1
        relative_position_id = FLY_congress_procedures

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_congress_procedures }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_lyra_speech"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 5
            }
            custom_effect_tooltip = FLY_add_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy = FLY_legitimacy_temp
            }
            add_stability = 0.1
            add_to_variable = {
                FLY_lyra_influence = 1
            }
        }
    }
                    
    shared_focus = {
        id = FLY_cirrus_speech
        icon = GFX_goal_unknown
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_congress_procedures

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_congress_procedures }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_cirrus_speech"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 5
            }
            custom_effect_tooltip = FLY_add_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy = FLY_legitimacy_temp
            }
            add_war_support = 0.1
            add_to_variable = {
                FLY_cirrus_influence = 1
            }
        }
    }
                            
    shared_focus = {
        id = FLY_sunset_shimmer
        icon = GFX_goal_unknown
        cost = 1
        x = -1
        y = 1
        relative_position_id = FLY_convince_ponies

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_war_effort }
        prerequisite = { focus = FLY_convince_ponies }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_sunset_shimmer"
            #add Sunset Shimmer character here
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
            hidden_effect = {
                country_event = { id = fillydelphia.3 days = 1 }
            }
        }
    }

    shared_focus = {
        id = FLY_topple_tyranny
        icon = GFX_goal_unknown
        cost = 1
        x = 1
        y = 1
        relative_position_id = FLY_convince_ponies

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_convince_ponies }
        prerequisite = { focus = FLY_lyra_speech focus = FLY_cirrus_speech }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_topple_tyranny"
            add_ideas = FLY_equestria_still_lives
        }
    }
    
    shared_focus = {
        id = FLY_declare_republic
        icon = GFX_goal_unknown
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_sunset_shimmer
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_15_legitimacy_req
                check_variable = { FLY_legitimacy > 14 }
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_sunset_shimmer }
        prerequisite = { focus = FLY_topple_tyranny }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_topple_tyranny"
            effect_tooltip = {
                set_cosmetic_tag = EQS_FLY_organised_1
            }
            EAW_raise_conscription_law = yes
            EAW_raise_economic_law = yes
            country_event = fillydelphia.4
        }
    }

    shared_focus = {
        id = FLY_wartime_leader
        icon = GFX_goal_unknown
        cost = 1
        x = 0
        y = 2
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_50_legitimacy_req
                check_variable = { FLY_legitimacy > 49 }
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_wartime_leader"
            custom_effect_tooltip = FLY_choose_wartime_leader_tp
            country_event = fillydelphia.5
        }
    }
        
    shared_focus = {
        id = FLY_assume_mantle_equestria
        icon = GFX_goal_unknown
        cost = 1
        x = 0
        y = 3
        relative_position_id = FLY_wartime_leader
        available = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = FLY_70_legitimacy_req
                    check_variable = { FLY_legitimacy > 69 } # nice
                }
                AND = {
                    OR = {
                        SOL = {
                            exists = no
                        }
                        NLR = {
                            exists = no
                        }
                    }
                    custom_trigger_tooltip = {
                        tooltip = FLY_50_legitimacy_req
                        check_variable = { FLY_legitimacy > 49 }
                    }
                }
                AND = {
                    num_of_controlled_states > 19
                    custom_trigger_tooltip = {
                        tooltip = FLY_50_legitimacy_req
                        check_variable = { FLY_legitimacy > 49 }
                    }
                }
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_wartime_leader }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_assume_mantle_equestria"
            effect_tooltip = {
                set_cosmetic_tag = EQS_FLY_republic_1
            }
            custom_effect_tooltip = FLY_get_cores_on_SOL_NLR_tp
            hidden_effect = {
                every_state = {
                    limit = {
                        OR = {
                            is_core_of = SOL
                            is_core_of = NLR
                        }
                    }
                    add_core_of = FLY
                }
                if = {
                    limit = {
                        has_cosmetic_tag = EQS_FLY_organised_1
                    }
                    set_cosmetic_tag = EQS_FLY_republic_1
                }
                else_if = {
                    limit = {
                        has_cosmetic_tag = EQS_FLY_organised_2
                    }
                    set_cosmetic_tag = EQS_FLY_republic_2
                }
                else = {
                    set_cosmetic_tag = EQS_FLY_republic_3
                }
            }
        }
    }