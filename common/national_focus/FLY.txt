focus_tree = {
    id = FLY_wartime_tree
    country = {
        factor = 0
        modifier = {
            add = 20
            has_country_flag = FLY_filldelphia
        }
    }
    default = no
    continuous_focus_position = { x = 2000 y = 0 }
    shared_focus = FLY_birth_of_republic
}

### STARTING FOCUS TREE ###

    shared_focus = {
        id = FLY_birth_of_republic
        icon = GFX_goal_generic_harmony
        cost = 1
        x = 10
        y = 0

        ai_will_do = {
            factor = 10
        }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_birth_of_republic"
            custom_effect_tooltip = FLY_start_focus_tp
        }
    }

    shared_focus = {
        id = FLY_fillydelphia_soldiers
        icon = GFX_goal_unknown
        cost = 2
        x = -3
        y = 1
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_fillydelphia_soldiers"
            custom_effect_tooltip = FLY_fillydelphia_soldiers_tp
            hidden_effect = {
                load_oob = "FLY_ex_eup"
            }
        }
    }

    shared_focus = {
        id = FLY_secure_garrisons
        icon = GFX_goal_unknown
        cost = 2
        x = -1
        y = 1
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_secure_garrisons"
            add_equipment_to_stockpile = {
                type = infantry_equipment_1
                amount = 900
                producer = EQS
            }
            add_equipment_to_stockpile = {
                type = infantry_equipment_0
                amount = 1200
                producer = EQS
            }
            add_equipment_to_stockpile = {
                type = artillery_equipment
                amount = 70
                producer = EQS
            }
            add_equipment_to_stockpile = {
                type = support_equipment
                amount = 200
                producer = EQS
            }
        }
    }
    
    shared_focus = {
        id = FLY_war_effort
        icon = GFX_goal_unknown
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_fillydelphia_soldiers

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_fillydelphia_soldiers focus = FLY_secure_garrisons }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_war_effort"
            add_ideas = FLY_industrial_war_effort
        }
    }
        
    shared_focus = {
        id = FLY_starlight_glimmer
        icon = GFX_goal_unknown
        cost = 1
        x = 0
        y = 2
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_convince_ponies"
            custom_effect_tooltip = FLY_starlight_glimmer_recruited_tp
            custom_effect_tooltip = FLY_starlight_glimmer_stats_tp
            hidden_effect = {
                every_possible_country = {
					limit = {
						has_character = EQS_starlight_glimmer
					}
					EQS_starlight_glimmer = {
						set_nationality = PREV.PREV
					}
				}
                add_field_marshal_role = {
                    character = EQS_starlight_glimmer
                    traits = { pony_race_trait trait_talented_coordinator thorough_planner organizer }
                    skill = 4
                    attack_skill = 2
                    defense_skill = 2
                    planning_skill = 5
                    logistics_skill = 4
                    legacy_id = 339110
                    desc = EQS_starlight_glimmer_desc
                }
            }
            hidden_effect = {
                country_event = { id = fillydelphia_manesix.1 days = 1 }
            }
        }
    }

    shared_focus = {
        id = FLY_hope_speech
        icon = GFX_goal_unknown
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_hope_speech"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 5
            }
            custom_effect_tooltip = FLY_add_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy = FLY_legitimacy_temp
            }
            add_stability = 0.1
            add_political_power = 200
        }
    }
                    
    shared_focus = {
        id = FLY_cause_speech
        icon = GFX_goal_unknown
        cost = 2
        x = 3
        y = 1
        relative_position_id = FLY_birth_of_republic

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_birth_of_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_cause_speech"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 5
            }
            custom_effect_tooltip = FLY_add_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy = FLY_legitimacy_temp
            }
            add_war_support = 0.1
            add_manpower = 45000
        }
    }
            
    shared_focus = {
        id = FLY_return_of_friendship
        icon = GFX_goal_tree_of_harmony
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_hope_speech

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_hope_speech focus = FLY_cause_speech }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_return_of_friendship"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 5
            }
            custom_effect_tooltip = FLY_add_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy = FLY_legitimacy_temp
            }
            add_ideas = FLY_keepers_friendship
        }
    }
                            
    shared_focus = {
        id = FLY_convince_ponies
        icon = GFX_goal_unknown
        cost = 1
        x = -1
        y = 1
        relative_position_id = FLY_starlight_glimmer

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_war_effort }
        prerequisite = { focus = FLY_starlight_glimmer }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_convince_ponies"
            custom_effect_tooltip = FLY_unlock_legitimacy_continuous_focus
            set_country_flag = FLY_unlocked_continuous_focus
            set_variable = {
                var = FLY_continuous_legitimacy_raise_cap
                value = 50
            }
        }
    }

    shared_focus = {
        id = FLY_topple_tyranny
        icon = GFX_goal_unknown
        cost = 1
        x = 1
        y = 1
        relative_position_id = FLY_starlight_glimmer

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_starlight_glimmer }
        prerequisite = { focus = FLY_return_of_friendship }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_topple_tyranny"
            add_ideas = FLY_equestria_still_lives
        }
    }
    
    shared_focus = {
        id = FLY_declare_republic
        icon = GFX_goal_unknown
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_convince_ponies
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_25_legitimacy_req
                check_variable = { FLY_legitimacy > 24 }
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_convince_ponies }
        prerequisite = { focus = FLY_topple_tyranny }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_topple_tyranny"
            effect_tooltip = {
                set_cosmetic_tag = EQS_FLY_organised_1
            }
            custom_effect_tooltip = FLY_can_core_tp
            hidden_effect = {
                country_event = fillydelphia_civil.4
            }
        }
    }

    shared_focus = {
        id = FLY_honesty 
        icon = GFX_goal_FLY_honesty
        cost = 1
        x = -13
        y = 1
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_honesty_tp
                always = no
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_honesty"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
        }
    }

    shared_focus = {
        id = FLY_kindness
        icon = GFX_goal_FLY_kindness
        cost = 1
        x = -11
        y = 1
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_kindness_tp
                always = no
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_kindness"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
        }
    }

    shared_focus = {
        id = FLY_laughter
        icon = GFX_goal_FLY_laughter
        cost = 1
        x = -9
        y = 1
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_laughter_tp
                always = no
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_laughter"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
        }
    }

    shared_focus = {
        id = FLY_generosity
        icon = GFX_goal_FLY_generosity
        cost = 1
        x = -7
        y = 1
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_generosity_tp
                always = no
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_generosity"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
        }
    }

    shared_focus = {
        id = FLY_loyalty
        icon = GFX_goal_FLY_loyalty
        cost = 1
        x = -5
        y = 1
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_loyalty_tp
                always = no
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_loyalty"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
        }
    }

    shared_focus = {
        id = FLY_magic
        icon = GFX_goal_FLY_magic
        cost = 1
        x = -3
        y = 1
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_magic_tp
                always = no
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_magic"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
        }
    }
    
    shared_focus = {
        id = FLY_unity
        icon = GFX_goal_FLY_unity
        cost = 2
        x = 1
        y = 1
        relative_position_id = FLY_laughter

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_honesty focus = FLY_kindness focus = FLY_laughter focus = FLY_generosity focus = FLY_loyalty focus = FLY_magic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_unity"
            set_temp_variable = {
                var = FLY_legitimacy_temp
                value = 10
            }
            custom_effect_tooltip = FLY_increase_max_legitimacy_tp
            add_to_variable = {
                FLY_legitimacy_max = FLY_legitimacy_temp
            }
            custom_effect_tooltip = FLY_starlight_unity_tp
            hidden_effect = {
                EQS_starlight_glimmer = {
                    gain_xp = 1250
                    add_attack = 1
                    add_defense = 1
                    add_logistics = 1
                    add_planning = 1
                }
            }
        }
    }

    shared_focus = {
        id = FLY_vanhoover_operation
        icon = GFX_goal_revolution_pony
        cost = 5
        x = -1
        y = 1
        relative_position_id = FLY_declare_republic
        available = {
            NOT = {
                14 = {
                    OR = {
                        is_controlled_by = CHN
                        is_controlled_by_ROOT_or_ally = yes
                        is_controlled_by_ROOT_or_subject = yes
                    }
                }
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancelable = no
        cancel_if_invalid = yes

        select_effect = {
            14 = {
                controller = {
                    if = {
                        limit = {
                            is_ai = no
                        }
                        #country event warning about Vanhoover movement

                    }
                }
            }
        }

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_wartime_leader"
            custom_effect_tooltip = FLY_vanhoover_explanation_tp
            hidden_effect = {
                14 = {
                    set_state_controller_to	= FLY
                    create_unit = {
                        division = "name = \"Vanhoover Militia\" division_template = \"Militia Brigade\" start_experience_factor  = 0.1"
                        owner = FLY
                        count = 2
                        prioritize_location = 585
                        allow_spawning_on_enemy_provs = yes
                    }
                    create_unit = {
                        division = "name = \"Vanhoover Militia\" division_template = \"Militia Brigade\" start_experience_factor  = 0.1"
                        owner = FLY
                        count = 1
                        prioritize_location = 1141
                        allow_spawning_on_enemy_provs = yes
                    }
                    create_unit = {
                        division = "name = \"Vanhoover Militia\" division_template = \"Militia Brigade\" start_experience_factor  = 0.1"
                        owner = FLY
                        count = 1
                        prioritize_location = 1141
                        allow_spawning_on_enemy_provs = yes
                    }
                }
            }
        }
    }

    shared_focus = {
        id = FLY_wartime_leader
        icon = GFX_goal_unknown
        cost = 3
        x = 0
        y = 2
        relative_position_id = FLY_declare_republic
        available = {
            custom_trigger_tooltip = {
                tooltip = FLY_50_legitimacy_req
                check_variable = { FLY_legitimacy > 49 }
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_declare_republic }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_wartime_leader"
            custom_effect_tooltip = FLY_choose_wartime_leader_tp
            country_event = fillydelphia_civil.5
        }
    }

    shared_focus = {
        id = FLY_assume_mantle_equestria
        icon = GFX_goal_unknown
        cost = 3
        x = 0
        y = 3
        relative_position_id = FLY_wartime_leader
        available = {
            OR = {
                custom_trigger_tooltip = {
                    tooltip = FLY_70_legitimacy_req
                    check_variable = { FLY_legitimacy > 69 } # nice
                }
                AND = {
                    OR = {
                        EQS = {
                            exists = no
                        }
                        NLR = {
                            exists = no
                        }
                    }
                    custom_trigger_tooltip = {
                        tooltip = FLY_50_legitimacy_req
                        check_variable = { FLY_legitimacy > 49 }
                    }
                }
                AND = {
                    num_of_controlled_states > 19
                    custom_trigger_tooltip = {
                        tooltip = FLY_50_legitimacy_req
                        check_variable = { FLY_legitimacy > 49 }
                    }
                }
                AND = {
                    EQS = {
                        exists = no
                    }
                    NLR = {
                        exists = no
                    }
                }
            }
        }

        ai_will_do = {
            factor = 5
        }

        prerequisite = { focus = FLY_wartime_leader }

        cancel_if_invalid = yes

        completion_reward = {
            log = "[GetDateText]: [Root.GetName]: Focus FLY_assume_mantle_equestria"
            effect_tooltip = {
                set_cosmetic_tag = EQS_FLY_republic_1
            }
            custom_effect_tooltip = FLY_get_cores_on_SOL_NLR_tp
            hidden_effect = {
                every_state = {
                    limit = {
                        OR = {
                            is_core_of = SOL
                            is_core_of = NLR
                        }
                    }
                    add_core_of = FLY
                }
                if = {
                    limit = {
                        has_cosmetic_tag = EQS_FLY_organised_1
                    }
                    set_cosmetic_tag = EQS_FLY_republic_1
                }
                else_if = {
                    limit = {
                        has_cosmetic_tag = EQS_FLY_organised_2
                    }
                    set_cosmetic_tag = EQS_FLY_republic_2
                }
                else = {
                    set_cosmetic_tag = EQS_FLY_republic_3
                }
            }
        }
    }