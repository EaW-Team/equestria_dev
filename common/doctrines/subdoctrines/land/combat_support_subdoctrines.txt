fire_concentration = {
    track = combat_support
    name = SUBDOCTRINE_FIRE_CONCENTRATION
    description = SUBDOCTRINE_FIRE_CONCENTRATION_DESC
    icon = GFX_doctrine_fire_concentration_medium

    xp_cost = 100
    xp_type = army

    available = {
        always = yes
    }

    ai_will_do = {

        base = 1
        modifier = {
            factor = 2
            ROOT = { tag = HIP }
        }
        modifier = {
            factor = 0.5
            ROOT = { is_major = no }
        }
    }

     # EFFECTS
     enable_tactic = tactic_overwhelming_fire

     artillery_brigade = {
        combat_width = -0.8
     }
     category_line_artillery = {
        max_organisation = 5
     }

     rewards = {
        standing_barrage = {
        #1
            category_line_artillery = {
                defense = 0.1
            }
        }
        predicted_fire = {
        #2
            category_line_artillery = {
                soft_attack = 0.1
            }
        }
        artillery_groups = {
        #3
            category_line_artillery = {
                breakthrough = 0.1
                defense = 0.05
            }
        }
        dedicated_air_support = {
        #4
            category_anti_air = {
                air_attack = 0.1
            }
        }
        weakpoint_studies = {
        #5
            anti_tank_brigade = {
                ap_attack = 0.1
                hard_attack = 0.1
            }
            artillery_brigade = {
                hard_attack = 0.1
            }
        }
    }
}

anti_tank_frontline = {
    track = combat_support
    name = SUBDOCTRINE_ANTI_TANK_FRONT
    description = SUBDOCTRINE_ANTI_TANK_FRONT_DESC
    icon = GFX_doctrine_antitank_frontline_medium

    xp_cost = 100
    xp_type = army

    available = {
        always = yes
    }

   ai_will_do = {

        
   }

     # EFFECTS
     

    engineer = {
        battalion_mult = {
            category = category_line_artillery
            entrenchment = 0.2
            add = yes
        }
    }

    rewards = {
        pakfront = {
        #1
            anti_tank_brigade = {
                defense = 0.2
                ap_attack = 0.1
                soft_attack = 0.2
            }
        }
        emplacement_rotation = {
        #2
            anti_tank_brigade = {
                max_organisation = 10
            }
        }
        weakpoint_studies = {
        #3
            anti_tank_brigade = {
                ap_attack = 0.1
                hard_attack = 0.1
            }
        }
        offensive_deployments = {
        #4
            mot_anti_tank_brigade = {
                breakthrough = 0.2
                ap_attack = 0.2
            }
        }
        assault_anti_tank = {
        #5
            mot_anti_tank_brigade = {
                soft_attack = 0.2
                hard_attack = 0.2
            }
        }
    }
}

flying_batteries = {
    track = combat_support
    name = SUBDOCTRINE_FLYING_BATTERIES
    description = SUBDOCTRINE_FLYING_BATTERIES_DESC
    icon = GFX_doctrine_flying_batteries_medium

    xp_cost = 100
    xp_type = army

    available = {
        has_dlc = "No Compromise, No Surrender"
    }

    
    ai_will_do = {
        base = 1

        modifier = {
            factor = 0 
            ROOT = { NOT = { has_tech = rocket_artillery } }
        }
    }

     # EFFECTS
     effect = {
        add_tech_bonus = {
            bonus = 0.5
            uses = 1
            category = rocketry
            name = SUBDOCTRINE_FLYING_BATTERIES
        }
    }

    category_line_artillery = {
        soft_attack = 0.1
    }

    rewards = {
        deployment_drills = {
            mot_rocket_artillery_brigade = {
                max_organisation = 10
            }
            motorized_rocket_brigade = {
                max_organisation = 10
            }
            mot_artillery_brigade = {
                max_organisation = 10
            }
        }
        counter_battery_tasks = {
            
            recon = {
                battalion_mult = {
                    category = category_line_artillery #there should be a motorized arty only cat
                    soft_attack = 0.05
                    defense = 0.1
                }
                recon = 0.25
            }
        }
        ballistics_corrections = {
            armored_signal = {
                battalion_mult = {
                    category = category_line_artillery
                    initiative = 0.02
                    supply_consumption = -0.01
                }
            }

        }
        mobile_barrages = {
            category_line_artillery = {
                default_morale = 0.05
                breakthrough = 0.05
            }

        }
        wide_dispersal_positions = {
            mot_rocket_artillery_brigade = {
                max_organisation = 10
            }
            motorized_rocket_brigade = {
                max_organisation = 10
            }
            mot_artillery_brigade = {
                max_organisation = 10
            }
        }
    }
}

air_cavalry = {
    track = combat_support
    name = SUBDOCTRINE_AIR_CAVALRY
    description = SUBDOCTRINE_AIR_CAVALRY_DESC
    icon = GFX_doctrine_air_cavalry_medium

    xp_cost = 100
    xp_type = army

    available = {
        is_special_project_completed = sp:sp_air_helicopter
    }
    visible = {
        has_dlc = "Gotterdammerung"
    }   

    ai_will_do = {
        base = 1
        modifier = {
            factor = 0
            ROOT = {NOT = { is_special_project_completed = sp:sp_air_helicopter}}
        }

    }

     # EFFECTS
    effect = {
        add_tech_bonus = {
            bonus = 0.5
            uses = 2
            category = helicopter_tech
            name = SUBDOCTRINE_AIR_CAVALRY
        }
    }

     rewards = {
        airborne_observers = { 
            helicopter_recon = {
                battalion_mult = {
                    category = category_artillery
                    soft_attack = 0.1
                }
                max_organisation = 10
            }
        }
        service_and_support = {
            category_helicopter_support_companies = {
                max_strength = 0.03
            }
        }
        rescue_liasions = {
            helicopter_field_hospital = {
            battalion_mult = {
                category = category_all_infantry
                    max_strength = 0.05 
                    default_morale = 0.05 
                }
                max_organisation = 5
                casualty_trickleback = 0.05
            }
        }

        transport_assault = {
            helicopter_transport = {
                battalion_mult = {
                    category = category_light_infantry
                    maximum_speed = 0.2
                    breakthrough = 0.05
                }
                breakthrough = 0.05
                max_organisation = 10
            }
                
        }
        intervention_units = {
            helicopter_brigade = {
                battalion_mult = {
                    category = category_all_infantry
                    soft_attack = 0.1
                }
                max_organisation = 10
                
            }
        }
 

     }
}

mobile_recon_and_assault = {
    track = combat_support
    name = SUBDOCTRINE_MOBILE_RECON_AND_ASSAULT
    description = SUBDOCTRINE_MOBILE_RECON_AND_ASSAULT_DESC
    icon = GFX_doctrine_mobile_recon_assault_medium

    xp_cost = 100
    xp_type = army

    available = {
        always = yes
    }

    
    ai_will_do = {

        base = 1
        modifier = {
            factor = 2
            ROOT = { tag = CHN }
        }
        modifier = {
            factor = 2
            ROOT = { tag = HIP }
        }
    }
    

    armored_car = {
        max_organisation = 3
    }

    rewards = {

        motorization_support = {
            category_mobile_and_mobile_combat_sup = {
                maximum_speed = 0.1
                default_morale = 0.2
            }

        }
        long_range_reconnaissance = {
            recon = {
                maximum_speed = 0.15
            }
        }
        mobile_operational_deployments = {
            light_tank_recon = {
                battalion_mult = {
                    category = category_all_armor
                    breakthrough = 0.1
                }
            }
            mot_artillery_brigade = {
                soft_attack = 0.05
            }

        }
        self_propelled_support_elements = {
            category_self_propelled_artillery = {
                soft_attack = 0.10
            }
            category_self_propelled_anti_air= {
                air_attack = 0.15
                soft_attack = 0.05
            }
            category_tank_destroyers = {
                hard_attack = 0.1
                ap_attack = 0.03
            }
            armored_car = {
                breakthrough = 0.2
                default_morale = 0.2
            }
        }
        deep_reconnaissance_focus = {
            category_recon = {
                maximum_speed = 0.1
            }
            light_tank_recon = {
                recon = 0.2
                breakthrough = 0.1
            }
        }
    }
}

self_propelled_support = {

    track = combat_support
    name = SUBDOCTRINE_SELF_PROPELLED_SUPPORT
    description = SUBDOCTRINE_SELF_PROPELLED_SUPPORT_DESC
    icon = GFX_doctrine_self_propelled_support_medium

    xp_cost = 100
    xp_type = army

    available = {
        has_dlc = "No Compromise, No Surrender"
    }

    ai_will_do = { }


    category_self_propelled_artillery = {
        soft_attack = 0.1
    }
    category_self_propelled_anti_air= {
        air_attack = 0.1
    }
    category_tank_destroyers = {
        hard_attack = 0.05
    }


    rewards = {

        mobile_battery_management_platoons = {
            category_self_propelled_artillery = {
                combat_width = -0.6
                max_organisation = 10
            }
            category_self_propelled_anti_air= {
                combat_width = -0.6
                max_organisation = 10
            }
            category_tank_destroyers = {
                combat_width = -0.6
                max_organisation = 10
            }
        }
        screening_attacks = {
            
            recon = {
                battalion_mult = {
                    category = category_self_propelled_artillery
                    soft_attack = 0.1
                    default_morale = 0.02
                }
            }
        }
        all_terrain_mobility = {
            category_self_propelled_artillery = {
                maximum_speed = 0.3
            }
            category_self_propelled_anti_air= {
                maximum_speed = 0.3
            }
            category_tank_destroyers = {
                maximum_speed = 0.3
            }
        }
        multirole_support_vehicles = {
            category_self_propelled_artillery = {
                hard_attack = 0.05
            }
            category_self_propelled_anti_air= {
                soft_attack = 0.1
                hard_attack = 0.05
            }
            category_tank_destroyers = {
                soft_attack = 0.1
            }
        }
        shoot_and_scoot = {
            category_self_propelled_artillery = {
                max_organisation = 10
                default_morale = 0.4
            }
            category_self_propelled_anti_air= {
                max_organisation = 10
                default_morale = 0.4
            }
            category_tank_destroyers = {
                max_organisation = 10
                default_morale = 0.4
            }
        }

    }

    
}

siege_artillery = {
    track = combat_support
    name = SUBDOCTRINE_SIEGE_ARTILLERY
    description = SUBDOCTRINE_SIEGE_ARTILLERY_DESC
    icon = GFX_doctrine_siege_artillery_medium

    xp_cost = 100
    xp_type = army

    available = {
        is_special_project_completed = sp:sp_land_super_heavy_howitzer
    }
    visible = {
        has_dlc = "Gotterdammerung"
    }

    ai_will_do = {

        modifier = {
            factor = 0.5
            ROOT = { is_major = no }
        }
        modifier = {
            factor = 0
            ROOT = { NOT = {is_special_project_completed = sp:sp_land_super_heavy_howitzer }}
        }
        
    }

    super_heavy_artillery = {
        battalion_mult = {
            category = category_army
            soft_attack = 0.1
            defense = 0.1
        }
    }

    rewards = {

        fortress_busters = {
            super_heavy_artillery = {
                fort = {
                    attack = 0.25
                }
            }
            self_propelled_super_heavy_artillery = {
                fort = {
                    attack = 0.25
                }
            }
        }
        improved_transport_preparation = {
            category_line_artillery = {
                default_morale = 0.2
            }
            super_heavy_artillery = {
                plains = {
                    movement = 0.1
                }
            }
            self_propelled_super_heavy_artillery = {
                plains = {
                    movement = 0.1
                }
            }
        }
        precomputed_firing_data = {
            super_heavy_artillery = {
                max_organisation = 10
                defense = 0.2
            }
            self_propelled_super_heavy_artillery = {
                max_organisation = 10
                defense = 0.2
            }

        }
        urban_strongpoint_sieges = {
            super_heavy_artillery = {
                urban = {
                    attack = 0.2
                }
            }
            self_propelled_super_heavy_artillery = {
                urban = {
                    attack = 0.2
                }
            }
        }
        mobile_artillery_command = {
            category_support_artillery = {
                max_organisation = 10
            }
            self_propelled_super_heavy_artillery = {
                max_organisation = 10
                maximum_speed = 0.5
            }
        }
    }
}


field_engineering = {
    track = combat_support
    name = SUBDOCTRINE_FIELD_ENGINEERING
    description = SUBDOCTRINE_FIELD_ENGINEERING_DESC
    icon = GFX_doctrine_siege_artillery_medium

    xp_cost = 100
    xp_type = army

    visible = {
        has_dlc = "No Compromise, No Surrender"
    }

    engineer = {
        river = {
            movement = 0.2
        }
        forest = {
            movement = 0.2
        }
    }
    assault_engineer = {
        river = {
            movement = 0.2
        }
        forest = {
            movement = 0.2
        }
    }
    pioneer_support = {
        river = {
            movement = 0.2
        }
        forest = {
            movement = 0.2
        }
    }
    #TODO_JBE: replace with category of engineers
    rewards = {
        rapid_fire_lane_clearance = {
            engineer = {
                max_organisation = 5
                battalion_mult = {
                    category = category_all_infantry
                    entrenchment = 0.01
                }
            }
            maintenance_company = {
                max_organisation = 5
            }
            
        }
        sapper_fieldcraft = {
            engineer = {
                max_strength = 0.25
                defense = 0.1
            }
            maintenance_company = {
                max_strength = 0.25
            }
        }
        engineerdug_gun_emplacements = {
            engineer = {
                battalion_mult = {
                    category = category_artillery
                    soft_attack = 0.1
                    defense = 0.1
                }
            }
        }
        smoke_projector_training = {
            engineer = {
                breakthrough = 0.5
            }
            maintenance_company = {
                supply_consumption = -0.01
                battalion_mult = {
                    category = category_tanks
                    reliability = 0.05
                    strength = 0.05
                }
            }

        }
        charge_and_flame = {
            engineer = {
                max_organisation = 5
                soft_attack = 0.05
                hard_attack = 1  
            }
            maintenance_company = {
                max_organisation = 5
            }
        }

    }
}