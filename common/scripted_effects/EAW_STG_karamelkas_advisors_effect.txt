#==============================#
### Karamelka's advisors GUI ###
#==============================#
# Made by Scars

### Initialization of the GUI itself, compute x and y values, etc.
STG_advisors_init = {
	set_country_flag = KRMLK_active
	## The x and y coordinates of where the advisors are as they rely on a gridbox to render
	clear_array = KRMLK_advisors_x
	clear_array = KRMLK_advisors_y
	add_to_array = { KRMLK_advisors_x = 21 }
	add_to_array = { KRMLK_advisors_y = 206 }
	add_to_array = { KRMLK_advisors_x = 72 }
	add_to_array = { KRMLK_advisors_y = 85 }
	add_to_array = { KRMLK_advisors_x = 193 }
	add_to_array = { KRMLK_advisors_y = 34 }
	add_to_array = { KRMLK_advisors_x = 314 }
	add_to_array = { KRMLK_advisors_y = 85 }
	add_to_array = { KRMLK_advisors_x = 366 }
	add_to_array = { KRMLK_advisors_y = 206 }

	## Advisors are tokens of hidden ideas defined in zzz_STG_karamelkas_advisors_ideas.txt
	clear_array = KRMLK_active_advisors
	add_to_array = { KRMLK_active_advisors = token:STG_KRMLK_no_advisor }
	add_to_array = { KRMLK_active_advisors = token:STG_KRMLK_no_advisor }
	add_to_array = { KRMLK_active_advisors = token:STG_KRMLK_no_advisor }
	add_to_array = { KRMLK_active_advisors = token:STG_KRMLK_no_advisor }
	add_to_array = { KRMLK_active_advisors = token:STG_KRMLK_no_advisor }
	
	clear_array = KRMLK_available_advisors
	add_to_array = { KRMLK_available_advisors = token:STG_KRMLK_test_1 }
	add_to_array = { KRMLK_available_advisors = token:STG_KRMLK_test_2 }
	add_to_array = { KRMLK_available_advisors = token:STG_KRMLK_test_3 }

	## Tick of the advisors
	clear_array = KRMLK_ticks
	resize_array = { array = KRMLK_ticks value = -1 size = 5 }
	
	add_to_variable = { KRMLK_dirty = 0.01 }
}

# Effect to set the tick delay of an idea
# Arguments: temp_tick_days, temp_id
KRMLK_set_tick = {
	set_temp_variable = { temp_value = temp_id }
	KRMLK_find_index = yes

	set_variable = { KRMLK_ticks^out_index = temp_tick_days }
}

# Shorthand function to get the index of the value in KRMLK_active_advisors
# Arguments: temp_value
# Output: out_index
KRMLK_find_index = {
	for_each_loop = {
		array = KRMLK_active_advisors
		break = b
		if = {
			limit = {
				check_variable = { v = temp_value }
			}
			set_temp_variable = { out_index = i }
			set_temp_variable = { b = 1 }
		}
	}
}