# Function    : STG_DW_setup_reforms_minigame_f
# Description : Setup the variables used by the reforms minigame
# Inputs  : None
# Outputs : SRG_DW_reform_point_step_values_array - Arrays defining the ranges for the point increase tooltips
STG_DW_setup_reforms_minigame_f = {
	clear_array  =   STG_DW_reform_point_step_values_array
	add_to_array = { STG_DW_reform_point_step_values_array = 20 }
	add_to_array = { STG_DW_reform_point_step_values_array = 50 }
	add_to_array = { STG_DW_reform_point_step_values_array = 80 }
	add_to_array = { STG_DW_reform_point_step_values_array = 120 }

	clear_array  =  STG_DW_reform_point_stage_values_array
	add_to_array = { STG_DW_reform_point_stage_values_array = 200 }
	add_to_array = { STG_DW_reform_point_stage_values_array = 800 }
	add_to_array = { STG_DW_reform_point_stage_values_array = 1500 }
	add_to_array = { STG_DW_reform_point_stage_values_array = 3000 }
	add_to_array = { STG_DW_reform_point_stage_values_array = 8000 }
	clear_array  = STG_DW_reform_point_stage_titles_array
	add_to_array = { STG_DW_reform_point_stage_titles_array = token:STG_DW_reform_stage_title_0 }
	add_to_array = { STG_DW_reform_point_stage_titles_array = token:STG_DW_reform_stage_title_1 }
	add_to_array = { STG_DW_reform_point_stage_titles_array = token:STG_DW_reform_stage_title_2 }
	add_to_array = { STG_DW_reform_point_stage_titles_array = token:STG_DW_reform_stage_title_3 }
	add_to_array = { STG_DW_reform_point_stage_titles_array = token:STG_DW_reform_stage_title_4 }
	add_to_array = { STG_DW_reform_point_stage_titles_array = token:STG_DW_reform_stage_title_5 }
	clear_array  = STG_DW_reform_point_stage_descs_array
	add_to_array = { STG_DW_reform_point_stage_descs_array = token:STG_DW_reform_stage_desc_0 }
	add_to_array = { STG_DW_reform_point_stage_descs_array = token:STG_DW_reform_stage_desc_1 }
	add_to_array = { STG_DW_reform_point_stage_descs_array = token:STG_DW_reform_stage_desc_2 }
	add_to_array = { STG_DW_reform_point_stage_descs_array = token:STG_DW_reform_stage_desc_3 }
	add_to_array = { STG_DW_reform_point_stage_descs_array = token:STG_DW_reform_stage_desc_4 }
	add_to_array = { STG_DW_reform_point_stage_descs_array = token:STG_DW_reform_stage_desc_5 }

	set_variable = { test_value = token:STG_DW_reform_stage_title_0 }
	set_variable = { STG_DW_reform_stage = 0 }
	set_variable = { STG_DW_reform_points = 0 }
	add_to_variable = { STD_DW_update_reform_gui = 1 }
}

# Function : STG_DW_add_points_f
# Description : Use to add reforms points. Provide an effect tooltip
# Inputs  : temp_STG_DW_reform_points_increase_value - The value to increment the point with
# Outputs : None
STG_DW_add_points_f = {
	custom_effect_tooltip = "[GetReformPointIncrLoc]"
	add_to_variable = {
		STG_DW_reform_points = temp_STG_DW_reform_points_increase_value
	}

	set_temp_variable = { temp_stage_changed = 0 }
	# Handle stage change
	for_each_loop = {
		array = STG_DW_reform_point_stage_values_array
		index = stage_index
		value = stage_value
		break = stage_break

		if = {
			limit = {
				check_variable = { STG_DW_reform_points < stage_value }
			}

			if = {
				limit = {
					check_variable = { stage_index > STG_DW_reform_stage }
				}

				set_variable = { STG_DW_reform_stage = stage_index }
				set_temp_variable = { temp_stage_changed = 1 }
			}
			set_temp_variable = { stage_break = 1 }
		}
	}
	set_temp_variable = { temp_size_array = STG_DW_reform_point_stage_values_array^num }
	add_to_temp_variable = { temp_size_array = -1 }
	if = {
		limit = {
			check_variable = { STG_DW_reform_point_stage_values_array^num > STG_DW_reform_stage }
			check_variable = { STG_DW_reform_points > STG_DW_reform_point_stage_values_array^temp_size_array }
		}

		set_variable = { STG_DW_reform_stage = STG_DW_reform_point_stage_values_array^num }
		set_temp_variable = { temp_stage_changed = 1 }
	}

	if = {
		limit = {
			check_variable = { temp_stage_changed = 1 }
		}

		meta_effect = {
			text = {
				country_event = stalliongrad_dark_wing_reform_stages.[ID_EVENT]
			}
			ID_EVENT = "[?STG_DW_reform_stage]"
		}
	}

	add_to_variable = { STD_DW_update_reform_gui = 1 }
}