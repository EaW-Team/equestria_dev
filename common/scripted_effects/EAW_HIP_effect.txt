HIP_increase_divided_society = {
	custom_effect_tooltip = HIP_increase_divided_society_tt
	if = {
		limit = {
			NOT = {
				has_idea = HIP_divided_society_9
			}
		}
		custom_effect_tooltip = HIP_underwater_building_cost_up_tt
		add_to_variable = {
			var = HIP_underwater_building_cost value = 5
		}
	}
	if = {
		limit = {
			has_idea = HIP_divided_society_1
		}
		swap_ideas = { remove_idea = HIP_divided_society_1 add_idea = HIP_divided_society_2 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_2
		}
		swap_ideas = { remove_idea = HIP_divided_society_2 add_idea = HIP_divided_society_3 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_3
		}
		swap_ideas = { remove_idea = HIP_divided_society_3 add_idea = HIP_divided_society_4 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_4
		}
		swap_ideas = { remove_idea = HIP_divided_society_4 add_idea = HIP_divided_society_5 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_5
		}
		swap_ideas = { remove_idea = HIP_divided_society_5 add_idea = HIP_divided_society_6 }
		hidden_effect = {
			HIP_hippogriff_leader = yes
		}
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_6
		}
		swap_ideas = { remove_idea = HIP_divided_society_6 add_idea = HIP_divided_society_7 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_7
		}
		swap_ideas = { remove_idea = HIP_divided_society_7 add_idea = HIP_divided_society_8 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_8
		}
		swap_ideas = { remove_idea = HIP_divided_society_8 add_idea = HIP_divided_society_9 }
	}
}

HIP_decrease_divided_society = {
	custom_effect_tooltip = HIP_decrease_divided_society_tt
	if = {
		limit = {
			NOT = {
				has_idea = HIP_divided_society_1
			}
		}
		custom_effect_tooltip = HIP_underwater_building_cost_down_tt
		add_to_variable = {
			var = HIP_underwater_building_cost value = -5
		}
	}
	if = {
		limit = {
			has_idea = HIP_divided_society_9
		}
		swap_ideas = { remove_idea = HIP_divided_society_9 add_idea = HIP_divided_society_8 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_8
		}
		swap_ideas = { remove_idea = HIP_divided_society_8 add_idea = HIP_divided_society_7 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_7
		}
		swap_ideas = { remove_idea = HIP_divided_society_7 add_idea = HIP_divided_society_6 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_6
		}
		swap_ideas = { remove_idea = HIP_divided_society_6 add_idea = HIP_divided_society_5 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_5
		}
		swap_ideas = { remove_idea = HIP_divided_society_5 add_idea = HIP_divided_society_4 }
		hidden_effect = {
			HIP_seapony_leader = yes
		}
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_4
		}
		swap_ideas = { remove_idea = HIP_divided_society_4 add_idea = HIP_divided_society_3 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_3
		}
		swap_ideas = { remove_idea = HIP_divided_society_3 add_idea = HIP_divided_society_2 }
	}
	else_if = {
		limit = {
			has_idea = HIP_divided_society_2
		}
		swap_ideas = { remove_idea = HIP_divided_society_2 add_idea = HIP_divided_society_1 }
	}
}

HIP_seapony_leader = {
	if = {
		limit = {
			has_country_leader = {
				character = HIP_queen_novo
			}
		}
		HIP_queen_novo = {
			set_portraits={
				civilian={
					large="gfx/leaders/HIP/Queen_Novo_Seapony.tga"
				}
			}
		}
	}
}

HIP_hippogriff_leader = {
	if = {
		limit = {
			has_country_leader = {
				character = HIP_queen_novo
			}
		}
		HIP_queen_novo = {
			set_portraits={
				civilian={
					large="gfx/leaders/HIP/Queen_Novo_Hippogriff.tga"
				}
			}
		}
	}
}

HIP_remove_underwater_buildings = {
	custom_effect_tooltip = HIP_remove_underwater_buildings_tt
	add_offsite_building = {
		type = industrial_complex
		level = var:HIP_underwater_civ_remove
	}
	add_offsite_building = {
		type = arms_factory
		level = var:HIP_underwater_mil_remove
	}
	add_offsite_building = {
		type = dockyard
		level = var:HIP_underwater_dockyard_remove
	}
	add_offsite_building = {
		type = synthetic_refinery
		level = var:HIP_underwater_refinery_remove
	}
	add_offsite_building = {
		type = fuel_silo
		level = var:HIP_underwater_fuel_silo_remove
	}
	add_offsite_building = {
		type = nuclear_reactor
		level = var:HIP_underwater_reactor_remove
	}
}

HIP_remove_political_advisors = {
	if = {
		limit = {
			has_idea = HIP_rocket_neverfall
		}
		remove_ideas = HIP_rocket_neverfall
	}
	if = {
		limit = {
			has_idea = HIP_silverstream
		}
		remove_ideas = HIP_silverstream
	}
	if = {
		limit = {
			has_idea = HIP_raft_wood_idea
		}
		remove_ideas = HIP_raft_wood_idea
	}
	if = {
		limit = {
			has_idea = HIP_zephyr_gust
		}
		remove_ideas = HIP_zephyr_gust
	}
	if = {
		limit = {
			has_idea = HIP_screaming_eagle
		}
		remove_ideas = HIP_screaming_eagle
	}
	if = {
		limit = {
			has_idea = HIP_azrael
		}
		remove_ideas = HIP_azrael
	}
	if = {
		limit = {
			has_idea = HIP_SIR_plumage_moonfeather
		}
		remove_ideas = HIP_SIR_plumage_moonfeather
	}
	if = {
		limit = {
			has_idea = HIP_posada_advisor
		}
		remove_ideas = HIP_posada_advisor
	}
	if = {
		limit = {
			has_idea = HIP_bit_tracker
		}
		remove_ideas = HIP_bit_tracker
	}
	if = {
		limit = {
			has_idea = HIP_switft_shell
		}
		remove_ideas = HIP_switft_shell
	}
	if = {
		limit = {
			has_idea = HIP_salina_blue
		}
		remove_ideas = HIP_salina_blue
	}
	if = {
		limit = {
			has_idea = HIP_hard_line
		}
		remove_ideas = HIP_hard_line
	}
	if = {
		limit = {
			has_idea = HIP_anarchist_schools
		}
		remove_ideas = HIP_anarchist_schools
	}
	if = {
		limit = {
			has_idea = HIP_razorbeak
		}
		remove_ideas = HIP_razorbeak
	}
	if = {
		limit = {
			has_idea = HIP_high_priests
		}
		remove_ideas = HIP_high_priests
	}
	if = {
		limit = {
			has_idea = HIP_violet_facade
		}
		remove_ideas = HIP_violet_facade
	}
	if = {
		limit = {
			has_idea = HIP_blackeyes_whitewind
		}
		remove_ideas = HIP_blackeyes_whitewind
	}
	if = {
		limit = {
			has_idea = HIP_cloud_breeze
		}
		remove_ideas = HIP_cloud_breeze
	}
	if = {
		limit = {
			has_idea = HIP_sunlight_rays
		}
		remove_ideas = HIP_sunlight_rays
	}
	if = {
		limit = {
			has_idea = HIP_coral_ridge
		}
		remove_ideas = HIP_coral_ridge
	}
	if = {
		limit = {
			has_idea = HIP_fetch_flow
		}
		remove_ideas = HIP_fetch_flow
	}
	if = {
		limit = {
			has_idea = HIP_SIR_sonata_advisor
		}
		remove_ideas = HIP_SIR_sonata_advisor
	}
	if = {
		limit = {
			has_idea = HIP_SIR_aria_advisor
		}
		remove_ideas = HIP_SIR_aria_advisor
	}
	if = {
		limit = {
			has_idea = HIP_SIR_adagio_advisor
		}
		remove_ideas = HIP_SIR_adagio_advisor
	}
}

HIP_seapony_breakway = {
	HIP_remove_underwater_buildings = yes
	set_country_flag = HIP_seapony_breakaway
	HIP_underwater_conscription_secession = yes
}
HIP_hippogriff_breakway = {
	HIP_remove_underwater_buildings = yes
	set_country_flag = HIP_seapony_breakaway
	HIP_underwater_conscription_secession = yes
}
HIP_check_posada_sad = {
	if = {
		limit = {
			has_country_flag = {
				flag = posada_sad_level
				value > 11
			}
			NOT = {
				has_country_flag = HIP_posada_became_sad
			}
		}
		set_country_flag = HIP_posada_became_sad
		HIP_posada = {
			set_portraits = {
				civilian={
					large="gfx/leaders/HIP/posadasad.tga"
				}
			}
			set_leader_description = HIP_POSADA_SAD_DESC
		}
		country_event = {
			id = hippocommie.381
			days = 21
		}
	}
}
HIP_SIR_magic_change = {
	if = {
		limit = {
			is_ai = no
		}
		add_to_variable = {
			HIP_siren_power = HIP_SIR_magic_change_var
		}
		clamp_variable = {
			var = HIP_siren_power
			min = 0
			max = HIP_siren_power_max
		}
		if = {
			limit = {
				check_variable = {
					HIP_SIR_magic_change_var < 0
				}
			}
			multiply_temp_variable = {
				HIP_SIR_magic_change_var = -1
			}
			custom_effect_tooltip = HIP_SIR_power_decrease_tt
		}
		else = {
			custom_effect_tooltip = HIP_SIR_power_increase_tt
		}
	}
}
HIP_remove_all_posadist_ideas = {
	custom_effect_tooltip = HIP_no_more_supercommunism
	hidden_effect = {
		remove_ideas = {
			HIP_communist_music
			HIP_communist_music_rocket
			HIP_unlimited_internationalism
			HIP_unlimited_internationalism_rocket
			HIP_racial_equality
			HIP_racial_equality_2
			HIP_reorganizing_military
			HIP_reorganizing_military
			HIP_communist_pioneers
			HIP_atom_cult
			HIP_PLA
			HIP_PLA_2
			HIP_PLAF
			HIP_PLN
			HIP_PLAF_2
			HIP_communist_defense
			HIP_communist_defense_2
			HIP_global_liberation
			HIP_global_liberation_2
			HIP_global_liberation_3
			HIP_global_liberation_4
			HIP_communal_farms
			HIP_communist_housing
			HIP_communist_housing_2
			HIP_communist_housing_3
			HIP_welfare_aids
			HIP_communist_education
			HIP_reason_above_all
			HIP_reason_above_all_lar
			HIP_workers_paradise_idea
			HIP_workers_paradise_idea_2
			HIP_workers_paradise_idea_3
			HIP_workers_paradise_idea_4
			HIP_global_spy_agency_lar
			HIP_global_spy_agency_2
			HIP_global_spy_agency_reformed
			HIP_global_spy_agency_reformed_lar
			HIP_global_spy_agency_2_lar
			HIP_global_spy_agency
			HIP_central_committee
			HIP_democratic_centralism_idea
			HIP_stalliongrad_model
			HIP_our_own_communism
			HIP_organic_centralism_idea
			HIP_councilism_idea
			HIP_council_control
			HIP_theory_for_all
			HIP_nuclear_fever
			HIP_war_plan_uranium_idea
			HIP_war_plan_plutonium_idea
			HIP_war_plan_plutonium_idea_2
			HIP_war_plan_hydrogen_idea
			HIP_rehabilitating_reactionaries
			HIP_wasting_money
			HIP_interstellar_cause
			HIP_interstellar_cause_2
			HIP_interstellar_cause_3
			HIP_interstellar_cause_4
			HIP_extranormal_affairs_committee
			HIP_extranormal_affairs_committee_2
			HIP_extranormal_affairs_committee_3
			HIP_extranormal_affairs_committee_4
			HIP_tritium_idea
			HIP_anti_bat_decryption
			HIP_anti_bat_decryption_lar
			HIP_bat_lmrd
			HIP_union_subversion
			HIP_union_subversion_lar
			HIP_boombing_ecomony_commie
		}	
	}
}
HIP_SIR_MAGIC_conscription_down = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 1
			}
		}
		set_temp_variable = { temp_rp_change = -0.01 }
		set_temp_variable = { temp_m_change = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 2
			}
		}
		set_temp_variable = { temp_rp_change = -0.02 }
		set_temp_variable = { temp_m_change = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 3
			}
		}
		set_temp_variable = { temp_rp_change = -0.05 }
		set_temp_variable = { temp_m_change = 2 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 4
			}
		}
		set_temp_variable = { temp_rp_change = -0.1 }
		set_temp_variable = { temp_m_change = 2 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 5
			}
		}
		set_temp_variable = { temp_rp_change = -0.05 }
		set_temp_variable = { temp_m_change = 5 }
	}
	add_to_variable = { HIP_MAGIC_conscription = temp_rp_change }
	add_to_variable = { HIP_MAGIC_recruitable_seapony_pop = temp_rp_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	custom_effect_tooltip = HIP_SIR_MAGIC_conscription_decrease_CET
	subtract_from_variable = { HIP_SIR_MAGIC_conscription_level = 1 }
}
HIP_SIR_MAGIC_conscription_up = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 0
			}
		}
		set_temp_variable = { temp_rp_change = 0.01 }
		set_temp_variable = { temp_m_change = -1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 1
			}
		}
		set_temp_variable = { temp_rp_change = 0.02 }
		set_temp_variable = { temp_m_change = -1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 2
			}
		}
		set_temp_variable = { temp_rp_change = 0.05 }
		set_temp_variable = { temp_m_change = -2 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 3
			}
		}
		set_temp_variable = { temp_rp_change = 0.1 }
		set_temp_variable = { temp_m_change = -2 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_conscription_level = 4
			}
		}
		set_temp_variable = { temp_rp_change = 0.05 }
		set_temp_variable = { temp_m_change = -5 }
	}
	add_to_variable = { HIP_MAGIC_conscription = temp_rp_change }
	add_to_variable = { HIP_MAGIC_recruitable_seapony_pop = temp_rp_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	custom_effect_tooltip = HIP_SIR_MAGIC_conscription_increase_CET
	add_to_variable = { HIP_SIR_MAGIC_conscription_level = 1 }
}
HIP_SIR_MAGIC_economy_down = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 1
			}
		}
		set_temp_variable = { temp_cg_change = 0.05 }
		set_temp_variable = { temp_psbf_change = -0.1 }
		set_temp_variable = { temp_m_change = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 2
			}
		}
		set_temp_variable = { temp_cg_change = 0.1 }
		set_temp_variable = { temp_m_change = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 3
			}
		}
		set_temp_variable = { temp_cg_change = 0.1 }
		set_temp_variable = { temp_psbf_change = -0.1 }
		set_temp_variable = { temp_m_change = 4 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 4
			}
		}
		set_temp_variable = { temp_cg_change = 0.05 }
		set_temp_variable = { temp_psbf_change = -0.15 }
		set_temp_variable = { temp_m_change = 5 }
	}
	add_to_variable = { HIP_MAGIC_consumer_goods_factor = temp_cg_change }
	add_to_variable = { HIP_MAGIC_production_speed_buildings_factor = temp_psbf_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 2
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_economy_decrease_CET1
	}
	else = {
		custom_effect_tooltip = HIP_SIR_MAGIC_economy_decrease_CET2
	}
	subtract_from_variable = { HIP_SIR_MAGIC_economy_level = 1 }
}
HIP_SIR_MAGIC_economy_up = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 0
			}
		}
		set_temp_variable = { temp_cg_change = -0.05 }
		set_temp_variable = { temp_psbf_change = 0.1 }
		set_temp_variable = { temp_m_change = -1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 1
			}
		}
		set_temp_variable = { temp_cg_change = -0.1 }
		set_temp_variable = { temp_m_change = -1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 2
			}
		}
		set_temp_variable = { temp_cg_change = -0.1 }
		set_temp_variable = { temp_psbf_change = 0.1 }
		set_temp_variable = { temp_m_change = -4 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 3
			}
		}
		set_temp_variable = { temp_cg_change = -0.05 }
		set_temp_variable = { temp_psbf_change = 0.15 }
		set_temp_variable = { temp_m_change = -5 }
	}
	add_to_variable = { HIP_MAGIC_consumer_goods_factor = temp_cg_change }
	add_to_variable = { HIP_MAGIC_production_speed_buildings_factor = temp_psbf_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_economy_level = 1
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_economy_increase_CET1
	}
	else = {
		custom_effect_tooltip = HIP_SIR_MAGIC_economy_increase_CET2
	}
	add_to_variable = { HIP_SIR_MAGIC_economy_level = 1 }
}
HIP_SIR_MAGIC_production_down = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 1
			}
		}
		set_temp_variable = { temp_pfmef_change = -0.15 }
		set_temp_variable = { temp_m_change = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 2
			}
		}
		set_temp_variable = { temp_pfmef_change = -0.05 }
		set_temp_variable = { temp_pfegf_change = -0.05 }
		set_temp_variable = { temp_m_change = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 3
			}
		}
		set_temp_variable = { temp_pfmef_change = -0.05 }
		set_temp_variable = { temp_pfegf_change = -0.05 }
		set_temp_variable = { temp_icf_change = -0.05 }
		set_temp_variable = { temp_icd_change = -0.05 }
		set_temp_variable = { temp_m_change = 4 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 4
			}
		}
		set_temp_variable = { temp_pfmef_change = -0.05 }
		set_temp_variable = { temp_pfegf_change = -0.1 }
		set_temp_variable = { temp_icf_change = -0.05 }
		set_temp_variable = { temp_icd_change = -0.05 }
		set_temp_variable = { temp_m_change = 5 }
	}
	add_to_variable = { HIP_MAGIC_production_factory_max_efficiency_factor = temp_pfmef_change }
	add_to_variable = { HIP_MAGIC_production_factory_efficiency_gain_factor = temp_pfegf_change }
	add_to_variable = { HIP_MAGIC_industrial_capacity_factory = temp_icf_change }
	add_to_variable = { HIP_MAGIC_industrial_capacity_dockyard = temp_icd_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 1
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_production_decrease_CET1
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 2
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_production_decrease_CET2
	}
	else = {
		custom_effect_tooltip = HIP_SIR_MAGIC_production_decrease_CET3
	}
	subtract_from_variable = { HIP_SIR_MAGIC_production_level = 1 }
}
HIP_SIR_MAGIC_production_up = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 0
			}
		}
		set_temp_variable = { temp_pfmef_change = 0.15 }
		set_temp_variable = { temp_m_change = -1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 1
			}
		}
		set_temp_variable = { temp_pfmef_change = 0.05 }
		set_temp_variable = { temp_pfegf_change = 0.05 }
		set_temp_variable = { temp_m_change = -1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 2
			}
		}
		set_temp_variable = { temp_pfmef_change = 0.05 }
		set_temp_variable = { temp_pfegf_change = 0.05 }
		set_temp_variable = { temp_icf_change = 0.05 }
		set_temp_variable = { temp_icd_change = 0.05 }
		set_temp_variable = { temp_m_change = -4 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 3
			}
		}
		set_temp_variable = { temp_pfmef_change = 0.05 }
		set_temp_variable = { temp_pfegf_change = 0.1 }
		set_temp_variable = { temp_icf_change = 0.05 }
		set_temp_variable = { temp_icd_change = 0.05 }
		set_temp_variable = { temp_m_change = -5 }
	}
	add_to_variable = { HIP_MAGIC_production_factory_max_efficiency_factor = temp_pfmef_change }
	add_to_variable = { HIP_MAGIC_production_factory_efficiency_gain_factor = temp_pfegf_change }
	add_to_variable = { HIP_MAGIC_industrial_capacity_factory = temp_icf_change }
	add_to_variable = { HIP_MAGIC_industrial_capacity_dockyard = temp_icd_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 0
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_production_increase_CET1
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_production_level = 1
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_production_increase_CET2
	}
	else = {
		custom_effect_tooltip = HIP_SIR_MAGIC_production_increase_CET3
	}
	add_to_variable = { HIP_SIR_MAGIC_production_level = 1 }
}
HIP_SIR_MAGIC_professionalism_down = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 1
			}
		}
		set_temp_variable = { temp_aof_change = -0.15 }
		set_temp_variable = { temp_aaf_change = -0.05 }
		set_temp_variable = { temp_adf_change = -0.05 }
		set_temp_variable = { temp_m_change = 1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 2
			}
		}
		set_temp_variable = { temp_aof_change = -0.05 }
		set_temp_variable = { temp_amf_change = -0.05 }
		set_temp_variable = { temp_m_change = 3 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 3
			}
		}
		set_temp_variable = { temp_aof_change = -0.05 }
		set_temp_variable = { temp_aaf_change = -0.05 }
		set_temp_variable = { temp_adf_change = -0.05 }
		set_temp_variable = { temp_m_change = 7 }
	}
	add_to_variable = { HIP_MAGIC_army_org_factor = temp_aof_change }
	add_to_variable = { HIP_MAGIC_army_morale_factor = temp_amf_change }
	add_to_variable = { HIP_MAGIC_army_attack_factor = temp_aaf_change }
	add_to_variable = { HIP_MAGIC_army_defence_factor = temp_adf_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 2
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_professionalism_decrease_CET1
	}
	else = {
		custom_effect_tooltip = HIP_SIR_MAGIC_professionalism_decrease_CET2
	}
	subtract_from_variable = { HIP_SIR_MAGIC_professionalism_level = 1 }
}
HIP_SIR_MAGIC_professionalism_up = {
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 0
			}
		}
		set_temp_variable = { temp_aof_change = 0.15 }
		set_temp_variable = { temp_aaf_change = 0.05 }
		set_temp_variable = { temp_adf_change = 0.05 }
		set_temp_variable = { temp_m_change = -1 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 1
			}
		}
		set_temp_variable = { temp_aof_change = 0.05 }
		set_temp_variable = { temp_amf_change = 0.05 }
		set_temp_variable = { temp_m_change = -3 }
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 2
			}
		}
		set_temp_variable = { temp_aof_change = 0.05 }
		set_temp_variable = { temp_aaf_change = 0.05 }
		set_temp_variable = { temp_adf_change = 0.05 }
		set_temp_variable = { temp_m_change = -7 }
	}
	add_to_variable = { HIP_MAGIC_army_org_factor = temp_aof_change }
	add_to_variable = { HIP_MAGIC_army_morale_factor = temp_amf_change }
	add_to_variable = { HIP_MAGIC_army_attack_factor = temp_aaf_change }
	add_to_variable = { HIP_MAGIC_army_defence_factor = temp_adf_change }
	add_to_variable = { HIP_MAGIC_magic_drift = temp_m_change }
	if = {
		limit = {
			check_variable = {
				HIP_SIR_MAGIC_professionalism_level = 1
			}
		}
		custom_effect_tooltip = HIP_SIR_MAGIC_professionalism_increase_CET1
	}
	else = {
		custom_effect_tooltip = HIP_SIR_MAGIC_professionalism_increase_CET2
	}
	add_to_variable = { HIP_SIR_MAGIC_professionalism_level = 1 }
}
HIP_SIR_zumidia_wargoal_effect = {
	set_temp_variable = { HIP_SIR_zumidia_stability_loss = 0 }
	if = {
		limit = {
			NOT = {
				has_completed_focus = HIP_SIR_last_minute_preparations
			}
		}
		add_to_temp_variable = { HIP_SIR_zumidia_stability_loss = 1 }
	}
	if = {
		limit = {
			NOT = {
				has_completed_focus = HIP_SIR_break_them_apart
			}
		}
		add_to_temp_variable = { HIP_SIR_zumidia_stability_loss = 1 }
	}
	if = {
		limit = {
			NOT = {
				has_completed_focus = HIP_SIR_a_shattered_crown
			}
		}
		add_to_temp_variable = { HIP_SIR_zumidia_stability_loss = 1 }
	}
	if = {
		limit = {
			NOT = {
				has_completed_focus = HIP_SIR_our_time_is_now
			}
		}
		add_to_temp_variable = { HIP_SIR_zumidia_stability_loss = 1 }
	}
	if = {
		limit = {
			check_variable = {
				HIP_SIR_zumidia_stability_loss = 1
			}
		}
		add_stability = -0.05
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_zumidia_stability_loss = 2
			}
		}
		add_stability = -0.1
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_zumidia_stability_loss = 3
			}
		}
		add_stability = -0.15
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_SIR_zumidia_stability_loss = 4
			}
		}
		add_stability = -0.2
	}
}
HIP_SIR_integrate_colthage = {
	set_temp_variable = { HIP_SIR_CGI_compliance_gain = 0 }
	set_temp_variable = { HIP_SIR_CGI_resistance_loss = 0 }
	if = {
		limit = {
			check_variable = { HIP_SIR_colthage_authority_level = 5 }
		}
		every_state = {
			limit = {
				OR = {
					is_core_of = CTH
					is_core_of = TRO
					is_core_of = HIE
					is_core_of = CVA
					is_core_of = CDR
				}
			}
			add_core_of = HIP
		}
		add_to_temp_variable = { HIP_SIR_CGI_compliance_gain = 40 }
		subtract_from_temp_variable = { HIP_SIR_CGI_resistance_loss = 10 }
	}
	else_if = {
		limit = {
			check_variable = { HIP_SIR_colthage_authority_level > 2	}
		}
		set_country_flag = HIP_SIR_colthage_cores_unlocked
		custom_effect_tooltip = HIP_SIR_can_core_colthage_tt
		add_to_temp_variable = { HIP_SIR_CGI_compliance_gain = 25 }
		subtract_from_temp_variable = { HIP_SIR_CGI_resistance_loss = 5 }
	}
	if = {
		limit = {
			check_variable = { HIP_SIR_colthage_scientifid_level = 3 }
		}
		add_ideas = HIP_SIR_scientifid_integration
		add_to_temp_variable = { HIP_SIR_CGI_compliance_gain = 10 }
	}
	if = {
		limit = {
			check_variable = { HIP_SIR_colthage_landowners_level = 5 }
		}
		add_ideas = HIP_SIR_landowner_dominance
		add_to_temp_variable = { HIP_SIR_CGI_compliance_gain = 20 }
		subtract_from_temp_variable = { HIP_SIR_CGI_resistance_loss = 20 }
	}
	else_if = {
		limit = {
			check_variable = { HIP_SIR_colthage_landowners_level > 2 }
		}
		add_ideas = HIP_SIR_landowner_integration
		add_to_temp_variable = { HIP_SIR_CGI_compliance_gain = 10 }
		subtract_from_temp_variable = { HIP_SIR_CGI_resistance_loss = 10 }
	}
	if = {
		limit = {
			check_variable = { HIP_SIR_colthage_warlords_level = 5 }
		}
		add_ideas = HIP_SIR_colthaginian_chaos_2
		if = {
			limit = {
				is_ai = yes
			}
			add_to_variable = { HIP_MAGIC_consumer_goods_factor = -0.025 }
			add_to_variable = { HIP_MAGIC_production_speed_buildings_factor = 0.05 }
			add_to_variable = { HIP_MAGIC_conscription = 0.025 }
			add_to_variable = { HIP_MAGIC_recruitable_seapony_pop = 0.025 }
			add_to_variable = { HIP_MAGIC_production_factory_max_efficiency_factor = 0.025 }
			add_to_variable = { HIP_MAGIC_production_factory_efficiency_gain_factor = 0.025 }
			add_to_variable = { HIP_MAGIC_industrial_capacity_factory = 0.0125 }
			add_to_variable = { HIP_MAGIC_industrial_capacity_dockyard = 0.0125 }
			add_to_variable = { HIP_MAGIC_army_org_factor = 0.025 }
			add_to_variable = { HIP_MAGIC_army_morale_factor = 0.0125 }
			add_to_variable = { HIP_MAGIC_army_attack_factor = 0.0125 }
			add_to_variable = { HIP_MAGIC_army_defence_factor = 0.0125 }
			add_to_variable = { HIP_MAGIC_magic_drift = -5 }
		}
		add_to_temp_variable = { HIP_SIR_CGI_compliance_gain = 15 }
		subtract_from_temp_variable = { HIP_SIR_CGI_resistance_loss = 5 }
	}
	else_if = {
		limit = {
			check_variable = { HIP_SIR_colthage_warlords_level > 2 }
		}
		add_ideas = HIP_SIR_colthaginian_chaos_1
		if = {
			limit = {
				is_ai = yes
			}
			add_to_variable = { HIP_MAGIC_consumer_goods_factor = -0.015 }
			add_to_variable = { HIP_MAGIC_production_speed_buildings_factor = 0.03 }
			add_to_variable = { HIP_MAGIC_conscription = 0.015 }
			add_to_variable = { HIP_MAGIC_recruitable_seapony_pop = 0.015 }
			add_to_variable = { HIP_MAGIC_production_factory_max_efficiency_factor = 0.015 }
			add_to_variable = { HIP_MAGIC_production_factory_efficiency_gain_factor = 0.015 }
			add_to_variable = { HIP_MAGIC_industrial_capacity_factory = 0.0075 }
			add_to_variable = { HIP_MAGIC_industrial_capacity_dockyard = 0.0075 }
			add_to_variable = { HIP_MAGIC_army_org_factor = 0.015 }
			add_to_variable = { HIP_MAGIC_army_morale_factor = 0.0075 }
			add_to_variable = { HIP_MAGIC_army_attack_factor = 0.0075 }
			add_to_variable = { HIP_MAGIC_army_defence_factor = 0.0075 }
			add_to_variable = { HIP_MAGIC_magic_drift = -3 }
		}
		add_to_temp_variable = { HIP_SIR_CGI_compliance_gain = 10 }
	}
	every_state = {
		limit = {
			is_core_of = CGI
			is_core_of = BKH
		}
		add_compliance = HIP_SIR_CGI_compliance_gain
		add_resistance = HIP_SIR_CGI_resistance_loss
	}
}


HIP_underwater_conscription_var_display = {
	set_variable = { HIP_seapony_population_displayed = HIP_seapony_population }
	subtract_from_variable = { HIP_seapony_population_displayed = HIP_deducted_casualties}
	round_variable = HIP_seapony_population_displayed
	divide_variable = { HIP_seapony_population_displayed = 1000 }

	set_variable = { HIP_deducted_casualties_displayed = HIP_deducted_casualties}
	multiply_variable = { HIP_deducted_casualties_displayed = 1000 }
	round_variable = HIP_deducted_casualties_displayed

	set_variable = { HIP_conscription_target_displayed = HIP_conscription_target }
	multiply_variable = { HIP_conscription_target_displayed = 100 }
	set_variable = { HIP_conscription_rate_displayed = HIP_conscription_rate }
	multiply_variable = { HIP_conscription_rate_displayed = 1000 }
	set_variable = { HIP_var_seapony_recruitable_pop_modif_displayed = HIP_var_seapony_recruitable_pop_displayed }
	multiply_variable = { HIP_var_seapony_recruitable_pop_modif_displayed = 100 }
	set_variable = { HIP_var_seapony_recruitable_pop_factor_modif_displayed = HIP_var_seapony_recruitable_pop_factor_modif }
	multiply_variable = { HIP_var_seapony_recruitable_pop_factor_modif_displayed = 100 }
	set_variable = { HIP_seapony_ratio_displayed = HIP_seapony_ratio}
	multiply_variable = { HIP_seapony_ratio_displayed = 100 }
}
HIP_underwater_population_increase = {
	set_temp_variable = { HIP_seapony_population_temp = HIP_seapony_population}
	divide_temp_variable = { HIP_seapony_population_temp = 1000 }
	multiply_temp_variable = { HIP_seapony_population_temp = 1.25 }
	add_to_variable = { HIP_seapony_population = HIP_seapony_population_temp }
}

HIP_underwater_conscription_target_calculation = {
	if = { limit = { has_idea = disarmed_nation } set_variable = { HIP_var_seapony_recruitable_pop = 0.01 } }
	else_if = { limit = { has_idea = volunteer_only } set_variable = { HIP_var_seapony_recruitable_pop = 0.015 } }
	else_if = { limit = { has_idea = limited_conscription } set_variable = { HIP_var_seapony_recruitable_pop = 0.025 } }
	else_if = { limit = { has_idea = extensive_conscription } set_variable = { HIP_var_seapony_recruitable_pop = 0.05 } }
	else_if = { limit = { has_idea = service_by_requirement } set_variable = { HIP_var_seapony_recruitable_pop = 0.1 } }
	else_if = { limit = { has_idea = all_adults_serve } set_variable = { HIP_var_seapony_recruitable_pop = 0.2 } }
	else_if = { limit = { has_idea = scraping_the_barrel } set_variable = { HIP_var_seapony_recruitable_pop = 0.25 } }

	else_if = { limit = { has_idea = HIP_siren_conscription } set_variable = { HIP_var_seapony_recruitable_pop = 0.025 } }
	else_if = { limit = { has_idea = HIP_switzerland_conscription } set_variable = { HIP_var_seapony_recruitable_pop = 0.1 } }
	else_if = { limit = { has_idea = HIP_volunteer_only_2 } set_variable = { HIP_var_seapony_recruitable_pop = 0.04 } }
	else = { set_variable = { HIP_var_seapony_recruitable_pop = 0.05 } }

	set_variable = { HIP_var_seapony_recruitable_pop_modif = modifier@HIP_recruitable_seapony_pop }
	set_variable = { HIP_var_seapony_recruitable_pop_factor_modif = modifier@HIP_recruitable_seapony_pop_factor }


	add_to_variable = { HIP_var_seapony_recruitable_pop = HIP_var_seapony_recruitable_pop_modif }
	set_variable = { HIP_var_seapony_recruitable_pop_displayed = HIP_var_seapony_recruitable_pop }
	set_temp_variable = { HIP_base_factor = 1 }
	add_to_temp_variable = { HIP_base_factor = HIP_var_seapony_recruitable_pop_factor_modif }
	multiply_variable = { HIP_var_seapony_recruitable_pop = HIP_base_factor }
	set_variable = { HIP_conscription_target = HIP_var_seapony_recruitable_pop }
}

HIP_underwater_conscription_pool_calculation = {
	set_variable = { HIP_conscription_pool = HIP_seapony_population }
	multiply_variable = { HIP_conscription_pool = HIP_conscription_target }
	round_variable = HIP_conscription_pool #--Value in thousands



	set_variable = { HIP_deducted_casualties = casualties_k }
	multiply_variable = { HIP_deducted_casualties = HIP_seapony_ratio }
	round_variable = HIP_deducted_casualties


	set_variable = { HIP_conscription_rate = HIP_conscription_pool }
	multiply_variable = { HIP_conscription_rate = HIP_conscription_mobilization_speed }
	round_variable = HIP_conscription_rate #--Value in thousands
}

HIP_underwater_conscription_setup = {
	set_variable = { HIP_seapony_population = 7014.94 } #In Thousands
	set_variable = { HIP_conscription_base = 0.015 }
	set_variable = { HIP_conscription_multiplier = 1 }
	set_variable = { HIP_conscription_target = 0.015 }

	set_variable = { HIP_conscription_mobilization_speed = 0.05 }

	set_temp_variable = { HIP_total_population = max_manpower_k }
	add_to_temp_variable = { HIP_total_population = HIP_seapony_population }
	set_variable = { HIP_seapony_ratio = HIP_seapony_population }
	divide_variable = { HIP_seapony_ratio = HIP_total_population }


	HIP_underwater_conscription_target_calculation = yes
	HIP_underwater_conscription_pool_calculation = yes



	set_variable = { HIP_conscription_conscripted_seaponies = 84 } #In Thousands
	add_manpower = 84000

	HIP_underwater_conscription_var_display = yes
}
HIP_underwater_conscription_weekly = {
	HIP_underwater_conscription_target_calculation = yes
	HIP_underwater_conscription_pool_calculation = yes

	clr_country_flag = HIP_seapony_trying_to_demobilize
	clr_country_flag = HIP_seapony_demobilizing
	clr_country_flag = HIP_seapony_mobilizing

	if = {
		limit = {
			check_variable = {
				HIP_conscription_conscripted_seaponies < HIP_conscription_pool
			}
		}

		#Conscripting more

		set_temp_variable = {
			HIP_unconscripted_seaponies = HIP_conscription_pool
		}
		subtract_from_temp_variable = {
			HIP_unconscripted_seaponies = HIP_conscription_conscripted_seaponies
		}
		if = {
			limit = {
				check_variable = {
					var = HIP_unconscripted_seaponies
					value = HIP_conscription_rate
					compare = less_than_or_equals
				}
			}
			set_variable = { HIP_conscription_conscripted_seaponies = HIP_conscription_pool }
			set_temp_variable = { HIP_var_added_manpower = HIP_unconscripted_seaponies }
			multiply_temp_variable = { HIP_var_added_manpower = 1000 }
			add_manpower = var:HIP_var_added_manpower
		}
		else = {
			add_to_variable = { HIP_conscription_conscripted_seaponies = HIP_conscription_rate }
			set_temp_variable = { HIP_var_added_manpower = HIP_conscription_rate }
			multiply_temp_variable = { HIP_var_added_manpower = 1000 }
			add_manpower = var:HIP_var_added_manpower
			set_country_flag = HIP_seapony_mobilizing
		}
	}
	else_if = {
		limit = {
			check_variable = {
				HIP_conscription_conscripted_seaponies > HIP_conscription_pool
			}
		}
		#Demobilization

		if = {
			limit = {
				check_variable = { max_available_manpower_k = 0 }
			}
			set_country_flag = HIP_seapony_trying_to_demobilize
		}
		else = {
			if = {
				limit = {
					check_variable = { HIP_conscription_conscripted_seaponies > HIP_deducted_casualties }
				}
				if = {
					limit = {
						check_variable = { HIP_deducted_casualties < HIP_conscription_pool }
					}
					set_variable = { HIP_demob_target = HIP_conscription_pool}
				}
				else = {
					set_variable = { HIP_demob_target = HIP_deducted_casualties}
				}

				set_variable = { HIP_seaponies_demobilizing = HIP_conscription_conscripted_seaponies }
				subtract_from_variable = { HIP_seaponies_demobilizing = HIP_demob_target }

				if = {
					limit = {
						check_variable = { HIP_seaponies_demobilizing < HIP_conscription_rate }
					}
					set_variable = { HIP_conscription_conscripted_seaponies = HIP_demob_target }
					set_temp_variable = { HIP_removed_mp = HIP_seaponies_demobilizing }
					multiply_temp_variable = { HIP_removed_mp = -1000 }
					add_manpower = var:HIP_removed_mp
				}
				else = {
					subtract_from_variable = { HIP_conscription_conscripted_seaponies = HIP_conscription_rate }
					set_temp_variable = { HIP_removed_mp = HIP_conscription_rate }
					multiply_temp_variable = { HIP_removed_mp = -1000 }

					log = "[?HIP_conscription_rate]"
					add_manpower = var:HIP_removed_mp

					set_country_flag = HIP_seapony_demobilizing
				}
			}
		}
	}

	HIP_underwater_conscription_var_display = yes
}

HIP_underwater_conscription_disabled = {
	set_country_flag = HIP_underwater_conscription_weekly_disabled
}

HIP_underwater_conscription_enabled = {
	clr_country_flag = HIP_underwater_conscription_weekly_disabled
}

HIP_underwater_conscription_secession = {
	HIP_underwater_conscription_disabled = yes
	set_temp_variable = { HIP_conscription_conscripted_seaponies_temp = HIP_conscription_conscripted_seaponies }
	set_variable = { HIP_conscription_conscripted_seaponies = 0 }
	multiply_temp_variable = { HIP_conscription_conscripted_seaponies_temp = -1000}
	add_manpower = var:HIP_conscription_conscripted_seaponies_temp
	set_country_flag = HIP_seapony_conscription_disabled
}

HIP_seapony_migration = {
	if = {
		limit = {
			has_country_flag = HIP_seapony_migration_enabled
		}
		if = {
			limit = {
				has_country_flag = HIP_forced_resettlement
			}
			set_variable = { HIP_seapony_migration = 10 }
		}
		else = {
			set_variable = { HIP_seapony_migration = 5 }
		}
		subtract_from_variable = { HIP_seapony_population = HIP_seapony_migration}
		multiply_variable = { HIP_seapony_migration = 1000 }
		random_owned_controlled_state = {
			limit = {	
				is_core_of = HIP
				OR = {
					state = 695
					state = 696
					state = 683
					state = 684
					state = 685
					state = 686
					state = 1202
					state = 1203
					state = 1204
					state = 1164
					state = 1165
				}
			}
			add_manpower = var:HIP.HIP_seapony_migration
		}
	}
}