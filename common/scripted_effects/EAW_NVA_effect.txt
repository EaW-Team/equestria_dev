NVA_initialize_occupation_gui = {
	set_variable = { NVA_lankir_occupation_progress = 40 }
	set_variable = { NVA_lankir_pacification_progress = 20 }
	NVA_update_occupation_gui = yes
}

NVA_update_occupation_gui = {
	set_variable = { NVA_sword_x = NVA_lankir_occupation_progress }
	multiply_variable = { NVA_sword_x = 3.27 }
	subtract_from_variable = { NVA_sword_x = 7 }

	set_variable = { NVA_icon_x = NVA_lankir_pacification_progress }
	multiply_variable = { NVA_icon_x = 3.17 }
	subtract_from_variable = { NVA_icon_x = 14 }

	add_to_variable = { NVA_occupation_dirty = 0.01 }
}

### Temp variable: temp_occupation
# Can be either negative or positive
# Tooltip automatically generated
NVA_change_NVA_lankir_occupation = {
	add_to_variable = { NVA_lankir_occupation_progress = temp_occupation }
	clamp_variable = {
		var = NVA_lankir_occupation_progress
		min = 0
		max = 100
	}
	custom_effect_tooltip = NVA_change_NVA_lankir_occupation_tt
	NVA_update_occupation_gui = yes

	if = {
		limit = {
			check_variable = {
				NVA_lankir_occupation_progress > 99.9
			}
		}
		set_country_flag = NVA_lankir_occupation_finished
		remove_mission = NVA_lankir_occupation_timer

		if = {
			limit = {
				check_variable = {
					NVA_lankir_pacification_progress > 99.9
				}
			}
			country_event = senkinh_misc.11
		}
		else_if = {
			limit = {
				check_variable = {
					NVA_lankir_pacification_progress > 89.9
				}
			}
			country_event = senkinh_misc.12
		}
		else_if = {
			limit = {
				check_variable = {
					NVA_lankir_pacification_progress > 59.9
				}
			}
			country_event = senkinh_misc.13
		}
		else_if = {
			limit = {
				check_variable = {
					NVA_lankir_pacification_progress > 29.9
				}
			}
			country_event = senkinh_misc.14
		}
		else = {
			country_event = senkinh_misc.15
		}
	}
}

debug_NVA_change_NVA_lankir_occupation = {
	set_temp_variable = { temp_occupation = args^0 }
	NVA_change_NVA_lankir_occupation = yes
}

### Temp variable: temp_pacification
# Can be either negative or positive
# Tooltip automatically generated
NVA_change_NVA_lankir_pacification = {
	add_to_variable = { NVA_lankir_pacification_progress = temp_pacification }
	clamp_variable = {
		var = NVA_lankir_pacification_progress
		min = 0
		max = 100
	}
	custom_effect_tooltip = NVA_change_NVA_lankir_pacification_tt
	NVA_update_occupation_gui = yes
}

debug_NVA_change_NVA_lankir_pacification = {
	set_temp_variable = { temp_pacification = args^0 }
	NVA_change_NVA_lankir_pacification = yes
}

NVA_release_lankir_occupation_effect = {
	custom_effect_tooltip = NVA_lankir_decisions_tt
	hidden_effect = {
		set_country_flag = NVA_lankir_occupation_started
		release_puppet = KXN
		KXN = {
			load_focus_tree = generic_zebra_focus
			set_cosmetic_tag = NVA_lankir_puppet
			kill_ideology_leader = neutrality
			set_politics = {
				ruling_party = neutrality
			}
			set_party_name = {
				ideology = neutrality
				name = KXN_administration_neutrality_party
				long_name = KXN_administration_neutrality_party_long
			}
			set_party_name = {
				ideology = democratic
				name = KXN_administration_democratic_party
				long_name = KXN_administration_democratic_party_long
			}
			add_country_leader_role = {
				character = KXN_chai_yik_wing
				promote_leader = yes
				country_leader = {
					desc = "NVA_chai_yik_wing_desc"
					expire = "1965.1.1"
					ideology = khakistocracy
					traits = { prince_of_terror }
				}
			}
		}
		1085 = {
			set_state_name = KXN_renjiang_name
			set_province_name = {
				id = 16573
				name = KXN_new_solstice_vp_name
			}
			set_province_name = {
				id = 4399
				name = KXN_new_razorgrain_vp_name
			}
		}
		1086 = {
			set_state_name = KXN_lan_tsao_name
			set_province_name = {
				id = 16579
				name = KXN_new_orchid_vp_name
			}
			set_province_name = {
				id = 16608
				name = KXN_new_arrowroot_vp_name
			}
			set_province_name = {
				id = 16639
				name = KXN_new_durum_vp_name
			}
		}
		activate_mission = NVA_lankir_occupation_timer
	}
}

NVA_reduce_king_incompetence_trait = {
	if = {
		limit = {
			has_character = NVA_rankin
		}
		NVA_rankin = {
			if ={
				limit = {
					has_trait = NVA_incompetent_king_1
				}
				swap_country_leader_traits = {
					ideology = oligarchism
					remove = NVA_incompetent_king_1
					add = NVA_incompetent_king_2
				}
			}
			else_if ={
				limit = {
					has_trait = NVA_incompetent_king_2
				}
				swap_country_leader_traits = {
					ideology = oligarchism
					remove = NVA_incompetent_king_2
					add = NVA_incompetent_king_3
				}
			}
			else = {
				remove_trait = {
					ideology = oligarchism
					trait = NVA_incompetent_king_3
				}
			}
		}
	}
}

NVA_set_dummy_array = {
	if = {
		limit = {
			NOT = {
				has_country_flag = NVA_dummy_array_initialized
			}
		}
		add_to_array = {
			dummy_array = 1
		}
		set_country_flag = NVA_dummy_array_initialized
	}
}