drop_JER_puppet_tag = {
	if = {
		limit = { 
			has_cosmetic_tag = JER_REPUBLIC_PUPPET
			is_subject = no
		}
		log = "[GetDateText]: [Root.GetName]: drop_JER_puppet_tag"
		drop_cosmetic_tag = yes
	}
}

#SRS/NTR tag remove if free
drop_NTR_SRS_puppet_FAT_FAW_tag = {
	log = "[GetDateText]: [Root.GetName]: drop_NTR_SRS_puppet_FAT_FAW_tag"
	if = {
		limit = {
			original_tag = SRS
		}
		drop_cosmetic_tag = yes
		promote_character = {
			character = SRS_dominik_kingston
			ideology = despotism
		}
		promote_character = {
			character = SRS_gilbert_lafayette
			ideology = fascism_ideology
		}
		promote_character = {
			character = SRS_gabriella_gentlewing
			ideology = socialism
		}
		promote_character = {
			character = SRS_skynavian_general_congress
			ideology = democratic_socialism
		}
		set_party_name = {
			ideology = democratic
			name = SRS_democratic_party
			long_name = SRS_democratic_party_long
		}
		set_party_name = {
			ideology = fascism
			name = SRS_fascism_party
			long_name = SRS_fascism_party_long
		}
		set_party_name = {
			ideology = communism
			name = SRS_communism_communal_league
			long_name = SRS_communism_communal_league
		}
		set_party_name = {
			ideology = neutrality
			name = SRS_neutrality_party
			long_name = SRS_neutrality_party
		}
	}
	else_if = {
		limit = {
			original_tag = NTR
		}
		drop_cosmetic_tag = yes
		promote_character = {
			character = NTR_chief_darius
			ideology = tribal_council
		}
		promote_character = {
			character = NTR_stormbringer
			ideology = kratokracy
		}
		promote_character = {
			character = NTR_princess_fiana_ii
			ideology = tribal_federation
		}
		promote_character = {
			character = NTR_gray_fox
			ideology = democratic_socialism
		}
		set_party_name = {
			ideology = democratic
			name = NTR_democratic_party
			long_name = NTR_democratic_party
		}
		set_party_name = {
			ideology = fascism
			name = NTR_fascism_party
			long_name = NTR_fascism_party
		}
		set_party_name = {
			ideology = communism
			name = NTR_communism_party
			long_name = NTR_communism_party_long
		}
		set_party_name = {
			ideology = neutrality
			name = NTR_neutrality_party
			long_name = NTR_neutrality_party
		}
	}
}

clr_demilitarized_flag = {
	if = {
		limit = {
			has_country_flag = demilitarized
			NOT = {
				has_autonomy_state = autonomy_demilitarized_puppet
				has_autonomy_state = autonomy_demilitarized_integrated_puppet
				has_autonomy_state = autonomy_demilitarized_colony
			}
		}
		log = "[GetDateText]: [Root.GetName]: clr_demilitarized_flag"
		clr_country_flag = demilitarized
	}
}

set_EQC_NLR_SOL_tag = {
	if = {
		limit = {
			OR = {
				AND = {
					overlord = {
						is_original_EQS = yes
						NOT = { has_completed_focus = eqs_new_equestrian_republic }
					}
				}
				has_country_flag = EQC_govt_in_exile
			}
		}
		set_cosmetic_tag = EQC_EQS
	}
	else_if = {
		limit = { has_focus_tree = eqc_sol_focus }
		set_cosmetic_tag = EQC_SOL
	}
	else_if = {
		limit = {
			has_country_flag = EQC_NLR_thestralia
			has_focus_tree = eqc_nlr_focus
		}
		set_cosmetic_tag = EQC_NLR_thestralia
	}
	else_if = {
		limit = {
			has_focus_tree = eqc_nlr_focus
		}
		set_cosmetic_tag = EQC_NLR
	}
}

drop_EQC_maresoc_cosmetic_tag = {
	if = {
		limit = {
			OR = {
				has_country_leader = { character = EQC_maresoc }
				has_country_leader = { character = EQC_big_sister }
			}
		}
		kill_ideology_leader = communism
	}
	if = {
		limit = {
			has_idea = EQC_MARE_poverty
		}
		swap_ideas = { 
			add_idea = no_poverty
			remove_idea = EQC_MARE_poverty
		}
	}
	clr_country_flag = is_maresoc
	load_focus_tree = new_mareland_focus
	if = {
		limit = { has_cosmetic_tag = EQC_maresoc }
		drop_cosmetic_tag = yes
	}
}

drop_EQC_equalist_tag = {
	clr_country_flag = equalist_eqc
	load_focus_tree = new_mareland_focus
	if = {
		limit = { has_cosmetic_tag = EQC_equalists }
		drop_cosmetic_tag = yes
	}
}

drop_GRI_and_set_seconday_tags_or_set_pvda = {
	if = {
		limit = { has_cosmetic_tag = FEA_PvdA_old_flag_GRI_Puppet }
		set_cosmetic_tag = FEA_PvdA_old_flag
	}
	else = {
		drop_cosmetic_tag = yes
		reapply_secondary_cosmetic_tags = yes
	}
}

set_GRD_cosmetic_feudal = {
	drop_cosmetic_tag = yes
	set_cosmetic_tag = GRIF_EMPIRE
	set_country_flag = { flag = holds_griffon_capital value = 1 }
}
set_GRD_cosmetics_not_feudal = {
	if = {
		limit = {
			has_cosmetic_tag = GRIF_AQUILIEA_REP
		}
		drop_cosmetic_tag = yes
		set_cosmetic_tag = GRIF_AQUILIEA_REP
	}
	else = {
		drop_cosmetic_tag = yes
		set_cosmetic_tag = GRIF_REPUBLIC
	}
	set_country_flag = { flag = holds_griffon_capital value = 2 }
}

set_GFF_NLR_cosmetic = {
	set_cosmetic_tag = GFF_NLR
	set_country_flag = is_luna_puppet
}

### on_action effects
handle_cosmetic_tag_change_weekly = {
	clr_demilitarized_flag = yes
	fire_GRD_cosmetic_handling = yes
	if = {
		limit = {
			is_GRD_and_feudal = yes
		}
		log = "[GetDateText]: [Root.GetName]: set_GRD_cosmetic_feudal"
		set_GRD_cosmetic_feudal =yes
	}
	else_if = {
		limit = {
			is_GRD_and_not_feudal = yes
		}
		log = "[GetDateText]: [Root.GetName]: set_GRD_cosmetics_not_feudal"
		set_GRD_cosmetics_not_feudal = yes
	}
	if = {
		limit = { 
			has_cosmetic_tag = JER_REPUBLIC_PUPPET
			is_subject = no
		}
		log = "[GetDateText]: [Root.GetName]: drop_JER_puppet_tag"
		drop_cosmetic_tag = yes
	}
	if = {
		limit = {
			OR = {
				original_tag = NTR
				original_tag = SRS
			}
			OR = {
				has_cosmetic_tag = FAT_NTR_puppet
				has_cosmetic_tag = FAW_NTR_puppet
				has_cosmetic_tag = SRS_FAT_puppet
				has_cosmetic_tag = SRS_FAW_puppet
			}
			NOT = {
				is_subject_of = FAT
				is_subject_of = FAW
			}
		}
		drop_NTR_SRS_puppet_FAT_FAW_tag = yes
	}
	if = {
		limit = {
			OR = {
				has_cosmetic_tag = BAT_puppet
				has_cosmetic_tag = CTH_BAT
				has_cosmetic_tag = HIP_BAT
				has_cosmetic_tag = CGI_BAT
			}
			NOT = {
				is_subject_of = BAT
			}
		}
		log = "[GetDateText]: [Root.GetName]: drop_BAT_puppet_tag"
		drop_cosmetic_tag = yes
		reapply_secondary_cosmetic_tags = yes
	}
	if = {
		limit = {
			OR = {
				has_cosmetic_tag = CVA_CTH_zoenician_puppet
				has_cosmetic_tag = CGI_CVA_CTH_zoenician_puppet
				has_cosmetic_tag = LMB_CVA_CTH_zoenician_puppet
				has_cosmetic_tag = MCW_CVA_CTH_zoenician_puppet
				has_cosmetic_tag = MIT_CVA_CTH_zoenician_puppet
				has_cosmetic_tag = CVA_CTH_zoenician_puppet_2
				has_cosmetic_tag = CDR_CVA_CTH_zoenician_puppet_2
			}
			is_subject = no
		}
		log = "[GetDateText]: [Root.GetName]: drop_zoenician_puppet_tag"
		drop_cosmetic_tag = yes
		reapply_secondary_cosmetic_tags = yes
	}
	if = {
		limit = {
			original_tag = EQC
		}
		if = {
			limit = {
				can_EQC_get_NLR_SOL_cosmetic = yes
			}
			log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_weekly1"
			set_EQC_NLR_SOL_tag = yes
		}
		if = {
			limit = {
				can_EQC_drop_NLR_SOL_EQS_cosmetic = yes
			}
			log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_weekly2"
			drop_cosmetic_tag = yes
		}
		if = {
			limit = {
				is_EQC_no_longer_maresoc = yes
			}
			log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_weekly3"
			drop_EQC_maresoc_cosmetic_tag = yes
		}
		if = {
			limit = {
				is_EQC_no_longer_equalist = yes			
			}
			log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_weekly4"
			drop_EQC_equalist_tag = yes
		}
	}
	if = {
		limit = {
			is_GFF_NLR_puppet = yes
		}
		log = "[GetDateText]: [Root.GetName]: set_GFF_NLR_cosmetic"
	}
}

handle_cosmetic_tag_change_on_puppet = {
	if = {
		limit = {
			original_tag = EQC
		}
		if = {
			limit = {
				FROM = {
					OR = {
						original_tag = EQS
						original_tag = NLR
					}
					can_EQC_get_NLR_SOL_cosmetic = yes
				}
			}
			log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_puppet1"
			set_EQC_NLR_SOL_tag = yes
		}
		else_if = {
			limit = { NOT = { has_focus_tree = new_mareland_focus } }
			load_focus_tree = new_mareland_focus
			if = {
				limit = {
					can_EQC_drop_NLR_SOL_EQS_cosmetic = yes
				}
				log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_puppet2"
				drop_cosmetic_tag = yes
			}
		}
		else_if = {
			limit = {
				is_EQC_no_longer_maresoc = yes
			}
			log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_puppet3"
			drop_EQC_maresoc_cosmetic_tag = yes
		}
		else_if = {
			limit = {
				is_EQC_no_longer_equalist = yes
			}
			log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_puppet4"
			drop_EQC_equalist_tag = yes
		}
		if = {
			limit = {
				has_idea = EQC_funding_the_resistiance
			}
			remove_ideas = EQC_funding_the_resistiance
			EQS = { remove_ideas = EQC_resistance }
			ELF = { remove_ideas = EQC_resistance }
		}
	}
}

handle_cosmetic_tag_change_on_free = {
	if = {
		limit = {
			original_tag = EQC
			OR = {
				has_cosmetic_tag = EQC_EQS
				has_cosmetic_tag = EQC_SOL
				has_cosmetic_tag = EQC_NLR
				has_cosmetic_tag = EQC_NLR_thestralia
			}
		}
		log = "[GetDateText]: [Root.GetName]: drop_EQC_tag_on_free"
		drop_cosmetic_tag = yes
	}
}

### directly fired effects
fire_EQC_tag_set_SOL_NLR_EQS = {
	if = {
		limit = {
			can_EQC_get_NLR_SOL_cosmetic = yes
		}
		log = "[GetDateText]: [Root.GetName]: fire_EQC_tag_set_SOL_NLR_EQS"
		set_EQC_NLR_SOL_tag = yes
	}
}

fire_EQC_tag_drop_SOL_NLR_EQS = {
	if = {
		limit = {
			can_EQC_drop_NLR_SOL_EQS_cosmetic = yes
		}
		log = "[GetDateText]: [Root.GetName]: fire_EQC_tag_drop_SOL_NLR_EQS"
		drop_cosmetic_tag = yes
	}
}

fire_GRD_cosmetic_handling = {
	if = {
		limit = { 
			has_GRI_subject_tag_and_GRD_is_not_GRI = yes
		}
		log = "[GetDateText]: [Root.GetName]: fire_GRD_cosmetic_application"
		drop_GRI_and_set_seconday_tags_or_set_pvda = yes
	}
}

fire_GFF_NLR_cosmetic_set = {
	if = {
		limit = {
			is_GFF_NLR_puppet = yes
		}
		log = "[GetDateText]: [Root.GetName]: fire_GFF_NLR_cosmetic_set"
		set_GFF_NLR_cosmetic = yes
	}
}