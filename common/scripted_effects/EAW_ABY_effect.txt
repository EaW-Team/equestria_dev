ABY_calm_slaves = {
	if = {
		limit = {
			has_idea = ABY_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_angry_slaves
			add_idea = ABY_somewhat_less_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_somewhat_less_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_somewhat_less_angry_slaves
			add_idea = ABY_way_less_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_way_less_angry_slaves
		}
		remove_ideas = ABY_way_less_angry_slaves
	}
	else_if = {
		limit = {
			has_idea = ABY_more_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_more_angry_slaves
			add_idea = ABY_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_even_more_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_even_more_angry_slaves
			add_idea = ABY_more_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_extremely_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_extremely_angry_slaves
			add_idea = ABY_even_more_angry_slaves
		}
	}
}
ABY_anger_slaves = {
	if = {
		limit = {
			has_idea = ABY_way_less_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_way_less_angry_slaves
			add_idea = ABY_somewhat_less_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_somewhat_less_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_somewhat_less_angry_slaves
			add_idea = ABY_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_angry_slaves
			add_idea = ABY_more_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_more_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_more_angry_slaves
			add_idea = ABY_even_more_angry_slaves
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_even_more_angry_slaves
		}
		swap_ideas = {
		    remove_idea = ABY_even_more_angry_slaves
			add_idea = ABY_extremely_angry_slaves
		}
	}
}
ABY_reduce_WNG_influence = {
	if = {
		limit = {
			has_idea = ABY_wingbardian_concessions
		}
		swap_ideas = {
			remove_idea = ABY_wingbardian_concessions
			add_idea = ABY_wingbardian_concessions_2
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_wingbardian_concessions_2
		}
		swap_ideas = {
			remove_idea = ABY_wingbardian_concessions_2
			add_idea = ABY_wingbardian_concessions_3
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_wingbardian_concessions_3
		}
		remove_ideas = ABY_wingbardian_concessions_3
	}
}
ABY_increase_WNG_influence = {
	if = {
		limit = {
			has_idea = ABY_wingbardian_concessions_2
		}
		swap_ideas = {
			remove_idea = ABY_wingbardian_concessions_2
			add_idea = ABY_wingbardian_concessions
		}
	}
	else_if = {
		limit = {
			has_idea = ABY_wingbardian_concessions_3
		}
		swap_ideas = {
			remove_idea = ABY_wingbardian_concessions_3
			add_idea = ABY_wingbardian_concessions_2
		}
	}
	else_if = {
		limit = {
			NOT = {
				has_idea = ABY_wingbardian_concessions
				has_idea = ABY_wingbardian_concessions_2
				has_idea = ABY_wingbardian_concessions_3
			}
		}
		add_ideas = ABY_wingbardian_concessions_3
	}
}

ABY_tardar_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_tardar_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 0 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_tardar_disloyal_tt
		set_variable = { ABY_noble_loyalties^0 = -1 }
		if = {
			limit = {
				owns_state = 777
			}
			777 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_tardar_loyal = {
	if = {
		limit = {
			NOT = {
				777 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 0 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_tardar_loyal_tt
		set_variable = { ABY_noble_loyalties^0 = 1 }
		if = {
			limit = {
				owns_state = 777
			}
			777 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_thurston_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_thurston_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 1 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_thurston_disloyal_tt
		set_variable = { ABY_noble_loyalties^1 = -1 }
		if = {
			limit = {
				owns_state = 776
			}
			776 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_thurston_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 1 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_thurston_loyal_tt
		set_variable = { ABY_noble_loyalties^1 = 1 }
		if = {
			limit = {
				owns_state = 776
			}
			776 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_duchess_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_duchess_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 2 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_duchess_disloyal_tt
		set_variable = { ABY_noble_loyalties^2 = -1 }
		if = {
			limit = {
				owns_state = 1200
			}
			1200 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
		if = {
			limit = {
				owns_state = 1201
			}
			1201 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_duchess_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 2 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_duchess_loyal_tt
		set_variable = { ABY_noble_loyalties^2 = 1 }
		if = {
			limit = {
				owns_state = 1200
			}
			1200 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
		if = {
			limit = {
				owns_state = 1201
			}
			1201 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_humbert_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_humbert_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 3 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_humbert_disloyal_tt
		set_variable = { ABY_noble_loyalties^3 = -1 }
		if = {
			limit = {
				owns_state = 785
			}
			785 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_humbert_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 3 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_humbert_loyal_tt
		set_variable = { ABY_noble_loyalties^3 = 1 }
		if = {
			limit = {
				owns_state = 785
			}
			785 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_nyanyanyanyanyanyanya_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_nyanyanyanyanyanyanya_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 4 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_nyanyanyanyanyanyanya_disloyal_tt
		set_variable = { ABY_noble_loyalties^4 = -1 }
		if = {
			limit = {
				owns_state = 771
			}
			771 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_nyanyanyanyanyanyanya_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 4 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_nyanyanyanyanyanyanya_loyal_tt
		set_variable = { ABY_noble_loyalties^4 = 1 }
		if = {
			limit = {
				owns_state = 771
			}
			771 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_salem_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_salem_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 5 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_salem_disloyal_tt
		set_variable = { ABY_noble_loyalties^5 = -1 }
		if = {
			limit = {
				owns_state = 772
			}
			772 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_salem_loyal = {
	if = {
		limit = {
			NOT = {
				772 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 5 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_salem_loyal_tt
		set_variable = { ABY_noble_loyalties^5 = 1 }
		if = {
			limit = {
				owns_state = 772
			}
			772 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_lucifer_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_lucifer_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 6 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_lucifer_disloyal_tt
		set_variable = { ABY_noble_loyalties^6 = -1 }
		if = {
			limit = {
				owns_state = 773
			}
			773 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_lucifer_loyal = {
	if = {
		limit = {
			NOT = {
				773 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 6 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_lucifer_loyal_tt
		set_variable = { ABY_noble_loyalties^6 = 1 }
		if = {
			limit = {
				owns_state = 773
			}
			773 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_cheshire_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_cheshire_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 8 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_cheshire_disloyal_tt
		set_variable = { ABY_noble_loyalties^8 = -1 }
		if = {
			limit = {
				owns_state = 778
			}
			778 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_cheshire_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 8 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_cheshire_loyal_tt
		set_variable = { ABY_noble_loyalties^8 = 1 }
		if = {
			limit = {
				owns_state = 778
			}
			778 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_sylvester_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_sylvester_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 10 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_sylvester_disloyal_tt
		set_variable = { ABY_noble_loyalties^10 = -1 }
		if = {
			limit = {
				owns_state = 780
			}
			780 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_sylvester_loyal = {
	if = {
		limit = {
			NOT = {
				780 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 10 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_sylvester_loyal_tt
		set_variable = { ABY_noble_loyalties^10 = 1 }
		if = {
			limit = {
				owns_state = 780
			}
			780 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_gumball_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_gumball_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 11 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_gumball_disloyal_tt
		set_variable = { ABY_noble_loyalties^11 = -1 }
		if = {
			limit = {
				owns_state = 782
			}
			782 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_gumball_loyal = {
	if = {
		limit = {
			NOT = {
				782 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 11 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_gumball_loyal_tt
		set_variable = { ABY_noble_loyalties^11 = 1 }
		if = {
			limit = {
				owns_state = 782
			}
			782 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_tom_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_tom_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 12 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_tom_disloyal_tt
		set_variable = { ABY_noble_loyalties^12 = -1 }
		if = {
			limit = {
				owns_state = 783
			}
			783 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_tom_loyal = {
	if = {
		limit = {
			NOT = {
				783 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 12 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_tom_loyal_tt
		set_variable = { ABY_noble_loyalties^12 = 1 }
		if = {
			limit = {
				owns_state = 783
			}
			783 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_timothy_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_timothy_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 7 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_timothy_disloyal_tt
		set_variable = { ABY_noble_loyalties^7 = -1 }
		if = {
			limit = {
				owns_state = 774
			}
			774 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_timothy_loyal = {
	if = {
		limit = {
			NOT = {
				774 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 7 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_timothy_loyal_tt
		set_variable = { ABY_noble_loyalties^7 = 1 }
		if = {
			limit = {
				owns_state = 774
			}
			774 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_cat_in_the_hat_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_cat_in_the_hat_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 9 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_cat_in_the_hat_disloyal_tt
		set_variable = { ABY_noble_loyalties^9 = -1 }
		if = {
			limit = {
				owns_state = 779
			}
			779 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_cat_in_the_hat_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 9 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_cat_in_the_hat_loyal_tt
		set_variable = { ABY_noble_loyalties^9 = 1 }
		if = {
			limit = {
				owns_state = 779
			}
			779 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_oatmeal_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 13 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_oatmeal_loyal_tt
		set_variable = { ABY_noble_loyalties^13 = 1 }
		if = {
			limit = {
				owns_state = 784
			}
			784 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_smudge_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_smudge_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 14 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_smudge_disloyal_tt
		set_variable = { ABY_noble_loyalties^14 = -1 }
		if = {
			limit = {
				owns_state = 786
			}
			786 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_smudge_loyal = {
	if = {
		limit = {
			NOT = {
				786 = {
					has_dynamic_modifier = {
						modifier = ABY_rebellious_local_noble
					}
				}
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 14 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_smudge_loyal_tt
		set_variable = { ABY_noble_loyalties^14 = 1 }
		if = {
			limit = {
				owns_state = 786
			}
			786 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_bingus_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_bingus_permaloyal
			}
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 15 }
				check_variable = { v = 1 }
			}
		}
		custom_effect_tooltip = ABY_bingus_disloyal_tt
		set_variable = { ABY_noble_loyalties^15 = -1 }
		if = {
			limit = {
				owns_state = 738
			}
			738 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
		if = {
			limit = {
				owns_state = 740
			}
			740 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
		if = {
			limit = {
				owns_state = 741
			}
			741 = {
				add_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}
ABY_bingus_loyal = {
	if = {
		limit = {
			any_of = {
				array = ABY_noble_loyalties
				value = v
				index = i
				check_variable = { i = 15 }
				check_variable = { v = -1 }
			}
		}
		custom_effect_tooltip = ABY_bingus_loyal_tt
		set_variable = { ABY_noble_loyalties^15 = 1 }
		if = {
			limit = {
				owns_state = 738
			}
			738 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
		if = {
			limit = {
				owns_state = 740
			}
			740 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
		if = {
			limit = {
				owns_state = 741
			}
			741 = {
				remove_dynamic_modifier = {
					modifier = ABY_disloyal_local_noble
				}
			}
		}
	}
}

ABY_update_number_of_loyal_disloyal = {
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_elections_disabled
			}
		}
		custom_effect_tooltip = ABY_disloyalty_majority_warning_tt
	}
	set_variable = {
		var = ABY_num_of_loyal
		value = 0
	}
	set_variable = {
		var = ABY_num_of_disloyal
		value = 0
	}
	for_each_loop = {
		array = ABY_noble_loyalties
		value = v
		index = i
		break = break
		if = {
			limit = {
				check_variable = { v = 1 }
			}
			if = {
				limit = {
					OR = {
						AND = {
							check_variable = { i = 0 }
							owns_state = 777
						}
						AND = {
							check_variable = { i = 1 }
							owns_state = 776
						}
						AND = {
							check_variable = { i = 2 }
							OR = {
								owns_state = 1200
								owns_state = 1201
							}
						}
						AND = {
							check_variable = { i = 3 }
							owns_state = 785
						}
						AND = {
							check_variable = { i = 4 }
							owns_state = 771
						}
						AND = {
							check_variable = { i = 5 }
							owns_state = 772
						}
						AND = {
							check_variable = { i = 6 }
							owns_state = 773
						}
						AND = {
							check_variable = { i = 7 }
							owns_state = 774
						}
						AND = {
							check_variable = { i = 8 }
							owns_state = 778
						}
						AND = {
							check_variable = { i = 9 }
							owns_state = 779
						}
						AND = {
							check_variable = { i = 10 }
							owns_state = 780
						}
						AND = {
							check_variable = { i = 11 }
							owns_state = 782
						}
						AND = {
							check_variable = { i = 12 }
							owns_state = 783
						}
						AND = {
							check_variable = { i = 13 }
							owns_state = 784
						}
						AND = {
							check_variable = { i = 14 }
							owns_state = 786
						}
						AND = {
							check_variable = { i = 15 }
							OR = {
								owns_state = 741
								owns_state = 738
								owns_state = 740
							}
						}
					}
				}
				add_to_variable = {
					var = ABY_num_of_loyal
					value = 1
				}
			}
		}
		else_if = {
			limit = {
				check_variable = { v = -1 }
			}
			if = {
				limit = {
					OR = {
						AND = {
							check_variable = { i = 0 }
							owns_state = 777
						}
						AND = {
							check_variable = { i = 1 }
							owns_state = 776
						}
						AND = {
							check_variable = { i = 2 }
							OR = {
								owns_state = 1200
								owns_state = 1201
							}
						}
						AND = {
							check_variable = { i = 3 }
							owns_state = 785
						}
						AND = {
							check_variable = { i = 4 }
							owns_state = 771
						}
						AND = {
							check_variable = { i = 5 }
							owns_state = 772
						}
						AND = {
							check_variable = { i = 6 }
							owns_state = 773
						}
						AND = {
							check_variable = { i = 7 }
							owns_state = 774
						}
						AND = {
							check_variable = { i = 8 }
							owns_state = 778
						}
						AND = {
							check_variable = { i = 9 }
							owns_state = 779
						}
						AND = {
							check_variable = { i = 10 }
							owns_state = 780
						}
						AND = {
							check_variable = { i = 11 }
							owns_state = 782
						}
						AND = {
							check_variable = { i = 12 }
							owns_state = 783
						}
						AND = {
							check_variable = { i = 13 }
							owns_state = 784
						}
						AND = {
							check_variable = { i = 14 }
							owns_state = 786
						}
						AND = {
							check_variable = { i = 15 }
							OR = {
								owns_state = 741
								owns_state = 738
								owns_state = 740
							}
						}
					}
				}
				add_to_variable = {
					var = ABY_num_of_disloyal
					value = 1
				}
			}
		}
	}
	if = {
		limit = {
			is_ai = no
			check_variable = { ABY_num_of_disloyal > ABY_num_of_loyal }
			OR = {
				has_government = neutrality
				has_government = democratic
			}
			NOT = {
				has_country_flag = ABY_elections_disabled
			}
		}
		hidden_effect = {
			activate_mission = ABY_nobles_elect_catrina
		}
	}
	else_if = {
		limit = {
			OR = {
				has_government = neutrality
				has_government = democratic
			}
			check_variable = { ABY_num_of_disloyal > ABY_num_of_loyal }
			has_country_flag = ABY_elections_disabled
		}
		add_stability = -0.05
	}
	else_if = {
		limit = {
			is_ai = no
			check_variable = { ABY_num_of_disloyal > ABY_num_of_loyal }
			has_government = fascism
			NOT = {
				has_country_flag = ABY_elections_disabled
			}
		}
		hidden_effect = {
			activate_mission = ABY_nobles_elect_clawomons
		}
	}
}

ABY_mental_stab_add_1 = {
	add_to_variable = {
		var = ABY_gomez_mental_stability
		value = 1
		tooltip = ABY_increase_mental_stab_1
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
	ABY_clear_alert = yes
}
ABY_mental_stab_add_5 = {
	add_to_variable = {
		var = ABY_gomez_mental_stability
		value = 5
		tooltip = ABY_increase_mental_stab_5
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
	ABY_clear_alert = yes
}
ABY_mental_stab_add_10 = {
	add_to_variable = {
		var = ABY_gomez_mental_stability
		value = 10
		tooltip = ABY_increase_mental_stab_10
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
	ABY_clear_alert = yes
}
ABY_mental_stab_add_15 = {
	add_to_variable = {
		var = ABY_gomez_mental_stability
		value = 15
		tooltip = ABY_increase_mental_stab_15
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
	ABY_clear_alert = yes
}
ABY_clear_alert = {
	if = {
		limit = {
			OR = {
				check_variable = { ABY_gomez_mental_stability > 5 }
				NOT = {
					has_country_flag = ABY_mental_stab_enabled
				}
			}
		}
		set_temp_variable = { alert_id = token:eaw_alert_ABY_mental_health }
		remove_eaw_alert = yes
	}
}
ABY_alert_raise_1 = {
	set_temp_variable = { alert_id = token:eaw_alert_ABY_mental_health }
	set_temp_variable = { alert_color = 2 }
	add_eaw_alert_unless_exists = yes
}
ABY_mental_stab_reduce_1 = {
	subtract_from_variable = {
		var = ABY_gomez_mental_stability
		value = 1
		tooltip = ABY_reduce_mental_stab_1
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
}
ABY_mental_stab_reduce_5 = {
	subtract_from_variable = {
		var = ABY_gomez_mental_stability
		value = 5
		tooltip = ABY_reduce_mental_stab_5
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
}
ABY_mental_stab_reduce_10 = {
	subtract_from_variable = {
		var = ABY_gomez_mental_stability
		value = 10
		tooltip = ABY_reduce_mental_stab_10
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
}
ABY_mental_stab_reduce_25 = {
	subtract_from_variable = {
		var = ABY_gomez_mental_stability
		value = 25
		tooltip = ABY_reduce_mental_stab_25
	}
	clamp_variable = {
		var = ABY_gomez_mental_stability
		min = 0
		max = 100
	}
}
ABY_witchweed_recalculate_production = {
	round_variable = ABY_catrina_slaves
	if = {
		limit = {
			check_variable = { ABY_catrina_slaves > ABY_catrina_slaves_cap }
		}
		set_variable = {
			ABY_catrina_slaves = ABY_catrina_slaves_cap
		}
	}
	set_temp_variable = { ABY_temp_var = ABY_catrina_slaves }
	multiply_temp_variable = {
		ABY_temp_var = ABY_machine_efficiency
	}
	set_variable = {
		ABY_slaves_multiplied_by_efficiency = ABY_temp_var
	}
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_slave_event_triggered
			}
			check_variable = { ABY_catrina_slaves > 1999 }
		}
		hidden_effect = {
			country_event = { id = abyssinia.137 days = 15 }
		}
	}
	if = {
		limit = {
			NOT = {
				has_country_flag = ABY_slave_event_2_triggered
				has_country_flag = ABY_final_battle
			}
			check_variable = { ABY_catrina_slaves > 7499 }
		}
		hidden_effect = {
			country_event = { id = abyssinia.139 days = 15 }
		}
	}
}
#Behold, the spaghetti monster code, gaze upon my works and despair
#Why is this so convoluted? All it does is give random 10% bonuses on states. Because I thought it'd be cool and fun to make. And I was right. B)
#and no i dont care if theres a more efficient way to do this, its unimportant so it doesnt matter if its shit
#PARADOX WHERE ARE MY MATRICES

# Your savior is here (too late tho D:)
ABY_debug_color_provinces = {
	for_each_loop = {
		array = ABY.ABY_prov_list
		value = x

		random_country = {
			for_each_loop = {
				array = ABY.ABY_prov_@var:x
				value = y
				
				var:y = {
					transfer_state_to = PREV
				}
			}
		}
	}
}

ABY_provincial_elections = {
	hidden_effect = {
		if = {
			limit = {
				has_country_flag = ABY_urf_split
			}
			set_temp_variable = { comm_pop = party_popularity_100@communism }
			divide_temp_variable = { comm_pop = 4 }
			set_temp_variable = { asp_pop = comm_pop }
			set_temp_variable = { alf_pop = comm_pop }
			multiply_temp_variable = { alf_pop = 3 }
			set_temp_variable = { pla_pop = party_popularity_100@democratic }
			set_temp_variable = { apf_pop = party_popularity_100@neutrality }
			add_to_temp_variable = { apf_pop = party_popularity_100@fascism }
			set_temp_variable = { asp_chance_urb = 15 }
			add_to_temp_variable = { asp_chance_urb = asp_pop }
			set_temp_variable = { alf_chance_urb = 10 }
			add_to_temp_variable = { alf_chance_urb = alf_pop }
			set_temp_variable = { pla_chance_urb = 5 }
			add_to_temp_variable = { pla_chance_urb = pla_pop }
			set_temp_variable = { apf_chance_rural = 15 }
			add_to_temp_variable = { apf_chance_rural = apf_pop }
			if = {
				limit = {
					has_country_flag = ABY_big_provinces
				}
				#Big provinces:
					#1. 775, 777, 785, 776, 786 urban
					#2. 773, 772, 771, 778, 774, (1208) rural
					#3. 779, 780, 1201, (1200), 782, 783, (784) rural
					#4. 741, 740, 738 urban
					#5. 737, 734, 733, 731, 732, 736, 735 urban
					#6. 760, 761, 759, 758 rural
					#7. 766, 770, 763 rural
					#8. 792, 801, 790, 795, 799 urban
					#9. 807, 808, 810, 812, 828, 827 rural
					#10. 788, 789, 955, 954, 956, 958, 957 urban
					
				#Province 1 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				
				#Province 2 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 3 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 4 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 5 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 6 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 7 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 8 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 9 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 10 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
			}
			else_if = {
				limit = {
					has_country_flag = ABY_medium_provinces
				}
				#Medium provinces:
					#1. 775, 785 urban
					#2. 776, 786 urban
					#3. 772, 773, 771, (1208) rural
					#4. 777, 779, 780 rural
					#5. 778, 774, 782 rural
					#6. 783, 1201, (1200), (784) rural
					#7. 741, 740, 738 urban
					#8. 737, 734 urban
					#9. 733, 732, 731 urban
					#10. 736, 735 urban
					#11. 759, 758 rural
					#12. 760, 761 rural
					#13. 766, 770, 763 rural
					#14. 792, 801, 790 urban
					#15. 795, 799 urban
					#16. 807, 810, 808 urban
					#17. 827, 828, 812 rural
					#18. 788, 789, 955 rural
					#19. 954, 956 urban
					#20. 957, 958 urban
					
				#Province 1 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 2 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 3 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 4 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 5 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 6 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 7 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 8 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 9 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 10 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 11 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_11
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_11
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_11
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_11
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 12 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_12
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_12
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_12
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_12
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 13 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_13
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_13
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_13
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_13
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 14 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_14
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_14
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_14
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_14
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 15 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_15
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_15
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_15
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_15
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 16 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_16
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_16
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_16
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_16
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 17 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_17
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_17
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_17
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_17
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 18 rural
				random_list = {
					asp_pop = {
						for_each_scope_loop = {
							array = ABY_prov_18
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_18
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_pop = {
						for_each_scope_loop = {
							array = ABY_prov_18
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_18
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 19 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_19
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_19
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_19
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_19
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 20 urban
				random_list = {
					asp_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_20
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
						}
					}
					alf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_20
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
						}
					}
					pla_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_20
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_20
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
			}
			else_if = {
				limit = {
					has_country_flag = ABY_every_state_a_province
				}
				every_owned_state = {
					limit = {
						is_core_of = ROOT
					}
					if = {
						limit = {
							OR = {
								has_state_category = megalopolis
								has_state_category = metropolis
								has_state_category = large_city
								has_state_category = city
								has_state_category = large_town
							}
						}
						random_list = {
							asp_chance_urb = {
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
							alf_chance_urb = {
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
							pla_chance_urb = {
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
							apf_pop = {
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
					else = {
						random_list = {
							asp_pop = {
								add_dynamic_modifier = {
									modifier = ABY_asp_dominant_state
								}
							}
							alf_pop = {
								add_dynamic_modifier = {
									modifier = ABY_alf_dominant_state
								}
							}
							pla_pop = {
								add_dynamic_modifier = {
									modifier = ABY_pla_dominant_state
								}
							}
							apf_chance_rural = {
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
			}
		}
		else = {
			set_temp_variable = { urf_pop = party_popularity_100@communism }
			add_to_temp_variable = { urf_pop = party_popularity_100@democratic }
			set_temp_variable = { apf_pop = party_popularity_100@neutrality }
			add_to_temp_variable = { apf_pop = party_popularity_100@fascism }
			set_temp_variable = { urf_chance_urb = 15 }
			add_to_temp_variable = { urf_chance_urb = urf_pop }
			set_temp_variable = { apf_chance_rural = 15 }
			add_to_temp_variable = { apf_chance_rural = apf_pop }
			log = "[GetDateText]: [Root.GetName]: Popularities setup [THIS.GetName]"
			if = {
				limit = {
					has_country_flag = ABY_big_provinces
				}
				#Big provinces:
					#1. 775, 777, 785, 776, 786 urban
					#2. 773, 772, 771, 778, 774, (1208) rural
					#3. 779, 780, 1201, (1200), 782, 783, (784) rural
					#4. 741, 740, 738 urban
					#5. 737, 734, 733, 731, 732, 736, 735 urban
					#6. 760, 761, 759, 758 rural
					#7. 766, 770, 763 rural
					#8. 792, 801, 790, 795, 799 urban
					#9. 807, 808, 810, 812, 828, 827 rural
					#10. 788, 789, 955, 954, 956, 958, 957 urban
					
				#Province 1 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				
				#Province 2 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 3 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 4 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 5 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 6 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 7 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 8 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 9 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 10 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
			}
			else_if = {
				limit = {
					has_country_flag = ABY_medium_provinces
				}
				#Medium provinces:
					#1. 775, 785 urban
					#2. 776, 786 urban
					#3. 772, 773, 771, (1208) rural
					#4. 777, 779, 780 rural
					#5. 778, 774, 782 rural
					#6. 783, 1201, (1200), (784) rural
					#7. 741, 740, 738 urban
					#8. 737, 734 urban
					#9. 733, 732, 731 urban
					#10. 736, 735 urban
					#11. 759, 758 rural
					#12. 760, 761 rural
					#13. 766, 770, 763 rural
					#14. 792, 801, 790 urban
					#15. 795, 799 urban
					#16. 807, 810, 808 urban
					#17. 827, 828, 812 rural
					#18. 788, 789, 955 rural
					#19. 954, 956 urban
					#20. 957, 958 urban
					
				#Province 1 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_1
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 2 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_2
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 3 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_3
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 4 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_4
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 5 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_5
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 6 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_6
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 7 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_7
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 8 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_8
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 9 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_9
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 10 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_10
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 11 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_11
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_11
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 12 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_12
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_12
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 13 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_13
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_13
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 14 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_14
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_14
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 15 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_15
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_15
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 16 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_16
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_16
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 17 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_17
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_17
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 18 rural
				random_list = {
					urf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_18
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_chance_rural = {
						for_each_scope_loop = {
							array = ABY_prov_18
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 19 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_19
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_19
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
				#Province 20 urban
				random_list = {
					urf_chance_urb = {
						for_each_scope_loop = {
							array = ABY_prov_20
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
						}
					}
					apf_pop = {
						for_each_scope_loop = {
							array = ABY_prov_20
							if = {
								limit = {
									is_owned_by = PREV
									is_core_of = PREV
								}
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
			}
			else_if = {
				limit = {
					has_country_flag = ABY_every_state_a_province
				}
				every_owned_state = {
					limit = {
						is_core_of = ROOT
					}
					if = {
						limit = {
							OR = {
								has_state_category = megalopolis
								has_state_category = metropolis
								has_state_category = large_city
								has_state_category = city
								has_state_category = large_town
							}
						}
						random_list = {
							urf_chance_urb = {
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
							apf_pop = {
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
					else = {
						random_list = {
							urf_pop = {
								add_dynamic_modifier = {
									modifier = ABY_urf_dominant_state
								}
							}
							apf_chance_rural = {
								add_dynamic_modifier = {
									modifier = ABY_apf_dominant_state
								}
							}
						}
					}
				}
			}
		}
	}
}
ABY_clear_provinces = {
	if = {
		limit = {
			has_country_flag = ABY_urf_split
		}
		every_owned_state = {
			limit = {
				OR = {
					has_dynamic_modifier = {
						modifier = ABY_asp_dominant_state
					}
					has_dynamic_modifier = {
						modifier = ABY_alf_dominant_state
					}
					has_dynamic_modifier = {
						modifier = ABY_pla_dominant_state
					}
					has_dynamic_modifier = {
						modifier = ABY_apf_dominant_state
					}
				}
			}
			if = {
				limit = {
					has_dynamic_modifier = {
						modifier = ABY_asp_dominant_state
					}
				}
				remove_dynamic_modifier = {
					modifier = ABY_asp_dominant_state
				}
			}
			else_if = {
				limit = {
					has_dynamic_modifier = {
						modifier = ABY_alf_dominant_state
					}
				}
				remove_dynamic_modifier = {
					modifier = ABY_alf_dominant_state
				}
			}
			else_if = {
				limit = {
					has_dynamic_modifier = {
						modifier = ABY_pla_dominant_state
					}
				}
				remove_dynamic_modifier = {
					modifier = ABY_pla_dominant_state
				}
			}
			else_if = {
				limit = {
					has_dynamic_modifier = {
						modifier = ABY_apf_dominant_state
					}
				}
				remove_dynamic_modifier = {
					modifier = ABY_apf_dominant_state
				}
			}
		}
	}
	else = {
		every_owned_state = {
			limit = {
				OR = {
					has_dynamic_modifier = {
						modifier = ABY_urf_dominant_state
					}
					has_dynamic_modifier = {
						modifier = ABY_apf_dominant_state
					}
				}
			}
			if = {
				limit = {
					has_dynamic_modifier = {
						modifier = ABY_urf_dominant_state
					}
				}
				remove_dynamic_modifier = {
					modifier = ABY_urf_dominant_state
				}
			}
			else_if = {
				limit = {
					has_dynamic_modifier = {
						modifier = ABY_apf_dominant_state
					}
				}
				remove_dynamic_modifier = {
					modifier = ABY_apf_dominant_state
				}
			}
		}
	}
}
ABY_no_majority_effect = {
	if = {
		limit = {
			NOT = {
				ABY_PLMT_has_majority = yes
			}
		}
		custom_effect_tooltip = ABY_majority_warning
		add_political_power = -50
		add_stability = -0.05
		add_war_support = -0.05
		add_popularity = { ideology = communism popularity = -0.05 }
	}
}
ABY_apf_opposes = {
	if = {
		limit = {
			check_variable = {
				ABY_apf_support > 4
			}
		}
		subtract_from_variable = {
			var = ABY_apf_support
			value = 5
			tooltip = ABY_lose_support_5_apf
		}
		ABY_PLMT_re_render = yes
	}

}
ABY_pla_opposes = {
	if = {
		limit = {
			has_country_flag = ABY_urf_split
		}
		custom_effect_tooltip = ABY_pla_opposes_tt
	}
	if = {
		limit = {
			has_country_flag = ABY_pla_alliance
		}
		add_to_variable = {
			var = ABY_pla_patience
			value = 1
			tooltip = ABY_lose_1_pla_patience
		}
		if = {
			limit = {
				check_variable = {
					ABY_pla_patience > 2
				}
			}
			custom_effect_tooltip = ABY_pla_alliance_breaks
			clr_country_flag = ABY_pla_alliance
			remove_from_array = { ABY_coalitions_array = 3 }
			ABY_PLMT_re_render = yes
		}
	}
}
ABY_asp_opposes = {
	if = {
		limit = {
			has_country_flag = ABY_urf_split
		}
		custom_effect_tooltip = ABY_asp_opposes_tt
	}
	if = {
		limit = {
			has_country_flag = ABY_asp_alliance
		}
		add_to_variable = {
			var = ABY_asp_patience
			value = 1
			tooltip = ABY_lose_1_asp_patience
		}
		if = {
			limit = {
				check_variable = {
					ABY_asp_patience > 2
				}
			}
			custom_effect_tooltip = ABY_asp_alliance_breaks
			clr_country_flag = ABY_asp_alliance
			remove_from_array = { ABY_coalitions_array = 1 }
			ABY_PLMT_re_render = yes
		}
	}
}
