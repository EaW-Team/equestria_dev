col = {
	OLE = {
		set_politics = {
			ruling_party = fascism
			elections_allowed = no
		}
		CHN = {
			puppet = PREV
		}
		add_ideas = surrender_test
		save_global_event_target_as = chnole
		# add_to_war = { targeted_alliance = CHN enemy = OLE }
		every_state = {
			limit = { is_core_of = OLE NOT = { state = 292 } }
			transfer_state_to = PREV
		}
	}
}

t = {
	194 = {
		for_each_loop = {
			array = core_countries
			log = "[?v.GetTag]"
		}
	}
}

ex = {
	#OLE = {
	#	become_exiled_in = {
	#		target = ROOT
	#		legitimacy = 50
	#	}
	#}
	OLE = {
		end_puppet_this = yes
		leave_faction = yes
		clear_variable = collaboration_formed_by
		set_politics = {
			ruling_party = democratic
			elections_allowed = no
		}
		set_temp_variable = { goodole = THIS}
		set_country_flag = { flag = bypass_on_peaceconference_ended value = 1 days = 1 }
		every_enemy_country = {
			white_peace = PREV
		}
	}
	every_state = {
		limit = { OR = { is_core_of = OLE is_owned_by = OLE } NOT = { state = 194 } }
		if = {
			limit = {
				is_owned_by = CHN
			}
			var:goodole = { set_state_owner = PREV }
			set_state_flag = chn_owned
		}
		set_state_flag = a
	}
	CHN = {
		set_variable = { collaboration_formed@OLE = 1 }
	}
	create_dynamic_country = {
		original_tag = OLE
		division_template = {
			name = "Stark Hovar Division"			#Stark Hovar Division - kek
			division_names_group = OLE_INF_01
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 }
				infantry = { x = 1 y = 2 }
			}
		
			support = {
				artillery = { x = 0 y = 0 }
			}
		}
		division_template = {
			name = "Kunglig Vakt"			#RoyalGuards
			division_names_group = OLE_GRD_01
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
			}
		
			support = {
			}
			priority = 2
		}
		division_template = {
			name = "Ryhmä"			#Garrison
			division_names_group = OLE_GAR_01
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
			}
		
			support = {
			}
			priority = 0
		}
		division_template = {
			name = "Skogvaktare Väpnad Grupp"			#Elites ahahahaha
			division_names_group = OLE_ELT_01
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 }
			}
			support = {
				recon = { x = 0 y = 0 }
			}
			priority = 2
		}
		division_template = {
			name = "Elite Bergsklättrare"			#mountaineers
			division_names_group = OLE_MTN_01
			regiments = {
				mountaineers = { x = 0 y = 0 }
				mountaineers = { x = 0 y = 1 }
				mountaineers = { x = 0 y = 2 }
				mountaineers = { x = 1 y = 0 }
				mountaineers = { x = 1 y = 1 }
				mountaineers = { x = 1 y = 2 }
				mountaineers = { x = 2 y = 0 }
			}
			support = {
				recon = { x = 0 y = 0 }
			}
		}
		division_template = {
			name = "Panssaroitu Divisioona"			#Tanks
			division_names_group = OLE_ELT_01
			regiments = {
				light_armor = { x = 0 y = 0 }
				light_armor = { x = 0 y = 1 }
				light_armor = { x = 0 y = 2 }
				light_armor = { x = 0 y = 3 }
			}
		}
		transfer_state = 194
		CHN = {
			puppet = PREV
			if = {
				limit = { has_dlc = "La Resistance" }
				PREV = { set_variable = { collaboration_formed_by = PREV } }
				set_autonomy = {
					target = PREV
					autonomy_state = autonomy_collaboration_government
				}
			}
			else = {
				set_autonomy = {
					target = PREV
					autonomy_state = autonomy_reichskommissariat
				}
			}
		}
		set_temp_variable = { badole = THIS}
		OLE = {
			OLE_Vidkun_Hjortsling = {
				set_nationality = PREV.PREV
			}
		}
		set_country_flag = OLE_CHN_puppet
		drop_cosmetic_tag = yes
		set_cosmetic_tag = OLE_CHN
		#load_focus_tree = generic_focus
		set_party_name = { ideology = fascism long_name = OLE_chn_collaborators_long name = OLE_chn_collaborators }
		promote_character = {
			character = OLE_Vidkun_Hjortsling
			ideology = ultranationalism
		}
	}
	var:goodole = {
		transfer_units_fraction = {
			target = var:badole
			size = 1
			stockpile_ratio = 0.8
			air_ratio = 0.9
			target_organization = 1
			source_organization = 1
			keep_unit_leaders_trigger = {
				always = yes
			}
		}
		country_event = olenia.720
		EQS = { add_to_faction = PREV }
		add_to_war = { targeted_alliance = EQS enemy = CHN }
		# add_ideas = surrender_test
	}
	every_state = {
		limit = { has_state_flag = a }
		if = {
			limit = {
				has_state_flag = chn_owned
			}
			CHN = { set_state_controller = PREV }
		}
		else = {
			var:badole = { set_state_controller = PREV }
		}
		clr_state_flag = a
		clr_state_flag = chn_owned
	}
	var:goodole = { change_tag_from = var:badole }
}

sw = {
	add_legitimacy = 100
}

end = {
	every_state = {
		limit = { is_core_of = OLE }
		EQS = { set_state_controller = PREV }
	}
}