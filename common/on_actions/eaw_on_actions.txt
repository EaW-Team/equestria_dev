on_actions = {

	#Not run on a specific country.
	on_startup = {
		effect = {
			EQS = {
				save_global_event_target_as = equestria
				country_event = { id = equestria.1 hours = 15 }
				country_event = { id = equestria.102 days = 93 }
			}
			STG = {
				country_event = { id = stalliongrad.0 days = 1 }
				country_event = { id = stalliongrad.12 days = 10 }
				country_event = { id = stalliongrad.13 days = 20 }
				country_event = { id = stalliongrad.24 days = 45 }
				country_event = { id = stalliongrad.2 days = 60 }
			}
			SOL = { save_global_event_target_as = solar_empire }
			OLE = { save_global_event_target_as = democratic_OLE }
			GRI = { 
				save_global_event_target_as = griffonian_empire 
				country_event = { id = imperial.1 days = 6 random = 10 }
				country_event = { id = imperial.60 days = 186 random = 20 }
			}
			DED = {
				every_other_country = {
					add_opinion_modifier = { target = PREV modifier = mortal_enemies }
					add_opinion_modifier = { target = PREV modifier = CHN_Embargo }
					reverse_add_opinion_modifier = { target = PREV modifier = mortal_enemies }
					reverse_add_opinion_modifier = { target = PREV modifier = CHN_Embargo }
					set_country_flag = DED_opinion_applied
				}
				every_owned_state = {
					add_claim_by = HLR
				}
			}
			CHN = {
				add_opinion_modifier = { target = EQS modifier = distrustful_relations }
				reverse_add_opinion_modifier = { target = EQS modifier = distrustful_relations }
				add_opinion_modifier = { target = CRY modifier = distrustful_relations }
				reverse_add_opinion_modifier = { target = CRY modifier = distrustful_relations }
				add_opinion_modifier = { target = EQC modifier = distrustful_relations }
				reverse_add_opinion_modifier = { target = EQC modifier = distrustful_relations }
				add_opinion_modifier = { target = EQS modifier = CHN_Embargo }
				reverse_add_opinion_modifier = { target = EQS modifier = CHN_Embargo }
				add_opinion_modifier = { target = CRY modifier = CHN_Embargo }
				reverse_add_opinion_modifier = { target = CRY modifier = CHN_Embargo }
				add_opinion_modifier = { target = EQC modifier = CHN_Embargo }
				reverse_add_opinion_modifier = { target = EQC modifier = CHN_Embargo }
				add_opinion_modifier = { target = GRI modifier = CHN_GRI_Friendship }
				reverse_add_opinion_modifier = { target = GRI modifier = CHN_GRI_Friendship }
			}
			EYR = {
				add_opinion_modifier = { target = ERI modifier = mortal_enemies }
			}
			ERI = {
				add_opinion_modifier = { target = EYR modifier = mortal_enemies }
			}
			GRF = {
				country_event = { id = griffons.21 days = 943 random = 4 }
				country_event = { id = griffons.22 days = 987 random = 4 }
				country_event = { id = griffons.23 days = 931 random = 4 }
				country_event = { id = griffons.24 days = 968 random = 4 }
				country_event = { id = griffons.25 days = 938 random = 4 }
			}
			FEA = {
				country_event = { id = feat.15 days = 60 random = 120 }
				country_event = { id = feat.20 days = 72 random = 6 }
				country_event = { id = feat.21 days = 105 random = 6 }
			}
			FAT = {
				country_event = { id = griffonRepublic.60 random = 800 }
				country_event = { id = griffonRepublic.61 random = 290 }
				country_event = { id = griffonRepublic.62 random = 200 }
				country_event = { id = griffonRepublic.63 random = 600 }
				country_event = { id = griffonRepublic.64 random = 460 }
				country_event = { id = griffonRepublic.65 random = 1000 }
			}
			BRF = {
				country_event = { id = prywhen.6 days = 1 }
			}
			if = {
				limit = { is_historical_focus_on = no }
				random_list = {
					10 = {
						set_global_flag = EQS_nice_celestia
					}
					65 = {

					}
					15 = {
						set_global_flag = EQS_evil_celestia
					}
				}
				random_list = {
					40 = {
						set_global_flag = OLE_no_servitude
					}
					60 = {

					}
				}
			}
			every_country = {
				limit = { is_generic_race = yes }
				set_technology = { generic_race = 1 }
				add_ideas = generic_race_idea
			}
			every_country = {
				limit = { is_pony_race = yes }
				add_ideas = pony_race
			}
			every_country = {
				limit = { is_changeling_race = yes }
				add_ideas = changeling_race
			}
			every_country = {
				limit = { is_deer_race = yes }
				add_ideas = deer_race
			}
			every_country = {
				limit = { is_griffon_race = yes }
				add_ideas = griffon_race
			}
			every_country = {
				limit = { 
					is_on_equestrian_continent = no
					OR = {
						has_idea = dummy_idea_science
						NOT = {
							has_idea_with_trait = science_idea
						}
					}
				}
				if = {
					limit = {
						num_of_civilian_factories > 2
						has_tech = melee_weapons1
						NOT = { owns_big_griffon_city = yes }
						NOT = { owns_major_griffon_city = yes }
					}
					#log = "[Root.GetName] better_science_base"
					add_ideas = better_science_base
					else = {
						if = {
							limit = { owns_big_griffon_city = yes }
							#log = "[Root.GetName] big_science_base"
							add_ideas = big_science_base
							else = {
								if = {
									limit = { owns_major_griffon_city = yes }
									#log = "[Root.GetName] proper_science_base"
									add_ideas = proper_science_base
									else = {
										if = {
											limit = {
												NOT = { owns_major_griffon_city = yes }
												NOT = { owns_big_griffon_city = yes }
												OR = {
													NOT = { has_tech = melee_weapons1 }
													NOT = { num_of_civilian_factories > 2 }
												}
												is_griffon_continent_country = yes
											}
											#log = "[Root.GetName] poor_science_base"
											add_ideas = poor_science_base
										}
									}
								}
							}
						}
					}
				}
			}
			every_country = {
				limit = {
					is_ai = yes
					NOT = { has_idea = detached_country }
					NOT = { has_country_flag = join_factions_set }
				}
				country_event = utility.1
			}

			every_country = {
				limit = {
					is_ai = no
				}
				set_variable = { eaw_welcome_screen = 1 }
			}

			every_country = {
				limit = {
					is_ai = yes
				}
				add_ideas = ai_xp_boost
			}

			every_country = {
				limit = {
					OR = {
						is_on_equestrian_continent = yes
						has_idea = dummy_idea_science
						NOT = {
							has_idea_with_trait = science_idea
						}
					}
				}
				#log = "[Root.GetName] proper_science_base"
				add_ideas = proper_science_base
			}

			every_country = {
				limit = {
					OR = {
						has_idea = dummy_idea_society
						NOT = {
							has_idea_with_trait = society_idea
						}
					}
				}
				if = {
					limit = { is_griffon_continent_country = yes }
					add_ideas = outdated_industry
					else = { add_ideas = modern_society
					}
				}
			}
			### Development End ####
			EQS = {
				set_country_flag = manpower_laws_blocked
				set_country_flag = economic_laws_blocked
				set_country_flag = { flag = celestia_evil_meter value = 0 }
				country_event = { id = news.1101 days = 210 }
				news_event = { id = news.16 days = 200 random = 40 }
			}
			BUF = {
				add_ideas = poor_science_base
			}
			PLB = {
				add_ideas = better_science_base
			}
			every_country = {
				limit = {
					is_griffon_continent_country = yes
					OR = {
						has_tribal_society = yes
						has_agrarian_society = yes
						has_pre_industrial_society = yes
						has_illiteracy = yes
					}
				}
				country_event = { id = griffonian.166 days = 912 } #comet sighted
			}
		}
	}

	#FROM is war target
	on_declare_war = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_declare_war"
			hidden_effect = {
				if = {
					limit = {
						OR = {
							tag = GRF
							FROM = { tag = GRF }
						}
					}
					clear_variable = GRF_delayed_merc_payment
					FROM = { clear_variable = GRF_delayed_merc_payment }
				}
				if = {
					limit = {
						OR = {
							AND = {
								tag = GRW
								FROM = { tag = BAN }
							}
							AND = {
								tag = BAN
								FROM = { tag = GRW }
							}
							AND = {
								tag = GRW
								FROM = { tag = BRF }
							}
							AND = {
								tag = BRF
								FROM = { tag = GRW }
							}
						}
					}
					GRW = { load_oob = "GRW_fun_for_player" }
				}
				if = {
					limit = { tag = DED FROM = { tag = HLR } }
					FROM = { add_timed_idea = {idea = HLR_Dreads_Incoming_Idea days = 200} }
				}
				if = {
					limit = {
						OR = {
							original_tag = EQS
							FROM = { original_tag = EQS }
						}
					}
					clr_country_flag = manpower_laws_blocked
					clr_country_flag = economic_laws_blocked
					FROM = {
						clr_country_flag = manpower_laws_blocked
						clr_country_flag = economic_laws_blocked
					}
				}
				if = {
					limit = {
						original_tag = CRY
						FROM = { original_tag = CRY }
					}
					if = {
						limit = {
							has_government = democratic
							NOT = { has_completed_focus = CRY_oldorder }
						}
						complete_national_focus = CRY_oldorder
						else = {
							FROM = {
								if = {
									limit = {
										has_government = democratic
										NOT = { has_completed_focus = CRY_oldorder }
									}
									complete_national_focus = CRY_oldorder
								}
							}
						}
					}
				}
				if = {
					limit = {
						original_tag = CRY has_government = democratic
					}
					country_event = { id = crysom.39 days = 1 }
				}
				if = {
					limit = {
						FROM = { original_tag = CRY has_government = democratic }
					}
					FROM = { country_event = { id = crysom.39 days = 1 } }
				}
				if = {
					limit = {
						tag = BRF
						FROM = { tag = GRW }
					}
					country_event = brodfeld.26
				}
				if = {
					limit = {
						#original_tag = FROM
						OR = {
							has_idea = dummy_idea_society
							#has_idea = modern_society
							NOT = { has_idea_with_trait = society_idea }
						}
					}
					if = {
						limit = {
							FROM = {
								NOT = {
									has_idea = modern_society
								}
							}
						}
						FROM = { ROOT = { transfer_society_ideas = yes } }
						else = { add_ideas = modern_society }
					}
				}
				if = {
					limit = {
						original_tag = FROM
					}
					if = {
						limit = { FROM = { NOT = { has_idea = generic_race_idea } } }
						FROM = { ROOT = { transfer_race_ideas = yes } }
					}
					if = {
						limit = {
							OR = {
								tag = FAT
								FROM = { has_focus_tree = generic_griffon_focus }
							}
							has_focus_tree = generic_griffon_focus
						}
						if = {
							limit = {
								#TODO make sure which countries can have monarchist civil wars
								always = yes
							}
							set_country_flag = have_regular_puppets
						}
					}
				}
				if = {
					limit = {
						#original_tag = FROM
						OR = {
							has_idea = dummy_idea_science
							#has_idea = proper_science_base
							NOT = { has_idea_with_trait = science_idea }
						}
					}
					if = {
						limit = {
							FROM = {
								NOT = {
									has_idea = proper_science_base
								}
							}
						}
						FROM = { ROOT = { transfer_science_ideas = yes } }
						else = {add_ideas = proper_science_base }
					}
				}
				if = {
					limit = {
						OR = {
							AND = {
								original_tag = EQS
								FROM = { original_tag = CRY has_government = fascism }
							}
							AND = {
								original_tag = CRY has_government = fascism
								FROM = { original_tag = EQS }
							}
						}
					}
					news_event = { id = news.45 days = 1 }
				}
				if = {
					limit = {
						NOT = { has_global_flag = the_war }
						tag = CHN
						FROM = {
							original_tag = EQS
						}
					}
					news_event = { id = news.3 days = 1 }
				}
				if = {
					limit = { 
						tag = CHN
						has_government = fascism
						has_completed_focus = demand_equestria
						NOT = { country_exists = VAN }
						FROM = {
							OR = {
								original_tag = EQS
								tag = NLR
							}
						}
					}
					country_event = { id = changelings.32 days = 1 random = 2 }
				}
				if = {
					limit = {
						STG = {
							exists = yes
							has_government = communism
							is_subject = no
						}
					}
					if = {
						limit = {
							OR = {
								AND = {
									tag = BAL
									FROM = { tag = EQS }
								}
								AND = {
									tag = EQS
									FROM = { tag = BAL }
								}
							}
						}
						BAL = { country_event = { id = civwar.14 days = 1 } }
					}
					if = {
						limit = {
							OR = {
								AND = {
									tag = BAL
									FROM = { tag = NLR }
								}
								AND = {
									tag = NLR
									FROM = { tag = BAL }
								}
							}
						}
						BAL = { country_event = { id = civwar.15 days = 1 } }
					}
				}
				if = {
					limit = {
						FROM = {
							original_tag = TRD
							has_completed_focus = TRD_full_recovery
						}
					}
					FROM = {
						country_event = { id = tradefed.31 days = 1 }
					}
				}
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = event_target:griffonian_empire
							is_in_faction_with = event_target:griffonian_empire
							is_subject_of = event_target:griffonian_empire
						}
					}
					FROM = { has_idea = FAT_republican_pact }
				}
				FROM = {
					country_event = griffonRepublic.79
				}
			}
			if = {
				limit = {
					FROM = {
						OR = {
							tag = event_target:griffonian_empire
							is_in_faction_with = event_target:griffonian_empire
							is_subject_of = event_target:griffonian_empire
						}
					}
					ROOT = { tag = FAT has_idea = FAT_republican_pact }
				}
				ROOT = {
					country_event = griffonRepublic.79
				}
			}
		}
	}
	#FROM is state the nuke got dropped on
	on_nuke_drop = {

		effect = {
			FROM = {
				decrease_population_on_nuke = yes
			}
			if = {
				limit = {
					tag = EQS
					FROM = { state = 251 }
					NOT = { has_country_flag = nuked_the_hive }
				}
				news_event = { id = news.50 days = 1}
				set_country_flag = nuked_the_hive
			}
		}
	}

	#used when puppeting in a peace conference
	#ROOT = nation being puppeted, FROM = overlord
	on_puppet = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_puppet"
			FROM = { remove_opinion_modifier = { target = ROOT modifier = cry_betrayal } }
			if = {
				limit = { tag = DED }
				FROM = {
					annex_country = { target = ROOT }
					country_event = { id = deadempire.29 days = 1 }
				}
			}
			if = {
				limit = {
					FROM = { tag = GRW }
					ROOT = { tag = BRF }
					}
				FROM = { annex_country = { target = ROOT } }
			}
			if = {
				limit = {
					FROM = { tag = BRF }
					ROOT = { tag = GRW }
					}
				FROM = { annex_country = { target = ROOT } }
			}
			if = {
				limit = {
					FROM = { tag = BAN }
					ROOT = { tag = GRW }
					}
				ROOT = {
					set_cosmetic_tag = GRW_BAN
					load_focus_tree = generic_focus
				}
			}
			if = {
				limit = {
					FROM = { NOT = { tag = BRF tag = BAN } has_government = fascism }
					ROOT = { tag = GRW }
					}
				ROOT = {
					set_cosmetic_tag = GRW_FASHPUPPET
					load_focus_tree = generic_focus
				}
			}
			if = {
				limit = {
					FROM = { NOT = { tag = BRF tag = BAN } NOT = { has_government = fascism } }
					ROOT = { tag = GRW }
					}
				ROOT = {
					set_cosmetic_tag = GRW_PUPPET
					load_focus_tree = generic_focus
				}
			}
			if = {
				limit = {
					FROM = { tag = FAT }
					is_griffon_continent_griffon_country = yes
				}
				if = {
					limit = {
						FROM = { has_idea = FAT_decentralized_republic_idea }
					}
					if = {
						limit = { has_dlc = "Together for Victory" }
						FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_integrated_puppet } }
						add_ideas = FAT_decentralized_republic_puppet
						add_to_tech_sharing_group = FAT_research_group
						else = { add_ideas = FAT_decentralized_republic_puppet_no_TfV }
					}
				}
				if = {
					limit = {
						FROM = { has_idea = FAT_griffonian_alliance_idea }
					}
					if = {
						limit = { has_dlc = "Together for Victory" }
						FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_dominion } }
						add_to_tech_sharing_group = FAT_research_group
					}
				}
			}
			if = {
				limit = {
					original_tag = JUN
					OR = {
						AND = {
							NOT = { has_completed_focus = JUN_alone }
							OR = {
								has_country_leader = { ruling_only = yes name = Caballeron }
								FROM = { AND = { original_tag = CHN has_government = fascism } }
								FROM = { AND = { original_tag = EQS has_government = democratic } }
							}
						}
						AND = {
							FROM = {
								OR = {
									original_tag = EQS
									original_tag = CHN
								}
								is_ai = yes
							}
						}
					}
				}
				FROM = { country_event = jungle.17 }
			}
			if = {
				limit = { 
					original_tag = CRY
					#has_focus_tree = crystalempire_sombra
					#NOT = { has_country_leader = { ruling_only = yes name = "King Sombra"} }
				}
				country_event = crysom.48
				if = {
					limit = { 
						FROM = {
							original_tag = EQS
							has_government = democratic
						}
					}
					country_event = crysom.40
				}
				if = {
					limit = {
						#has_country_leader = { ruling_only = yes name = "Radiant Hope" }
						FROM = { has_government = fascism }
					}
					kill_country_leader = yes
				}
			}
			if = {
				limit = {
					tag = event_target:equestria
					has_country_flag = EQS_CRY_has_twilight
					FROM = { tag = event_target:solar_empire }
				}
				FROM = { country_event = solarempire.22 }
			}
			if = {
				limit = {
					original_tag = CRY
					has_country_flag = EQS_CRY_has_twilight
					FROM = { tag = event_target:solar_empire }
				}
				FROM = { news_event = solarempire.26 }
			}
			if = {
				limit = {
					FROM = {
						is_ai = yes
						original_tag = GRF
					}
					ROOT = {
						original_tag = GFF
					}
				}
				FROM = { annex_country =  { target = ROOT } }
			}
			if = {
				limit = {
					FROM = {
						is_ai = yes
						is_eqs_civil_war_tag = yes
						NOT = { original_tag = JUN }
					}
					ROOT = {
						is_ai = yes
						is_eqs_civil_war_tag = yes
						NOT = { original_tag = JUN }
					}
				}
				FROM = { annex_country =  { target = ROOT } }
			}
			if = {
				limit = { original_tag = CHN }
				if = {
					limit = {
						FROM = {
							OR = {
								original_tag = EQS
								original_tag = CRY
							}
							has_government = democratic
						}
					}
					FROM = {
						country_event = { id = changelings.39 days = 1 }
					}
					if = {
						limit = {
							FROM = { 
								is_ai = yes
							}
							any_owned_state = {
								is_core_of = OLE
							}
							NOT = { country_exists = OLE }
						}
						release = OLE
						FROM = { puppet = OLE }
					}
				}
				if = {
					limit = { FROM = { has_government = fascism } }
					country_event = { id = solarempire.906 }
				}
				if = {
					limit = { FROM = { has_government = communism } }
					complete_national_focus = seize_production
					complete_national_focus = equality_for_all_CHN
					complete_national_focus = battleforthehives_chn
				}
			}
			if = {
				limit = { FROM = { original_tag = NLR } original_tag = EQS }
				FROM = { annex_country = { target = ROOT } }
			}
			if = {
				limit = {
					FROM = {
						original_tag = EQS
					}
				}
				if = {
					limit = { original_tag = NLR }
					FROM = { annex_country = { target = ROOT } }
				}
				if = {
					limit = { original_tag = CRY }
					if = {
						limit = {
							has_government = democratic
							FROM = { has_government = democratic }
							NOT = {
								has_country_leader = { ruling_only = yes name = "Princess Mi Amore Cadenza" }
								has_country_leader = { ruling_only = yes name = "Princess Twilight Sparkle" }
								has_country_leader = { ruling_only = yes name = "Princess Flurry Heart" }
							}
							OR = {
								AND = {
									OR = {
										has_global_flag = free_the_old_royalty
										has_global_flag = continue_imprisonment
									}
								}
								AND = {
									has_global_flag = royalty_executed
									NOT = { country_exists = event_target:solar_empire }
									NOT = { has_global_flag = SOL_twilight_converted }
								}
							}
							has_global_flag = sombra_returned
						}
						country_event = { id = crysom.40 days = 1 }
					}
					if = {
						limit = {
							NOT = {
								has_idea = equestrian_overlord
								has_idea = equestrian_overlord2
								has_idea = equestrian_overlord3
							}
						}
						if = {
							limit = { has_completed_focus = CRY_subordination }
							add_ideas = equestrian_overlord3
							else = { 
								if = {
									limit = { has_completed_focus = CRY_eqsengineers }
									add_ideas = equestrian_overlord2
									else = { add_ideas = equestrian_overlord }
								}
							}
						}
					}
                	event_target:equestria = {
						remove_opinion_modifier = { target = ROOT modifier = CHN_embargo }
						remove_opinion_modifier = { target = ROOT modifier = cry_refused_demmands }
						remove_opinion_modifier = { target = ROOT modifier = enemies }
						remove_opinion_modifier = { target = ROOT modifier = executed_royalty }
					}
                	EQC = {
						remove_opinion_modifier = { target = ROOT modifier = CHN_embargo }
						remove_opinion_modifier = { target = ROOT modifier = cry_refused_demmands }
						remove_opinion_modifier = { target = ROOT modifier = enemies }
					}
				}
				if = {
					limit = { tag = CHN }
                	remove_opinion_modifier = { target = FROM modifier = CHN_embargo }
			    	FROM = { remove_opinion_modifier = { target = ROOT modifier = CHN_embargo } }
                	remove_opinion_modifier = { target = CRY modifier = CHN_embargo }
			    	CRY = { remove_opinion_modifier = { target = ROOT modifier = CHN_embargo } }
                	remove_opinion_modifier = { target = EQC modifier = CHN_embargo }
			    	EQC = { remove_opinion_modifier = { target = ROOT modifier = CHN_embargo } }
                	remove_opinion_modifier = { target = FROM modifier = mortal_enemies }
			    	FROM = { remove_opinion_modifier = { target = ROOT modifier = mortal_enemies } }
                	remove_opinion_modifier = { target = CRY modifier = mortal_enemies }
			    	CRY = { remove_opinion_modifier = { target = ROOT modifier = mortal_enemies } }
                	remove_opinion_modifier = { target = EQC modifier = mortal_enemies }
			    	EQC = { remove_opinion_modifier = { target = ROOT modifier = mortal_enemies } }
				}
			}
			if = {
				limit = {
					original_tag = EQC
				}
				if = {
					limit = {
						FROM = {
							OR = {
								original_tag = EQS
								original_tag = NLR
							}
						}
					}
					if = {
						limit = { FROM = { is_EQS_SOL = yes } }
						create_country_leader = {
							name = "Arcane Nova"
							picture = "ArcaneNova.tga"
							expire = "1965.1.1"
							ideology = falangism
							traits = {
							}
						}
						set_party_name = { ideology = fascism long_name = EQC_SOL_fascism_party_long name = EQC_SOL_fascism_party }
						if = {
							limit = {
								has_country_flag = EQC_destined_to_be_an_RK
							}
							FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_reichskommissariat } }
						}
						load_focus_tree = eqc_sol_focus
						set_global_flag = SOL_chose_EQC_leader
						set_province_name = { id = 10005 name = "Sunset"}
					}
					if = {
						limit = { FROM = { tag = NLR } }
						set_country_flag = EQC_NLR_LoyalBat
						set_party_name = { ideology = fascism long_name = EQC_bat_supporters_fash name = EQC_bat_supporters_fash }
						create_country_leader = {
							name = "Flawless Glow"
							desc = "POLITICS_FLAWLESS_GLOW"
							picture = "FlawlessGlow.tga"
							expire = "1965.1.1"
							ideology = fascism_ideology
							id = 717
							traits = {
							}
						}
						load_focus_tree = eqc_nlr_focus
					}
					country_event = equestriancolony.1
					else = {
						if = {
							limit = {
								has_country_flag = equalist_eqc
								NOT = { has_government = communism }
							}
							country_event = equestriancolony.4
							else = {
								if = {
									limit = {
										has_country_flag = is_maresoc
									}
									country_event = equestriancolony.3
								}
								else = {
									if = {
										limit = { NOT = { has_focus_tree = new_mareland_focus } }
										load_focus_tree = new_mareland_focus
										country_event = equestriancolony.2
									}
								}
							}
						}
					}
				}
			}
			if = {
				limit = {
					is_feudal_vassal = yes
					FROM = { has_country_flag = have_regular_puppets }
				}
				set_country_flag = have_regular_puppets
			}
			if = {
				limit = {
					tag = JER
				}
				if = {
					limit = {
						OR = {
							has_government = democratic
							has_government = communism
						}
						NOT = { has_country_flag = JER_AWPR_wins }
						FAT = { has_unit_leader = 75654 }
					}
					FAT = { country_event = griffonRepublic.84 }
				}
				if = {
					limit = {
						has_government = communism
						NOT = { 
							has_completed_focus = JER_election_radicals
							has_completed_focus = JER_election_moderates
						}
					}
					complete_national_focus = JER_election_moderates
				}
				if = {
					limit = {
						has_government = democratic
						NOT = { 
							has_completed_focus = JER_election_democracy
						}
					}
					complete_national_focus = JER_election_democracy
				}
				if = {
					limit = {
						has_government = neutrality
						NOT = { 
							has_completed_focus = JER_absolute_rule
						}
					}
					complete_national_focus = JER_absolute_rule
				}
				if = {
					limit = {
						has_government = fascism
						NOT = { 
							has_completed_focus = JER_fascist_coup
						}
					}
					set_country_flag = JER_fash_bypass
					complete_national_focus = JER_fascist_coup
					clr_country_flag = JER_fash_bypass
				}
			}
			#COSMETIC TAG ON PUPPET BELOW, DO NOT USE break = yes ABOVE
			if = {
				limit = { original_tag = STG }
				if = {
					limit = {
						FROM = { has_government = democratic }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_EQS
						load_focus_tree = generic_focus
					}
					break = yes
				}
				if = {
					limit = {
						FROM = { NOT = { tag = EQS } has_government = democratic }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_DEM
						load_focus_tree = generic_focus
					}
					break = yes
				}
				if = {
					limit = {
						FROM = { has_government = fascism }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_PAGAN
						load_focus_tree = generic_focus
					}
					break = yes
				}
				if = {
					limit = {
						FROM = { has_government = neutrality }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_MONARCHY
						load_focus_tree = generic_focus
					}
					break = yes
				}
				break = yes
			}
			if = {
				limit = {
					FROM = {
						tag = event_target:griffonian_empire
						NOT = { has_country_flag = have_regular_puppets }
					}
					is_feudal_vassal = yes
				}
				country_event = griffonian.1
				break = yes
			}
			if = {
				limit = {
					original_tag = FEA
					OR = {
						has_cosmetic_tag = FEA_PvdA_old_flag
						has_cosmetic_tag = FEA_PvdA_old_flag_GRI_Puppet
					}
					FROM = { has_government = communism }
				}
				drop_cosmetic_tag = yes
			}
			#sanity check
			if = {
				limit = {
					FROM = {
						is_ai = yes
						original_tag = JER
					}
					OR = {
						original_tag = HEL
						original_tag = FLO
						original_tag = POM
						original_tag = AET
						original_tag = FEZ
						original_tag = JEB
						original_tag = JES
						original_tag = JRR
						original_tag = VIN
						original_tag = JFT
					}
				}
				FROM = { annex_country = { target = ROOT transfer_troops = yes } }
				break = yes
			}
			if = {
				limit = {
					FROM = {
						is_ai = yes
						OR = {
							original_tag = JEB
							original_tag = JES
							original_tag = JRR
							original_tag = VIN
							original_tag = JFT
						}
					}
					original_tag = JER
				}
				FROM = { annex_country = { target = ROOT transfer_troops = yes } }
				break = yes
			}
			if = {
				limit = {
					FROM = {
						tag = event_target:solar_empire
						has_government = fascism
					}
				}
				if = {
					limit = { original_tag = CRY }
					FROM = {
						set_country_flag = SOL_twilight_governor
						set_autonomy = { target = ROOT autonomy_state = autonomy_reichskommissariat }
					}
					set_cosmetic_tag = CRY_SOL
					add_autonomy_ratio = { value = -0.20 }
					set_country_flag = CRY_solar_governorship
					load_focus_tree = crystal_empire_solar_focus
					set_party_name = { ideology = fascism long_name = SOL_fascism_party_long name = SOL_fascism_party }
					if = {
						limit = {
							NOT = { has_global_flag = SOL_twilight_converted }
							has_global_flag = SOL_chose_EQC_leader
							any_other_country = {
								NOT = { has_country_leader = { ruling_only = yes name = "Arcane Nova" } }
							}
						}
						create_country_leader = {
							name = "Arcane Nova"
							#desc = "TWILIGHT_DESC"
							picture = "ArcaneNova.tga"
							expire = "1965.1.1"
							ideology = falangism
							traits = {
							}
						}
						else = {
							if = {
								limit = {
									has_global_flag = SOL_twilight_converted
								}
								create_country_leader = {
									name = "Grand Inquisitor Sunrise Sparkle"
									#desc = "TWILIGHT_DESC"
									picture = "TwilightSunrise.tga"
									expire = "1965.1.1"
									ideology = falangism
									traits = {
										lady_inquisitor
									}
								}
								else = {
									create_country_leader = {
										name = "Nameless Busybody"
										expire = "1965.1.1"
										ideology = falangism
										traits = {
										}
									}
								}
							}
						}
					}
					break = yes
				}
				if = {
					limit = { original_tag = PLB }
					country_event = solarempire.1000
					break = yes
				}
				if = {
					limit = { original_tag = GRF }
					country_event = solarempire.1001
					break = yes
				}
				if = {
					limit = { original_tag = PNG }
					country_event = solarempire.1002
					break = yes
				}
				if = {
					limit = { original_tag = STL }
					country_event = solarempire.1003
					break = yes
				}
				if = {
					limit = { original_tag = BUF }
					country_event = solarempire.1004
					break = yes
				}
				if = {
					limit = { original_tag = DRG }
					country_event = solarempire.1005
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = solarempire.1006
					break = yes
				}
				if = {
					limit = { original_tag = OLE }
					country_event = solarempire.1008
					break = yes
				}
				if = {
					limit = { original_tag = BAL }
					country_event = solarempire.1009
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					country_event = solarempire.1010
					break = yes
				}
				if = {
					limit = { original_tag = JUN }
					country_event = solarempire.1011
					break = yes
				}
				if = {
					limit = { original_tag = SCS }
					country_event = solarempire.1012
					break = yes
				}
				if = {
					limit = { original_tag = STG }
					country_event = solarempire.1013
					break = yes
				}
				if = {
					limit = { original_tag = JAK }
					country_event = solarempire.1015
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					country_event = solarempire.1010
					break = yes
				}
				if = {
					limit = { original_tag = CHN }
					country_event = solarempire.1016
					break = yes
				}
				if = {
					limit = { original_tag = YAK }
					country_event = solarempire.1017
					break = yes
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = NLR
						has_government = fascism
					}
				}
				if = {
					limit = { original_tag = PLB }
					country_event = { id = lunas.900 }
					break = yes
				}
				if = {
					limit = { original_tag = GRF }
					country_event = { id = lunas.902 }
					break = yes
				}
				if = {
					limit = { original_tag = PNG }
					country_event = { id = lunas.901 }
					break = yes
				}
				if = {
					limit = { original_tag = STL }
					country_event = { id = lunas.903 }
					break = yes
				}
				if = {
					limit = { original_tag = BUF }
					country_event = { id = lunas.904 }
					break = yes
				}
				if = {
					limit = { original_tag = DRG }
					country_event = { id = lunas.905 }
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = { id = lunas.906 }
					break = yes
				}
				if = {
					limit = { original_tag = OLE }
					country_event = { id = lunas.911 }
					break = yes
				}
				if = {
					limit = { original_tag = BAL }
					country_event = { id = lunas.912 }
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					country_event = { id = lunas.913 }
					break = yes
				}
				if = {
					limit = { original_tag = JUN }
					country_event = { id = lunas.914 }
					break = yes
				}
				if = {
					limit = { original_tag = SCS }
					country_event = { id = lunas.916 }
					break = yes
				}
				if = {
					limit = { original_tag = STG }
					country_event = { id = lunas.917 }
					break = yes
				}
				if = {
					limit = { original_tag = CRY }
					country_event = { id = lunas.918 }
					break = yes
				}
				if = {
					limit = { original_tag = JAK }
					country_event = { id = lunas.919 }
					break = yes
				}
				if = {
					limit = { original_tag = CHN }
					country_event = { id = lunas.920 }
					break = yes
				}
				if = {
					limit = { original_tag = YAK }
					country_event = { id = lunas.921 }
					break = yes
				}
			}

			if = {
				limit = {
					FROM = {
						original_tag = CHN
						has_government = fascism
					}
				}
				if = {
					limit = { original_tag = OLE }
					country_event = { id = olenia.718 }
					break = yes
				}
				if = {
					limit = { original_tag = PLB }
					country_event = { id = changelings.900 }
					break = yes
				}
				if = {
					limit = { original_tag = GRF }
					country_event = { id = changelings.902 }
					break = yes
				}
				if = {
					limit = { original_tag = PNG }
					country_event = { id = changelings.901 }
					break = yes
				}
				if = {
					limit = { original_tag = STL }
					country_event = { id = changelings.903 }
					break = yes
				}
				if = {
					limit = { original_tag = BUF }
					country_event = { id = changelings.904 }
					break = yes
				}
				if = {
					limit = { original_tag = DRG }
					country_event = { id = changelings.905 }
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = { id = changelings.906 }
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = { id = changelings.906 }
					break = yes
				}
				if = {
					limit = { original_tag = OLE }
					country_event = { id = olenia.718 }
					break = yes
				}
				if = {
					limit = { original_tag = CRY }
					country_event = { id = crystalemp.23 }
					break = yes
				}
				if = {
					limit = { original_tag = EQS }
					country_event = { id = equestriachn.3 }
					break = yes
				}
				if = {
					limit = { original_tag = STG }
					country_event = { id = stalliongrad.98 }
					break = yes
				}
				if = {
					limit = { original_tag = YAK }
					country_event = { id = yakistan.12 }
					break = yes
				}
				if = {
					limit = { original_tag = SCS }
					set_cosmetic_tag = CHN_confpuppet
					break = yes
				}
				if = {
					limit = { original_tag = JUN }
					set_cosmetic_tag = JUN_CHN
					break = yes
				}
				if = {
					limit = { original_tag = BAL }
					set_cosmetic_tag = BAL_CHN
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					set_cosmetic_tag = CES_CHN
					break = yes
				}
				if = {
					limit = { original_tag = MAN }
					set_cosmetic_tag = MAN_CHN
					CHN = {
						set_country_flag = released_manehattan_puppet
					}
					break = yes
				}
				if = {
					limit = { original_tag = JAK }
					country_event = { id = yakistan.13 }
					break = yes
				}
			}

			if = {
				limit = {
					FROM = {
						original_tag = FAT
					}
				}
				if = {
					limit = { original_tag = SRS }
					country_event = griffonRepublic.100
					break = yes
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = EQS
						has_government = democratic
					}
				}
				if = {
					limit = { original_tag = BUF }
					country_event = bufstate.36
					break = yes
				}
			}
		}
	}

	#used when puppeting through the occupied territories menu during peace time (or when releasing from non-core but owned territory, f.e. Britain releasing Egypt)
	#ROOT = nation being released, FROM = overlord
	on_release_as_puppet = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_release_as_puppet"
			if = {
				limit = { tag = DED }
				FROM = {
					annex_country = { target = ROOT  }
					country_event = { id = deadempire.29 days = 1 }
				}
			}
			if = {
				limit = { FROM = { tag = DED } }
				annex_country = { target = FROM  }
			}
			if = {
				limit = {
					FROM = { tag = BAN }
					ROOT = { tag = GRW }
					}
				ROOT = {
					set_cosmetic_tag = GRW_BAN
					load_focus_tree = generic_focus
				}
			}
			if = {
				limit = {
					FROM = { NOT = { tag = BRF tag = BAN } has_government = fascism }
					ROOT = { tag = GRW }
					}
				ROOT = {
					set_cosmetic_tag = GRW_FASHPUPPET
					load_focus_tree = generic_focus
				}
			}
			if = {
				limit = {
					FROM = { NOT = { tag = BRF tag = BAN } NOT = { has_government = fascism } }
					ROOT = { tag = GRW }
					}
				ROOT = {
					set_cosmetic_tag = GRW_PUPPET
					load_focus_tree = generic_focus
				}
			}
			##############################################################
			##############################################################
			if = {
				limit = {
					FROM = { tag = FAT }
					is_griffon_continent_griffon_country = yes
				}
				if = {
					limit = {
						FROM = { has_idea = FAT_decentralized_republic_idea }
					}
					if = {
						limit = { has_dlc = "Together for Victory" }
						FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_integrated_puppet } }
						add_ideas = FAT_decentralized_republic_puppet
						add_to_tech_sharing_group = FAT_research_group
						else = {
							add_ideas = FAT_decentralized_republic_puppet_no_TfV
						}
					}
				}
				if = {
					limit = {
						FROM = { has_idea = FAT_griffonian_alliance_idea }
					}
					if = {
						limit = { has_dlc = "Together for Victory" }
						FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_dominion } }
						add_to_tech_sharing_group = FAT_research_group
					}
				}
			}
			if = {
				limit = { original_tag = CHN }
				if = {
					limit = { FROM = { has_government = fascism } }
					country_event = { id = solarempire.906 }
				}
				if = {
					limit = { FROM = { has_government = communism } }
					complete_national_focus = seize_production
					complete_national_focus = equality_for_all_CHN
					complete_national_focus = battleforthehives_chn
				}
			}
			if = {
				limit = { 
					original_tag = CRY
					#has_focus_tree = crystalempire_sombra
					#NOT = { has_country_leader = { ruling_only = yes name = "King Sombra"} }
				}
				country_event = crysom.48
				if = {
					limit = { 
						FROM = {
							original_tag = EQS
							has_government = democratic
						}
					}
					country_event = crysom.40
				}
				if = {
					limit = {
						#has_country_leader = { ruling_only = yes name = "Radiant Hope" }
						FROM = { has_government = fascism }
					}
					kill_country_leader = yes
				}
			}
			if = {
				limit = { FROM = { original_tag = NLR } original_tag = EQS }
				FROM = { annex_country = { target = ROOT } }
			}
			if = {
				limit = {
					FROM = {
						original_tag = EQS
					}
				}
				if = {
					limit = { original_tag = NLR }
					FROM = { annex_country = { target = ROOT } }
				}
				country_event = equestria.170
				if = {
					limit = { original_tag = CRY }
					if = {
						limit = {
							has_government = democratic
							FROM = { has_government = democratic }
							NOT = {
								has_country_leader = { ruling_only = yes name = "Princess Mi Amore Cadenza" }
								has_country_leader = { ruling_only = yes name = "Princess Twilight Sparkle" }
								has_country_leader = { ruling_only = yes name = "Princess Flurry Heart" }
							}
							OR = {
								AND = {
									OR = {
										has_global_flag = free_the_old_royalty
										has_global_flag = continue_imprisonment
									}
								}
								AND = {
									has_global_flag = royalty_executed
									NOT = { country_exists = event_target:solar_empire }
									NOT = { has_global_flag = SOL_twilight_converted }
								}
							}
							has_global_flag = sombra_returned
						}
						country_event = { id = crysom.40 days = 1 }
					}
					if = {
						limit = {
							NOT = {
								has_idea = equestrian_overlord
								has_idea = equestrian_overlord2
								has_idea = equestrian_overlord3
							}
						}
						if = {
							limit = { has_completed_focus = CRY_subordination }
							add_ideas = equestrian_overlord3
							else = { 
								if = {
									limit = { has_completed_focus = CRY_eqsengineers }
									add_ideas = equestrian_overlord2
									else = { add_ideas = equestrian_overlord }
								}
							}
						}
					}
				}
				if = {
					limit = {
						FROM = { 
							OR = {
								original_tag = EQS
								original_tag = CRY
							}
							has_government = democratic 
						}
						tag = CHN
					}
					FROM = {
						country_event = { id = changelings.39 days = 1 }
					}
				}
			}
			if = {
				limit = {
					FROM = {
						NOT = { has_idea = modern_society }
					}
				}
				hidden_effect = { FROM = { ROOT = { transfer_society_ideas = yes } } }
				else = {
					hidden_effect = { add_ideas = modern_society }
				}
			}
			if = {
				limit = {
					FROM = {
						NOT = { has_idea = proper_science_base }
					}
				}
				hidden_effect = { FROM = { ROOT = { transfer_science_ideas = yes } } }
				else = {
					hidden_effect = { add_ideas = proper_science_base }
				}
			}
			if = {
				limit = {
					original_tag = EQC
				}
				if = {
					limit = {
						FROM = {
							OR = {
								original_tag = EQS
								original_tag = NLR
							}
						}
					}
					if = {
						limit = { FROM = { is_EQS_SOL = yes } }
						create_country_leader = {
							name = "Arcane Nova"
							picture = "ArcaneNova.tga"
							expire = "1965.1.1"
							ideology = falangism
							traits = {
							}
						}
						set_party_name = { ideology = fascism long_name = EQC_SOL_fascism_party_long name = EQC_SOL_fascism_party }
						if = {
							limit = {
								has_country_flag = EQC_destined_to_be_an_RK
							}
							FROM = { set_autonomy = { target = ROOT autonomy_state = autonomy_reichskommissariat } }
						}
						load_focus_tree = eqc_sol_focus
						set_global_flag = SOL_chose_EQC_leader
						set_province_name = { id = 10005 name = "Sunset"}
					}
					if = {
						limit = { FROM = { tag = NLR } }
						set_country_flag = EQC_NLR_LoyalBat
						set_party_name = { ideology = fascism long_name = EQC_bat_supporters_fash name = EQC_bat_supporters_fash }
						create_country_leader = {
							name = "Flawless Glow"
							desc = "POLITICS_FLAWLESS_GLOW"
							picture = "FlawlessGlow.tga"
							expire = "1965.1.1"
							ideology = fascism_ideology
							id = 717
							traits = {
							}
						}
						load_focus_tree = eqc_nlr_focus
					}
					country_event = equestriancolony.1
					else = {
						if = {
							limit = {
								has_country_flag = equalist_eqc
								NOT = { has_government = communism }
							}
							country_event = equestriancolony.4
							else = {
								if = {
									limit = {
										has_country_flag = is_maresoc
									}
									country_event = equestriancolony.3
								}
								else = {
									if = {
										limit = { NOT = { has_focus_tree = new_mareland_focus } }
										load_focus_tree = new_mareland_focus
										country_event = equestriancolony.2
									}
								}
							}
						}
					}
				}
			}
			if = {
				limit = {
					tag = JER
				}
				if = {
					limit = {
						OR = {
							has_government = democratic
							has_government = communism
						}
						NOT = { has_country_flag = JER_AWPR_wins }
						FAT = { has_unit_leader = 75654 }
					}
					FAT = { country_event = griffonRepublic.84 }
				}
				if = {
					limit = {
						has_government = communism
						NOT = { 
							has_completed_focus = JER_election_radicals
							has_completed_focus = JER_election_moderates
						}
					}
					complete_national_focus = JER_election_moderates
				}
				if = {
					limit = {
						has_government = democratic
						NOT = { 
							has_completed_focus = JER_election_democracy
						}
					}
					complete_national_focus = JER_election_democracy
				}
				if = {
					limit = {
						has_government = neutrality
						NOT = { 
							has_completed_focus = JER_absolute_rule
						}
					}
					complete_national_focus = JER_absolute_rule
				}
				if = {
					limit = {
						has_government = fascism
						NOT = { 
							has_completed_focus = JER_fascist_coup
						}
					}
					set_country_flag = JER_fash_bypass
					complete_national_focus = JER_fascist_coup
					clr_country_flag = JER_fash_bypass
				}
			}
			#COSMETIC TAG ON PUPPET BELOW, DO NOT USE break = yes ABOVE
			if = {
				limit = { original_tag = STG }
				if = {
					limit = {
						FROM = { has_government = democratic }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_EQS
						load_focus_tree = generic_focus
					}
					break = yes
				}
				if = {
					limit = {
						FROM = { NOT = { tag = EQS } has_government = democratic }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_DEM
						load_focus_tree = generic_focus
					}
					break = yes
				}
				if = {
					limit = {
						FROM = { has_government = fascism }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_PAGAN
						load_focus_tree = generic_focus
					}
					break = yes
				}
				if = {
					limit = {
						FROM = { has_government = neutrality }
					}
					ROOT = {
						drop_cosmetic_tag = yes
						set_cosmetic_tag = STG_MONARCHY
						load_focus_tree = generic_focus
					}
					break = yes
				}
				break = yes
			}
			if = {
				limit = {
					FROM = {
						tag = event_target:griffonian_empire
						NOT = { has_country_flag = have_regular_puppets }
					}
					is_feudal_vassal = yes
				}
				country_event = griffonian.1
				break = yes
			}
			if = {
				limit = {
					FROM = {
						has_country_flag = FEA_STW_union
					}
					OR = {
						tag = STW
						tag = FEA
					}
				}
				FROM = { 
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_personal_union
					}
					clr_country_flag = FEA_STW_union
					drop_cosmetic_tag = yes
				}
				break = yes
			}
			if = {
				limit = {
					FROM = {
						tag = event_target:solar_empire
						has_government = fascism
					}
				}
				if = {
					limit = { original_tag = CRY }
					FROM = {
						set_country_flag = SOL_twilight_governor
						set_autonomy = { target = ROOT autonomy_state = autonomy_reichskommissariat }
					}
					set_cosmetic_tag = CRY_SOL
					add_autonomy_ratio = { value = -0.20 }
					set_country_flag = CRY_solar_governorship
					load_focus_tree = crystal_empire_solar_focus
					set_party_name = { ideology = fascism long_name = SOL_fascism_party_long name = SOL_fascism_party }
					if = {
						limit = {
							NOT = { has_global_flag = SOL_twilight_converted }
							has_global_flag = SOL_chose_EQC_leader
							any_other_country = {
								NOT = { has_country_leader = { ruling_only = yes name = "Arcane Nova" } }
							}
						}
						create_country_leader = {
							name = "Arcane Nova"
							#desc = "TWILIGHT_DESC"
							picture = "ArcaneNova.tga"
							expire = "1965.1.1"
							ideology = falangism
							traits = {
							}
						}
						else = {
							if = {
								limit = {
									has_global_flag = SOL_twilight_converted
								}
								create_country_leader = {
									name = "Grand Inquisitor Sunrise Sparkle"
									#desc = "TWILIGHT_DESC"
									picture = "TwilightSunrise.tga"
									expire = "1965.1.1"
									ideology = falangism
									traits = {
										lady_inquisitor
									}
								}
								else = {
									create_country_leader = {
										name = "Nameless Busybody"
										expire = "1965.1.1"
										ideology = falangism
										traits = {
										}
									}
								}
							}
						}
					}
					break = yes
				}
				if = {
					limit = { original_tag = PLB }
					country_event = solarempire.1000
					break = yes
				}
				if = {
					limit = { original_tag = GRF }
					country_event = solarempire.1001
					break = yes
				}
				if = {
					limit = { original_tag = PNG }
					country_event = solarempire.1002
					break = yes
				}
				if = {
					limit = { original_tag = STL }
					country_event = solarempire.1003
					break = yes
				}
				if = {
					limit = { original_tag = BUF }
					country_event = solarempire.1004
					break = yes
				}
				if = {
					limit = { original_tag = DRG }
					country_event = solarempire.1005
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = solarempire.1006
					break = yes
				}
				if = {
					limit = { original_tag = OLE }
					country_event = solarempire.1008
					break = yes
				}
				if = {
					limit = { original_tag = BAL }
					country_event = solarempire.1009
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					country_event = solarempire.1010
					break = yes
				}
				if = {
					limit = { original_tag = JUN }
					country_event = solarempire.1011
					break = yes
				}
				if = {
					limit = { original_tag = SCS }
					country_event = solarempire.1012
					break = yes
				}
				if = {
					limit = { original_tag = STG }
					country_event = solarempire.1013
					break = yes
				}
				if = {
					limit = { original_tag = JAK }
					country_event = solarempire.1015
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					country_event = solarempire.1010
					break = yes
				}
				if = {
					limit = { original_tag = CHN }
					country_event = solarempire.1016
					break = yes
				}
				if = {
					limit = { original_tag = YAK }
					country_event = solarempire.1017
					break = yes
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = NLR
						has_government = fascism
					}
				}
				if = {
					limit = { original_tag = PLB }
					country_event = { id = lunas.900 }
					break = yes
				}
				if = {
					limit = { original_tag = GRF }
					country_event = { id = lunas.902 }
					break = yes
				}
				if = {
					limit = { original_tag = PNG }
					country_event = { id = lunas.901 }
					break = yes
				}
				if = {
					limit = { original_tag = STL }
					country_event = { id = lunas.903 }
					break = yes
				}
				if = {
					limit = { original_tag = BUF }
					country_event = { id = lunas.904 }
					break = yes
				}
				if = {
					limit = { original_tag = DRG }
					country_event = { id = lunas.905 }
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = { id = lunas.906 }
					break = yes
				}
				if = {
					limit = { original_tag = OLE }
					country_event = { id = lunas.911 }
					break = yes
				}
				if = {
					limit = { original_tag = BAL }
					country_event = { id = lunas.912 }
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					country_event = { id = lunas.913 }
					break = yes
				}
				if = {
					limit = { original_tag = JUN }
					country_event = { id = lunas.914 }
					break = yes
				}
				if = {
					limit = { original_tag = SCS }
					country_event = { id = lunas.916 }
					break = yes
				}
				if = {
					limit = { original_tag = STG }
					country_event = { id = lunas.917 }
					break = yes
				}
				if = {
					limit = { original_tag = CRY }
					country_event = { id = lunas.918 }
					break = yes
				}
				if = {
					limit = { original_tag = JAK }
					country_event = { id = lunas.919 }
					break = yes
				}
				if = {
					limit = { original_tag = CHN }
					country_event = { id = lunas.920 }
					break = yes
				}
				if = {
					limit = { original_tag = YAK }
					country_event = { id = lunas.921 }
					break = yes
				}
			}

			if = {
				limit = {
					FROM = {
						original_tag = CHN
						has_government = fascism
					}
				}
				if = {
					limit = { original_tag = OLE }
					country_event = { id = olenia.718 }
					break = yes
				}
				if = {
					limit = { original_tag = PLB }
					country_event = { id = changelings.900 }
					break = yes
				}
				if = {
					limit = { original_tag = GRF }
					country_event = { id = changelings.902 }
					break = yes
				}
				if = {
					limit = { original_tag = PNG }
					country_event = { id = changelings.901 }
					break = yes
				}
				if = {
					limit = { original_tag = STL }
					country_event = { id = changelings.903 }
					break = yes
				}
				if = {
					limit = { original_tag = BUF }
					country_event = { id = changelings.904 }
					break = yes
				}
				if = {
					limit = { original_tag = DRG }
					country_event = { id = changelings.905 }
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = { id = changelings.906 }
					break = yes
				}
				if = {
					limit = { original_tag = GFF }
					country_event = { id = changelings.906 }
					break = yes
				}
				if = {
					limit = { original_tag = OLE }
					country_event = { id = olenia.718 }
					break = yes
				}
				if = {
					limit = { original_tag = CRY }
					country_event = { id = crystalemp.23 }
					break = yes
				}
				if = {
					limit = { original_tag = EQS }
					country_event = { id = equestriachn.3 }
					break = yes
				}
				if = {
					limit = { original_tag = STG }
					country_event = { id = stalliongrad.98 }
					break = yes
				}
				if = {
					limit = { original_tag = YAK }
					country_event = { id = yakistan.12 }
					break = yes
				}
				if = {
					limit = { original_tag = JAK }
					country_event = { id = yakistan.13 }
					break = yes
				}
				if = {
					limit = { original_tag = SCS }
					set_cosmetic_tag = CHN_confpuppet
					break = yes
				}
				if = {
					limit = { original_tag = JUN }
					set_cosmetic_tag = JUN_CHN
					break = yes
				}
				if = {
					limit = { original_tag = CES }
					set_cosmetic_tag = CES_CHN
					break = yes
				}
				if = {
					limit = { original_tag = BAL }
					set_cosmetic_tag = BAL_CHN
					break = yes
				}
				if = {
					limit = { original_tag = MAN }
					set_cosmetic_tag = MAN_CHN
					CHN = {
						set_country_flag = released_manehattan_puppet
					}
					break = yes
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = FAT
					}
				}
				if = {
					limit = { original_tag = SRS }
					country_event = griffonRepublic.100
					break = yes
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = EQS
						has_government = democratic
					}
				}
				if = {
					limit = { original_tag = BUF }
					country_event = bufstate.36
					break = yes
				}
			}
		}
	}

	#ROOT is subject FROM is overlord
	on_subject_annexed = {
		effect = {
			if = {
				limit = {
					OR = {
						tag = STW
						tag = FEA
					}
					OR = {
						has_country_flag = FEA_STW_marriage
						FROM = { has_country_flag = FEA_STW_marriage }
					}
					FROM = {
						OR = {
							tag = STW
							tag = FEA
						}
						OR = {
							has_country_leader = { ruling_only = yes name = "Duchess Gabriela Eagleclaw" }
							has_idea = FEA_beloved_monarch
							has_idea = FEA_beloved_monarch_2
							has_idea = FEA_beloved_monarch_3
						}
					}
					OR = {
						has_country_leader = { ruling_only = yes name = "Duchess Gabriela Eagleclaw" }
						has_idea = FEA_beloved_monarch
						has_idea = FEA_beloved_monarch_2
						has_idea = FEA_beloved_monarch_3
					}
				}
				FROM = {
					set_country_flag = FEA_STW_union
					set_cosmetic_tag = FEA_STW_union
				}
			}
		}
	}

	#ROOT is winner #FROM gets annexed - For civil wars on_civil_war_end is also fired
	on_annex = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_annex"
			if = {
				limit = {
					NOT = { has_country_flag = recovery_idea_bypass }
					OR = {
						original_tag = FROM
						AND = {
							original_tag = EQS
							FROM = { original_tag = NLR }
						}
						AND = {
							FROM = { original_tag = EQS }
							original_tag = NLR
						}
					}
				}
				add_timed_idea = { 
					idea = civil_war_recovery
					days = 210
				}
			}
			if = {
				limit = {
					FROM = { tag = event_target:griffonian_empire }
				}
				GRI = { save_global_event_target_as = griffonian_empire}
			}
			#if = {
			#	limit = {
			#		tag = CCN
			#		FROM = { tag = CHN }
			#	}
			#	country_event = { id = thoraxian.41 days = 7 }
			#}
			if = {
				limit = {
					tag = CHN
					FROM = { original_tag = OLE }
				}
				FROM = { set_country_flag = OLE_was_annexed }
			}

			if = {
				limit = {
					tag = event_target:solar_empire
					FROM = {
						has_country_flag = EQS_CRY_has_twilight
						original_tag = EQS
					}
				}
				country_event = solarempire.22
			}
			if = {
				limit = {
					tag = event_target:solar_empire
					FROM = {
						has_country_flag = EQS_CRY_has_twilight
						original_tag = CRY
					}
				}
				news_event = solarempire.26
			}
			if = {
				limit = {
					FROM = {
						tag = JER
						has_idea = JER_revolutionary
					}
					FAT = {
						exists = yes
						is_subject = no
					}
				}
				FAT = { country_event = { id = griffonRepublic.83 days = 15 } }
			}
			if = {
				limit = {
					OR = {
						tag = JEB
						tag = JES
						tag = VIN
						tag = JFT
						tag = JRR
					}
					FROM = {
						tag = JER
					}
				}
				news_event = aquileia_news.5
			}
			if = {
				limit = {
					tag = event_target:solar_empire
					FROM = { original_tag = EQC }
				}
				set_province_name = { id = 10005 name = "Sunset"}
			}
		}
	}

	#ROOT is winner FROM gets annexed
	on_civil_war_end = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_civil_war_end"
			if = {
				limit = {
					original_tag = OLE
					NOT = { tag = OLE }
				}
				set_cosmetic_tag = OLE_CWWON
				set_capital = 76
			}
			if = {
				limit = {
					original_tag = EQS
					FROM = { original_tag = EQS has_government = communism }
				}
				country_event = { id = equestriadem.8 days = 60 }
				country_event = { id = equestria.44 days = 1 }
			}
			if = {
				limit = {
					tag = event_target:equestria
					FROM = { tag = event_target:solar_empire }
				}
				set_capital = 3
				SOL = { save_global_event_target_as = solar_empire }
				break = yes
			}
			if = {
				limit = {
					FROM = {tag = event_target:equestria }
					tag = event_target:solar_empire
				}
				SOL = {
					set_politics = { ruling_party = democratic }
					save_global_event_target_as = equestria
				}
				set_country_flag = { flag = SOL_next_civ_war_delay value = 1 days = 180 }
				break = yes
			}
			if = {
				limit = {
					original_tag = CRY
					FROM = { original_tag = CRY }
				}
				if = {
					limit = { 
						has_country_leader = { ruling_only = yes name = "King Sombra" }
					}
					country_event = { id = crysom.16 hours = 12 }
					if = {
						limit = { event_target:equestria = { exists = yes } }
						random_list = {
							30 = { 
								event_target:equestria = { 
									country_event = { id = crysom.49 hours = 2 }
								}
								country_event = { id = crysom.50 hours = 1 }
							}
							70 = { country_event = { id = crysom.41 hours = 1 } }
						}
						else = { country_event = { id = crysom.41 hours = 1 } }
					}
				}
				if = {
					limit = { 
						has_government = communism
						FROM = { has_government = democratic }
					}
					news_event = { id = news.cry.1 days = 1 }
				}
				set_capital = 344
				break = yes
			}
			if = {
				limit = {
					original_tag = OLE
					FROM = { original_tag = OLE }
				}
				set_cosmetic_tag = OLE_CWWON
				drop_cosmetic_tag = yes
				if = {
					limit = {
						any_country = {
							original_tag = OLE
							has_government = democratic
						}
					}
					random_country = {
						limit = {
							original_tag = OLE
							has_government = democratic
							exists = yes
						}
						save_global_event_target_as = democratic_OLE
					}
					else = {
						random_country = {
							limit = { original_tag = OLE exists = yes}
							save_global_event_target_as = democratic_OLE
						}
					}
				}
				break = yes
			}
			#End of ideology Civil War

			# Give back WNG focus tree to Beakolini if he wins the civil war.
			if = {
				limit = {
					original_tag = WNG
					has_government = fascism
					FROM = {
						original_tag = WNG
						NOT = { has_government = fascism }
					}
				}
				load_focus_tree = { tree = Wingbardy keep_completed = no }
				unlock_national_focus = WNG_march_on_karthin
				unlock_national_focus = WNG_meet_with_beakolini
				unlock_national_focus = WNG_a_fascist_prime_minister
			}
			#End WNG Civil War Event
			if = {
				limit = {
					FROM = {
						original_tag = WNG
						has_government = fascism
					}
					original_tag = WNG
					has_government = communism
				}
				country_event = { id = wingbardy.51 days = 1 }
			}
			#End of EQC MARESOC Civil War
			if = {
				limit = {
					FROM = {
						original_tag = EQC
						has_country_flag = is_maresoc
					}
					original_tag = EQC
				}
				country_event = { id = mareland.26 days = 1 }
			}
			if = {
				limit = {
					FROM = {
						original_tag = EQC
					}
					original_tag = EQC
					has_country_flag = is_maresoc
				}
				country_event = { id = mareland.27 days = 1 }
			}
		}
	}
	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_capitulation"
			if = {
				limit = {
					tag = EQP
				}
				EQS = { annex_country = { target = EQP } }
			}
			if = {
				limit = {
					tag = CHN
					FROM = { tag = CCN }
				}
				transfer_navy = { target = FROM }
			}
			if = {
				limit = {
					tag = TRD
					FROM = { tag = event_target:griffonian_empire }
				}
				transfer_navy = { target = FROM }
			}
			if = {
				limit = {
					FROM = {
						tag = DED
						NOT = { has_country_flag = DED_capitulated@ROOT}
					}
				}
				set_country_flag = DED_capitulated@ROOT
				if = {
					limit = { is_major = yes }
					FROM = { modify_country_flag = { flag = DED_killed_nations value = 5 } }
					else = {
						FROM = { modify_country_flag = { flag = DED_killed_nations value = 1 } }
					}
				}
			}
			if = {
				limit = {
					tag = event_target:equestria
					has_country_flag = EQS_CRY_has_twilight
					FROM = { tag = event_target:solar_empire }
				}
				FROM = { country_event = solarempire.22 }
			}
			if = {
				limit = {
					original_tag = CRY
					has_country_flag = EQS_CRY_has_twilight
					FROM = { tag = event_target:solar_empire }
				}
				FROM = { news_event = solarempire.26 }
			}
		}
	}
	#ROOT is free nation FROM is releaser
	on_release_as_free = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_release_as_free"
			if = {
				limit = { tag = DED }
				FROM = {
					annex_country = { target = ROOT  }
					country_event = { id = deadempire.29 days = 1 }
				}
			}
			if = {
				limit = { 
					original_tag = CRY
				#	has_focus_tree = crystalempire_sombra
				#	NOT = { has_country_leader = { ruling_only = yes name = "King Sombra"} }
				}
				country_event = crysom.48
			}
			if = {
				limit = { FROM = { original_tag = EQS } }
				country_event = equestria.170
			}
			if = {
				limit = {
					FROM = {
						has_country_flag = FEA_STW_union
					}
					OR = {
						tag = STW
						tag = FEA
					}
				}
				FROM = {
					clr_country_flag = FEA_STW_union
					drop_cosmetic_tag = yes
				}
			}
			if = {
				limit = {
					OR = {
						has_idea = dummy_idea_society
						#has_idea = modern_society
						NOT = { has_idea_with_trait = society_idea }
					}
					FROM = {
						NOT = {
							has_idea = modern_society
						}
					}
				}
				FROM = { ROOT = { transfer_society_ideas = yes } }
				else = { add_ideas = modern_society }
			}
			if = {
				limit = {
					OR = {
						has_idea = dummy_idea_science
						#has_idea = modern_society
						NOT = { has_idea_with_trait = science_idea }
					}
					FROM = {
						NOT = {
							has_idea = proper_science_base
						}
					}
				}
				FROM = { ROOT = { transfer_science_ideas = yes } }
				else = {
					add_ideas = proper_science_base
				}
			}
			if = {
				limit = {
					tag = JER
				}
				if = {
					limit = {
						OR = {
							has_government = democratic
							has_government = communism
						}
						NOT = { has_country_flag = JER_AWPR_wins }
						FAT = { has_unit_leader = 75654 }
					}
					FAT = { country_event = griffonRepublic.84 }
				}
				if = {
					limit = {
						has_government = communism
						NOT = { 
							has_completed_focus = JER_election_radicals
							has_completed_focus = JER_election_moderates
						}
					}
					complete_national_focus = JER_election_moderates
				}
				if = {
					limit = {
						has_government = democratic
						NOT = { 
							has_completed_focus = JER_election_democracy
						}
					}
					complete_national_focus = JER_election_democracy
				}
				if = {
					limit = {
						has_government = neutrality
						NOT = { 
							has_completed_focus = JER_absolute_rule
						}
					}
					complete_national_focus = JER_absolute_rule
				}
				if = {
					limit = {
						has_government = fascism
						NOT = { 
							has_completed_focus = JER_fascist_coup
						}
					}
					set_country_flag = JER_fash_bypass
					complete_national_focus = JER_fascist_coup
					clr_country_flag = JER_fash_bypass
				}
			}
		}
	}

	on_subject_free = {
		effect = {
			log = "ROOT: [Root.GetName] FROM: [From.GetName] on_subject_free"
			if = {
				limit = {
					has_cosmetic_tag = GRI_SUBJECT
				}
				country_event = griffonian.2
				break = yes
			}
			if = {
				limit = {
					has_country_flag = is_changeling_puppet
					NOT = { tag = EQS }
				}
				country_event = changelings.910
				break = yes
			}
			if = {
				limit = {
					has_country_flag = is_changeling_puppet
					original_tag = EQS
					num_of_controlled_states > 15
					controls_fillydelphia = yes
					controls_manehattan = yes
					controls_los_pegasus = yes
					controls_baltimare = yes
					controls_canterlot = yes
				}
				country_event = changelings.911
				break = yes
			}
			if = {
				limit = {
					original_tag = EQC
					OR = {
						has_cosmetic_tag = EQC_EQS
						has_cosmetic_tag = EQC_SOL
						has_cosmetic_tag = EQC_NLR
					}
				}
				country_event = equestriancolony.2
				break = yes
			}
			if = {
				limit = {
					NOT = { original_tag = EQS }
					has_country_flag = is_luna_puppet
				}
				country_event = lunas.910
				break = yes
			}
			if = {
				limit = {
					original_tag = CRY
					NOT = {
						is_subject_of = event_target:solar_empire
						is_in_faction_with = event_target:solar_empire
					}
					has_country_flag = is_sol_puppet
				}
				country_event = solarempiresparkles.104
				break = yes
			}
			if = {
				limit = {
					has_country_flag = is_solar_puppet
				}
				country_event = solarempire.1007
				break = yes
			}
			if = {
				limit = {
					has_country_flag = is_FAT_puppet
				}
				country_event = griffonRepublic.101
				break = yes
			}
		}
	}

	on_government_change = {
		effect = {
			log = "ROOT: [Root.GetName] on_government_change"
			if = {
				limit = { original_tag = CRY }
				if = {
					limit = {
						has_government = democratic
						NOT = {
							has_country_leader = { ruling_only = yes name = "Princess Mi Amore Cadenza" }
							has_country_leader = { ruling_only = yes name = "Princess Twilight Sparkle" }
							has_country_leader = { ruling_only = yes name = "Princess Flurry Heart" }
						}
						OR = {
							AND = {
								OR = {
									has_global_flag = free_the_old_royalty
									has_global_flag = continue_imprisonment
								}
							}
							AND = {
								has_global_flag = royalty_executed
								NOT = { country_exists = event_target:solar_empire }
								NOT = { has_global_flag = SOL_twilight_converted }
							}
						}
						has_global_flag = sombra_returned
					}
					country_event = { id = crysom.40 days = 1 }
				}
				#if = {
				#	limit = { 
				#		has_focus_tree = crystalempire_sombra
				#		NOT = { has_country_leader = { ruling_only = yes name = "King Sombra"} }
				#	}
					country_event = { id = crysom.48 hours = 1 }
				#}
				if = {
					limit = {
						has_country_leader = { ruling_only = yes name = "Radiant Hope" }
						has_global_flag = sombra_returned
					}
					kill_country_leader = yes
				}
			}
			if = {
				limit = {
					original_tag = BAN
					has_government = neutrality
				}
				clr_country_flag = have_regular_puppets
			}
			if = {
				limit = { 
					original_tag = STG 
					is_subject = no
				}
				if = {
					limit = {
						has_government = democratic
					}
					drop_cosmetic_tag = yes
					set_cosmetic_tag = STG_DEM
					break = yes
				}
				if = {
					limit = {
						has_government = fascism
					}
					drop_cosmetic_tag = yes
					set_cosmetic_tag = STG_PAGAN
					break = yes
				}
				if = {
					limit = {
						has_government = neutrality
					}
					drop_cosmetic_tag = yes
					set_cosmetic_tag = STG_MONARCHY
					break = yes
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					OR = {
						has_idea = griffon_neutrality_support_idea
						has_idea = griffon_monarchy_support_idea
					}
					NOT = { has_government = neutrality }
				}
				remove_ideas = { griffon_monarchy_support_idea griffon_neutrality_support_idea }
			}
			if = {
				limit = {
					OR = {
						has_idea = griffon_monarchy_dem_support_idea
						has_idea = griffon_harmony_support_idea
					}
					NOT = { has_government = democratic }
				}
				remove_ideas = { griffon_monarchy_dem_support_idea griffon_harmony_support_idea }
			}
			if = {
				limit = {
					OR = {
						has_idea = griffon_fascism_support_idea
						has_idea = griffon_monarchy_fas_support_idea
					}
					NOT = { has_government = fascism }
				}
				remove_ideas = { griffon_monarchy_fas_support_idea griffon_fascism_support_idea }
			}
			if = {
				limit = {
					has_idea = griffon_communism_support_idea
					NOT = { has_government = communism }
				}
				remove_ideas = griffon_communism_support_idea
			}
			if = {
				limit = {
					original_tag = FEA
					OR = {
						has_cosmetic_tag = FEA_PvdA_old_flag
						has_cosmetic_tag = FEA_PvdA_old_flag_GRI_Puppet
					}
					OR = {
						NOT = { has_government = communism }
						AND = {
							is_subject = yes
							overlord = { has_government = communism }
						}
					}
				}
				drop_cosmetic_tag = yes
			}
			if = {
				limit = {
					original_tag = EQS
					tag = event_target:solar_empire
					NOT = { has_government = fascism }
				}
				if = {
					limit = { event_target:equestria = { exists = no } }
					save_global_event_target_as = equestria
				}
				SOL = { save_global_event_target_as = solar_empire }
				load_focus_tree = equestria_focus
			}
		}
	}

	#ROOT is winner #FROM is loser
	on_peaceconference_ended = {
		effect = {
			# PUT EVERYTHING IN THE IF BELOW
			# THE bypass_on_peaceconference_ended FLAG **HAS** TO BE SET BEFORE CALLING THE white_peace COMMAND AND CLEARED AFTERWARDS
			if = {
				limit = { 
					NOT = {
						has_country_flag = bypass_on_peaceconference_ended
						FROM = { has_country_flag = bypass_on_peaceconference_ended }
					}
				}
				log = "ROOT: [Root.GetName] FROM: [From.GetName] on_peaceconference_ended"
				every_state = {
					limit = {
						is_core_of = FROM
					}
					add_to_variable = { FROM.industry_value = industrial_complex_level }
					add_to_variable = { FROM.industry_value = arms_factory_level }
				}
				every_state = {
					limit = {
						is_core_of = FROM
					}
					set_state_flag = op_paperclip_state
					set_variable = { previous_owner = FROM.id }
					set_variable = { previous_owner_industry_value = FROM.industry_value }
				}
				FROM = { clear_variable = industry_value }
				country_event = oppaperclip.1
				if = {
					limit = {
						OR = {
							has_government = democratic
							has_government = communism
						}
						FROM = { 
							tag = CHN 
							OR = {
								has_unit_leader = 600
								has_unit_leader = 602
								has_unit_leader = 606
								has_unit_leader = 607
							}
						}
					}
					hidden_effect = {
						# SOL is used as limbo
						event_target:CHN_Trimmel = { set_nationality = SOL }
						event_target:CHN_Vect = { set_nationality = SOL }
						event_target:CHN_Opertis = { set_nationality = SOL }
						event_target:CHN_Ersatz = { set_nationality = SOL }
					}
				}
				if = {
					limit = { original_tag = EQS }
					if = {
						limit = {
							FROM = { is_major = yes NOT = { tag = CHN } }
						}
						set_country_flag = EQS_had_big_war
						country_event = { id = equestriadem.8 days = 60 }
					}
					if = {
						limit = {
							is_ai = yes
							has_government = democratic
							any_owned_state = {
								is_core_of = OLE
							}
							NOT = { country_exists = OLE }
						}
						release_puppet = OLE
					}
					if = {
						limit = {
							is_ai = yes
							has_government = democratic
							country_exists = OLE
							OLE = { is_subject_of = ROOT }
							any_owned_state = {
								is_core_of = OLE
							}
						}
						every_owned_state = {
							limit = { is_core_of = OLE }
							OLE = { transfer_state = PREV } 
						}
					}
					if = {
						limit = {
							FROM = { tag = CHN }
						}
						country_event = { id = news.2101 days = 1 }
						country_event = { id = equestriadem.8 days = 60 }
					}
					if = {
						limit = {
							has_global_flag = equestrian_civil_war
							FROM = { tag = NLR }
						}
						country_event = { id = news.2031 days = 1 }
						country_event = { id = equestriadem.8 days = 60 }
						if = {
							limit = { country_exists = FROM }
							annex_country = { target = FROM }
						}
					}
					if = {
						limit = {
							has_global_flag = the_crystal_war
							FROM = { original_tag = CRY }
							
						}
						news_event = { id = news.42 days = 1}
						clr_global_flag = the_crystal_war
					}
				}
				if = {
					limit = {
						original_tag = STG
						FROM = { tag = CHN }
					}
					country_event = { id = news.2201 days = 1 }
				}
				if = {
					limit = {
						FROM = { original_tag = EQS }
						tag = NLR
					}
					if = {
						limit = { country_exists = FROM }
						annex_country = { target = FROM }
					}
					country_event = { id = news.2041 days = 1 }
					country_event = { id = lunas.35 random = 200 }
				}

				if = {
					limit = {
						has_global_flag = equestrian_civil_war
						tag = NLR
						FROM = { original_tag = NLR }
					}
					country_event = { id = news.2041 days = 1 }
				}

				if = {
					limit = {
						tag = event_target:solar_empire
						FROM = { tag = event_target:equestria }
					}
					country_event = { id =  news.sol.31 days = 1 }
					every_other_country = {
						limit = {
							NOT = { is_subject_of = event_target:solar_empire }
							is_in_faction_with = event_target:solar_empire
						}
						leave_faction = yes
					}
				}

				if = {
					limit = {
						has_global_flag = the_crystal_war
						FROM = { original_tag = EQS  }
						original_tag = CRY					
					}
					news_event = { id = news.43 days = 1}
					clr_global_flag = the_crystal_war
				}

				if = {
					limit = {
						FROM = { tag = event_target:solar_empire  }
						tag = event_target:equestria
					}
					country_event = { id =  news.sol.21 days = 1 }
				}

				if = {
					limit = { FROM = { tag = DED } }
					annex_country = { target = FROM  }
					country_event = { id = deadempire.29 days = 1 }
				}

				if = {
					limit = {
						FROM = {
							tag = DED
							NOT = { has_country_flag = DED_capitulated@ROOT}
						}
					}
					set_country_flag = DED_capitulated@ROOT
					if = {
						limit = { is_major = yes }
						FROM = { modify_country_flag = { flag = DED_killed_nations value = 5 } }
						else = {
							FROM = { modify_country_flag = { flag = DED_killed_nations value = 1 } }
						}
					}
				}

				if = {
					limit = {
						tag = HLR
						FROM = { tag = EWI }
					}
					country_event = { id = arcturian.50 days = 1 }
				}

				if = {
					limit = {
						tag = BRF
						FROM = { tag = GRW }
					}
					country_event = { id = brodfeld.21 days = 1 }
				}
			}
		}
	}

	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					original_tag = CRY
					has_government = democratic
					NOT = { has_idea = crystal_heart }
					FROM.FROM = { state = 344 }
				}
				add_ideas = crystal_heart
			}

			if = {
				limit = {
					has_war_with = FROM
					FROM.FROM = {
						is_owned_by = FROM
						NOT = { has_state_flag = state_has_fallen }
					}
				}
				if = {#River City
					limit = { FROM.FROM = { state = 619 } }
					news_event = { id = cityfall.5 }
				}
				if = {#Sunset
					limit = { FROM.FROM = { state = 356 } }
					news_event = { id = cityfall.6 }
				}
			}			
		}
	}

	#FROM is country getting invited.
	#on_offer_join_faction = {
	#	effect = {
	#		if = {
	#			limit = { original_tag = EQS }
	#			 FROM = { country_event = equestria.170 }
	#		}
	#	}
	#}

	#FROM is faction leader on join faction requests. THIS DOES NOT FIRE ON ADD_TO_FACTION EFFECT! USE ON_OFFER_JOIN_FACTION!
	#on_join_faction = {
	#	effect = {
	#		if = {
	#			limit = { FROM = { original_tag = EQS } }
	#			country_event = equestria.170
	#		}
	#	}
	#}

	# ROOT is country, this is ran for every country
	on_daily = {
		effect = {
			if = {
				limit = { has_idea = GRF_got_mercs_delayed }
				add_to_variable = { GRF_delayed_merc_payment = 1 }
			}
			if = {
				limit = { 
					has_tech = nukes 
				}
				if = {
					limit = { 
						has_idea = no_crystals_reactor_prevent
						check_variable = { resource@crystals > -1 } 
					}
					remove_ideas = no_crystals_reactor_prevent
					else = {
						if = {
							limit = { check_variable = { resource@crystals < 0 } }
							add_ideas = no_crystals_reactor_prevent
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = OLE
					OR = {
						has_government = democratic
						NOT = { any_other_country = { original_tag = OLE } }
					}
					OR = {
						NOT = { has_event_target = democratic_OLE }
						NOT = { country_exists = event_target:democratic_OLE }
						event_target:democratic_OLE = { NOT = { original_tag = OLE } }
					}
				}
				save_global_event_target_as = democratic_OLE
				break = yes
			}
			if = {
				limit = { 
					OR = {
						NOT = { has_event_target = griffonian_empire }
						if = {
							limit = { has_event_target = griffonian_empire }
							event_target:griffonian_empire = { exists = no }
						}
					}
					exists = yes
					OR = {
						AND = {
							owns_state = 382
							has_cosmetic_tag = GRIF_EMPIRE
						}
						if = {
							limit = {
								382 = {
									owner = { NOT = { has_cosmetic_tag = GRIF_EMPIRE } }
								}
							}
							tag = GRI
						}
					}
				}
				save_global_event_target_as = griffonian_empire
			}
		}
	}
}
