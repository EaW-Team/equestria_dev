on_actions = {
    on_startup = {
        effect = {
            every_state = {
                limit = {
                    is_core_of = WNG
                }
                set_state_flag = WNG_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = LAK
                }
                set_state_flag = LAK_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = FAL
                }
                set_state_flag = FAL_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = JES
                }
                set_state_flag = JES_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = FRN
                }
                set_state_flag = FRN_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = TAL
                }
                set_state_flag = TAL_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = ARA
                }
                set_state_flag = ARA_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = ABY
                }
                set_state_flag = ABY_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = SIC
                }
                set_state_flag = SIC_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = MIT
                }
                set_state_flag = MIT_ORIGINAL_CORE_FLAG
            }


            every_state = {
                limit = {
                    is_core_of = CYA
                }
                set_state_flag = CYA_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = BAN
                }
                set_state_flag = BAN_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = BOI  
                }
                set_state_flag = BOI_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = HIP
                }
                set_state_flag = HIP_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    or = {
                        is_core_of = BRF
                        is_core_of = GRW
                    }
                    
                }
                set_state_flag = BRF_ORIGINAL_CORE_FLAG
            }
        }
    }
    
    on_daily_CTH = {
        effect = {
            ##SOW graphic change
            if = {
                limit = {
                    has_completed_focus = CTH_MZO_reorganiz_the_old_command_system
                }
                set_variable = { MZN_MI_POINTER_COUNT_BAR_VAR = MZN_MI_var}
                multiply_variable = { MZN_MI_POINTER_COUNT_BAR_VAR = -5.2}
                set_variable = { MZN_IR_POINTER_COUNT_BAR_VAR = MZN_IR_var}
                multiply_variable = { MZN_IR_POINTER_COUNT_BAR_VAR = -5.2}
            }
            
        }
    }
    on_daily_CTH = {
    effect = {
        ##TOE ACT CHECK
        if = {
            limit = {
                has_country_flag = MZN_ACT_under_voting
            }
            add_to_variable = { MZN_TOE_ACT_BAR_var = 3.3 }
            add_to_variable = { MZN_TOE_DAYS_COUNTING_var = 1 }
            clamp_variable = {
                var = MZN_TOE_ACT_BAR_var
                max = 100
            }

            clamp_variable = {
                var = MZN_TOE_DAYS_COUNTING_var
                max = 31
            }
        }

        if = {
            limit = {
                has_country_flag = MZN_progressive_act
                has_country_flag = MZN_NA_conservatives_unpleasant
            }
            add_to_variable = { MZN_ACT_NA_need_var = 1 }
            clr_country_flag = MZN_NA_conservatives_unpleasant
        }

        if = {
            limit = {
                check_variable = { MZN_TOE_DAYS_COUNTING_var = 31}
            }
            clr_country_flag = MZN_ACT_under_voting

            if = {
                limit = {
                    has_country_flag = MZN_progressive_act
                }
                if = {
                    limit = {
                        check_variable = { MZN_ACT_NA_need_var < MZN_NA_attitude }
                    }
                    if = {
                        limit = {
                            check_variable = { MZN_ACT_SC_need_var < MZN_PJDI_SC_attitude }
                        }

                        country_event = colthage_monzano_act.1
                    }

                    else = {
                        country_event = colthage_monzano_act.3
                    }
                }

                else = {
                    country_event = colthage_monzano_act.2
                }
            }

            else_if = {
                limit = {
                    has_country_flag = MZN_conservative_act
                }
                if = {
                    limit = {
                        check_variable = { MZN_ACT_NA_need_var > MZN_NA_attitude }
                    }
                    if = {
                        limit = {
                            check_variable = { MZN_ACT_SC_need_var > MZN_PJDI_SC_attitude }
                        }

                        country_event = colthage_monzano_act.1
                    }

                    else = {
                        country_event = colthage_monzano_act.3
                    }
                }

                else = {
                    country_event = colthage_monzano_act.2
                }
            }

            else = {
                country_event = colthage_monzano_act.1
            }
        }

        else = {

        }
    }
}

    on_daily_CTH = {
        effect = {
            every_country = {
				limit = {
					controls_state = 697
				}
                CTH = {
                    set_variable = { MZN_tag_control_697 = PREV }
                }
			}
        }
    }

    on_monthly_CTH = {
        effect = {
            if = {
                limit = {
                    has_completed_focus = CTH_MZN_offer_democracy_instruction_to_ally
                }
            }
            every_country = {
                limit = {
                    is_subject_of = CTH
                    is_in_array = {
                        array = MZN_MSFNCP_NZ_MEMBERS_ARRAY
                        value = PREV
                    }
                }
                add_dynamic_modifier = {
                    modifier = MZN_MSFNCP_MEMBER_modifier 
                }
            }
        }
    }

    on_daily_CTH = {
        effect = {
            if = {
                limit = {
                    has_country_flag = MZN_NZF_reform_start
                    not = {
                        check_variable = { MZN_NZF_reform_process > 100 }
                    }
                }
                add_to_variable = { MZN_NZF_reform_process = MZN_NZF_reform_speed_var }
                set_variable = { MZN_NZF_days_need_var = 100 }
                subtract_from_variable = { MZN_NZF_days_need_var = MZN_NZF_reform_process }
                divide_variable = { MZN_NZF_days_need_var = MZN_NZF_reform_speed_var }
                set_variable = { MZN_NZF_days_need_show_var = MZN_NZF_days_need_var }
                round_variable = MZN_NZF_days_need_show_var
            }

            else_if = {
                limit = {
                    check_variable = { MZN_NZF_reform_process > 100 }
                }
                set_variable = { MZN_NZF_reform_process = 0 }

                clr_country_flag = MZN_NZF_reform_start
                MZN_NZF_reform_effects = yes
            }
        }
    }

    on_daily_CTH = {
        effect = {
            if = {
                limit = {
                    has_country_flag = MZN_BAT_counter_start
                    check_variable = { MZN_SOW_OSE_var < 99.9 }
                }
                add_to_variable = { MZN_SOW_OSE_var = 0.8 }
                clamp_variable = { MZN_SOW_OSE_var max = 100 }
                add_to_variable = { MZN_SOW_OSE_left_days = -1 }
            }
            
            else_if = {
                limit = {
                    check_variable = { MZN_SOW_OSE_var = 100 }
                }
                BAT = {
                    remove_ideas = MZN_BAT_ID
                }
                NLR = {
                    declare_war_on = {
                        target = CTH
                        type = annex_everything
                    }
                }
            }
        }
    }

    on_daily_CTH = {
        effect = {
            if = {
                limit = {
                    check_variable = { MZN_NZF_policy_cooldown_days_left_var > 1 }
                }
                add_to_variable = { MZN_NZF_policy_cooldown_days_left_var = -1 }
            }

            else_if = {
                limit = {
                    check_variable = { MZN_NZF_policy_cooldown_days_left_var = 0 }
                    or = {
                        check_variable = { MZN_NZF_policy_1_frame_var = 2 }
                        check_variable = { MZN_NZF_policy_2_frame_var = 2 }
                        check_variable = { MZN_NZF_policy_3_frame_var = 2 }
                        check_variable = { MZN_NZF_policy_4_frame_var = 2 }
                        check_variable = { MZN_NZF_policy_5_frame_var = 2 }
                        check_variable = { MZN_NZF_policy_6_frame_var = 2 }
                    }
                }
                set_variable = { MZN_NZF_policy_1_frame_var = 1 }
                set_variable = { MZN_NZF_policy_2_frame_var = 1 }
                set_variable = { MZN_NZF_policy_3_frame_var = 1 }
                set_variable = { MZN_NZF_policy_4_frame_var = 1 }
                set_variable = { MZN_NZF_policy_5_frame_var = 1 }
                set_variable = { MZN_NZF_policy_6_frame_var = 1 }
            }
        }
    }

    on_peaceconference_ended = {
        effect = {
            if = {
                limit = {
                    original_tag = CTH
                    CTH = {
                        has_country_flag = MZN_OSW_start
                    }
                    WNG = {
                        or = {
                            exists = no
                            is_subject = yes
                        }
                    }
                }
                CTH = {
                    if = {
                        limit = {
                            owns_state = 371
                        }
                        set_country_flag = MZN_totally_won
                    }
                    clr_country_flag = MZN_OSW_start
                    set_country_flag = MZN_threaten_of_foreign_has_been_neutralize
                    mark_focus_tree_layout_dirty = yes
                }
            }
        }
    }
}

