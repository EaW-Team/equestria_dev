on_actions = {
    on_startup = {
        effect = {
            every_state = {
                limit = {
                    is_owned_by = EQC
                }
                set_state_flag = EQC_ORIGINAL_CORE_FLAG
            }

            every_STATE = {
                limit = {
                    or = {
                        is_owned_by = WAR
                        is_owned_by = TBK
                        is_owned_by = BAT
                        is_owned_by = ZAR
                    }
                }
                set_state_flag = NZ_continent_state_flag
            }

            every_state = {
                limit = {
                    is_owned_by = WNG
                }
                set_state_flag = WNG_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = LAK
                }
                set_state_flag = LAK_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = FAL
                }
                set_state_flag = FAL_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = JES
                }
                set_state_flag = JES_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = FRN
                }
                set_state_flag = FRN_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = TAL
                }
                set_state_flag = TAL_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = ARA
                }
                set_state_flag = ARA_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = ABY
                }
                set_state_flag = ABY_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = SIC
                }
                set_state_flag = SIC_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = MIT
                }
                set_state_flag = MIT_ORIGINAL_CORE_FLAG
            }


            every_state = {
                limit = {
                    is_owned_by = CYA
                }
                set_state_flag = CYA_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = BAN
                }
                set_state_flag = BAN_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_owned_by = BOI  
                }
                set_state_flag = BOI_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    is_core_of = HIP
                }
                set_state_flag = HIP_ORIGINAL_CORE_FLAG
            }

            every_state = {
                limit = {
                    or = {
                        is_owned_by = BRF
                        is_owned_by = GRW
                    }
                }
                set_state_flag = BRF_ORIGINAL_CORE_FLAG
            }
        }
    }

    on_daily = {
        effect = {
            #SOW graphic change thing
            if = {
                limit = {
                    tag = MZN
                    has_completed_focus = CTH_MZO_reorganiz_the_old_command_system
                }
                set_variable = { MZN_MI_POINTER_COUNT_BAR_VAR = MZN_MI_var}
                multiply_variable = { MZN_MI_POINTER_COUNT_BAR_VAR = -5.2}
                set_variable = { MZN_IR_POINTER_COUNT_BAR_VAR = MZN_IR_var}
                multiply_variable = { MZN_IR_POINTER_COUNT_BAR_VAR = -5.2}
            }
            #Ain Trotgourait
            if = {
                limit = {
                    tag = MZN
                }
                every_country = {
                    limit = {
                        controls_state = 697
                    }
                    MZN = {
                        set_variable = { MZN_tag_control_697 = PREV }
                    }
                }
            }
            #mcw
            if = {
                limit = {
                    tag = MZN
                    has_war_with = MCW
                }
                set_variable = { MZN_MCW_NW_CAL = MCW.surrender_progress }
                multiply_variable = { MZN_MCW_NW_CAL = 100 }
                set_variable = { MZN_MCW_NW = MZN_MCW_NW_CAL }
            }
            ##combat_readiness
            if = {
                limit = {
                    check_variable = { MZN_MI_var > 70 }
                }
                add_ideas = MZN_combat_readiness
            }

            if = {
                limit = {
                    has_idea = MZN_combat_readiness
                    check_variable = { MZN_MI_var < 69 }
                }
                remove_ideas = MZN_combat_readiness
            }
        }
    }

    on_daily = {
    effect = {
        ##TOE ACT CHECK
        if = {
            limit = {
                has_country_flag = MZN_ACT_under_voting
            }
            add_to_variable = { MZN_TOE_ACT_BAR_var = 3.3 }
            add_to_variable = { MZN_TOE_DAYS_COUNTING_var = 1 }
            clamp_variable = {
                var = MZN_TOE_ACT_BAR_var
                max = 100
            }

            clamp_variable = {
                var = MZN_TOE_DAYS_COUNTING_var
                max = 31
            }
        }

        if = {
            limit = {
                has_country_flag = MZN_progressive_act
                has_country_flag = MZN_NA_conservatives_unpleasant
            }
            add_to_variable = { MZN_ACT_NA_need_var = 1 }
            clr_country_flag = MZN_NA_conservatives_unpleasant
        }

        if = {
            limit = {
                check_variable = { MZN_TOE_DAYS_COUNTING_var = 31}
            }
            clr_country_flag = MZN_ACT_under_voting

            if = {
                limit = {
                    has_country_flag = MZN_progressive_act
                }
                if = {
                    limit = {
                        check_variable = { MZN_ACT_NA_need_var = MZN_NA_attitude compare = less_than_or_equals }
                    }
                    if = {
                        limit = {
                            check_variable = { MZN_ACT_SC_need_var = MZN_SC_attitude compare = less_than_or_equals }
                        }

                        country_event = colthage_monzano_act.1
                    }

                    else = {
                        country_event = colthage_monzano_act.3
                    }
                }

                else = {
                    country_event = colthage_monzano_act.2
                }
            }

            else_if = {
                limit = {
                    has_country_flag = MZN_conservative_act
                }
                if = {
                    limit = {
                        check_variable = { MZN_ACT_NA_need_var = MZN_NA_attitude compare = greater_than_or_equals }
                    }
                    if = {
                        limit = {
                            check_variable = { MZN_ACT_SC_need_var = MZN_SC_attitude compare = greater_than_or_equals }
                        }

                        country_event = colthage_monzano_act.1
                    }

                    else = {
                        country_event = colthage_monzano_act.3
                    }
                }

                else = {
                    country_event = colthage_monzano_act.2
                }
            }

            else = {
                country_event = colthage_monzano_act.1
            }
        }

        else = {

        }
    }
    }

    on_daily = {
        effect = {
            ##reform
            if = {
                limit = {
                    tag = MZN
                    has_country_flag = MZN_NZF_reform_start
                    check_variable = { MZN_NZF_reform_process < 100 }
                }
                add_to_variable = { MZN_NZF_reform_process = MZN_NZF_reform_speed_var }
                clamp_variable = { MZN_NZF_reform_process = 100 }
                set_variable = { MZN_NZF_days_need_var = 100 }
                subtract_from_variable = { MZN_NZF_days_need_var = MZN_NZF_reform_process }
                divide_variable = { MZN_NZF_days_need_var = MZN_NZF_reform_speed_var }
                set_variable = { MZN_NZF_days_need_show_var = MZN_NZF_days_need_var }
                round_variable = MZN_NZF_days_need_show_var
                clamp_variable = { var = MZN_NZF_days_need_show_var min = 0 }
            }
            else_if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_reform_process = 100 compare = greater_than_or_equals }
                }
                set_variable = { MZN_NZF_reform_process = 0 }
                
                clr_country_flag = MZN_NZF_reform_start
                clr_country_flag = MZN_reform_alert_lock
                MZN_NZF_reform_effects = yes
            }
        }
    }

    on_daily = {
        effect = {
            ##policies
            if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_policy_cooldown_days_left_var = 0 }
                    has_country_flag = MZN_NZF_policy_implementing
                }
                set_variable = { MZN_NZF_policy_name = token:MZN_NZF_NO_chosen_policy }
                clr_country_flag = MZN_policies_alert_lock
                clr_country_flag = MZN_NZF_policy_implementing
            }
            ##ALERT
            if = {
                limit = {
                    tag = MZN
                    has_completed_focus = CTH_MZN_offer_democracy_instruction_to_ally
                    not = {
                        has_country_flag = MZN_NZF_policy_implementing
                        has_country_flag = MZN_policies_alert_lock
                    }
                }
                set_country_flag = MZN_policies_alert_lock
                MZN_NZF_policies_available = yes
            }
            if = {
                limit = {
                    tag = MZN
                    has_completed_focus = CTH_MZN_dream_of_superstate
                    not = {
                        has_country_flag = MZN_NZF_reform_start
                        has_country_flag = MZN_reform_alert_lock
                    }
                }
                set_country_flag = MZN_reform_alert_lock
                MZN_NZF_reform_available = yes
            }
        }
    }

    on_daily = {
        effect = {
            if = {
                limit = {
                    tag = MZN
                    has_country_flag = MZN_BAT_counter_start
                    check_variable = { MZN_SOW_OSE_var < 99.9 }
                }
                add_to_variable = { MZN_SOW_OSE_var = 0.8 }
                clamp_variable = { MZN_SOW_OSE_var max = 100 }
                add_to_variable = { MZN_SOW_OSE_left_days = -1 }
            }
            
            else_if = {
                limit = {
                    check_variable = { MZN_SOW_OSE_var = 100 }
                }
                BAT = {
                    remove_ideas = MZN_BAT_ID
                }
                NLR = {
                    declare_war_on = {
                        target = CTH
                        type = annex_everything
                    }
                }
            }
        }
    }

    on_daily = {
        effect = {
            if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_policy_cooldown_days_left_var > 0 }
                }
                add_to_variable = { MZN_NZF_policy_cooldown_days_left_var = -1 }
            }

            if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_policy_cooldown_days_left_var = 0 }
                }

                if = {
                    limit = {
                        check_variable = { MZN_NZF_policy_5_frame_var = 2 }
                    }
                    set_variable = { MZN_NZF_policy_5_frame_var = 1 }
                }

                if = {
                    limit = {
                        check_variable = { MZN_NZF_policy_6_frame_var = 2 }
                    }
                    set_variable = { MZN_NZF_policy_6_frame_var = 1 }
                }
            }

            if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_policy_1_frame_var = 2 }
                    not = {
                        has_idea = MZN_policy_1_idea
                    }
                }
                set_variable = { MZN_NZF_policy_1_frame_var = 1 }
            }

            if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_policy_2_frame_var = 2 }
                    not = {
                        has_idea = MZN_policy_2_idea
                    }
                }
                set_variable = { MZN_NZF_policy_2_frame_var = 1 }
            }

            if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_policy_3_frame_var = 2 }
                    not = {
                        has_idea = MZN_policy_3_idea
                    }
                }
                set_variable = { MZN_NZF_policy_3_frame_var = 1 }
            }

            if = {
                limit = {
                    tag = MZN
                    check_variable = { MZN_NZF_policy_4_frame_var = 2 }
                    not = {
                        has_idea = MZN_policy_4_idea
                    }
                }
                set_variable = { MZN_NZF_policy_4_frame_var = 1 }
            }
        }
    }

    on_daily = {
        if = {
            limit = {
                tag = MZN
                has_country_flag = MZN_OSW_start
            }
            CTH = {
                set_variable = { MZN_WNG_WAR_casualties = CTH.casualties }
            }
        }
    }

    on_monthly = {
        if = {
            limit = {
                tag = MZN
                has_idea = MZN_Zasom
            }
            CTH = {
                add_to_variable = { MZN_Zasom_oil = 3 }
                add_to_variable = { MZN_Zasom_consumer_goods = 0.001 }
            }
        }
    }

    on_monthly = {
        if = {
            limit = {
                tag = MZN
                has_idea = MZN_HOC
            }

            if = {
                limit = {
                    has_country_flag = MZN_no_C_flag
                }
                add_to_variable = { MZN_corruption_var = -1 }
            }

            if = {
                limit = {
                    has_country_flag = MZN_offensive_attitude
                }
                
                add_to_variable = { MZN_MI_var = 1 }
                clamp_variable = { MZN_MI_var = 100 }
            }

            if = {
                limit = {
                    has_country_flag = MZN_defensive_attitude
                }
                add_to_variable = { MZN_IR_var = 1 }
                clamp_variable = { MZN_IR_var = 100 }
            }

            if = {
                limit = {
                    has_war = yes
                }
                every_enemy_country = {
                    add_political_power = -10
                    add_stability = -0.02
                    add_war_support = -0.02
                }
            }

            if = {
                limit = {
                    has_country_flag = MZN_military_first
                }
                set_variable = { MZN_HOC_consumer_goods = 0.03 }
                random_list = {
                    MZN_HOC_MF = {
                        add_offsite_building = { type = arms_factory level = 1 }
                        set_variable = { MZN_HOC_MF = 0 }
                        set_variable = { MZN_HOC_MF_CAL_2 = 0 }
                    }

                    50 = {
                        add_to_variable = { MZN_HOC_MF = 10 }
                        set_variable = { MZN_HOC_MF_CAL = MZN_HOC_MF }
                        set_variable = { MZN_HOC_MF_CAL_2 = MZN_HOC_MF }
                        add_to_variable = { MZN_HOC_MF_CAL = 50 }
                        divide_variable = { MZN_HOC_MF_CAL_2 = MZN_HOC_MF_CAL}
                    }
                }
            }

            if = {
                limit = {
                    has_country_flag = MZN_people_first
                }
                set_variable = { MZN_HOC_consumer_goods = 0.03 }
                random_list = {
                    MZN_HOC_CF = {
                        add_offsite_building = { type = industrial_complex level = 1 }
                        set_variable = { MZN_HOC_CF = 0 }
                        set_variable = { MZN_HOC_CF_CAL_2 = 0 }
                    }

                    80 = {
                        add_to_variable = { MZN_HOC_CF = 10 }
                        set_variable = { MZN_HOC_CF_CAL = MZN_HOC_CF }
                        set_variable = { MZN_HOC_CF_CAL_2 = MZN_HOC_CF }
                        add_to_variable = { MZN_HOC_CF_CAL = 80 }
                        divide_variable = { MZN_HOC_CF_CAL_2 = MZN_HOC_CF_CAL}
                    }
                }
            }

            if = {
                limit = {
                    has_completed_focus = CTH_MZN_liberty_first_strategy
                }
                set_variable = { MZN_HOC_Compliance = 0.10 }
            }

            if = {
                limit = {
                    has_completed_focus = CTH_MZN_democratic_way
                }
                set_variable = { MZN_HOC_SAG = -1 }
            }

            random_list = {
                15 = {
                    add_political_power = 30
                }
                15 = {
                    add_war_support = 0.002
                }
                15 = {
                    add_stability = 0.002
                }
                55 = {

                }
            }
        }
    }

    on_declare_war = {
        effect = {
            if = {
                limit = {
                    tag = MZN
                    FROM = { tag = BAT }
                    NLR = {
                        exists = yes
                    }
                    has_country_flag = MZN_OSE_unlocks
                }
                set_country_flag = MZN_BAT_counter_start
                BAT = {
                    add_ideas = MZN_BAT_ID
                }
            }
        }
    }

    on_declare_war = {
        effect = {
            if = {
                limit = {
                    or = {
                        and = {
                            tag = MZN
                            FROM = { tag = MCW }
                        }
                        and = {
                            tag = MCW
                            FROM = { tag = MZN }
                        }
                    }
                }
            }
            MCW = {
                country_event = colthage_monzano_diplomacy_MCW.8
            }
        }
    }

    on_peaceconference_ended = {
        effect = {
            if = {
                limit = {
                    original_tag = CTH
                    CTH = {
                        has_country_flag = MZN_OSW_start
                    }
                    WNG = {
                        or = {
                            exists = no
                            is_subject = yes
                        }
                    }
                }
                CTH = {
                    if = {
                        limit = {
                            371 = {
                                is_owned_and_controlled_by_ROOT_or_ally = yes
                            }
                        }
                        set_country_flag = MZN_totally_won
                    }
                    clr_country_flag = MZN_OSW_start
                    set_country_flag = MZN_threaten_of_foreign_has_been_neutralize
                    clr_country_flag = MZN_OSW_ENABLED_FLAG
                    mark_focus_tree_layout_dirty = yes
                    scoped_play_song = "Artem_Yegorov_The_Heart_Carol"
                }
            }
        }
    }
}

